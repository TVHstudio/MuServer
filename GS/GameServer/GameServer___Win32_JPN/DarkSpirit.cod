; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.30319.01 

	TITLE	E:\work\tranet_version\GS\GameServer\DarkSpirit.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

_DATA	SEGMENT
_g_iNpcUpDfLevel_CGATE DD 01H
	DD	02H
	DD	02dc6c0H
	DD	02H
	DD	03H
	DD	02dc6c0H
	DD	03H
	DD	04H
	DD	02dc6c0H
_g_iNpcUpDfLevel_CSTATUE DD 01H
	DD	03H
	DD	02dc6c0H
	DD	02H
	DD	05H
	DD	02dc6c0H
	DD	03H
	DD	07H
	DD	02dc6c0H
_g_iNpcUpMaxHP_CGATE DD 02625a0H
	DD	02H
	DD	0f4240H
	DD	03567e0H
	DD	03H
	DD	0f4240H
	DD	04f5880H
	DD	04H
	DD	0f4240H
_g_iNpcUpMaxHP_CSTATUE DD 02191c0H
	DD	03H
	DD	0f4240H
	DD	033e140H
	DD	05H
	DD	0f4240H
	DD	04c4b40H
	DD	07H
	DD	0f4240H
_g_iNpcUpRgLevel_CSTATUE DD 01H
	DD	03H
	DD	04c4b40H
	DD	02H
	DD	05H
	DD	04c4b40H
	DD	03H
	DD	07H
	DD	04c4b40H
_g_iCsUserReSpawnArea DD 023H
	DD	011H
	DD	090H
	DD	030H
	DD	04aH
	DD	090H
	DD	073H
	DD	09aH
	DD	023H
	DD	011H
	DD	090H
	DD	030H
_g_iNpcDefense_CGATE DD 064H
	DD	0b4H
	DD	012cH
	DD	0208H
_g_iNpcDefense_CSTATUE DD 050H
	DD	0b4H
	DD	0154H
	DD	0226H
_g_iCastleWallStepAxisY DD 071H
	DD	0a0H
	DD	0cbH
_g_sttBLOODCASTLE_LEVEL DD 0fH
	DD	050H
	DD	0aH
	DD	03cH
	DD	051H
	DD	082H
	DD	03dH
	DD	06eH
	DD	083H
	DD	0b4H
	DD	06fH
	DD	0a0H
	DD	0b5H
	DD	0e6H
	DD	0a1H
	DD	0d2H
	DD	0e7H
	DD	0118H
	DD	0d3H
	DD	0104H
	DD	0119H
	DD	014aH
	DD	0105H
	DD	0136H
	DD	014bH
	DD	03e8H
	DD	0137H
	DD	03e8H
	DD	0fH
	DD	04afH
	DD	0aH
	DD	04afH
_g_sttCHAOSCASTLE_LEVEL DD 0fH
	DD	031H
	DD	0fH
	DD	01dH
	DD	032H
	DD	077H
	DD	01eH
	DD	063H
	DD	078H
	DD	0b3H
	DD	064H
	DD	09fH
	DD	0b4H
	DD	0efH
	DD	0a0H
	DD	0dbH
	DD	0f0H
	DD	012bH
	DD	0dcH
	DD	0117H
	DD	012cH
	DD	03e8H
	DD	0118H
	DD	03e8H
	DD	03e8H
	DD	04afH
	DD	03e8H
	DD	04afH
_g_iChaosCastle_BlowOutDistance DD 03H
	DD	04H
	DD	03H
	DD	04H
	DD	02H
	DD	03H
	DD	00H
	DD	01H
_g_iChaosCastle_BlowOutDamage DD 0fH
	DD	0fH
	DD	0aH
	DD	05H
_g_iChaosCastle_EnterCost DD 061a8H
	DD	013880H
	DD	0249f0H
	DD	03d090H
	DD	061a80H
	DD	09eb10H
	DD	0f4240H
_g_iChaosCastle_GuardSetValue DD 09c4H
	DD	09c4H
	DD	09c4H
	DD	09c4H
	DD	09c4H
	DD	09c4H
	DD	09c4H
_g_iChaosCastle_MonsterItems DD 01c0dH
	DD	01H
	DD	01c0eH
	DD	02H
	DD	01c0dH
	DD	01H
	DD	01c0eH
	DD	03H
	DD	01c0dH
	DD	01H
	DD	01c0eH
	DD	03H
	DD	01c0dH
	DD	02H
	DD	01c0eH
	DD	02H
	DD	01c0dH
	DD	02H
	DD	01c0eH
	DD	03H
	DD	01c0dH
	DD	02H
	DD	01c0eH
	DD	03H
	DD	01c0dH
	DD	02H
	DD	01c0eH
	DD	04H
_g_iChaosCastle_MonsterItemsNewServer DD 00H
	DD	00H
	DD	01c0eH
	DD	02H
	DD	01c0dH
	DD	01H
	DD	01c0eH
	DD	01H
	DD	01c0dH
	DD	01H
	DD	01c0eH
	DD	02H
	DD	01c0dH
	DD	01H
	DD	01c0eH
	DD	02H
	DD	01c0dH
	DD	02H
	DD	01c0eH
	DD	01H
	DD	01c0dH
	DD	02H
	DD	01c0eH
	DD	02H
	DD	01c0dH
	DD	02H
	DD	01c0eH
	DD	03H
_g_iChaosCastle_GroundAxis DD 017H
	DD	04bH
	DD	02cH
	DD	06cH
_g_iChaosCastle_DamageAxis DD 017H
	DD	04bH
	DD	02cH
	DD	06cH
	DD	019H
	DD	04dH
	DD	02aH
	DD	06aH
	DD	01bH
	DD	04fH
	DD	028H
	DD	068H
	DD	01dH
	DD	051H
	DD	026H
	DD	066H
_g_iChaosCastle_MapHollowZone DD 017H
	DD	04bH
	DD	02cH
	DD	04cH
	DD	02bH
	DD	04dH
	DD	02cH
	DD	06cH
	DD	017H
	DD	06bH
	DD	02aH
	DD	06cH
	DD	017H
	DD	04dH
	DD	018H
	DD	06aH
	DD	017H
	DD	04bH
	DD	02cH
	DD	04cH
	DD	02bH
	DD	04dH
	DD	02cH
	DD	06cH
	DD	017H
	DD	06bH
	DD	02aH
	DD	06cH
	DD	017H
	DD	04dH
	DD	018H
	DD	06aH
	DD	019H
	DD	04dH
	DD	02aH
	DD	04eH
	DD	029H
	DD	04fH
	DD	02aH
	DD	06aH
	DD	019H
	DD	069H
	DD	028H
	DD	06aH
	DD	019H
	DD	04fH
	DD	01aH
	DD	068H
	DD	01bH
	DD	04fH
	DD	028H
	DD	050H
	DD	027H
	DD	051H
	DD	028H
	DD	068H
	DD	01bH
	DD	067H
	DD	026H
	DD	068H
	DD	01bH
	DD	051H
	DD	01cH
	DD	066H
_DATA	ENDS
PUBLIC	?set@PBMSG_HEAD@@QAEXPAEEE@Z			; PBMSG_HEAD::set
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\include\prodef.h
;	COMDAT ?set@PBMSG_HEAD@@QAEXPAEEE@Z
_TEXT	SEGMENT
_lpBuf$ = 8						; size = 4
_head$ = 12						; size = 1
_size$ = 16						; size = 1
?set@PBMSG_HEAD@@QAEXPAEEE@Z PROC			; PBMSG_HEAD::set, COMDAT
; _this$ = ecx

; 80   : 	{

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 81   : 		lpBuf[0] = 0xC1;

  00003	8b 45 08	 mov	 eax, DWORD PTR _lpBuf$[ebp]

; 82   : 		lpBuf[1] = size;

  00006	8a 4d 10	 mov	 cl, BYTE PTR _size$[ebp]

; 83   : 		lpBuf[2] = head;

  00009	8a 55 0c	 mov	 dl, BYTE PTR _head$[ebp]
  0000c	c6 00 c1	 mov	 BYTE PTR [eax], 193	; 000000c1H
  0000f	88 48 01	 mov	 BYTE PTR [eax+1], cl
  00012	88 50 02	 mov	 BYTE PTR [eax+2], dl

; 84   : 	};	// line : 22

  00015	5d		 pop	 ebp
  00016	c2 0c 00	 ret	 12			; 0000000cH
?set@PBMSG_HEAD@@QAEXPAEEE@Z ENDP			; PBMSG_HEAD::set
_TEXT	ENDS
PUBLIC	??_H@YGXPAXIHP6EPAX0@Z@Z			; `vector constructor iterator'
; Function compile flags: /Ogtp
;	COMDAT ??_H@YGXPAXIHP6EPAX0@Z@Z
_TEXT	SEGMENT
___t$ = 8						; size = 4
___s$ = 12						; size = 4
___n$ = 16						; size = 4
___f$ = 20						; size = 4
??_H@YGXPAXIHP6EPAX0@Z@Z PROC				; `vector constructor iterator', COMDAT
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	57		 push	 edi
  00004	8b 7d 10	 mov	 edi, DWORD PTR ___n$[ebp]
  00007	4f		 dec	 edi
  00008	78 14		 js	 SHORT $LN1@vector
  0000a	53		 push	 ebx
  0000b	8b 5d 14	 mov	 ebx, DWORD PTR ___f$[ebp]
  0000e	56		 push	 esi
  0000f	8b 75 08	 mov	 esi, DWORD PTR ___t$[ebp]
$LL2@vector:
  00012	8b ce		 mov	 ecx, esi
  00014	ff d3		 call	 ebx
  00016	03 75 0c	 add	 esi, DWORD PTR ___s$[ebp]
  00019	4f		 dec	 edi
  0001a	79 f6		 jns	 SHORT $LL2@vector
  0001c	5e		 pop	 esi
  0001d	5b		 pop	 ebx
$LN1@vector:
  0001e	5f		 pop	 edi
  0001f	5d		 pop	 ebp
  00020	c2 10 00	 ret	 16			; 00000010H
??_H@YGXPAXIHP6EPAX0@Z@Z ENDP				; `vector constructor iterator'
_TEXT	ENDS
PUBLIC	?GetCastleState@CCastleSiege@@QAEHXZ		; CCastleSiege::GetCastleState
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\castlesiege.h
;	COMDAT ?GetCastleState@CCastleSiege@@QAEHXZ
_TEXT	SEGMENT
?GetCastleState@CCastleSiege@@QAEHXZ PROC		; CCastleSiege::GetCastleState, COMDAT
; _this$ = ecx

; 314  : 	int GetCastleState(){return m_iCastleSiegeState;}

  00000	8b 41 28	 mov	 eax, DWORD PTR [ecx+40]
  00003	c3		 ret	 0
?GetCastleState@CCastleSiege@@QAEHXZ ENDP		; CCastleSiege::GetCastleState
_TEXT	ENDS
PUBLIC	?GetCrywolfState@CCrywolf@@QAEHXZ		; CCrywolf::GetCrywolfState
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\crywolf.h
;	COMDAT ?GetCrywolfState@CCrywolf@@QAEHXZ
_TEXT	SEGMENT
?GetCrywolfState@CCrywolf@@QAEHXZ PROC			; CCrywolf::GetCrywolfState, COMDAT
; _this$ = ecx

; 91   : 	int GetCrywolfState(){return this->m_iCrywolfState;}

  00000	8b 81 ec b7 0f
	00		 mov	 eax, DWORD PTR [ecx+1030124]
  00006	c3		 ret	 0
?GetCrywolfState@CCrywolf@@QAEHXZ ENDP			; CCrywolf::GetCrywolfState
_TEXT	ENDS
PUBLIC	??_7CDarkSpirit@@6B@				; CDarkSpirit::`vftable'
PUBLIC	??1CDarkSpirit@@UAE@XZ				; CDarkSpirit::~CDarkSpirit
PUBLIC	??_R4CDarkSpirit@@6B@				; CDarkSpirit::`RTTI Complete Object Locator'
PUBLIC	??_R0?AVCDarkSpirit@@@8				; CDarkSpirit `RTTI Type Descriptor'
PUBLIC	??_R3CDarkSpirit@@8				; CDarkSpirit::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2CDarkSpirit@@8				; CDarkSpirit::`RTTI Base Class Array'
PUBLIC	??_R1A@?0A@EA@CDarkSpirit@@8			; CDarkSpirit::`RTTI Base Class Descriptor at (0,-1,0,64)'
PUBLIC	??_R1A@?0A@EA@CObjBaseAttack@@8			; CObjBaseAttack::`RTTI Base Class Descriptor at (0,-1,0,64)'
PUBLIC	??_R0?AVCObjBaseAttack@@@8			; CObjBaseAttack `RTTI Type Descriptor'
PUBLIC	??_R3CObjBaseAttack@@8				; CObjBaseAttack::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2CObjBaseAttack@@8				; CObjBaseAttack::`RTTI Base Class Array'
EXTRN	??1CObjBaseAttack@@UAE@XZ:PROC			; CObjBaseAttack::~CObjBaseAttack
EXTRN	??_7type_info@@6B@:QWORD			; type_info::`vftable'
EXTRN	??_ECDarkSpirit@@UAEPAXI@Z:PROC			; CDarkSpirit::`vector deleting destructor'
EXTRN	?MissCheck@CObjBaseAttack@@UAEHPAUOBJECTSTRUCT@@0HHHAAHE@Z:PROC ; CObjBaseAttack::MissCheck
;	COMDAT ??_R2CObjBaseAttack@@8
; File e:\work\tranet_version\gs\gameserver\darkspirit.cpp
rdata$r	SEGMENT
??_R2CObjBaseAttack@@8 DD FLAT:??_R1A@?0A@EA@CObjBaseAttack@@8 ; CObjBaseAttack::`RTTI Base Class Array'
rdata$r	ENDS
;	COMDAT ??_R3CObjBaseAttack@@8
rdata$r	SEGMENT
??_R3CObjBaseAttack@@8 DD 00H				; CObjBaseAttack::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	01H
	DD	FLAT:??_R2CObjBaseAttack@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVCObjBaseAttack@@@8
_DATA	SEGMENT
??_R0?AVCObjBaseAttack@@@8 DD FLAT:??_7type_info@@6B@	; CObjBaseAttack `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVCObjBaseAttack@@', 00H
_DATA	ENDS
;	COMDAT ??_R1A@?0A@EA@CObjBaseAttack@@8
rdata$r	SEGMENT
??_R1A@?0A@EA@CObjBaseAttack@@8 DD FLAT:??_R0?AVCObjBaseAttack@@@8 ; CObjBaseAttack::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	00H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3CObjBaseAttack@@8
rdata$r	ENDS
;	COMDAT ??_R1A@?0A@EA@CDarkSpirit@@8
rdata$r	SEGMENT
??_R1A@?0A@EA@CDarkSpirit@@8 DD FLAT:??_R0?AVCDarkSpirit@@@8 ; CDarkSpirit::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	01H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3CDarkSpirit@@8
rdata$r	ENDS
;	COMDAT ??_R2CDarkSpirit@@8
rdata$r	SEGMENT
??_R2CDarkSpirit@@8 DD FLAT:??_R1A@?0A@EA@CDarkSpirit@@8 ; CDarkSpirit::`RTTI Base Class Array'
	DD	FLAT:??_R1A@?0A@EA@CObjBaseAttack@@8
rdata$r	ENDS
;	COMDAT ??_R3CDarkSpirit@@8
rdata$r	SEGMENT
??_R3CDarkSpirit@@8 DD 00H				; CDarkSpirit::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	02H
	DD	FLAT:??_R2CDarkSpirit@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVCDarkSpirit@@@8
_DATA	SEGMENT
??_R0?AVCDarkSpirit@@@8 DD FLAT:??_7type_info@@6B@	; CDarkSpirit `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVCDarkSpirit@@', 00H
_DATA	ENDS
;	COMDAT ??_R4CDarkSpirit@@6B@
rdata$r	SEGMENT
??_R4CDarkSpirit@@6B@ DD 00H				; CDarkSpirit::`RTTI Complete Object Locator'
	DD	00H
	DD	00H
	DD	FLAT:??_R0?AVCDarkSpirit@@@8
	DD	FLAT:??_R3CDarkSpirit@@8
rdata$r	ENDS
;	COMDAT ??_7CDarkSpirit@@6B@
CONST	SEGMENT
??_7CDarkSpirit@@6B@ DD FLAT:??_R4CDarkSpirit@@6B@	; CDarkSpirit::`vftable'
	DD	FLAT:??_ECDarkSpirit@@UAEPAXI@Z
	DD	FLAT:?MissCheck@CObjBaseAttack@@UAEHPAUOBJECTSTRUCT@@0HHHAAHE@Z
; Function compile flags: /Ogtp
CONST	ENDS
;	COMDAT ??1CDarkSpirit@@UAE@XZ
_TEXT	SEGMENT
??1CDarkSpirit@@UAE@XZ PROC				; CDarkSpirit::~CDarkSpirit, COMDAT
; _this$ = ecx

; 35   : {

  00000	c7 01 00 00 00
	00		 mov	 DWORD PTR [ecx], OFFSET ??_7CDarkSpirit@@6B@

; 36   : 	return;
; 37   : }

  00006	e9 00 00 00 00	 jmp	 ??1CObjBaseAttack@@UAE@XZ ; CObjBaseAttack::~CObjBaseAttack
??1CDarkSpirit@@UAE@XZ ENDP				; CDarkSpirit::~CDarkSpirit
_TEXT	ENDS
PUBLIC	?Init@CDarkSpirit@@QAEXXZ			; CDarkSpirit::Init
; Function compile flags: /Ogtp
;	COMDAT ?Init@CDarkSpirit@@QAEXXZ
_TEXT	SEGMENT
?Init@CDarkSpirit@@QAEXXZ PROC				; CDarkSpirit::Init, COMDAT
; _this$ = ecx

; 41   : 	this->m_AttackDamageMin = 0;

  00000	33 c0		 xor	 eax, eax

; 42   : 	this->m_AttackDamageMax = 0;
; 43   : 	this->m_AttackSpeed = 0;
; 44   : 	this->m_SuccessAttackRate = 0;
; 45   : 	this->m_dwLastAttackTime = 0;
; 46   : 	this->m_iMasterIndex = -1;

  00002	83 ca ff	 or	 edx, -1
  00005	89 41 04	 mov	 DWORD PTR [ecx+4], eax
  00008	89 41 08	 mov	 DWORD PTR [ecx+8], eax
  0000b	89 41 0c	 mov	 DWORD PTR [ecx+12], eax
  0000e	89 41 10	 mov	 DWORD PTR [ecx+16], eax
  00011	89 41 1c	 mov	 DWORD PTR [ecx+28], eax
  00014	89 51 14	 mov	 DWORD PTR [ecx+20], edx

; 47   : 	this->m_iTargetIndex = -1;

  00017	89 51 18	 mov	 DWORD PTR [ecx+24], edx

; 48   : 	this->m_pPetItem = NULL;

  0001a	89 41 24	 mov	 DWORD PTR [ecx+36], eax

; 49   : }

  0001d	c3		 ret	 0
?Init@CDarkSpirit@@QAEXXZ ENDP				; CDarkSpirit::Init
_TEXT	ENDS
PUBLIC	?ModeNormal@CDarkSpirit@@QAEXXZ			; CDarkSpirit::ModeNormal
; Function compile flags: /Ogtp
;	COMDAT ?ModeNormal@CDarkSpirit@@QAEXXZ
_TEXT	SEGMENT
?ModeNormal@CDarkSpirit@@QAEXXZ PROC			; CDarkSpirit::ModeNormal, COMDAT
; _this$ = ecx

; 117  : 	LPOBJ lpObj = &gObj[this->m_iMasterIndex];
; 118  : }

  00000	c3		 ret	 0
?ModeNormal@CDarkSpirit@@QAEXXZ ENDP			; CDarkSpirit::ModeNormal
_TEXT	ENDS
PUBLIC	__real@403e000000000000
PUBLIC	__$ArrayPad$
PUBLIC	?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z		; CDarkSpirit::SendAttackMsg
EXTRN	?gObjAddAttackProcMsgSendDelay@@YAXPAUOBJECTSTRUCT@@HHHHH@Z:PROC ; gObjAddAttackProcMsgSendDelay
EXTRN	_rand:PROC
EXTRN	?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z:PROC	; MsgSendV2
EXTRN	?gObj@@3PAUOBJECTSTRUCT@@A:DWORD		; gObj
EXTRN	?DataSend@@YAHHPAEK@Z:PROC			; DataSend
EXTRN	___security_cookie:DWORD
EXTRN	__fltused:DWORD
EXTRN	@__security_check_cookie@4:PROC
;	COMDAT __real@403e000000000000
; File e:\work\tranet_version\gs\include\prodef.h
CONST	SEGMENT
__real@403e000000000000 DQ 0403e000000000000r	; 30
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\darkspirit.cpp
CONST	ENDS
;	COMDAT ?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z
_TEXT	SEGMENT
tv138 = -28						; size = 8
tv129 = -28						; size = 8
tv220 = -20						; size = 4
tv207 = -20						; size = 4
_pMsg$ = -16						; size = 9
__$ArrayPad$ = -4					; size = 4
_aIndex$ = 8						; size = 4
_aTargetIndex$ = 12					; size = 4
_criticaldamage$ = 16					; size = 4
_iActionType$ = 20					; size = 4
?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z PROC		; CDarkSpirit::SendAttackMsg, COMDAT
; _this$ = ecx

; 418  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 1c	 sub	 esp, 28			; 0000001cH
  00006	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000b	33 c5		 xor	 eax, ebp
  0000d	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00010	53		 push	 ebx
  00011	8b 5d 08	 mov	 ebx, DWORD PTR _aIndex$[ebp]
  00014	56		 push	 esi
  00015	57		 push	 edi

; 419  : 	PMSG_PET_ITEM_ATTACK_COMMAND pMsg;
; 420  : 
; 421  : 	if ( criticaldamage != 2 )

  00016	8b 7d 10	 mov	 edi, DWORD PTR _criticaldamage$[ebp]
  00019	8b f1		 mov	 esi, ecx
  0001b	83 ff 02	 cmp	 edi, 2
  0001e	0f 84 cb 00 00
	00		 je	 $LN5@SendAttack

; 422  : 	{
; 423  : 		pMsg.PetType = 0;
; 424  : 		pMsg.SkillType = (criticaldamage)? 0 : 1;

  00024	85 ff		 test	 edi, edi
  00026	0f 94 c0	 sete	 al
  00029	88 45 f4	 mov	 BYTE PTR _pMsg$[ebp+4], al

; 425  : 		pMsg.NumberH = SET_NUMBERH(aIndex);
; 426  : 		pMsg.NumberL = SET_NUMBERL(aIndex);
; 427  : 		pMsg.TargetNumberH = SET_NUMBERH(aTargetIndex);

  0002c	8b 45 0c	 mov	 eax, DWORD PTR _aTargetIndex$[ebp]
  0002f	8b d0		 mov	 edx, eax

; 428  : 		pMsg.TargetNumberL = SET_NUMBERL(aTargetIndex);

  00031	88 45 f8	 mov	 BYTE PTR _pMsg$[ebp+8], al

; 429  : 		pMsg.h.set((LPBYTE)&pMsg, 0xA8, sizeof(pMsg));
; 430  : 		
; 431  : 		DataSend(aIndex, (LPBYTE)&pMsg, pMsg.h.size);

  00034	6a 09		 push	 9
  00036	8d 45 f0	 lea	 eax, DWORD PTR _pMsg$[ebp]
  00039	8b cb		 mov	 ecx, ebx
  0003b	50		 push	 eax
  0003c	c1 e9 08	 shr	 ecx, 8
  0003f	c1 ea 08	 shr	 edx, 8
  00042	53		 push	 ebx
  00043	88 4d f5	 mov	 BYTE PTR _pMsg$[ebp+5], cl
  00046	88 5d f6	 mov	 BYTE PTR _pMsg$[ebp+6], bl
  00049	88 55 f7	 mov	 BYTE PTR _pMsg$[ebp+7], dl
  0004c	c7 45 f0 c1 09
	a8 00		 mov	 DWORD PTR _pMsg$[ebp], 11012545 ; 00a809c1H
  00053	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend

; 432  : 		MsgSendV2(&gObj[aIndex], (LPBYTE)&pMsg, pMsg.h.size);

  00058	0f b6 4d f1	 movzx	 ecx, BYTE PTR _pMsg$[ebp+1]
  0005c	8b c3		 mov	 eax, ebx
  0005e	69 c0 50 2b 00
	00		 imul	 eax, 11088		; 00002b50H
  00064	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0006a	51		 push	 ecx
  0006b	8d 55 f0	 lea	 edx, DWORD PTR _pMsg$[ebp]
  0006e	52		 push	 edx
  0006f	50		 push	 eax
  00070	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2
  00075	83 c4 18	 add	 esp, 24			; 00000018H

; 433  : 
; 434  : 		if ( iActionType == 1 )

  00078	83 7d 14 01	 cmp	 DWORD PTR _iActionType$[ebp], 1
  0007c	75 73		 jne	 SHORT $LN10@SendAttack

; 435  : 		{
; 436  : 			criticaldamage = 0;
; 437  : 
; 438  : 			LPOBJ lpObj	= &gObj[this->m_iMasterIndex];

  0007e	8b 76 14	 mov	 esi, DWORD PTR [esi+20]
  00081	69 f6 50 2b 00
	00		 imul	 esi, 11088		; 00002b50H
  00087	03 35 00 00 00
	00		 add	 esi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0008d	33 ff		 xor	 edi, edi

; 439  : 			// ----
; 440  : 			if( 30 + lpObj->m_MPSkillOpt.MpsDarkSpiritStr2 > rand() % 100 )

  0008f	d9 86 08 27 00
	00		 fld	 DWORD PTR [esi+9992]
  00095	dc 05 00 00 00
	00		 fadd	 QWORD PTR __real@403e000000000000
  0009b	dd 5d e4	 fstp	 QWORD PTR tv129[ebp]
  0009e	e8 00 00 00 00	 call	 _rand
  000a3	99		 cdq
  000a4	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  000a9	f7 f9		 idiv	 ecx
  000ab	89 55 ec	 mov	 DWORD PTR tv220[ebp], edx
  000ae	db 45 ec	 fild	 DWORD PTR tv220[ebp]
  000b1	dc 5d e4	 fcomp	 QWORD PTR tv129[ebp]
  000b4	df e0		 fnstsw	 ax
  000b6	f6 c4 05	 test	 ah, 5
  000b9	7a 03		 jp	 SHORT $LN3@SendAttack

; 441  : 			{
; 442  : 				criticaldamage	= 1;	

  000bb	8d 79 9d	 lea	 edi, DWORD PTR [ecx-99]
$LN3@SendAttack:

; 443  : 			}
; 444  : 			// ----
; 445  : 			if( 30 + lpObj->m_MPSkillOpt.MpsDarkSpiritStr3 > rand() % 100 )

  000be	d9 86 0c 27 00
	00		 fld	 DWORD PTR [esi+9996]
  000c4	dc 05 00 00 00
	00		 fadd	 QWORD PTR __real@403e000000000000
  000ca	dd 5d e4	 fstp	 QWORD PTR tv138[ebp]
  000cd	e8 00 00 00 00	 call	 _rand
  000d2	99		 cdq
  000d3	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  000d8	f7 f9		 idiv	 ecx
  000da	89 55 ec	 mov	 DWORD PTR tv207[ebp], edx
  000dd	db 45 ec	 fild	 DWORD PTR tv207[ebp]
  000e0	dc 5d e4	 fcomp	 QWORD PTR tv138[ebp]
  000e3	df e0		 fnstsw	 ax
  000e5	f6 c4 05	 test	 ah, 5
  000e8	7a 07		 jp	 SHORT $LN10@SendAttack

; 446  : 			{
; 447  : 				criticaldamage	= 2;

  000ea	8d 79 9e	 lea	 edi, DWORD PTR [ecx-98]

; 448  : 			}
; 449  : 
; 450  : 		}
; 451  : 	}
; 452  : 	else

  000ed	eb 02		 jmp	 SHORT $LN10@SendAttack
$LN5@SendAttack:

; 453  : 	{
; 454  : 		criticaldamage = 0;

  000ef	33 ff		 xor	 edi, edi
$LN10@SendAttack:

; 455  : 	}
; 456  : 
; 457  : 	gObjAddAttackProcMsgSendDelay(&gObj[aIndex], 51, aTargetIndex, 600, criticaldamage, iActionType);

  000f1	8b 55 14	 mov	 edx, DWORD PTR _iActionType$[ebp]
  000f4	69 db 50 2b 00
	00		 imul	 ebx, 11088		; 00002b50H
  000fa	8b 45 0c	 mov	 eax, DWORD PTR _aTargetIndex$[ebp]
  000fd	03 1d 00 00 00
	00		 add	 ebx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00103	52		 push	 edx
  00104	57		 push	 edi
  00105	68 58 02 00 00	 push	 600			; 00000258H
  0010a	50		 push	 eax
  0010b	6a 33		 push	 51			; 00000033H
  0010d	53		 push	 ebx
  0010e	e8 00 00 00 00	 call	 ?gObjAddAttackProcMsgSendDelay@@YAXPAUOBJECTSTRUCT@@HHHHH@Z ; gObjAddAttackProcMsgSendDelay

; 458  : }

  00113	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00116	83 c4 18	 add	 esp, 24			; 00000018H
  00119	5f		 pop	 edi
  0011a	5e		 pop	 esi
  0011b	33 cd		 xor	 ecx, ebp
  0011d	5b		 pop	 ebx
  0011e	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00123	8b e5		 mov	 esp, ebp
  00125	5d		 pop	 ebp
  00126	c2 10 00	 ret	 16			; 00000010H
?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z ENDP		; CDarkSpirit::SendAttackMsg
_TEXT	ENDS
PUBLIC	?SetTarget@CDarkSpirit@@QAEXH@Z			; CDarkSpirit::SetTarget
; Function compile flags: /Ogtp
;	COMDAT ?SetTarget@CDarkSpirit@@QAEXH@Z
_TEXT	SEGMENT
_aTargetIndex$ = 8					; size = 4
?SetTarget@CDarkSpirit@@QAEXH@Z PROC			; CDarkSpirit::SetTarget, COMDAT
; _this$ = ecx

; 461  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 462  : 	if ( this->m_iMasterIndex == -1 )

  00003	8b 41 14	 mov	 eax, DWORD PTR [ecx+20]
  00006	83 f8 ff	 cmp	 eax, -1
  00009	74 1d		 je	 SHORT $LN3@SetTarget

; 463  : 	{
; 464  : 		return;
; 465  : 	}
; 466  : 
; 467  : 	LPOBJ lpObj = &gObj[this->m_iMasterIndex];
; 468  : 
; 469  : 	if ( lpObj->Class != CLASS_DARKLORD )

  0000b	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00011	69 c0 50 2b 00
	00		 imul	 eax, 11088		; 00002b50H
  00017	66 83 bc 10 b8
	00 00 00 04	 cmp	 WORD PTR [eax+edx+184], 4
  00020	75 06		 jne	 SHORT $LN3@SetTarget

; 470  : 	{
; 471  : 		return;
; 472  : 	}
; 473  : 
; 474  : 	this->m_iTargetIndex = aTargetIndex;

  00022	8b 45 08	 mov	 eax, DWORD PTR _aTargetIndex$[ebp]
  00025	89 41 18	 mov	 DWORD PTR [ecx+24], eax
$LN3@SetTarget:

; 475  : }

  00028	5d		 pop	 ebp
  00029	c2 04 00	 ret	 4
?SetTarget@CDarkSpirit@@QAEXH@Z ENDP			; CDarkSpirit::SetTarget
_TEXT	ENDS
PUBLIC	?GetAttackDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@HHH@Z ; CDarkSpirit::GetAttackDamage
EXTRN	?g_ShieldSystemOn@@3HA:DWORD			; g_ShieldSystemOn
EXTRN	__ftol2_sse:PROC
; Function compile flags: /Ogtp
;	COMDAT ?GetAttackDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@HHH@Z
_TEXT	SEGMENT
_lpObj$ = 8						; size = 4
_targetDefense$ = 12					; size = 4
_bIsOnDuel$ = 16					; size = 4
_damage$216084 = 20					; size = 4
_crititcaldamage$ = 20					; size = 4
?GetAttackDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@HHH@Z PROC ; CDarkSpirit::GetAttackDamage, COMDAT
; _this$ = ecx

; 1348 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	53		 push	 ebx

; 1349 : 	if ( g_ShieldSystemOn == TRUE )

  00004	b8 01 00 00 00	 mov	 eax, 1
  00009	56		 push	 esi
  0000a	57		 push	 edi
  0000b	8b d9		 mov	 ebx, ecx
  0000d	39 05 00 00 00
	00		 cmp	 DWORD PTR ?g_ShieldSystemOn@@3HA, eax ; g_ShieldSystemOn
  00013	75 0c		 jne	 SHORT $LN15@GetAttackD

; 1350 : 	{
; 1351 : 		if ( bIsOnDuel == TRUE )

  00015	39 45 10	 cmp	 DWORD PTR _bIsOnDuel$[ebp], eax
  00018	75 07		 jne	 SHORT $LN15@GetAttackD

; 1352 : 		{
; 1353 : 			bIsOnDuel = FALSE;

  0001a	c7 45 10 00 00
	00 00		 mov	 DWORD PTR _bIsOnDuel$[ebp], 0
$LN15@GetAttackD:

; 1354 : 		}
; 1355 : 	}
; 1356 : 
; 1357 : 	int ad;
; 1358 : 	int sub = this->m_AttackDamageMax - this->m_AttackDamageMin;

  00021	8b 7b 04	 mov	 edi, DWORD PTR [ebx+4]
  00024	8b 73 08	 mov	 esi, DWORD PTR [ebx+8]
  00027	2b f7		 sub	 esi, edi

; 1359 : 	int AttackDamage;
; 1360 : 
; 1361 : 	if ( crititcaldamage )

  00029	83 7d 14 00	 cmp	 DWORD PTR _crititcaldamage$[ebp], 0
  0002d	74 04		 je	 SHORT $LN10@GetAttackD

; 1362 : 	{
; 1363 : 		AttackDamage = this->m_AttackDamageMin + sub;

  0002f	03 fe		 add	 edi, esi

; 1364 : 	}
; 1365 : 	else

  00031	eb 0e		 jmp	 SHORT $LN9@GetAttackD
$LN10@GetAttackD:

; 1366 : 	{
; 1367 : 		AttackDamage = this->m_AttackDamageMin + (rand()%(sub+1));

  00033	e8 00 00 00 00	 call	 _rand
  00038	46		 inc	 esi
  00039	99		 cdq
  0003a	f7 fe		 idiv	 esi
  0003c	8b fa		 mov	 edi, edx
  0003e	03 7b 04	 add	 edi, DWORD PTR [ebx+4]
$LN9@GetAttackD:

; 1368 : 	}
; 1369 : 
; 1370 : 	if((lpObj->pInventory[0].m_Type >= ITEMGET(2,8) && lpObj->pInventory[0].m_Type <= ITEMGET(2,12) ) ||
; 1371 : 		lpObj->pInventory[0].m_Type == ITEMGET(2,13) || 
; 1372 : 		lpObj->pInventory[0].m_Type == ITEMGET(2,14) || 
; 1373 : 		lpObj->pInventory[0].m_Type == ITEMGET(2,15) ||
; 1374 : 		lpObj->pInventory[0].m_Type >= ITEMGET(2,17)) //season4 add-on

  00041	8b 4d 08	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  00044	8b 91 24 0e 00
	00		 mov	 edx, DWORD PTR [ecx+3620]
  0004a	0f b7 42 06	 movzx	 eax, WORD PTR [edx+6]
  0004e	be 08 04 00 00	 mov	 esi, 1032		; 00000408H
  00053	66 3b c6	 cmp	 ax, si
  00056	7c 0a		 jl	 SHORT $LN6@GetAttackD
  00058	be 0c 04 00 00	 mov	 esi, 1036		; 0000040cH
  0005d	66 3b c6	 cmp	 ax, si
  00060	7e 28		 jle	 SHORT $LN7@GetAttackD
$LN6@GetAttackD:
  00062	be 0d 04 00 00	 mov	 esi, 1037		; 0000040dH
  00067	66 3b c6	 cmp	 ax, si
  0006a	74 1e		 je	 SHORT $LN7@GetAttackD
  0006c	be 0e 04 00 00	 mov	 esi, 1038		; 0000040eH
  00071	66 3b c6	 cmp	 ax, si
  00074	74 14		 je	 SHORT $LN7@GetAttackD
  00076	be 0f 04 00 00	 mov	 esi, 1039		; 0000040fH
  0007b	66 3b c6	 cmp	 ax, si
  0007e	74 0a		 je	 SHORT $LN7@GetAttackD
  00080	be 11 04 00 00	 mov	 esi, 1041		; 00000411H
  00085	66 3b c6	 cmp	 ax, si
  00088	7c 38		 jl	 SHORT $LN17@GetAttackD
$LN7@GetAttackD:

; 1375 : 	{
; 1376 : 		if(lpObj->pInventory[0].m_Magic > 0 )

  0008a	66 83 7a 20 00	 cmp	 WORD PTR [edx+32], 0
  0008f	76 31		 jbe	 SHORT $LN17@GetAttackD

; 1377 : 		{
; 1378 : 			int damage = lpObj->pInventory[0].m_Magic / 2;

  00091	8b c2		 mov	 eax, edx
  00093	0f b7 70 20	 movzx	 esi, WORD PTR [eax+32]

; 1379 : 			damage -= (int)(damage * lpObj->pInventory[0].m_CurrentDurabilityState);
; 1380 : 			damage = AttackDamage * damage / 100;
; 1381 : 			AttackDamage += damage;

  00097	d9 80 a8 00 00
	00		 fld	 DWORD PTR [eax+168]
  0009d	d1 ee		 shr	 esi, 1
  0009f	89 75 14	 mov	 DWORD PTR _damage$216084[ebp], esi
  000a2	da 4d 14	 fimul	 DWORD PTR _damage$216084[ebp]
  000a5	e8 00 00 00 00	 call	 __ftol2_sse
  000aa	2b f0		 sub	 esi, eax
  000ac	0f af f7	 imul	 esi, edi
  000af	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  000b4	f7 ee		 imul	 esi
  000b6	c1 fa 05	 sar	 edx, 5
  000b9	8b c2		 mov	 eax, edx
  000bb	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  000be	03 c2		 add	 eax, edx
  000c0	03 f8		 add	 edi, eax
$LN17@GetAttackD:

; 1382 : 		}
; 1383 : 	}
; 1384 : 
; 1385 : 	if ( bIsOnDuel )

  000c2	83 7d 10 00	 cmp	 DWORD PTR _bIsOnDuel$[ebp], 0
  000c6	74 26		 je	 SHORT $LN4@GetAttackD

; 1386 : 	{
; 1387 : 		ad = AttackDamage * 60 / 100 - targetDefense;

  000c8	8b cf		 mov	 ecx, edi
  000ca	c1 e1 04	 shl	 ecx, 4
  000cd	2b cf		 sub	 ecx, edi
  000cf	03 c9		 add	 ecx, ecx
  000d1	03 c9		 add	 ecx, ecx
  000d3	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  000d8	f7 e9		 imul	 ecx
  000da	c1 fa 05	 sar	 edx, 5
  000dd	8b c2		 mov	 eax, edx
  000df	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  000e2	5f		 pop	 edi
  000e3	03 c2		 add	 eax, edx
  000e5	2b 45 0c	 sub	 eax, DWORD PTR _targetDefense$[ebp]
  000e8	5e		 pop	 esi
  000e9	5b		 pop	 ebx

; 1392 : 	}
; 1393 : 
; 1394 : 
; 1395 : 	if( lpObj->m_MPSkillOpt.MpsDarkSpiritStr1 > 0.0f )
; 1396 : 	{
; 1397 : 		AttackDamage += int(lpObj->m_MPSkillOpt.MpsDarkSpiritStr1);
; 1398 : 	}
; 1399 : 	// ----
; 1400 : 	if( lpObj->m_MPSkillOpt.MpsUseScepterPetStr > 0.0f )
; 1401 : 	{
; 1402 : 		AttackDamage += int(lpObj->m_MPSkillOpt.MpsUseScepterPetStr);
; 1403 : 	}
; 1404 : 
; 1405 : 
; 1406 : 	return ad;
; 1407 : }

  000ea	5d		 pop	 ebp
  000eb	c2 10 00	 ret	 16			; 00000010H
$LN4@GetAttackD:

; 1388 : 	}
; 1389 : 	else
; 1390 : 	{
; 1391 : 		ad = AttackDamage - targetDefense;

  000ee	2b 7d 0c	 sub	 edi, DWORD PTR _targetDefense$[ebp]
  000f1	8b c7		 mov	 eax, edi
  000f3	5f		 pop	 edi
  000f4	5e		 pop	 esi
  000f5	5b		 pop	 ebx

; 1392 : 	}
; 1393 : 
; 1394 : 
; 1395 : 	if( lpObj->m_MPSkillOpt.MpsDarkSpiritStr1 > 0.0f )
; 1396 : 	{
; 1397 : 		AttackDamage += int(lpObj->m_MPSkillOpt.MpsDarkSpiritStr1);
; 1398 : 	}
; 1399 : 	// ----
; 1400 : 	if( lpObj->m_MPSkillOpt.MpsUseScepterPetStr > 0.0f )
; 1401 : 	{
; 1402 : 		AttackDamage += int(lpObj->m_MPSkillOpt.MpsUseScepterPetStr);
; 1403 : 	}
; 1404 : 
; 1405 : 
; 1406 : 	return ad;
; 1407 : }

  000f6	5d		 pop	 ebp
  000f7	c2 10 00	 ret	 16			; 00000010H
?GetAttackDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@HHH@Z ENDP ; CDarkSpirit::GetAttackDamage
_TEXT	ENDS
PUBLIC	?MissCheck@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z ; CDarkSpirit::MissCheck
EXTRN	?GCDamageSend@@YAXHHHHHH@Z:PROC			; GCDamageSend
EXTRN	?GetShieldSpellStatus@CIllusionTempleEvent@@QAEHHE@Z:PROC ; CIllusionTempleEvent::GetShieldSpellStatus
EXTRN	?GetState@CIllusionTempleEvent@@QAEEE@Z:PROC	; CIllusionTempleEvent::GetState
EXTRN	?g_IllusionTempleEvent@@3VCIllusionTempleEvent@@A:BYTE ; g_IllusionTempleEvent
EXTRN	?CheckUser@CZtLicense@@QAE_NH@Z:PROC		; CZtLicense::CheckUser
EXTRN	?g_ZtLicense@@3VCZtLicense@@A:BYTE		; g_ZtLicense
; Function compile flags: /Ogtp
;	COMDAT ?MissCheck@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z
_TEXT	SEGMENT
_this$ = -4						; size = 4
_lpObj$ = 8						; size = 4
_lpTargetObj$ = 12					; size = 4
_skill$ = 16						; size = 4
_skillSuccess$ = 20					; size = 4
_bAllMiss$ = 24						; size = 4
?MissCheck@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z PROC ; CDarkSpirit::MissCheck, COMDAT
; _this$ = ecx

; 1410 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	57		 push	 edi
  00005	8b f9		 mov	 edi, ecx

; 1411 : 	if(g_ZtLicense.CheckUser(NSGames))

  00007	6a 51		 push	 81			; 00000051H
  00009	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_ZtLicense@@3VCZtLicense@@A ; g_ZtLicense
  0000e	89 7d fc	 mov	 DWORD PTR _this$[ebp], edi
  00011	e8 00 00 00 00	 call	 ?CheckUser@CZtLicense@@QAE_NH@Z ; CZtLicense::CheckUser
  00016	84 c0		 test	 al, al
  00018	74 0c		 je	 SHORT $LN12@MissCheck

; 1412 : 	{
; 1413 : 		return true;

  0001a	b8 01 00 00 00	 mov	 eax, 1
  0001f	5f		 pop	 edi

; 1465 : }

  00020	8b e5		 mov	 esp, ebp
  00022	5d		 pop	 ebp
  00023	c2 14 00	 ret	 20			; 00000014H
$LN12@MissCheck:
  00026	53		 push	 ebx
  00027	56		 push	 esi

; 1414 : 	}
; 1415 : 
; 1416 : 	int SuccessAttackRate = 0; //loc2
; 1417 : 	int TargetSuccessfulBlocking = lpTargetObj->m_SuccessfulBlocking;

  00028	8b 75 0c	 mov	 esi, DWORD PTR _lpTargetObj$[ebp]
  0002b	8b 9e 9c 04 00
	00		 mov	 ebx, DWORD PTR [esi+1180]

; 1418 : 	int MsgDamage = 0; //loc4
; 1419 : 
; 1420 : 	SuccessAttackRate				+= lpObj->m_MPSkillOpt.MpsAttackSuccessRate;
; 1421 : 
; 1422 : 	if ( this->m_SuccessAttackRate < TargetSuccessfulBlocking )

  00031	39 5f 10	 cmp	 DWORD PTR [edi+16], ebx
  00034	7d 09		 jge	 SHORT $LN17@MissCheck

; 1423 : 	{
; 1424 : 		bAllMiss = TRUE;

  00036	8b 45 18	 mov	 eax, DWORD PTR _bAllMiss$[ebp]
  00039	c7 00 01 00 00
	00		 mov	 DWORD PTR [eax], 1
$LN17@MissCheck:

; 1425 : 	}
; 1426 : 
; 1427 : 	if(IT_MAP_RANGE(lpTargetObj->MapNumber) != FALSE) //Season2.5 add-on Illusion

  0003f	8a 86 49 01 00
	00		 mov	 al, BYTE PTR [esi+329]
  00045	8b 7d 08	 mov	 edi, DWORD PTR _lpObj$[ebp]
  00048	3c 2d		 cmp	 al, 45			; 0000002dH
  0004a	72 70		 jb	 SHORT $LN18@MissCheck
  0004c	b9 32 00 00 00	 mov	 ecx, 50			; 00000032H
  00051	3a c8		 cmp	 cl, al
  00053	1b c9		 sbb	 ecx, ecx
  00055	41		 inc	 ecx
  00056	74 64		 je	 SHORT $LN18@MissCheck

; 1428 : 	{
; 1429 : 		if(g_IllusionTempleEvent.GetState(lpTargetObj->MapNumber) == 2)

  00058	50		 push	 eax
  00059	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_IllusionTempleEvent@@3VCIllusionTempleEvent@@A ; g_IllusionTempleEvent
  0005e	e8 00 00 00 00	 call	 ?GetState@CIllusionTempleEvent@@QAEEE@Z ; CIllusionTempleEvent::GetState
  00063	3c 02		 cmp	 al, 2
  00065	75 55		 jne	 SHORT $LN18@MissCheck

; 1430 : 		{
; 1431 : 			if ( lpTargetObj->Type == OBJ_USER )

  00067	66 83 7e 68 01	 cmp	 WORD PTR [esi+104], 1
  0006c	75 40		 jne	 SHORT $LN7@MissCheck

; 1432 : 			{
; 1433 : 				if(g_IllusionTempleEvent.GetShieldSpellStatus(lpTargetObj->m_iIllusionTempleIndex, lpTargetObj->MapNumber) != FALSE)

  0006e	0f b6 96 49 01
	00 00		 movzx	 edx, BYTE PTR [esi+329]
  00075	8b 86 78 20 00
	00		 mov	 eax, DWORD PTR [esi+8312]
  0007b	52		 push	 edx
  0007c	50		 push	 eax
  0007d	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_IllusionTempleEvent@@3VCIllusionTempleEvent@@A ; g_IllusionTempleEvent
  00082	e8 00 00 00 00	 call	 ?GetShieldSpellStatus@CIllusionTempleEvent@@QAEHHE@Z ; CIllusionTempleEvent::GetShieldSpellStatus
  00087	85 c0		 test	 eax, eax
  00089	74 23		 je	 SHORT $LN7@MissCheck

; 1434 : 				{
; 1435 : 					GCDamageSend(lpObj->m_Index, lpTargetObj->m_Index, 0, 0, 0, 0);

  0008b	8b 0e		 mov	 ecx, DWORD PTR [esi]
  0008d	6a 00		 push	 0
  0008f	6a 00		 push	 0
  00091	6a 00		 push	 0
  00093	6a 00		 push	 0
  00095	8b d7		 mov	 edx, edi
  00097	8b 02		 mov	 eax, DWORD PTR [edx]
  00099	51		 push	 ecx
  0009a	50		 push	 eax
  0009b	e8 00 00 00 00	 call	 ?GCDamageSend@@YAXHHHHHH@Z ; GCDamageSend
  000a0	83 c4 18	 add	 esp, 24			; 00000018H
  000a3	5e		 pop	 esi
  000a4	5b		 pop	 ebx

; 1436 : 					return FALSE;

  000a5	33 c0		 xor	 eax, eax
  000a7	5f		 pop	 edi

; 1465 : }

  000a8	8b e5		 mov	 esp, ebp
  000aa	5d		 pop	 ebp
  000ab	c2 14 00	 ret	 20			; 00000014H
$LN7@MissCheck:

; 1437 : 				}	
; 1438 : 			}
; 1439 : 			if(lpObj->PartyNumber == lpTargetObj->PartyNumber)

  000ae	8b 8f 2c 04 00
	00		 mov	 ecx, DWORD PTR [edi+1068]
  000b4	3b 8e 2c 04 00
	00		 cmp	 ecx, DWORD PTR [esi+1068]

; 1440 : 			{
; 1441 : 				GCDamageSend(lpObj->m_Index, lpTargetObj->m_Index, 0, 0, 0, 0);
; 1442 : 				return FALSE;

  000ba	74 1a		 je	 SHORT $LN23@MissCheck
$LN18@MissCheck:

; 1443 : 			}
; 1444 : 		}
; 1445 : 	}
; 1446 : 
; 1447 : 	if ( bAllMiss != FALSE )

  000bc	8b 4d 18	 mov	 ecx, DWORD PTR _bAllMiss$[ebp]
  000bf	83 39 00	 cmp	 DWORD PTR [ecx], 0
  000c2	74 33		 je	 SHORT $LN5@MissCheck

; 1448 : 	{
; 1449 : 		if ( (rand()%100) >= 5 )

  000c4	e8 00 00 00 00	 call	 _rand
  000c9	99		 cdq
  000ca	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  000cf	f7 f9		 idiv	 ecx
  000d1	83 fa 05	 cmp	 edx, 5
  000d4	7c 3a		 jl	 SHORT $LN20@MissCheck
$LN23@MissCheck:

; 1450 : 		{
; 1451 : 			GCDamageSend(lpObj->m_Index, lpTargetObj->m_Index, 0, 0, MsgDamage, 0);

  000d6	8b 16		 mov	 edx, DWORD PTR [esi]
  000d8	8b 07		 mov	 eax, DWORD PTR [edi]
  000da	6a 00		 push	 0
  000dc	6a 00		 push	 0
  000de	6a 00		 push	 0
  000e0	6a 00		 push	 0
  000e2	52		 push	 edx
  000e3	50		 push	 eax
  000e4	e8 00 00 00 00	 call	 ?GCDamageSend@@YAXHHHHHH@Z ; GCDamageSend
  000e9	83 c4 18	 add	 esp, 24			; 00000018H
  000ec	5e		 pop	 esi
  000ed	5b		 pop	 ebx

; 1452 : 			return FALSE;

  000ee	33 c0		 xor	 eax, eax
  000f0	5f		 pop	 edi

; 1465 : }

  000f1	8b e5		 mov	 esp, ebp
  000f3	5d		 pop	 ebp
  000f4	c2 14 00	 ret	 20			; 00000014H
$LN5@MissCheck:

; 1453 : 		}
; 1454 : 	}
; 1455 : 	else if ( this->m_SuccessAttackRate )

  000f7	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  000fa	83 79 10 00	 cmp	 DWORD PTR [ecx+16], 0
  000fe	74 10		 je	 SHORT $LN20@MissCheck

; 1456 : 	{
; 1457 : 		if ( (rand()%this->m_SuccessAttackRate) < TargetSuccessfulBlocking)

  00100	e8 00 00 00 00	 call	 _rand
  00105	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00108	99		 cdq
  00109	f7 79 10	 idiv	 DWORD PTR [ecx+16]
  0010c	3b d3		 cmp	 edx, ebx

; 1458 : 		{
; 1459 : 			GCDamageSend(lpObj->m_Index, lpTargetObj->m_Index, 0, 0, MsgDamage, 0);
; 1460 : 			return FALSE;

  0010e	7c c6		 jl	 SHORT $LN23@MissCheck
$LN20@MissCheck:
  00110	5e		 pop	 esi
  00111	5b		 pop	 ebx

; 1461 : 		}
; 1462 : 	}
; 1463 : 
; 1464 : 	return TRUE;

  00112	b8 01 00 00 00	 mov	 eax, 1
  00117	5f		 pop	 edi

; 1465 : }

  00118	8b e5		 mov	 esp, ebp
  0011a	5d		 pop	 ebp
  0011b	c2 14 00	 ret	 20			; 00000014H
?MissCheck@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z ENDP ; CDarkSpirit::MissCheck
_TEXT	ENDS
PUBLIC	__real@4059000000000000
PUBLIC	__real@40c3880000000000
PUBLIC	__real@00000000
PUBLIC	?MissCheckPvP@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z ; CDarkSpirit::MissCheckPvP
EXTRN	?g_fSuccessAttackRateOption@@3MA:DWORD		; g_fSuccessAttackRateOption
;	COMDAT __real@4059000000000000
CONST	SEGMENT
__real@4059000000000000 DQ 04059000000000000r	; 100
CONST	ENDS
;	COMDAT __real@40c3880000000000
CONST	SEGMENT
__real@40c3880000000000 DQ 040c3880000000000r	; 10000
CONST	ENDS
;	COMDAT __real@00000000
CONST	SEGMENT
__real@00000000 DD 000000000r			; 0
; Function compile flags: /Ogtp
CONST	ENDS
;	COMDAT ?MissCheckPvP@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z
_TEXT	SEGMENT
tv628 = -12						; size = 4
_iDefenseRate$ = -8					; size = 4
_iAttackRate$ = -4					; size = 4
tv491 = 8						; size = 4
tv490 = 8						; size = 4
tv486 = 8						; size = 4
tv481 = 8						; size = 4
tv471 = 8						; size = 4
tv412 = 8						; size = 4
tv401 = 8						; size = 4
tv399 = 8						; size = 4
tv398 = 8						; size = 4
tv393 = 8						; size = 4
tv392 = 8						; size = 4
tv391 = 8						; size = 4
tv390 = 8						; size = 4
tv385 = 8						; size = 4
tv366 = 8						; size = 4
tv364 = 8						; size = 4
tv360 = 8						; size = 4
tv358 = 8						; size = 4
tv349 = 8						; size = 4
tv348 = 8						; size = 4
tv342 = 8						; size = 4
tv341 = 8						; size = 4
tv340 = 8						; size = 4
tv313 = 8						; size = 4
tv295 = 8						; size = 4
tv258 = 8						; size = 4
tv238 = 8						; size = 4
_iAttackSuccessRate$ = 8				; size = 4
_lpObj$ = 8						; size = 4
_lpTargetObj$ = 12					; size = 4
_skill$ = 16						; size = 4
_skillSuccess$ = 20					; size = 4
_bAllMiss$ = 24						; size = 4
?MissCheckPvP@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z PROC ; CDarkSpirit::MissCheckPvP, COMDAT
; _this$ = ecx

; 1468 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 0c	 sub	 esp, 12			; 0000000cH

; 1469 : 	float iAttackRate = 0;

  00006	d9 ee		 fldz
  00008	53		 push	 ebx

; 1470 : 	float iDefenseRate = 0;
; 1471 : 	int iAttackSuccessRate = 0;
; 1472 : 
; 1473 : 	if(IT_MAP_RANGE(lpTargetObj->MapNumber) != FALSE) //Season2.5 add-on Illusion

  00009	8b 5d 0c	 mov	 ebx, DWORD PTR _lpTargetObj$[ebp]
  0000c	d9 55 fc	 fst	 DWORD PTR _iAttackRate$[ebp]
  0000f	8a 83 49 01 00
	00		 mov	 al, BYTE PTR [ebx+329]
  00015	d9 55 f8	 fst	 DWORD PTR _iDefenseRate$[ebp]
  00018	57		 push	 edi
  00019	8b 7d 08	 mov	 edi, DWORD PTR _lpObj$[ebp]
  0001c	3c 2d		 cmp	 al, 45			; 0000002dH
  0001e	0f 82 97 00 00
	00		 jb	 $LN46@MissCheckP
  00024	b9 32 00 00 00	 mov	 ecx, 50			; 00000032H
  00029	3a c8		 cmp	 cl, al
  0002b	1b c9		 sbb	 ecx, ecx
  0002d	41		 inc	 ecx
  0002e	0f 84 87 00 00
	00		 je	 $LN46@MissCheckP

; 1474 : 	{
; 1475 : 		if(g_IllusionTempleEvent.GetState(lpTargetObj->MapNumber) == 2)

  00034	50		 push	 eax
  00035	dd d8		 fstp	 ST(0)
  00037	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_IllusionTempleEvent@@3VCIllusionTempleEvent@@A ; g_IllusionTempleEvent
  0003c	e8 00 00 00 00	 call	 ?GetState@CIllusionTempleEvent@@QAEEE@Z ; CIllusionTempleEvent::GetState
  00041	3c 02		 cmp	 al, 2
  00043	75 74		 jne	 SHORT $LN45@MissCheckP

; 1476 : 		{
; 1477 : 			if ( lpTargetObj->Type == OBJ_USER )

  00045	66 83 7b 68 01	 cmp	 WORD PTR [ebx+104], 1
  0004a	75 3f		 jne	 SHORT $LN36@MissCheckP

; 1478 : 			{
; 1479 : 				if(g_IllusionTempleEvent.GetShieldSpellStatus(lpTargetObj->m_iIllusionTempleIndex, lpTargetObj->MapNumber) != FALSE)

  0004c	0f b6 93 49 01
	00 00		 movzx	 edx, BYTE PTR [ebx+329]
  00053	8b 83 78 20 00
	00		 mov	 eax, DWORD PTR [ebx+8312]
  00059	52		 push	 edx
  0005a	50		 push	 eax
  0005b	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_IllusionTempleEvent@@3VCIllusionTempleEvent@@A ; g_IllusionTempleEvent
  00060	e8 00 00 00 00	 call	 ?GetShieldSpellStatus@CIllusionTempleEvent@@QAEHHE@Z ; CIllusionTempleEvent::GetShieldSpellStatus
  00065	85 c0		 test	 eax, eax
  00067	74 22		 je	 SHORT $LN36@MissCheckP

; 1480 : 				{
; 1481 : 					GCDamageSend(lpObj->m_Index, lpTargetObj->m_Index, 0, 0, 0, 0);

  00069	8b 0b		 mov	 ecx, DWORD PTR [ebx]
  0006b	6a 00		 push	 0
  0006d	6a 00		 push	 0
  0006f	6a 00		 push	 0
  00071	6a 00		 push	 0
  00073	8b d7		 mov	 edx, edi
  00075	8b 02		 mov	 eax, DWORD PTR [edx]
  00077	51		 push	 ecx
  00078	50		 push	 eax
  00079	e8 00 00 00 00	 call	 ?GCDamageSend@@YAXHHHHHH@Z ; GCDamageSend
  0007e	83 c4 18	 add	 esp, 24			; 00000018H
  00081	5f		 pop	 edi

; 1482 : 					return FALSE;

  00082	33 c0		 xor	 eax, eax
  00084	5b		 pop	 ebx

; 1605 : }

  00085	8b e5		 mov	 esp, ebp
  00087	5d		 pop	 ebp
  00088	c2 14 00	 ret	 20			; 00000014H
$LN36@MissCheckP:

; 1483 : 				}	
; 1484 : 			}
; 1485 : 			if(lpObj->PartyNumber == lpTargetObj->PartyNumber)

  0008b	8b 8f 2c 04 00
	00		 mov	 ecx, DWORD PTR [edi+1068]
  00091	3b 8b 2c 04 00
	00		 cmp	 ecx, DWORD PTR [ebx+1068]
  00097	75 20		 jne	 SHORT $LN45@MissCheckP

; 1486 : 			{
; 1487 : 				GCDamageSend(lpObj->m_Index, lpTargetObj->m_Index, 0, 0, 0, 0);

  00099	8b 13		 mov	 edx, DWORD PTR [ebx]
  0009b	8b 07		 mov	 eax, DWORD PTR [edi]
  0009d	6a 00		 push	 0
  0009f	6a 00		 push	 0
  000a1	6a 00		 push	 0
  000a3	6a 00		 push	 0
  000a5	52		 push	 edx
  000a6	50		 push	 eax
  000a7	e8 00 00 00 00	 call	 ?GCDamageSend@@YAXHHHHHH@Z ; GCDamageSend
  000ac	83 c4 18	 add	 esp, 24			; 00000018H
  000af	5f		 pop	 edi

; 1488 : 				return FALSE;

  000b0	33 c0		 xor	 eax, eax
  000b2	5b		 pop	 ebx

; 1605 : }

  000b3	8b e5		 mov	 esp, ebp
  000b5	5d		 pop	 ebp
  000b6	c2 14 00	 ret	 20			; 00000014H
$LN45@MissCheckP:

; 1483 : 				}	
; 1484 : 			}
; 1485 : 			if(lpObj->PartyNumber == lpTargetObj->PartyNumber)

  000b9	d9 ee		 fldz
$LN46@MissCheckP:

; 1489 : 			}
; 1490 : 		}
; 1491 : 	}
; 1492 : 
; 1493 : 	int iBaseLevel = lpObj->Level + lpObj->MLevel;

  000bb	0f b7 87 be 00
	00 00		 movzx	 eax, WORD PTR [edi+190]
  000c2	56		 push	 esi
  000c3	0f bf b7 d0 00
	00 00		 movsx	 esi, WORD PTR [edi+208]
  000ca	0f bf c8	 movsx	 ecx, ax

; 1494 : 
; 1495 : 	if ( lpObj->Class == CLASS_KNIGHT )

  000cd	0f b7 87 b8 00
	00 00		 movzx	 eax, WORD PTR [edi+184]
  000d4	03 f1		 add	 esi, ecx
  000d6	83 f8 01	 cmp	 eax, 1
  000d9	75 2b		 jne	 SHORT $LN34@MissCheckP

; 1496 : 	{
; 1497 : 		iAttackRate = (float)(iBaseLevel * 3 + ( lpObj->Dexterity * 45) / 10);	// #formula

  000db	0f b7 8f f6 00
	00 00		 movzx	 ecx, WORD PTR [edi+246]
  000e2	6b c9 2d	 imul	 ecx, 45			; 0000002dH
  000e5	b8 67 66 66 66	 mov	 eax, 1717986919		; 66666667H
  000ea	f7 e9		 imul	 ecx
  000ec	c1 fa 02	 sar	 edx, 2
  000ef	8b c2		 mov	 eax, edx
  000f1	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  000f4	03 c2		 add	 eax, edx
  000f6	8d 0c 76	 lea	 ecx, DWORD PTR [esi+esi*2]
  000f9	03 c1		 add	 eax, ecx
  000fb	89 45 08	 mov	 DWORD PTR tv491[ebp], eax
  000fe	db 45 08	 fild	 DWORD PTR tv491[ebp]
  00101	e9 f8 00 00 00	 jmp	 $LN108@MissCheckP
$LN34@MissCheckP:

; 1498 : 	}
; 1499 : 	else if ( lpObj->Class == CLASS_DARKLORD )

  00106	83 f8 04	 cmp	 eax, 4
  00109	75 18		 jne	 SHORT $LN32@MissCheckP

; 1500 : 	{
; 1501 : 		iAttackRate = (float)(iBaseLevel * 3 + ( lpObj->Dexterity * 4 ));	// #formula

  0010b	0f b7 97 f6 00
	00 00		 movzx	 edx, WORD PTR [edi+246]
  00112	8d 04 76	 lea	 eax, DWORD PTR [esi+esi*2]
  00115	8d 0c 90	 lea	 ecx, DWORD PTR [eax+edx*4]
  00118	89 4d 08	 mov	 DWORD PTR tv490[ebp], ecx
  0011b	db 45 08	 fild	 DWORD PTR tv490[ebp]
  0011e	e9 db 00 00 00	 jmp	 $LN108@MissCheckP
$LN32@MissCheckP:

; 1502 : 	}
; 1503 : 	else if ( lpObj->Class == CLASS_ELF )

  00123	83 f8 02	 cmp	 eax, 2
  00126	75 2d		 jne	 SHORT $LN30@MissCheckP

; 1504 : 	{
; 1505 : 		iAttackRate = (float)(iBaseLevel * 3 + ( lpObj->Dexterity * 6 ) / 10);	// #formula

  00128	0f b7 87 f6 00
	00 00		 movzx	 eax, WORD PTR [edi+246]
  0012f	8d 0c 40	 lea	 ecx, DWORD PTR [eax+eax*2]
  00132	03 c9		 add	 ecx, ecx
  00134	b8 67 66 66 66	 mov	 eax, 1717986919		; 66666667H
  00139	f7 e9		 imul	 ecx
  0013b	c1 fa 02	 sar	 edx, 2
  0013e	8b c2		 mov	 eax, edx
  00140	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  00143	03 c2		 add	 eax, edx
  00145	8d 0c 76	 lea	 ecx, DWORD PTR [esi+esi*2]
  00148	03 c1		 add	 eax, ecx
  0014a	89 45 08	 mov	 DWORD PTR tv486[ebp], eax
  0014d	db 45 08	 fild	 DWORD PTR tv486[ebp]
  00150	e9 a9 00 00 00	 jmp	 $LN108@MissCheckP
$LN30@MissCheckP:

; 1506 : 	}
; 1507 : 	else if ( lpObj->Class == CLASS_MAGUMSA )

  00155	83 f8 03	 cmp	 eax, 3
  00158	75 28		 jne	 SHORT $LN28@MissCheckP

; 1508 : 	{
; 1509 : 		iAttackRate = (float)(iBaseLevel * 3 + ( lpObj->Dexterity * 35 ) / 10);	// #formula

  0015a	0f b7 8f f6 00
	00 00		 movzx	 ecx, WORD PTR [edi+246]
  00161	6b c9 23	 imul	 ecx, 35			; 00000023H
  00164	b8 67 66 66 66	 mov	 eax, 1717986919		; 66666667H
  00169	f7 e9		 imul	 ecx
  0016b	c1 fa 02	 sar	 edx, 2
  0016e	8b c2		 mov	 eax, edx
  00170	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  00173	03 c2		 add	 eax, edx
  00175	8d 0c 76	 lea	 ecx, DWORD PTR [esi+esi*2]
  00178	03 c1		 add	 eax, ecx
  0017a	89 45 08	 mov	 DWORD PTR tv481[ebp], eax
  0017d	db 45 08	 fild	 DWORD PTR tv481[ebp]
  00180	eb 7c		 jmp	 SHORT $LN108@MissCheckP
$LN28@MissCheckP:

; 1510 : 	}
; 1511 : 	else if ( lpObj->Class == CLASS_WIZARD )

  00182	66 85 c0	 test	 ax, ax
  00185	75 15		 jne	 SHORT $LN26@MissCheckP

; 1512 : 	{
; 1513 : 		iAttackRate = (float)(iBaseLevel * 3 + ( lpObj->Dexterity * 4 ));	// #formula

  00187	0f b7 97 f6 00
	00 00		 movzx	 edx, WORD PTR [edi+246]
  0018e	8d 04 76	 lea	 eax, DWORD PTR [esi+esi*2]
  00191	8d 0c 90	 lea	 ecx, DWORD PTR [eax+edx*4]
  00194	89 4d 08	 mov	 DWORD PTR tv471[ebp], ecx
  00197	db 45 08	 fild	 DWORD PTR tv471[ebp]
  0019a	eb 62		 jmp	 SHORT $LN108@MissCheckP
$LN26@MissCheckP:

; 1514 : 	}
; 1515 : 	else if ( lpTargetObj->Class == CLASS_SUMMONER ) //webzen bug?? wtf??

  0019c	0f b7 83 b8 00
	00 00		 movzx	 eax, WORD PTR [ebx+184]
  001a3	83 f8 05	 cmp	 eax, 5
  001a6	75 28		 jne	 SHORT $LN24@MissCheckP

; 1516 : 	{
; 1517 : 		iAttackRate = (float)(iBaseLevel * 3 + ( lpObj->Dexterity * 35 ) / 10);	// #formula

  001a8	0f b7 8f f6 00
	00 00		 movzx	 ecx, WORD PTR [edi+246]
  001af	6b c9 23	 imul	 ecx, 35			; 00000023H
  001b2	b8 67 66 66 66	 mov	 eax, 1717986919		; 66666667H
  001b7	f7 e9		 imul	 ecx
  001b9	c1 fa 02	 sar	 edx, 2
  001bc	8b c2		 mov	 eax, edx
  001be	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  001c1	03 c2		 add	 eax, edx
  001c3	8d 0c 76	 lea	 ecx, DWORD PTR [esi+esi*2]
  001c6	03 c1		 add	 eax, ecx
  001c8	89 45 08	 mov	 DWORD PTR tv412[ebp], eax
  001cb	db 45 08	 fild	 DWORD PTR tv412[ebp]
  001ce	eb 2e		 jmp	 SHORT $LN108@MissCheckP
$LN24@MissCheckP:

; 1518 : 	}
; 1519 : #ifdef MONK
; 1520 : 	else if( lpTargetObj->Class == CLASS_MONK )

  001d0	83 f8 06	 cmp	 eax, 6
  001d3	75 2c		 jne	 SHORT $LN22@MissCheckP

; 1521 : 	{
; 1522 : 		iAttackRate = iBaseLevel * 3 + ( lpObj->Dexterity * 48 ) / 10;

  001d5	0f b7 87 f6 00
	00 00		 movzx	 eax, WORD PTR [edi+246]
  001dc	8d 0c 40	 lea	 ecx, DWORD PTR [eax+eax*2]
  001df	c1 e1 04	 shl	 ecx, 4
  001e2	b8 67 66 66 66	 mov	 eax, 1717986919		; 66666667H
  001e7	f7 e9		 imul	 ecx
  001e9	c1 fa 02	 sar	 edx, 2
  001ec	8b c2		 mov	 eax, edx
  001ee	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  001f1	03 c2		 add	 eax, edx
  001f3	8d 0c 76	 lea	 ecx, DWORD PTR [esi+esi*2]
  001f6	03 c1		 add	 eax, ecx
  001f8	89 45 08	 mov	 DWORD PTR tv401[ebp], eax
  001fb	db 45 08	 fild	 DWORD PTR tv401[ebp]
$LN108@MissCheckP:
  001fe	d9 5d fc	 fstp	 DWORD PTR _iAttackRate$[ebp]
$LN22@MissCheckP:

; 1523 : 	}
; 1524 : #endif
; 1525 : 
; 1526 : 	int iTargetBaseLevel = lpTargetObj->Level + lpTargetObj->MLevel;

  00201	0f b7 83 be 00
	00 00		 movzx	 eax, WORD PTR [ebx+190]

; 1527 : 
; 1528 : 	if ( lpTargetObj->Class == CLASS_KNIGHT )

  00208	8b 4d 0c	 mov	 ecx, DWORD PTR _lpTargetObj$[ebp]
  0020b	0f bf 9b d0 00
	00 00		 movsx	 ebx, WORD PTR [ebx+208]
  00212	0f bf d0	 movsx	 edx, ax
  00215	89 45 f4	 mov	 DWORD PTR tv628[ebp], eax
  00218	0f b7 81 b8 00
	00 00		 movzx	 eax, WORD PTR [ecx+184]
  0021f	03 da		 add	 ebx, edx
  00221	83 f8 01	 cmp	 eax, 1
  00224	75 17		 jne	 SHORT $LN21@MissCheckP

; 1529 : 	{
; 1530 : 		iDefenseRate = (float)(iTargetBaseLevel * 2 + lpTargetObj->Dexterity / 2);	// #formula

  00226	0f b7 81 f6 00
	00 00		 movzx	 eax, WORD PTR [ecx+246]
  0022d	d1 e8		 shr	 eax, 1
  0022f	8d 14 58	 lea	 edx, DWORD PTR [eax+ebx*2]
  00232	89 55 08	 mov	 DWORD PTR tv399[ebp], edx
  00235	db 45 08	 fild	 DWORD PTR tv399[ebp]
  00238	e9 b6 00 00 00	 jmp	 $LN109@MissCheckP
$LN21@MissCheckP:

; 1531 : 	}
; 1532 : 	else if ( lpTargetObj->Class == CLASS_DARKLORD )

  0023d	83 f8 04	 cmp	 eax, 4
  00240	75 17		 jne	 SHORT $LN19@MissCheckP

; 1533 : 	{
; 1534 : 		iDefenseRate = (float)(iTargetBaseLevel * 2 + lpTargetObj->Dexterity / 2);	// #formula

  00242	0f b7 81 f6 00
	00 00		 movzx	 eax, WORD PTR [ecx+246]
  00249	d1 e8		 shr	 eax, 1
  0024b	8d 14 58	 lea	 edx, DWORD PTR [eax+ebx*2]
  0024e	89 55 08	 mov	 DWORD PTR tv398[ebp], edx
  00251	db 45 08	 fild	 DWORD PTR tv398[ebp]
  00254	e9 9a 00 00 00	 jmp	 $LN109@MissCheckP
$LN19@MissCheckP:

; 1535 : 	}
; 1536 : 	else if ( lpTargetObj->Class == CLASS_ELF )

  00259	83 f8 02	 cmp	 eax, 2
  0025c	75 23		 jne	 SHORT $LN17@MissCheckP

; 1537 : 	{
; 1538 : 		iDefenseRate = (float)(iTargetBaseLevel * 2 + lpTargetObj->Dexterity / 10);	// #formula

  0025e	0f b7 91 f6 00
	00 00		 movzx	 edx, WORD PTR [ecx+246]
  00265	b8 67 66 66 66	 mov	 eax, 1717986919		; 66666667H
  0026a	f7 ea		 imul	 edx
  0026c	c1 fa 02	 sar	 edx, 2
  0026f	8b c2		 mov	 eax, edx
  00271	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  00274	03 c2		 add	 eax, edx
  00276	8d 14 58	 lea	 edx, DWORD PTR [eax+ebx*2]
  00279	89 55 08	 mov	 DWORD PTR tv393[ebp], edx
  0027c	db 45 08	 fild	 DWORD PTR tv393[ebp]
  0027f	eb 72		 jmp	 SHORT $LN109@MissCheckP
$LN17@MissCheckP:

; 1539 : 	}
; 1540 : 	else if ( lpTargetObj->Class == CLASS_MAGUMSA )

  00281	83 f8 03	 cmp	 eax, 3
  00284	75 15		 jne	 SHORT $LN15@MissCheckP

; 1541 : 	{
; 1542 : 		iDefenseRate = (float)(iTargetBaseLevel * 2 + lpTargetObj->Dexterity / 4);	// #formula

  00286	0f b7 81 f6 00
	00 00		 movzx	 eax, WORD PTR [ecx+246]
  0028d	c1 e8 02	 shr	 eax, 2
  00290	8d 14 58	 lea	 edx, DWORD PTR [eax+ebx*2]
  00293	89 55 08	 mov	 DWORD PTR tv392[ebp], edx
  00296	db 45 08	 fild	 DWORD PTR tv392[ebp]
  00299	eb 58		 jmp	 SHORT $LN109@MissCheckP
$LN15@MissCheckP:

; 1543 : 	}
; 1544 : 	else if ( lpTargetObj->Class == CLASS_WIZARD )

  0029b	66 85 c0	 test	 ax, ax
  0029e	75 15		 jne	 SHORT $LN13@MissCheckP

; 1545 : 	{
; 1546 : 		iDefenseRate = (float)(iTargetBaseLevel * 2 + lpTargetObj->Dexterity / 4);	// #formula

  002a0	0f b7 81 f6 00
	00 00		 movzx	 eax, WORD PTR [ecx+246]
  002a7	c1 e8 02	 shr	 eax, 2
  002aa	8d 14 58	 lea	 edx, DWORD PTR [eax+ebx*2]
  002ad	89 55 08	 mov	 DWORD PTR tv391[ebp], edx
  002b0	db 45 08	 fild	 DWORD PTR tv391[ebp]
  002b3	eb 3e		 jmp	 SHORT $LN109@MissCheckP
$LN13@MissCheckP:

; 1547 : 	}
; 1548 : 	else if ( lpTargetObj->Class == CLASS_SUMMONER )

  002b5	83 f8 05	 cmp	 eax, 5
  002b8	75 14		 jne	 SHORT $LN11@MissCheckP

; 1549 : 	{
; 1550 : 		iDefenseRate = (float)(iTargetBaseLevel * 2 + lpTargetObj->Dexterity / 2);	// #formula

  002ba	0f b7 81 f6 00
	00 00		 movzx	 eax, WORD PTR [ecx+246]
  002c1	d1 e8		 shr	 eax, 1
  002c3	8d 14 58	 lea	 edx, DWORD PTR [eax+ebx*2]
  002c6	89 55 08	 mov	 DWORD PTR tv390[ebp], edx
  002c9	db 45 08	 fild	 DWORD PTR tv390[ebp]
  002cc	eb 25		 jmp	 SHORT $LN109@MissCheckP
$LN11@MissCheckP:

; 1551 : 	}
; 1552 : #ifdef MONK
; 1553 : 	else if( lpTargetObj->Class == CLASS_MONK )

  002ce	83 f8 06	 cmp	 eax, 6
  002d1	75 23		 jne	 SHORT $LN9@MissCheckP

; 1554 : 	{
; 1555 : 		iDefenseRate = iTargetBaseLevel * 2 + lpTargetObj->Dexterity / 5;

  002d3	0f b7 91 f6 00
	00 00		 movzx	 edx, WORD PTR [ecx+246]
  002da	b8 67 66 66 66	 mov	 eax, 1717986919		; 66666667H
  002df	f7 ea		 imul	 edx
  002e1	d1 fa		 sar	 edx, 1
  002e3	8b c2		 mov	 eax, edx
  002e5	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  002e8	03 c2		 add	 eax, edx
  002ea	8d 14 58	 lea	 edx, DWORD PTR [eax+ebx*2]
  002ed	89 55 08	 mov	 DWORD PTR tv385[ebp], edx
  002f0	db 45 08	 fild	 DWORD PTR tv385[ebp]
$LN109@MissCheckP:
  002f3	d9 5d f8	 fstp	 DWORD PTR _iDefenseRate$[ebp]
$LN9@MissCheckP:

; 1556 : 	}
; 1557 : #endif
; 1558 : 
; 1559 : 	if ( iAttackRate <= 0.0f || iDefenseRate <= 0.0f || lpObj->Level <= 0 || lpTargetObj->Level <= 0 )

  002f6	d9 45 fc	 fld	 DWORD PTR _iAttackRate$[ebp]
  002f9	d8 d1		 fcom	 ST(1)
  002fb	df e0		 fnstsw	 ax
  002fd	f6 c4 41	 test	 ah, 65			; 00000041H
  00300	0f 8b 54 01 00
	00		 jnp	 $LN63@MissCheckP
  00306	d9 45 f8	 fld	 DWORD PTR _iDefenseRate$[ebp]
  00309	d8 d2		 fcom	 ST(2)
  0030b	df e0		 fnstsw	 ax
  0030d	dd da		 fstp	 ST(2)
  0030f	f6 c4 41	 test	 ah, 65			; 00000041H
  00312	0f 8b 51 01 00
	00		 jnp	 $LN72@MissCheckP
  00318	0f b7 87 be 00
	00 00		 movzx	 eax, WORD PTR [edi+190]
  0031f	66 85 c0	 test	 ax, ax
  00322	0f 8e 41 01 00
	00		 jle	 $LN72@MissCheckP
  00328	66 83 7d f4 00	 cmp	 WORD PTR tv628[ebp], 0
  0032d	0f 8e 36 01 00
	00		 jle	 $LN72@MissCheckP

; 1562 : 	}
; 1563 : 
; 1564 : 	iAttackRate += lpObj->m_ItemOptionExFor380.OpAddAttackSuccessRatePVP;
; 1565 : 	iDefenseRate += lpTargetObj->m_ItemOptionExFor380.OpAddDefenseSuccessRatePvP;
; 1566 : 
; 1567 : 	iAttackRate += lpObj->m_JewelOfHarmonyEffect.HJOpAddAttackSuccessRatePVP;
; 1568 : 	iDefenseRate += lpTargetObj->m_JewelOfHarmonyEffect.HJOpAddDefenseSuccessRatePvP;
; 1569 : 
; 1570 : 
; 1571 : 	iAttackRate		+= lpObj->m_MPSkillOpt.MpsPVPAttackDmgRate;

  00333	0f bf 87 fe 1f
	00 00		 movsx	 eax, WORD PTR [edi+8190]
  0033a	0f bf 97 e6 1f
	00 00		 movsx	 edx, WORD PTR [edi+8166]
  00341	89 45 08	 mov	 DWORD PTR tv366[ebp], eax

; 1572 : 	iDefenseRate	+= lpTargetObj->m_MPSkillOpt.MpsPVPBlockingRate;
; 1573 : 
; 1574 : 
; 1575 : 	float iExpressionA = ( iAttackRate * 10000.0f ) / ( iAttackRate + iDefenseRate );
; 1576 : 	float iExpressionB = (float)(( iBaseLevel * 10000 ) / ( iBaseLevel + iTargetBaseLevel ));
; 1577 : 
; 1578 : 	iExpressionA /= 10000.0f;
; 1579 : 	iExpressionB /= 10000.0f;
; 1580 : 
; 1581 : 	iAttackSuccessRate = (int)(100.0f * iExpressionA * g_fSuccessAttackRateOption * iExpressionB);

  00344	0f bf 81 02 20
	00 00		 movsx	 eax, WORD PTR [ecx+8194]
  0034b	db 45 08	 fild	 DWORD PTR tv366[ebp]
  0034e	de c1		 faddp	 ST(1), ST(0)
  00350	d9 5d 08	 fstp	 DWORD PTR tv364[ebp]
  00353	d9 45 08	 fld	 DWORD PTR tv364[ebp]
  00356	89 55 08	 mov	 DWORD PTR tv360[ebp], edx
  00359	db 45 08	 fild	 DWORD PTR tv360[ebp]
  0035c	0f bf 91 f8 1f
	00 00		 movsx	 edx, WORD PTR [ecx+8184]
  00363	de c1		 faddp	 ST(1), ST(0)
  00365	d9 5d 08	 fstp	 DWORD PTR tv358[ebp]
  00368	d9 45 08	 fld	 DWORD PTR tv358[ebp]
  0036b	89 45 08	 mov	 DWORD PTR tv349[ebp], eax
  0036e	d8 87 3c 26 00
	00		 fadd	 DWORD PTR [edi+9788]
  00374	8b c6		 mov	 eax, esi
  00376	69 c0 10 27 00
	00		 imul	 eax, 10000		; 00002710H
  0037c	d9 5d fc	 fstp	 DWORD PTR _iAttackRate$[ebp]
  0037f	d9 45 fc	 fld	 DWORD PTR _iAttackRate$[ebp]
  00382	d9 c0		 fld	 ST(0)
  00384	dd 05 00 00 00
	00		 fld	 QWORD PTR __real@40c3880000000000
  0038a	dc c9		 fmul	 ST(1), ST(0)
  0038c	db 45 08	 fild	 DWORD PTR tv349[ebp]
  0038f	de c4		 faddp	 ST(4), ST(0)
  00391	d9 cb		 fxch	 ST(3)
  00393	d9 5d 08	 fstp	 DWORD PTR tv348[ebp]
  00396	d9 45 08	 fld	 DWORD PTR tv348[ebp]
  00399	89 55 08	 mov	 DWORD PTR tv342[ebp], edx
  0039c	db 45 08	 fild	 DWORD PTR tv342[ebp]
  0039f	99		 cdq
  003a0	de c1		 faddp	 ST(1), ST(0)
  003a2	d9 5d 08	 fstp	 DWORD PTR tv340[ebp]
  003a5	d9 45 08	 fld	 DWORD PTR tv340[ebp]
  003a8	d8 81 40 26 00
	00		 fadd	 DWORD PTR [ecx+9792]
  003ae	8d 0c 33	 lea	 ecx, DWORD PTR [ebx+esi]
  003b1	f7 f9		 idiv	 ecx
  003b3	d9 5d 08	 fstp	 DWORD PTR tv313[ebp]
  003b6	d9 45 08	 fld	 DWORD PTR tv313[ebp]
  003b9	de c2		 faddp	 ST(2), ST(0)
  003bb	de f1		 fdivrp	 ST(1), ST(0)
  003bd	d9 5d 08	 fstp	 DWORD PTR tv295[ebp]
  003c0	d9 45 08	 fld	 DWORD PTR tv295[ebp]
  003c3	d8 f1		 fdiv	 ST(0), ST(1)
  003c5	d9 5d 08	 fstp	 DWORD PTR tv341[ebp]
  003c8	d9 45 08	 fld	 DWORD PTR tv341[ebp]
  003cb	dc 0d 00 00 00
	00		 fmul	 QWORD PTR __real@4059000000000000
  003d1	89 45 08	 mov	 DWORD PTR tv258[ebp], eax
  003d4	d8 0d 00 00 00
	00		 fmul	 DWORD PTR ?g_fSuccessAttackRateOption@@3MA ; g_fSuccessAttackRateOption
  003da	db 45 08	 fild	 DWORD PTR tv258[ebp]
  003dd	de f2		 fdivrp	 ST(2), ST(0)
  003df	d9 c9		 fxch	 ST(1)
  003e1	d9 5d 08	 fstp	 DWORD PTR tv238[ebp]
  003e4	d8 4d 08	 fmul	 DWORD PTR tv238[ebp]
  003e7	e8 00 00 00 00	 call	 __ftol2_sse

; 1582 : 
; 1583 : 	if ( (iTargetBaseLevel - iBaseLevel) >= 100 )

  003ec	2b de		 sub	 ebx, esi
  003ee	89 45 08	 mov	 DWORD PTR _iAttackSuccessRate$[ebp], eax
  003f1	83 fb 64	 cmp	 ebx, 100		; 00000064H
  003f4	7c 05		 jl	 SHORT $LN6@MissCheckP

; 1584 : 	{
; 1585 : 		iAttackSuccessRate -= 5;

  003f6	83 e8 05	 sub	 eax, 5
  003f9	eb 18		 jmp	 SHORT $LN110@MissCheckP
$LN6@MissCheckP:

; 1586 : 	}
; 1587 : 	else if ( (iTargetBaseLevel - iBaseLevel) >= 200 )

  003fb	81 fb c8 00 00
	00		 cmp	 ebx, 200		; 000000c8H
  00401	7c 05		 jl	 SHORT $LN4@MissCheckP

; 1588 : 	{
; 1589 : 		iAttackSuccessRate -= 10;

  00403	83 e8 0a	 sub	 eax, 10			; 0000000aH
  00406	eb 0b		 jmp	 SHORT $LN110@MissCheckP
$LN4@MissCheckP:

; 1590 : 	}
; 1591 : 	else if ( (iTargetBaseLevel - iBaseLevel) >= 300 )

  00408	81 fb 2c 01 00
	00		 cmp	 ebx, 300		; 0000012cH
  0040e	7c 06		 jl	 SHORT $LN2@MissCheckP

; 1592 : 	{
; 1593 : 		iAttackSuccessRate -= 15;

  00410	83 e8 0f	 sub	 eax, 15			; 0000000fH
$LN110@MissCheckP:
  00413	89 45 08	 mov	 DWORD PTR _iAttackSuccessRate$[ebp], eax
$LN2@MissCheckP:

; 1594 : 	}
; 1595 : 
; 1596 : 	DWORD dwRate = rand() % 100;

  00416	e8 00 00 00 00	 call	 _rand
  0041b	99		 cdq
  0041c	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  00421	f7 f9		 idiv	 ecx

; 1597 : 
; 1598 : 	if ( dwRate > iAttackSuccessRate )

  00423	3b 55 08	 cmp	 edx, DWORD PTR _iAttackSuccessRate$[ebp]
  00426	76 24		 jbe	 SHORT $LN1@MissCheckP

; 1599 : 	{
; 1600 : 		GCDamageSend(lpObj->m_Index, lpTargetObj->m_Index, 0, 0, 0, 0);

  00428	8b 55 0c	 mov	 edx, DWORD PTR _lpTargetObj$[ebp]
  0042b	8b 02		 mov	 eax, DWORD PTR [edx]
  0042d	8b 0f		 mov	 ecx, DWORD PTR [edi]
  0042f	6a 00		 push	 0
  00431	6a 00		 push	 0
  00433	6a 00		 push	 0
  00435	6a 00		 push	 0
  00437	50		 push	 eax
  00438	51		 push	 ecx
  00439	e8 00 00 00 00	 call	 ?GCDamageSend@@YAXHHHHHH@Z ; GCDamageSend
  0043e	83 c4 18	 add	 esp, 24			; 00000018H
  00441	5e		 pop	 esi
  00442	5f		 pop	 edi
  00443	33 c0		 xor	 eax, eax
  00445	5b		 pop	 ebx

; 1605 : }

  00446	8b e5		 mov	 esp, ebp
  00448	5d		 pop	 ebp
  00449	c2 14 00	 ret	 20			; 00000014H
$LN1@MissCheckP:
  0044c	5e		 pop	 esi
  0044d	5f		 pop	 edi

; 1601 : 		return FALSE;
; 1602 : 	}
; 1603 : 
; 1604 : 	return TRUE;

  0044e	b8 01 00 00 00	 mov	 eax, 1
  00453	5b		 pop	 ebx

; 1605 : }

  00454	8b e5		 mov	 esp, ebp
  00456	5d		 pop	 ebp
  00457	c2 14 00	 ret	 20			; 00000014H
$LN63@MissCheckP:
  0045a	5e		 pop	 esi

; 1556 : 	}
; 1557 : #endif
; 1558 : 
; 1559 : 	if ( iAttackRate <= 0.0f || iDefenseRate <= 0.0f || lpObj->Level <= 0 || lpTargetObj->Level <= 0 )

  0045b	dd d9		 fstp	 ST(1)
  0045d	5f		 pop	 edi
  0045e	dd d8		 fstp	 ST(0)

; 1560 : 	{
; 1561 : 		return FALSE;

  00460	33 c0		 xor	 eax, eax
  00462	5b		 pop	 ebx

; 1605 : }

  00463	8b e5		 mov	 esp, ebp
  00465	5d		 pop	 ebp
  00466	c2 14 00	 ret	 20			; 00000014H
$LN72@MissCheckP:
  00469	5e		 pop	 esi

; 1556 : 	}
; 1557 : #endif
; 1558 : 
; 1559 : 	if ( iAttackRate <= 0.0f || iDefenseRate <= 0.0f || lpObj->Level <= 0 || lpTargetObj->Level <= 0 )

  0046a	dd d8		 fstp	 ST(0)
  0046c	5f		 pop	 edi
  0046d	dd d8		 fstp	 ST(0)

; 1560 : 	{
; 1561 : 		return FALSE;

  0046f	33 c0		 xor	 eax, eax
  00471	5b		 pop	 ebx

; 1605 : }

  00472	8b e5		 mov	 esp, ebp
  00474	5d		 pop	 ebp
  00475	c2 14 00	 ret	 20			; 00000014H
?MissCheckPvP@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z ENDP ; CDarkSpirit::MissCheckPvP
_TEXT	ENDS
PUBLIC	__$ArrayPad$
PUBLIC	?SendLevelmsg@CDarkSpirit@@SAXHHHH@Z		; CDarkSpirit::SendLevelmsg
; Function compile flags: /Ogtp
;	COMDAT ?SendLevelmsg@CDarkSpirit@@SAXHHHH@Z
_TEXT	SEGMENT
tv174 = -28						; size = 4
tv172 = -28						; size = 4
tv177 = -22						; size = 2
_pMsg$ = -20						; size = 16
__$ArrayPad$ = -4					; size = 4
_aIndex$ = 8						; size = 4
_nPos$ = 12						; size = 4
_PetType$ = 16						; size = 4
_InvenType$ = 20					; size = 4
?SendLevelmsg@CDarkSpirit@@SAXHHHH@Z PROC		; CDarkSpirit::SendLevelmsg, COMDAT

; 1632 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 1c	 sub	 esp, 28			; 0000001cH
  00006	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000b	33 c5		 xor	 eax, ebp
  0000d	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00010	8b 45 0c	 mov	 eax, DWORD PTR _nPos$[ebp]

; 1633 : 	PMSG_SEND_PET_ITEMINFO pMsg;
; 1634 : 
; 1635 : 	pMsg.h.set((LPBYTE)&pMsg, 0xA9, sizeof(pMsg));
; 1636 : 	pMsg.PetType = PetType;
; 1637 : 	pMsg.InvenType = 0xFE;
; 1638 : 	pMsg.nPos = nPos;
; 1639 : 	pMsg.Level = gObj[aIndex].pInventory[nPos].m_PetItem_Level;
; 1640 : 	pMsg.Exp = gObj[aIndex].pInventory[nPos].m_PetItem_Exp;
; 1641 : 	pMsg.Life = (BYTE)gObj[aIndex].pInventory[nPos].m_Durability; //season4 add-on (possible fix)

  00013	d9 7d ea	 fnstcw	 WORD PTR tv177[ebp]
  00016	8a 4d 10	 mov	 cl, BYTE PTR _PetType$[ebp]
  00019	56		 push	 esi
  0001a	8b 75 08	 mov	 esi, DWORD PTR _aIndex$[ebp]
  0001d	88 45 f1	 mov	 BYTE PTR _pMsg$[ebp+5], al
  00020	69 c0 d4 00 00
	00		 imul	 eax, 212		; 000000d4H
  00026	8b d6		 mov	 edx, esi
  00028	69 d2 50 2b 00
	00		 imul	 edx, 11088		; 00002b50H
  0002e	88 4d ef	 mov	 BYTE PTR _pMsg$[ebp+3], cl
  00031	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00037	8d 8c 0a 24 0e
	00 00		 lea	 ecx, DWORD PTR [edx+ecx+3620]
  0003e	66 c7 45 ec c1
	10		 mov	 WORD PTR _pMsg$[ebp], 4289 ; 000010c1H
  00044	c6 45 ee a9	 mov	 BYTE PTR _pMsg$[ebp+2], 169 ; 000000a9H
  00048	c6 45 f0 fe	 mov	 BYTE PTR _pMsg$[ebp+4], 254 ; 000000feH
  0004c	8b 11		 mov	 edx, DWORD PTR [ecx]
  0004e	0f b6 94 02 bc
	00 00 00	 movzx	 edx, BYTE PTR [edx+eax+188]
  00056	88 55 f2	 mov	 BYTE PTR _pMsg$[ebp+6], dl
  00059	8b 11		 mov	 edx, DWORD PTR [ecx]
  0005b	8b 94 02 c0 00
	00 00		 mov	 edx, DWORD PTR [edx+eax+192]
  00062	89 55 f4	 mov	 DWORD PTR _pMsg$[ebp+8], edx
  00065	8b 09		 mov	 ecx, DWORD PTR [ecx]

; 1642 : 
; 1643 : 	DataSend(aIndex, (LPBYTE)&pMsg, pMsg.h.size);

  00067	6a 10		 push	 16			; 00000010H
  00069	d9 44 01 24	 fld	 DWORD PTR [ecx+eax+36]
  0006d	0f b7 45 ea	 movzx	 eax, WORD PTR tv177[ebp]
  00071	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  00076	89 45 e4	 mov	 DWORD PTR tv174[ebp], eax
  00079	8d 45 ec	 lea	 eax, DWORD PTR _pMsg$[ebp]
  0007c	50		 push	 eax
  0007d	d9 6d e4	 fldcw	 WORD PTR tv174[ebp]
  00080	56		 push	 esi
  00081	db 5d e4	 fistp	 DWORD PTR tv172[ebp]
  00084	0f b6 55 e4	 movzx	 edx, BYTE PTR tv172[ebp]
  00088	88 55 f8	 mov	 BYTE PTR _pMsg$[ebp+12], dl
  0008b	d9 6d ea	 fldcw	 WORD PTR tv177[ebp]
  0008e	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend

; 1644 : }

  00093	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00096	83 c4 0c	 add	 esp, 12			; 0000000cH
  00099	33 cd		 xor	 ecx, ebp
  0009b	5e		 pop	 esi
  0009c	e8 00 00 00 00	 call	 @__security_check_cookie@4
  000a1	8b e5		 mov	 esp, ebp
  000a3	5d		 pop	 ebp
  000a4	c3		 ret	 0
?SendLevelmsg@CDarkSpirit@@SAXHHHH@Z ENDP		; CDarkSpirit::SendLevelmsg
_TEXT	ENDS
PUBLIC	__real@4034000000000000
PUBLIC	??_C@_0IE@HMIJIHBA@?$FLJewelOfHarmony?$FN?$FLPvP?5System?$FN?5Att@ ; `string'
PUBLIC	?GetShieldDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0H@Z ; CDarkSpirit::GetShieldDamage
EXTRN	?GCSendEffectInfo@@YAXHE@Z:PROC			; GCSendEffectInfo
EXTRN	?LogAddTD@@3P6AXPADZZA:DWORD			; LogAddTD
EXTRN	?g_iDamageDevideToSDRate@@3HA:DWORD		; g_iDamageDevideToSDRate
;	COMDAT __real@4034000000000000
CONST	SEGMENT
__real@4034000000000000 DQ 04034000000000000r	; 20
CONST	ENDS
;	COMDAT ??_C@_0IE@HMIJIHBA@?$FLJewelOfHarmony?$FN?$FLPvP?5System?$FN?5Att@
CONST	SEGMENT
??_C@_0IE@HMIJIHBA@?$FLJewelOfHarmony?$FN?$FLPvP?5System?$FN?5Att@ DB '[J'
	DB	'ewelOfHarmony][PvP System] Attacker:[%s][%s]-SD Decrease[%d] '
	DB	'SD Ignore[%d] Defender:[%s][%s] SD Increase Option[%d] - SD R'
	DB	'ate[%d]', 00H				; `string'
; Function compile flags: /Ogtp
CONST	ENDS
;	COMDAT ?GetShieldDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0H@Z
_TEXT	SEGMENT
_lpObj$ = 8						; size = 4
_lpTargetObj$ = 12					; size = 4
_iAttackDamage$ = 16					; size = 4
?GetShieldDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0H@Z PROC ; CDarkSpirit::GetShieldDamage, COMDAT
; _this$ = ecx

; 1647 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 1648 : 	int iShieldDamage = 0;
; 1649 : 
; 1650 : 	if ( g_ShieldSystemOn == FALSE )

  00003	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?g_ShieldSystemOn@@3HA, 0 ; g_ShieldSystemOn
  0000a	75 06		 jne	 SHORT $LN12@GetShieldD
$LN22@GetShieldD:

; 1651 : 	{
; 1652 : 		return 0;

  0000c	33 c0		 xor	 eax, eax

; 1716 : }

  0000e	5d		 pop	 ebp
  0000f	c2 0c 00	 ret	 12			; 0000000cH
$LN12@GetShieldD:

; 1653 : 	}
; 1654 : 
; 1655 : 	if ( iAttackDamage <= 0 )

  00012	8b 4d 10	 mov	 ecx, DWORD PTR _iAttackDamage$[ebp]
  00015	85 c9		 test	 ecx, ecx

; 1656 : 	{
; 1657 : 		return 0;

  00017	7e f3		 jle	 SHORT $LN22@GetShieldD

; 1658 : 	}
; 1659 : 
; 1660 : 	int iReduceLife = 0;
; 1661 : 	int iReduceShield = 0;
; 1662 : 	int iReduceLifeForEffect = 0; 
; 1663 : 	bool bReduceShieldGage = 0;
; 1664 : 	int iDamageDevideToSDRate = g_iDamageDevideToSDRate;
; 1665 : 	iDamageDevideToSDRate -= lpObj->m_JewelOfHarmonyEffect.HJOpDecreaseSDRate;

  00019	53		 push	 ebx
  0001a	8b 5d 08	 mov	 ebx, DWORD PTR _lpObj$[ebp]

; 1666 : 	iDamageDevideToSDRate += lpTargetObj->m_JewelOfHarmonyEffect.HJOpAddSDRate;

  0001d	0f bf 83 e8 1f
	00 00		 movsx	 eax, WORD PTR [ebx+8168]
  00024	56		 push	 esi
  00025	57		 push	 edi
  00026	8b 7d 0c	 mov	 edi, DWORD PTR _lpTargetObj$[ebp]
  00029	0f bf b7 fc 1f
	00 00		 movsx	 esi, WORD PTR [edi+8188]
  00030	2b f0		 sub	 esi, eax
  00032	03 35 00 00 00
	00		 add	 esi, DWORD PTR ?g_iDamageDevideToSDRate@@3HA ; g_iDamageDevideToSDRate

; 1667 : 
; 1668 : 	if ( iDamageDevideToSDRate < 0 )

  00038	79 04		 jns	 SHORT $LN10@GetShieldD

; 1669 : 		iDamageDevideToSDRate = 0;

  0003a	33 f6		 xor	 esi, esi

; 1670 : 
; 1671 : 	if ( iDamageDevideToSDRate > 100 )

  0003c	eb 0a		 jmp	 SHORT $LN9@GetShieldD
$LN10@GetShieldD:
  0003e	83 fe 64	 cmp	 esi, 100		; 00000064H
  00041	7e 05		 jle	 SHORT $LN9@GetShieldD

; 1672 : 		iDamageDevideToSDRate = 100;

  00043	be 64 00 00 00	 mov	 esi, 100		; 00000064H
$LN9@GetShieldD:

; 1673 : 
; 1674 : 	if ( lpObj->m_JewelOfHarmonyEffect.HJOpAddIgnoreSDRate > 0 )

  00048	0f b7 83 ea 1f
	00 00		 movzx	 eax, WORD PTR [ebx+8170]
  0004f	66 85 c0	 test	 ax, ax
  00052	7e 20		 jle	 SHORT $LN7@GetShieldD

; 1675 : 	{
; 1676 : 		int iRand = rand()%100;

  00054	e8 00 00 00 00	 call	 _rand
  00059	99		 cdq
  0005a	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  0005f	f7 f9		 idiv	 ecx

; 1677 : 
; 1678 : 		if ( iRand < lpObj->m_JewelOfHarmonyEffect.HJOpAddIgnoreSDRate )

  00061	0f b7 83 ea 1f
	00 00		 movzx	 eax, WORD PTR [ebx+8170]
  00068	0f bf c8	 movsx	 ecx, ax
  0006b	3b d1		 cmp	 edx, ecx

; 1679 : 		{
; 1680 : 			iDamageDevideToSDRate = 0;

  0006d	8b 4d 10	 mov	 ecx, DWORD PTR _iAttackDamage$[ebp]
  00070	7d 02		 jge	 SHORT $LN7@GetShieldD
  00072	33 f6		 xor	 esi, esi
$LN7@GetShieldD:

; 1681 : 		}
; 1682 : 	}
; 1683 : 
; 1684 : 	if ( lpObj->m_JewelOfHarmonyEffect.HJOpDecreaseSDRate || lpTargetObj->m_JewelOfHarmonyEffect.HJOpAddSDRate || lpObj->m_JewelOfHarmonyEffect.HJOpAddIgnoreSDRate )

  00074	0f b7 93 e8 1f
	00 00		 movzx	 edx, WORD PTR [ebx+8168]
  0007b	66 85 d2	 test	 dx, dx
  0007e	75 0e		 jne	 SHORT $LN5@GetShieldD
  00080	66 39 97 fc 1f
	00 00		 cmp	 WORD PTR [edi+8188], dx
  00087	75 05		 jne	 SHORT $LN5@GetShieldD
  00089	66 85 c0	 test	 ax, ax
  0008c	74 30		 je	 SHORT $LN6@GetShieldD
$LN5@GetShieldD:

; 1685 : 	{
; 1686 : 		LogAddTD("[JewelOfHarmony][PvP System] Attacker:[%s][%s]-SD Decrease[%d] SD Ignore[%d] Defender:[%s][%s] SD Increase Option[%d] - SD Rate[%d]",
; 1687 : 			lpObj->AccountID, lpObj->Name,
; 1688 : 			lpObj->m_JewelOfHarmonyEffect.HJOpDecreaseSDRate, lpObj->m_JewelOfHarmonyEffect.HJOpAddIgnoreSDRate, lpTargetObj->AccountID, lpTargetObj->Name, lpTargetObj->m_JewelOfHarmonyEffect.HJOpAddSDRate, iDamageDevideToSDRate);

  0008e	0f bf 8f fc 1f
	00 00		 movsx	 ecx, WORD PTR [edi+8188]
  00095	56		 push	 esi
  00096	51		 push	 ecx
  00097	8d 4f 77	 lea	 ecx, DWORD PTR [edi+119]
  0009a	51		 push	 ecx
  0009b	8d 4f 6c	 lea	 ecx, DWORD PTR [edi+108]
  0009e	51		 push	 ecx
  0009f	98		 cwde
  000a0	50		 push	 eax
  000a1	0f bf ca	 movsx	 ecx, dx
  000a4	51		 push	 ecx
  000a5	8d 53 77	 lea	 edx, DWORD PTR [ebx+119]
  000a8	52		 push	 edx
  000a9	83 c3 6c	 add	 ebx, 108		; 0000006cH
  000ac	53		 push	 ebx
  000ad	68 00 00 00 00	 push	 OFFSET ??_C@_0IE@HMIJIHBA@?$FLJewelOfHarmony?$FN?$FLPvP?5System?$FN?5Att@
  000b2	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  000b8	8b 4d 10	 mov	 ecx, DWORD PTR _iAttackDamage$[ebp]
  000bb	83 c4 24	 add	 esp, 36			; 00000024H
$LN6@GetShieldD:

; 1689 : 	}
; 1690 : 
; 1691 : 	iReduceShield = iAttackDamage * iDamageDevideToSDRate / 100;

  000be	0f af f1	 imul	 esi, ecx
  000c1	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  000c6	f7 ee		 imul	 esi

; 1692 : 	iReduceLife = iAttackDamage - iReduceShield;
; 1693 : 
; 1694 : 	if ( (lpTargetObj->iShield-iReduceShield) <0 )

  000c8	8b 87 54 01 00
	00		 mov	 eax, DWORD PTR [edi+340]
  000ce	c1 fa 05	 sar	 edx, 5
  000d1	8b f2		 mov	 esi, edx
  000d3	c1 ee 1f	 shr	 esi, 31			; 0000001fH
  000d6	03 f2		 add	 esi, edx
  000d8	2b ce		 sub	 ecx, esi
  000da	2b c6		 sub	 eax, esi
  000dc	8b d9		 mov	 ebx, ecx
  000de	79 56		 jns	 SHORT $LN1@GetShieldD

; 1695 : 	{
; 1696 : 		iReduceLife += iReduceShield  - lpTargetObj->iShield;

  000e0	8b 87 54 01 00
	00		 mov	 eax, DWORD PTR [edi+340]
  000e6	2b f0		 sub	 esi, eax
  000e8	03 de		 add	 ebx, esi

; 1697 : 		iReduceShield = lpTargetObj->iShield;

  000ea	8b f0		 mov	 esi, eax

; 1698 : 
; 1699 : 		if ( lpTargetObj->iShield > 0 )

  000ec	85 c0		 test	 eax, eax
  000ee	7e 46		 jle	 SHORT $LN1@GetShieldD

; 1700 : 		{
; 1701 : 			bReduceShieldGage = true;
; 1702 : 		}
; 1703 : 	}
; 1704 : 
; 1705 : 	iReduceLifeForEffect = (int)(( lpTargetObj->MaxLife + lpTargetObj->AddLife ) * 20.0f / 100.0f);
; 1706 : 
; 1707 : 	if ( bReduceShieldGage == true && iReduceLife > iReduceLifeForEffect )

  000f0	db 87 4c 01 00
	00		 fild	 DWORD PTR [edi+332]
  000f6	d8 87 00 01 00
	00		 fadd	 DWORD PTR [edi+256]
  000fc	dc 0d 00 00 00
	00		 fmul	 QWORD PTR __real@4034000000000000
  00102	dc 35 00 00 00
	00		 fdiv	 QWORD PTR __real@4059000000000000
  00108	e8 00 00 00 00	 call	 __ftol2_sse
  0010d	3b d8		 cmp	 ebx, eax
  0010f	7e 25		 jle	 SHORT $LN1@GetShieldD

; 1708 : 	{
; 1709 : 		if ( !CC_MAP_RANGE(lpTargetObj->MapNumber) )

  00111	0f b6 87 49 01
	00 00		 movzx	 eax, BYTE PTR [edi+329]
  00118	3c 35		 cmp	 al, 53			; 00000035H
  0011a	74 1a		 je	 SHORT $LN1@GetShieldD
  0011c	3c 12		 cmp	 al, 18			; 00000012H
  0011e	72 09		 jb	 SHORT $LN20@GetShieldD
  00120	b1 17		 mov	 cl, 23			; 00000017H
  00122	3a c8		 cmp	 cl, al
  00124	1b c0		 sbb	 eax, eax
  00126	40		 inc	 eax
  00127	75 0d		 jne	 SHORT $LN1@GetShieldD
$LN20@GetShieldD:

; 1710 : 		{
; 1711 : 			GCSendEffectInfo(lpTargetObj->m_Index, 17);

  00129	8b 17		 mov	 edx, DWORD PTR [edi]
  0012b	6a 11		 push	 17			; 00000011H
  0012d	52		 push	 edx
  0012e	e8 00 00 00 00	 call	 ?GCSendEffectInfo@@YAXHE@Z ; GCSendEffectInfo
  00133	83 c4 08	 add	 esp, 8
$LN1@GetShieldD:

; 1712 : 		}
; 1713 : 	}
; 1714 : 
; 1715 : 	return iReduceShield;

  00136	5f		 pop	 edi
  00137	8b c6		 mov	 eax, esi
  00139	5e		 pop	 esi
  0013a	5b		 pop	 ebx

; 1716 : }

  0013b	5d		 pop	 ebp
  0013c	c2 0c 00	 ret	 12			; 0000000cH
?GetShieldDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0H@Z ENDP ; CDarkSpirit::GetShieldDamage
_TEXT	ENDS
PUBLIC	?size@?$vector@UDARKREVAN_ATTACK_BLOCK@@V?$allocator@UDARKREVAN_ATTACK_BLOCK@@@std@@@std@@QBEIXZ ; std::vector<DARKREVAN_ATTACK_BLOCK,std::allocator<DARKREVAN_ATTACK_BLOCK> >::size
; Function compile flags: /Ogtp
; File d:\program files (x86)\microsoft visual studio 10.0\vc\include\vector
;	COMDAT ?size@?$vector@UDARKREVAN_ATTACK_BLOCK@@V?$allocator@UDARKREVAN_ATTACK_BLOCK@@@std@@@std@@QBEIXZ
_TEXT	SEGMENT
?size@?$vector@UDARKREVAN_ATTACK_BLOCK@@V?$allocator@UDARKREVAN_ATTACK_BLOCK@@@std@@@std@@QBEIXZ PROC ; std::vector<DARKREVAN_ATTACK_BLOCK,std::allocator<DARKREVAN_ATTACK_BLOCK> >::size, COMDAT
; _this$ = ecx

; 879  : 		return (this->_Mylast - this->_Myfirst);

  00000	8b 41 04	 mov	 eax, DWORD PTR [ecx+4]
  00003	2b 01		 sub	 eax, DWORD PTR [ecx]
  00005	c1 f8 02	 sar	 eax, 2

; 880  : 		}

  00008	c3		 ret	 0
?size@?$vector@UDARKREVAN_ATTACK_BLOCK@@V?$allocator@UDARKREVAN_ATTACK_BLOCK@@@std@@@std@@QBEIXZ ENDP ; std::vector<DARKREVAN_ATTACK_BLOCK,std::allocator<DARKREVAN_ATTACK_BLOCK> >::size
_TEXT	ENDS
PUBLIC	??A?$vector@UDARKREVAN_ATTACK_BLOCK@@V?$allocator@UDARKREVAN_ATTACK_BLOCK@@@std@@@std@@QAEAAUDARKREVAN_ATTACK_BLOCK@@I@Z ; std::vector<DARKREVAN_ATTACK_BLOCK,std::allocator<DARKREVAN_ATTACK_BLOCK> >::operator[]
; Function compile flags: /Ogtp
;	COMDAT ??A?$vector@UDARKREVAN_ATTACK_BLOCK@@V?$allocator@UDARKREVAN_ATTACK_BLOCK@@@std@@@std@@QAEAAUDARKREVAN_ATTACK_BLOCK@@I@Z
_TEXT	SEGMENT
__Pos$ = 8						; size = 4
??A?$vector@UDARKREVAN_ATTACK_BLOCK@@V?$allocator@UDARKREVAN_ATTACK_BLOCK@@@std@@@std@@QAEAAUDARKREVAN_ATTACK_BLOCK@@I@Z PROC ; std::vector<DARKREVAN_ATTACK_BLOCK,std::allocator<DARKREVAN_ATTACK_BLOCK> >::operator[], COMDAT
; _this$ = ecx

; 928  : 		{	// subscript mutable sequence

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 929  :  #if _ITERATOR_DEBUG_LEVEL == 2
; 930  : 		if (size() <= _Pos)
; 931  : 			{	// report error
; 932  : 			_DEBUG_ERROR("vector subscript out of range");
; 933  : 			_SCL_SECURE_OUT_OF_RANGE;
; 934  : 			}
; 935  : 
; 936  :  #elif _ITERATOR_DEBUG_LEVEL == 1
; 937  : 		_SCL_SECURE_VALIDATE_RANGE(_Pos < size());
; 938  :  #endif /* _ITERATOR_DEBUG_LEVEL */
; 939  : 
; 940  : 		return (*(this->_Myfirst + _Pos));

  00003	8b 01		 mov	 eax, DWORD PTR [ecx]
  00005	8b 4d 08	 mov	 ecx, DWORD PTR __Pos$[ebp]
  00008	8d 04 88	 lea	 eax, DWORD PTR [eax+ecx*4]

; 941  : 		}

  0000b	5d		 pop	 ebp
  0000c	c2 04 00	 ret	 4
??A?$vector@UDARKREVAN_ATTACK_BLOCK@@V?$allocator@UDARKREVAN_ATTACK_BLOCK@@@std@@@std@@QAEAAUDARKREVAN_ATTACK_BLOCK@@I@Z ENDP ; std::vector<DARKREVAN_ATTACK_BLOCK,std::allocator<DARKREVAN_ATTACK_BLOCK> >::operator[]
_TEXT	ENDS
PUBLIC	??0CDarkSpirit@@QAE@XZ				; CDarkSpirit::CDarkSpirit
EXTRN	??0CObjBaseAttack@@QAE@XZ:PROC			; CObjBaseAttack::CObjBaseAttack
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\darkspirit.cpp
;	COMDAT ??0CDarkSpirit@@QAE@XZ
_TEXT	SEGMENT
??0CDarkSpirit@@QAE@XZ PROC				; CDarkSpirit::CDarkSpirit, COMDAT
; _this$ = ecx

; 30   : {

  00000	56		 push	 esi
  00001	8b f1		 mov	 esi, ecx
  00003	e8 00 00 00 00	 call	 ??0CObjBaseAttack@@QAE@XZ ; CObjBaseAttack::CObjBaseAttack

; 31   : 	this->Init();

  00008	8b ce		 mov	 ecx, esi
  0000a	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET ??_7CDarkSpirit@@6B@
  00010	c7 46 20 00 00
	00 00		 mov	 DWORD PTR [esi+32], 0
  00017	e8 00 00 00 00	 call	 ?Init@CDarkSpirit@@QAEXXZ ; CDarkSpirit::Init

; 32   : }

  0001c	8b c6		 mov	 eax, esi
  0001e	5e		 pop	 esi
  0001f	c3		 ret	 0
??0CDarkSpirit@@QAE@XZ ENDP				; CDarkSpirit::CDarkSpirit
_TEXT	ENDS
EXTRN	??3@YAXPAX@Z:PROC				; operator delete
; Function compile flags: /Ogtp
;	COMDAT ??_GCDarkSpirit@@UAEPAXI@Z
_TEXT	SEGMENT
___flags$ = 8						; size = 4
??_GCDarkSpirit@@UAEPAXI@Z PROC				; CDarkSpirit::`scalar deleting destructor', COMDAT
; _this$ = ecx
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	56		 push	 esi
  00004	8b f1		 mov	 esi, ecx
  00006	e8 00 00 00 00	 call	 ??1CDarkSpirit@@UAE@XZ	; CDarkSpirit::~CDarkSpirit
  0000b	f6 45 08 01	 test	 BYTE PTR ___flags$[ebp], 1
  0000f	74 09		 je	 SHORT $LN4@scalar
  00011	56		 push	 esi
  00012	e8 00 00 00 00	 call	 ??3@YAXPAX@Z		; operator delete
  00017	83 c4 04	 add	 esp, 4
$LN4@scalar:
  0001a	8b c6		 mov	 eax, esi
  0001c	5e		 pop	 esi
  0001d	5d		 pop	 ebp
  0001e	c2 04 00	 ret	 4
??_GCDarkSpirit@@UAEPAXI@Z ENDP				; CDarkSpirit::`scalar deleting destructor'
_TEXT	ENDS
PUBLIC	?RangeAttack@CDarkSpirit@@QAEXHH@Z		; CDarkSpirit::RangeAttack
EXTRN	?gObjCalDistance@@YAHPAUOBJECTSTRUCT@@0@Z:PROC	; gObjCalDistance
EXTRN	?gObjTargetGuildWarCheck@@YAHPAUOBJECTSTRUCT@@0@Z:PROC ; gObjTargetGuildWarCheck
; Function compile flags: /Ogtp
;	COMDAT ?RangeAttack@CDarkSpirit@@QAEXHH@Z
_TEXT	SEGMENT
_this$ = -12						; size = 4
tv330 = -8						; size = 4
_count$ = -4						; size = 4
_HitCount$ = 8						; size = 4
_aIndex$ = 8						; size = 4
_aTargetIndex$ = 12					; size = 4
?RangeAttack@CDarkSpirit@@QAEXHH@Z PROC			; CDarkSpirit::RangeAttack, COMDAT
; _this$ = ecx

; 319  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 0c	 sub	 esp, 12			; 0000000cH
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 320  : 	LPOBJ lpObj = &gObj[aIndex];

  00009	8b 7d 08	 mov	 edi, DWORD PTR _aIndex$[ebp]
  0000c	69 ff 50 2b 00
	00		 imul	 edi, 11088		; 00002b50H
  00012	03 3d 00 00 00
	00		 add	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj

; 321  : 	int StartDis = 1;
; 322  : 	int tObjNum;
; 323  : 	int count = 0;

  00018	33 c0		 xor	 eax, eax

; 324  : 	int loopcount = 0;
; 325  : 	int attackcheck;
; 326  : 	int EnableAttack;
; 327  : 	int HitCount = 0;
; 328  : 
; 329  : 	this->SendAttackMsg(lpObj->m_Index, aTargetIndex, 0, 0);

  0001a	8b 17		 mov	 edx, DWORD PTR [edi]
  0001c	50		 push	 eax
  0001d	50		 push	 eax
  0001e	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
  00021	89 45 08	 mov	 DWORD PTR _HitCount$[ebp], eax
  00024	8b 45 0c	 mov	 eax, DWORD PTR _aTargetIndex$[ebp]
  00027	50		 push	 eax
  00028	52		 push	 edx
  00029	89 4d f4	 mov	 DWORD PTR _this$[ebp], ecx
  0002c	e8 00 00 00 00	 call	 ?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z ; CDarkSpirit::SendAttackMsg
  00031	8d 87 ae 08 00
	00		 lea	 eax, DWORD PTR [edi+2222]
  00037	89 45 f8	 mov	 DWORD PTR tv330[ebp], eax
  0003a	8d 9b 00 00 00
	00		 npad	 6
$LL19@RangeAttac:

; 330  : 
; 331  : 	while ( true )
; 332  : 	{
; 333  : 		if ( lpObj->VpPlayer2[count].state != 0 )

  00040	80 78 fe 00	 cmp	 BYTE PTR [eax-2], 0
  00044	0f 84 ac 00 00
	00		 je	 $LN28@RangeAttac

; 334  : 		{
; 335  : 			tObjNum = lpObj->VpPlayer2[count].number;

  0004a	0f bf 18	 movsx	 ebx, WORD PTR [eax]

; 336  : 
; 337  : 			if ( tObjNum >= 0 && aTargetIndex != tObjNum )

  0004d	85 db		 test	 ebx, ebx
  0004f	0f 88 a1 00 00
	00		 js	 $LN28@RangeAttac
  00055	39 5d 0c	 cmp	 DWORD PTR _aTargetIndex$[ebp], ebx
  00058	0f 84 98 00 00
	00		 je	 $LN28@RangeAttac

; 338  : 			{
; 339  : 				EnableAttack = FALSE;
; 340  : 				
; 341  : 				if ( lpObj->VpPlayer2[count].type == OBJ_MONSTER && gObj[tObjNum].m_RecallMon < 0)

  0005e	80 78 02 02	 cmp	 BYTE PTR [eax+2], 2
  00062	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00067	75 12		 jne	 SHORT $LN15@RangeAttac
  00069	8b f3		 mov	 esi, ebx
  0006b	69 f6 50 2b 00
	00		 imul	 esi, 11088		; 00002b50H
  00071	83 bc 06 50 04
	00 00 00	 cmp	 DWORD PTR [esi+eax+1104], 0

; 342  : 				{
; 343  : 					EnableAttack = TRUE;

  00079	7c 43		 jl	 SHORT $LN26@RangeAttac
$LN15@RangeAttac:

; 344  : 				}
; 345  : 				else if ( tObjNum == aTargetIndex )
; 346  : 				{
; 347  : 					EnableAttack = TRUE;
; 348  : 				}
; 349  : 				else
; 350  : 				{
; 351  : 					int lc10 = gObj[tObjNum].m_Index;

  0007b	8b f3		 mov	 esi, ebx
  0007d	69 f6 50 2b 00
	00		 imul	 esi, 11088		; 00002b50H

; 352  : 
; 353  : 					if ( gObj[tObjNum].Type == OBJ_MONSTER )

  00083	66 83 7c 06 68
	02		 cmp	 WORD PTR [esi+eax+104], 2
  00089	8b 0c 06	 mov	 ecx, DWORD PTR [esi+eax]
  0008c	75 14		 jne	 SHORT $LN10@RangeAttac

; 354  : 					{
; 355  : 						if ( gObj[tObjNum].m_RecallMon >= 0 )

  0008e	8b 94 06 50 04
	00 00		 mov	 edx, DWORD PTR [esi+eax+1104]
  00095	85 d2		 test	 edx, edx
  00097	78 09		 js	 SHORT $LN10@RangeAttac

; 356  : 						{
; 357  : 							lc10 = gObj[gObj[tObjNum].m_RecallMon].m_Index;

  00099	69 d2 50 2b 00
	00		 imul	 edx, 11088		; 00002b50H
  0009f	8b 0c 02	 mov	 ecx, DWORD PTR [edx+eax]
$LN10@RangeAttac:

; 358  : 						}
; 359  : 					}
; 360  : 
; 361  : 					if ( gObjTargetGuildWarCheck(lpObj, &gObj[lc10]) == TRUE )

  000a2	69 c9 50 2b 00
	00		 imul	 ecx, 11088		; 00002b50H
  000a8	03 c8		 add	 ecx, eax
  000aa	51		 push	 ecx
  000ab	57		 push	 edi
  000ac	e8 00 00 00 00	 call	 ?gObjTargetGuildWarCheck@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjTargetGuildWarCheck
  000b1	83 c4 08	 add	 esp, 8
  000b4	83 f8 01	 cmp	 eax, 1
  000b7	75 3d		 jne	 SHORT $LN28@RangeAttac
  000b9	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
$LN26@RangeAttac:

; 362  : 					{
; 363  : 						EnableAttack = TRUE;
; 364  : 					}
; 365  : 				}
; 366  : 
; 367  : 				if ( EnableAttack != FALSE )
; 368  : 				{
; 369  : 					attackcheck = FALSE;
; 370  : 
; 371  : 					if ( loopcount == 0 )
; 372  : 					{
; 373  : 						attackcheck = TRUE;
; 374  : 					}
; 375  : 					else if ( (rand()%3) == 0 )
; 376  : 					{
; 377  : 						attackcheck = TRUE;
; 378  : 					}
; 379  : 
; 380  : 					if ( attackcheck != FALSE )
; 381  : 					{
; 382  : 						if ( gObjCalDistance(&gObj[aTargetIndex], &gObj[tObjNum]) < RAVEN_ATTACK_DISTANCE-3 )

  000be	8b 4d 0c	 mov	 ecx, DWORD PTR _aTargetIndex$[ebp]
  000c1	69 c9 50 2b 00
	00		 imul	 ecx, 11088		; 00002b50H
  000c7	03 f0		 add	 esi, eax
  000c9	03 c8		 add	 ecx, eax
  000cb	56		 push	 esi
  000cc	51		 push	 ecx
  000cd	e8 00 00 00 00	 call	 ?gObjCalDistance@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjCalDistance
  000d2	83 c4 08	 add	 esp, 8
  000d5	83 f8 04	 cmp	 eax, 4
  000d8	7d 1c		 jge	 SHORT $LN28@RangeAttac

; 383  : 						{
; 384  : 							this->SendAttackMsg(lpObj->m_Index, tObjNum, 2, 0);

  000da	8b 17		 mov	 edx, DWORD PTR [edi]
  000dc	8b 4d f4	 mov	 ecx, DWORD PTR _this$[ebp]
  000df	6a 00		 push	 0
  000e1	6a 02		 push	 2
  000e3	53		 push	 ebx
  000e4	52		 push	 edx
  000e5	e8 00 00 00 00	 call	 ?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z ; CDarkSpirit::SendAttackMsg

; 385  : 							HitCount++;

  000ea	8b 45 08	 mov	 eax, DWORD PTR _HitCount$[ebp]
  000ed	40		 inc	 eax
  000ee	89 45 08	 mov	 DWORD PTR _HitCount$[ebp], eax

; 386  : 
; 387  : 							if ( HitCount > 3 )

  000f1	83 f8 03	 cmp	 eax, 3
  000f4	7f 19		 jg	 SHORT $LN24@RangeAttac
$LN28@RangeAttac:

; 388  : 							{
; 389  : 								break;
; 390  : 							}
; 391  : 						}
; 392  : 					}
; 393  : 				}
; 394  : 			}				
; 395  : 		}
; 396  : 
; 397  : 		count++;

  000f6	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000f9	8b 45 f8	 mov	 eax, DWORD PTR tv330[ebp]
  000fc	41		 inc	 ecx
  000fd	83 c0 0c	 add	 eax, 12			; 0000000cH
  00100	89 4d fc	 mov	 DWORD PTR _count$[ebp], ecx
  00103	89 45 f8	 mov	 DWORD PTR tv330[ebp], eax

; 398  : 
; 399  : 		if ( count > MAX_VIEWPORT-1 )

  00106	83 f9 4a	 cmp	 ecx, 74			; 0000004aH
  00109	0f 8e 31 ff ff
	ff		 jle	 $LL19@RangeAttac
$LN24@RangeAttac:
  0010f	5f		 pop	 edi
  00110	5e		 pop	 esi
  00111	5b		 pop	 ebx

; 400  : 		{
; 401  : 			break;
; 402  : 		}
; 403  : 	}
; 404  : }

  00112	8b e5		 mov	 esp, ebp
  00114	5d		 pop	 ebp
  00115	c2 08 00	 ret	 8
?RangeAttack@CDarkSpirit@@QAEXHH@Z ENDP			; CDarkSpirit::RangeAttack
_TEXT	ENDS
PUBLIC	?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z	; CDarkSpirit::SetMode
EXTRN	?g_Manager@@3VCManager@@A:BYTE			; g_Manager
; Function compile flags: /Ogtp
;	COMDAT ?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z
_TEXT	SEGMENT
_pMsg$215772 = -8					; size = 7
_mode$ = 8						; size = 4
_iTargetindex$ = 12					; size = 4
?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z PROC	; CDarkSpirit::SetMode, COMDAT
; _this$ = ecx

; 512  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 08	 sub	 esp, 8
  00006	56		 push	 esi
  00007	8b f1		 mov	 esi, ecx

; 513  : 	if ( this->m_iMasterIndex == -1 )

  00009	8b 46 14	 mov	 eax, DWORD PTR [esi+20]
  0000c	83 f8 ff	 cmp	 eax, -1
  0000f	0f 84 cc 00 00
	00		 je	 $LN5@SetMode

; 514  : 	{
; 515  : 		return;
; 516  : 	}
; 517  : 
; 518  : 	LPOBJ lpObj = &gObj[this->m_iMasterIndex];

  00015	69 c0 50 2b 00
	00		 imul	 eax, 11088		; 00002b50H
  0001b	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00021	57		 push	 edi
  00022	8b f8		 mov	 edi, eax

; 519  : 
; 520  : 	if ( lpObj->Class != CLASS_DARKLORD )

  00024	66 83 bf b8 00
	00 00 04	 cmp	 WORD PTR [edi+184], 4
  0002c	0f 85 ae 00 00
	00		 jne	 $LN28@SetMode

; 521  : 	{
; 522  : 		return;
; 523  : 	}
; 524  : 
; 525  : 	#if(CUSTOM_MANAGER)
; 526  : 	if(g_ZtLicense.CheckUser(eZtUB::Gredy) || g_ZtLicense.CheckUser(eZtUB::Gredy2) || g_ZtLicense.CheckUser(eZtUB::GredyLocal))

  00032	6a 20		 push	 32			; 00000020H
  00034	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_ZtLicense@@3VCZtLicense@@A ; g_ZtLicense
  00039	e8 00 00 00 00	 call	 ?CheckUser@CZtLicense@@QAE_NH@Z ; CZtLicense::CheckUser
  0003e	84 c0		 test	 al, al
  00040	75 20		 jne	 SHORT $LN10@SetMode
  00042	6a 22		 push	 34			; 00000022H
  00044	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_ZtLicense@@3VCZtLicense@@A ; g_ZtLicense
  00049	e8 00 00 00 00	 call	 ?CheckUser@CZtLicense@@QAE_NH@Z ; CZtLicense::CheckUser
  0004e	84 c0		 test	 al, al
  00050	75 10		 jne	 SHORT $LN10@SetMode
  00052	6a 21		 push	 33			; 00000021H
  00054	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_ZtLicense@@3VCZtLicense@@A ; g_ZtLicense
  00059	e8 00 00 00 00	 call	 ?CheckUser@CZtLicense@@QAE_NH@Z ; CZtLicense::CheckUser
  0005e	84 c0		 test	 al, al
  00060	74 28		 je	 SHORT $LN7@SetMode
$LN10@SetMode:

; 527  : 	{
; 528  : 		for(int i = 0; i < g_Manager.m_DarkRevenAttackBlock.size(); i++)

  00062	a1 04 00 00 00	 mov	 eax, DWORD PTR ?g_Manager@@3VCManager@@A+4
  00067	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?g_Manager@@3VCManager@@A
  0006d	2b c2		 sub	 eax, edx
  0006f	c1 f8 02	 sar	 eax, 2
  00072	33 c9		 xor	 ecx, ecx
  00074	85 c0		 test	 eax, eax
  00076	74 12		 je	 SHORT $LN7@SetMode
  00078	0f b6 bf 49 01
	00 00		 movzx	 edi, BYTE PTR [edi+329]
  0007f	90		 npad	 1
$LL9@SetMode:

; 529  : 		{
; 530  : 			if(lpObj->MapNumber == g_Manager.m_DarkRevenAttackBlock[i].Map)

  00080	3b 3c 8a	 cmp	 edi, DWORD PTR [edx+ecx*4]
  00083	74 5b		 je	 SHORT $LN28@SetMode

; 527  : 	{
; 528  : 		for(int i = 0; i < g_Manager.m_DarkRevenAttackBlock.size(); i++)

  00085	41		 inc	 ecx
  00086	3b c8		 cmp	 ecx, eax
  00088	72 f6		 jb	 SHORT $LL9@SetMode
$LN7@SetMode:

; 531  : 			{
; 532  : 				return;
; 533  : 			}
; 534  : 		}
; 535  : 	}
; 536  : 	#endif
; 537  : 
; 538  : 	if ( mode == PetItem_Mode_Attack_Target || this->m_ActionMode != mode)

  0008a	8b 45 08	 mov	 eax, DWORD PTR _mode$[ebp]
  0008d	83 f8 03	 cmp	 eax, 3
  00090	74 07		 je	 SHORT $LN27@SetMode
  00092	39 46 20	 cmp	 DWORD PTR [esi+32], eax
  00095	74 49		 je	 SHORT $LN28@SetMode

; 539  : 	{
; 540  : 		if ( mode == PetItem_Mode_Attack_Target )

  00097	eb 19		 jmp	 SHORT $LN1@SetMode
$LN27@SetMode:

; 541  : 		{
; 542  : 			if ( OBJMAX_RANGE(iTargetindex) != FALSE )

  00099	8b 4d 0c	 mov	 ecx, DWORD PTR _iTargetindex$[ebp]
  0009c	85 c9		 test	 ecx, ecx
  0009e	78 40		 js	 SHORT $LN28@SetMode
  000a0	33 d2		 xor	 edx, edx
  000a2	81 f9 97 3a 00
	00		 cmp	 ecx, 14999		; 00003a97H
  000a8	0f 9e c2	 setle	 dl
  000ab	85 d2		 test	 edx, edx
  000ad	74 31		 je	 SHORT $LN28@SetMode

; 543  : 			{
; 544  : 				this->m_iTargetIndex = iTargetindex;

  000af	89 4e 18	 mov	 DWORD PTR [esi+24], ecx
$LN1@SetMode:

; 545  : 			}
; 546  : 			else
; 547  : 			{
; 548  : 				return;
; 549  : 			}
; 550  : 		}
; 551  : 
; 552  : 		this->m_ActionMode = mode;
; 553  : 		PMSG_SEND_PET_ITEM_COMMAND pMsg;
; 554  : 
; 555  : 		pMsg.h.set((LPBYTE)&pMsg, 0xA7, sizeof(pMsg));
; 556  : 		pMsg.PetType = 0;
; 557  : 		pMsg.Command = mode;
; 558  : 		pMsg.NumberH = SET_NUMBERH(this->m_iTargetIndex);
; 559  : 		pMsg.NumberL = SET_NUMBERL(this->m_iTargetIndex);

  000b2	8a 4e 18	 mov	 cl, BYTE PTR [esi+24]
  000b5	89 46 20	 mov	 DWORD PTR [esi+32], eax
  000b8	88 45 fc	 mov	 BYTE PTR _pMsg$215772[ebp+4], al
  000bb	8b 46 18	 mov	 eax, DWORD PTR [esi+24]
  000be	c1 e8 08	 shr	 eax, 8

; 560  : 
; 561  : 		DataSend(this->m_iMasterIndex, (LPBYTE)&pMsg, sizeof(pMsg));

  000c1	6a 07		 push	 7
  000c3	8d 55 f8	 lea	 edx, DWORD PTR _pMsg$215772[ebp]
  000c6	88 45 fd	 mov	 BYTE PTR _pMsg$215772[ebp+5], al
  000c9	8b 46 14	 mov	 eax, DWORD PTR [esi+20]
  000cc	52		 push	 edx
  000cd	50		 push	 eax
  000ce	c7 45 f8 c1 07
	a7 00		 mov	 DWORD PTR _pMsg$215772[ebp], 10946497 ; 00a707c1H
  000d5	88 4d fe	 mov	 BYTE PTR _pMsg$215772[ebp+6], cl
  000d8	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  000dd	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN28@SetMode:
  000e0	5f		 pop	 edi
$LN5@SetMode:
  000e1	5e		 pop	 esi

; 562  : 
; 563  : 		char strMode[4][255] =
; 564  : 		{
; 565  : 			"[]",
; 566  : 			"[]",
; 567  : 			"[]",
; 568  : 			"[]"
; 569  : 		};
; 570  : 	}
; 571  : }

  000e2	8b e5		 mov	 esp, ebp
  000e4	5d		 pop	 ebp
  000e5	c2 08 00	 ret	 8
?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z ENDP	; CDarkSpirit::SetMode
_TEXT	ENDS
PUBLIC	?Set@CDarkSpirit@@QAEXHPAVCItem@@@Z		; CDarkSpirit::Set
EXTRN	?ZtConfig@@3VcZtConfigs@@A:BYTE			; ZtConfig
; Function compile flags: /Ogtp
;	COMDAT ?Set@CDarkSpirit@@QAEXHPAVCItem@@@Z
_TEXT	SEGMENT
_bChange$ = -4						; size = 4
_aIndex$ = 8						; size = 4
_pPetItem$ = 12						; size = 4
?Set@CDarkSpirit@@QAEXHPAVCItem@@@Z PROC		; CDarkSpirit::Set, COMDAT
; _this$ = ecx

; 574  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	53		 push	 ebx

; 575  : 	LPOBJ lpObj = &gObj[aIndex];

  00005	8b 5d 08	 mov	 ebx, DWORD PTR _aIndex$[ebp]
  00008	69 db 50 2b 00
	00		 imul	 ebx, 11088		; 00002b50H
  0000e	03 1d 00 00 00
	00		 add	 ebx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj

; 576  : 
; 577  : 	if ( lpObj->Class != CLASS_DARKLORD )

  00014	66 83 bb b8 00
	00 00 04	 cmp	 WORD PTR [ebx+184], 4
  0001c	0f 85 f4 00 00
	00		 jne	 $LN1@Set

; 578  : 	{
; 579  : 		return;
; 580  : 	}
; 581  : 
; 582  : 	BOOL bChange = FALSE;
; 583  : 
; 584  : 	if ( this->m_iMasterIndex == -1 )

  00022	83 79 14 ff	 cmp	 DWORD PTR [ecx+20], -1
  00026	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _bChange$[ebp], 0
  0002d	75 07		 jne	 SHORT $LN4@Set

; 585  : 	{
; 586  : 		bChange = TRUE;

  0002f	c7 45 fc 01 00
	00 00		 mov	 DWORD PTR _bChange$[ebp], 1
$LN4@Set:

; 587  : 	}
; 588  : 
; 589  : 	this->Init();

  00036	e8 00 00 00 00	 call	 ?Init@CDarkSpirit@@QAEXXZ ; CDarkSpirit::Init

; 590  : 
; 591  : 	if ( pPetItem->m_Type != ITEMGET(13,5) )

  0003b	8b 55 0c	 mov	 edx, DWORD PTR _pPetItem$[ebp]
  0003e	b8 05 1a 00 00	 mov	 eax, 6661		; 00001a05H
  00043	66 39 42 06	 cmp	 WORD PTR [edx+6], ax
  00047	0f 85 c9 00 00
	00		 jne	 $LN1@Set

; 592  : 	{
; 593  : 		return;
; 594  : 	}
; 595  : 
; 596  : 	if ( pPetItem->m_Durability <= 0.0f )

  0004d	d9 ee		 fldz
  0004f	d8 5a 24	 fcomp	 DWORD PTR [edx+36]
  00052	df e0		 fnstsw	 ax
  00054	f6 c4 01	 test	 ah, 1
  00057	0f 84 b9 00 00
	00		 je	 $LN1@Set

; 597  : 	{
; 598  : 		return;
; 599  : 	}
; 600  : 
; 601  : 	int petitemlevel = pPetItem->m_PetItem_Level;

  0005d	56		 push	 esi
  0005e	8b b2 bc 00 00
	00		 mov	 esi, DWORD PTR [edx+188]

; 602  : 	int leadership = lpObj->Leadership + lpObj->AddLeadership;

  00064	0f b7 93 18 01
	00 00		 movzx	 edx, WORD PTR [ebx+280]
  0006b	57		 push	 edi
  0006c	0f b7 bb 1a 01
	00 00		 movzx	 edi, WORD PTR [ebx+282]
  00073	03 fa		 add	 edi, edx

; 603  : 
; 604  : 	//this->m_AttackDamageMin = petitemlevel*15 + leadership/8 + 180;
; 605  : 	//this->m_AttackDamageMax = petitemlevel*15 + leadership/4 + 200;
; 606  : 	//this->m_AttackSpeed = petitemlevel * 4 / 5 + leadership / 50 + 20;
; 607  : 	//this->m_SuccessAttackRate= petitemlevel + petitemlevel / 15 + 1000;
; 608  : 
; 609  : 
; 610  : 	this->m_AttackDamageMin = petitemlevel * ZtConfig.Pet.RavenAttackDamageMinLvl + leadership/ZtConfig.Pet.RavenAttackDamageMinCmd + 180;

  00075	8b c7		 mov	 eax, edi
  00077	99		 cdq
  00078	f7 3d b4 08 00
	00		 idiv	 DWORD PTR ?ZtConfig@@3VcZtConfigs@@A+2228
  0007e	8b 15 ac 08 00
	00		 mov	 edx, DWORD PTR ?ZtConfig@@3VcZtConfigs@@A+2220
  00084	0f af d6	 imul	 edx, esi
  00087	8d 84 10 b4 00
	00 00		 lea	 eax, DWORD PTR [eax+edx+180]
  0008e	89 41 04	 mov	 DWORD PTR [ecx+4], eax

; 611  : 	this->m_AttackDamageMax = petitemlevel * ZtConfig.Pet.RavenAttackDamageMaxLvl + leadership/ZtConfig.Pet.RavenAttackDamageMaxCmd + 200;

  00091	8b c7		 mov	 eax, edi
  00093	99		 cdq
  00094	f7 3d b8 08 00
	00		 idiv	 DWORD PTR ?ZtConfig@@3VcZtConfigs@@A+2232
  0009a	8b 15 b0 08 00
	00		 mov	 edx, DWORD PTR ?ZtConfig@@3VcZtConfigs@@A+2224
  000a0	0f af d6	 imul	 edx, esi
  000a3	8d 84 10 c8 00
	00 00		 lea	 eax, DWORD PTR [eax+edx+200]
  000aa	89 41 08	 mov	 DWORD PTR [ecx+8], eax

; 612  : 	this->m_AttackSpeed = petitemlevel * 4 / 5 + leadership / 50 + 20;

  000ad	8d 14 b5 00 00
	00 00		 lea	 edx, DWORD PTR [esi*4]
  000b4	b8 67 66 66 66	 mov	 eax, 1717986919		; 66666667H
  000b9	f7 ea		 imul	 edx
  000bb	d1 fa		 sar	 edx, 1
  000bd	8b da		 mov	 ebx, edx
  000bf	c1 eb 1f	 shr	 ebx, 31			; 0000001fH
  000c2	03 da		 add	 ebx, edx
  000c4	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  000c9	f7 ef		 imul	 edi
  000cb	c1 fa 04	 sar	 edx, 4
  000ce	8b c2		 mov	 eax, edx
  000d0	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  000d3	03 da		 add	 ebx, edx
  000d5	8d 54 18 14	 lea	 edx, DWORD PTR [eax+ebx+20]
  000d9	89 51 0c	 mov	 DWORD PTR [ecx+12], edx

; 613  : 	this->m_SuccessAttackRate= petitemlevel + petitemlevel / 15 + 1000;

  000dc	b8 89 88 88 88	 mov	 eax, -2004318071	; 88888889H
  000e1	f7 ee		 imul	 esi
  000e3	03 d6		 add	 edx, esi
  000e5	c1 fa 03	 sar	 edx, 3
  000e8	8b c2		 mov	 eax, edx
  000ea	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  000ed	03 c2		 add	 eax, edx

; 614  : 
; 615  : 	this->m_iMasterIndex = aIndex;
; 616  : 	this->m_pPetItem = pPetItem;
; 617  : 
; 618  : 	if ( bChange != FALSE )

  000ef	83 7d fc 00	 cmp	 DWORD PTR _bChange$[ebp], 0
  000f3	8d 94 30 e8 03
	00 00		 lea	 edx, DWORD PTR [eax+esi+1000]
  000fa	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  000fd	89 51 10	 mov	 DWORD PTR [ecx+16], edx
  00100	8b 55 0c	 mov	 edx, DWORD PTR _pPetItem$[ebp]
  00103	5f		 pop	 edi
  00104	89 41 14	 mov	 DWORD PTR [ecx+20], eax
  00107	89 51 24	 mov	 DWORD PTR [ecx+36], edx
  0010a	5e		 pop	 esi
  0010b	74 09		 je	 SHORT $LN1@Set

; 619  : 	{
; 620  : 		this->SetMode(PetItem_Mode_Normal, -1);

  0010d	6a ff		 push	 -1
  0010f	6a 00		 push	 0
  00111	e8 00 00 00 00	 call	 ?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z ; CDarkSpirit::SetMode
$LN1@Set:
  00116	5b		 pop	 ebx

; 621  : 	}
; 622  : }

  00117	8b e5		 mov	 esp, ebp
  00119	5d		 pop	 ebp
  0011a	c2 08 00	 ret	 8
?Set@CDarkSpirit@@QAEXHPAVCItem@@@Z ENDP		; CDarkSpirit::Set
_TEXT	ENDS
PUBLIC	__real@4024000000000000
PUBLIC	??_C@_0EO@IMJLIFKK@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$LE?Y?E?$KJ?$LN?$LK?G?G?$LI?$LE?$MA?G?$LJ?$NP?E?i?5Item?5i@ ; `string'
PUBLIC	??_C@_0DL@HDCMLJGF@?$FL?$CFs?$FN?$FL?$CFs?$FN?$FLPetItemExpDown?$FN?5?$FL?$CFs?$FN?5Le@ ; `string'
PUBLIC	__real@3f800000
PUBLIC	__real@3ff0000000000000
PUBLIC	?Attack@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0PAVCMagicInf@@HH@Z ; CDarkSpirit::Attack
EXTRN	?gObjLifeCheck@@YAXPAUOBJECTSTRUCT@@0HHHHGH@Z:PROC ; gObjLifeCheck
EXTRN	?GCMagicAttackNumberSend@@YAXPAUOBJECTSTRUCT@@GHE@Z:PROC ; GCMagicAttackNumberSend
EXTRN	?GCManaSend@@YAXHHEEH@Z:PROC			; GCManaSend
EXTRN	?gObjUniriaSprite@@YAHPAUOBJECTSTRUCT@@@Z:PROC	; gObjUniriaSprite
EXTRN	?gObjCheckSelfDefense@@YAXPAUOBJECTSTRUCT@@H@Z:PROC ; gObjCheckSelfDefense
EXTRN	?GetPkLevel@PartyClass@@QAEDH@Z:PROC		; PartyClass::GetPkLevel
EXTRN	?gParty@@3VPartyClass@@A:BYTE			; gParty
EXTRN	?GCMagicCancelSend@@YAXPAUOBJECTSTRUCT@@G@Z:PROC ; GCMagicCancelSend
EXTRN	?gObjRemoveBuffEffect@@YAEPAUOBJECTSTRUCT@@H@Z:PROC ; gObjRemoveBuffEffect
EXTRN	?gObjArmorRandomDurDown@@YAXPAUOBJECTSTRUCT@@0@Z:PROC ; gObjArmorRandomDurDown
EXTRN	?gObjGetRelationShip@@YAHPAUOBJECTSTRUCT@@0@Z:PROC ; gObjGetRelationShip
EXTRN	?IncAgro@TMonsterAIAgro@@QAEHHH@Z:PROC		; TMonsterAIAgro::IncAgro
EXTRN	?gObjAddMsgSendDelay@@YAXPAUOBJECTSTRUCT@@HHHH@Z:PROC ; gObjAddMsgSendDelay
EXTRN	?gObjWeaponDurDownInCastle@@YAXPAUOBJECTSTRUCT@@0H@Z:PROC ; gObjWeaponDurDownInCastle
EXTRN	?gObjUpdateAppliedBuffEffect@@YAEPAUOBJECTSTRUCT@@HPAH1@Z:PROC ; gObjUpdateAppliedBuffEffect
EXTRN	?gObjSearchActiveEffect@@YAEPAUOBJECTSTRUCT@@H@Z:PROC ; gObjSearchActiveEffect
EXTRN	?SetCharHorseAttack@cWingsDamage@@QAEXHHHAAH@Z:PROC ; cWingsDamage::SetCharHorseAttack
EXTRN	?gWingsDamage@@3VcWingsDamage@@A:BYTE		; gWingsDamage
EXTRN	?gObjDarkHorse@@YAHPAUOBJECTSTRUCT@@@Z:PROC	; gObjDarkHorse
EXTRN	?GCReFillSend@@YAXHHEEH@Z:PROC			; GCReFillSend
EXTRN	?IsDinorantReduceAttackDamaege@CItem@@QAEHXZ:PROC ; CItem::IsDinorantReduceAttackDamaege
EXTRN	?gObjDenorantSprite@@YAHPAUOBJECTSTRUCT@@@Z:PROC ; gObjDenorantSprite
EXTRN	?gObjWingSprite@@YAHPAUOBJECTSTRUCT@@@Z:PROC	; gObjWingSprite
EXTRN	?gObjAngelSprite@@YAHPAUOBJECTSTRUCT@@@Z:PROC	; gObjAngelSprite
EXTRN	?GCItemDurSend@@YAXHEEE@Z:PROC			; GCItemDurSend
EXTRN	?GetName@CItem@@QAEPADXZ:PROC			; CItem::GetName
EXTRN	?DecPetItemExp@CItem@@QAEHH@Z:PROC		; CItem::DecPetItemExp
EXTRN	?GetTargetDefense@CObjBaseAttack@@QAEHPAUOBJECTSTRUCT@@0AAE@Z:PROC ; CObjBaseAttack::GetTargetDefense
EXTRN	__imp__GetTickCount@0:PROC
EXTRN	?gObjDuelCheck@@YAHPAUOBJECTSTRUCT@@0@Z:PROC	; gObjDuelCheck
EXTRN	?PkCheck@CObjBaseAttack@@QAEHPAUOBJECTSTRUCT@@0@Z:PROC ; CObjBaseAttack::PkCheck
EXTRN	?CheckAttackArea@CObjBaseAttack@@QAEHPAUOBJECTSTRUCT@@0@Z:PROC ; CObjBaseAttack::CheckAttackArea
EXTRN	?g_CastleSiege@@3VCCastleSiege@@A:BYTE		; g_CastleSiege
EXTRN	?gObjAttackQ@@YAHPAUOBJECTSTRUCT@@@Z:PROC	; gObjAttackQ
EXTRN	?gObjIsConnected@@YAHPAUOBJECTSTRUCT@@@Z:PROC	; gObjIsConnected
EXTRN	?gObjMonsterStateProc@@YAXPAUOBJECTSTRUCT@@HHH@Z:PROC ; gObjMonsterStateProc
EXTRN	?GetBattleSoccerGoalMove@@YAHH@Z:PROC		; GetBattleSoccerGoalMove
EXTRN	?g_Crywolf@@3VCCrywolf@@A:BYTE			; g_Crywolf
;	COMDAT __real@4024000000000000
; File e:\work\tranet_version\gs\gameserver\castlesiege.h
CONST	SEGMENT
__real@4024000000000000 DQ 04024000000000000r	; 10
CONST	ENDS
;	COMDAT ??_C@_0EO@IMJLIFKK@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$LE?Y?E?$KJ?$LN?$LK?G?G?$LI?$LE?$MA?G?$LJ?$NP?E?i?5Item?5i@
CONST	SEGMENT
??_C@_0EO@IMJLIFKK@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$LE?Y?E?$KJ?$LN?$LK?G?G?$LI?$LE?$MA?G?$LJ?$NP?E?i?5Item?5i@ DB '['
	DB	'%s][%s] ', 0b4H, 0d9H, 0c5H, 0a9H, 0bdH, 0baH, 0c7H, 0c7H, 0b8H
	DB	0b4H, 0c0H, 0c7H, 0b9H, 0dfH, 0c5H, 0e9H, ' Item is Broken bec'
	DB	'ause durability is exhausted [%d]', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0DL@HDCMLJGF@?$FL?$CFs?$FN?$FL?$CFs?$FN?$FLPetItemExpDown?$FN?5?$FL?$CFs?$FN?5Le@
CONST	SEGMENT
??_C@_0DL@HDCMLJGF@?$FL?$CFs?$FN?$FL?$CFs?$FN?$FLPetItemExpDown?$FN?5?$FL?$CFs?$FN?5Le@ DB '['
	DB	'%s][%s][PetItemExpDown] [%s] Level:[%d]Exp:[%d]DecExp[%d]', 00H ; `string'
CONST	ENDS
;	COMDAT __real@3f800000
CONST	SEGMENT
__real@3f800000 DD 03f800000r			; 1
CONST	ENDS
;	COMDAT __real@3ff0000000000000
CONST	SEGMENT
__real@3ff0000000000000 DQ 03ff0000000000000r	; 1
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\darkspirit.cpp
CONST	ENDS
;	COMDAT ?Attack@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0PAVCMagicInf@@HH@Z
_TEXT	SEGMENT
tv1442 = -24						; size = 4
tv1440 = -24						; size = 4
tv1429 = -24						; size = 4
tv1427 = -24						; size = 4
_iTotalShieldDamage$ = -20				; size = 4
_ManaChange$ = -16					; size = 4
_this$ = -12						; size = 4
_skill$ = -8						; size = 4
_MsgDamage$ = -1					; size = 1
tv1634 = 8						; size = 4
tv1626 = 8						; size = 4
tv1624 = 8						; size = 4
_iWizardSkillDefense$215977 = 8				; size = 4
_bAllMiss$ = 8						; size = 4
_lpCallObj$ = 8						; size = 4
_lpObj$ = 8						; size = 4
_AttackDamage$ = 12					; size = 4
_bIsOnDuel$ = 12					; size = 4
_lpTargetObj$ = 12					; size = 4
_MSBFlag$ = 16						; size = 4
_lpMagic$ = 16						; size = 4
tv1709 = 20						; size = 4
tv1704 = 20						; size = 4
tv1658 = 20						; size = 4
tv1652 = 20						; size = 4
tv1618 = 20						; size = 4
tv1616 = 20						; size = 4
tv1610 = 20						; size = 4
tv1608 = 20						; size = 4
tv1606 = 20						; size = 4
tv1599 = 20						; size = 4
tv1597 = 20						; size = 4
tv1591 = 20						; size = 4
tv1589 = 20						; size = 4
tv1583 = 20						; size = 4
tv1581 = 20						; size = 4
tv1575 = 20						; size = 4
tv1573 = 20						; size = 4
tv1567 = 20						; size = 4
tv1565 = 20						; size = 4
tv1557 = 20						; size = 4
tv1555 = 20						; size = 4
tv1547 = 20						; size = 4
tv1545 = 20						; size = 4
tv1537 = 20						; size = 4
tv1535 = 20						; size = 4
tv1527 = 20						; size = 4
tv1525 = 20						; size = 4
tv1519 = 20						; size = 4
tv1517 = 20						; size = 4
tv1510 = 20						; size = 4
tv1508 = 20						; size = 4
tv1370 = 20						; size = 4
tv1305 = 20						; size = 4
_selfdefense$ = 20					; size = 4
_replacemana$215979 = 20				; size = 4
_iWizardSkillTime$215978 = 20				; size = 4
_decdamage$215972 = 20					; size = 4
_Wing$215904 = 20					; size = 4
_iPetExp$215894 = 20					; size = 4
_criticaldamage$ = 20					; size = 4
tv1630 = 22						; size = 2
tv1445 = 22						; size = 2
tv1432 = 22						; size = 2
_iActionType$ = 24					; size = 4
?Attack@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0PAVCMagicInf@@HH@Z PROC ; CDarkSpirit::Attack, COMDAT
; _this$ = ecx

; 625  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 18	 sub	 esp, 24			; 00000018H
  00006	53		 push	 ebx

; 626  : 	int skillSuccess = 0;
; 627  : 	LPOBJ lpCallObj;
; 628  : 	LPOBJ lpCallTargetObj;
; 629  : 	BYTE MsgDamage = 0;

  00007	33 d2		 xor	 edx, edx
  00009	57		 push	 edi

; 630  : 	int ManaChange = 0;
; 631  : 	int iTempShieldDamage = 0;
; 632  : 	int iTotalShieldDamage = 0;
; 633  : 
; 634  : 	if ( (lpTargetObj->Authority&2) == 2 )

  0000a	8b 7d 0c	 mov	 edi, DWORD PTR _lpTargetObj$[ebp]
  0000d	f6 87 0c 02 00
	00 02		 test	 BYTE PTR [edi+524], 2
  00014	8b d9		 mov	 ebx, ecx
  00016	89 5d f4	 mov	 DWORD PTR _this$[ebp], ebx
  00019	88 55 ff	 mov	 BYTE PTR _MsgDamage$[ebp], dl
  0001c	89 55 f0	 mov	 DWORD PTR _ManaChange$[ebp], edx
  0001f	89 55 ec	 mov	 DWORD PTR _iTotalShieldDamage$[ebp], edx
  00022	74 0a		 je	 SHORT $LN163@Attack

; 635  : 	{
; 636  : 		return FALSE;

  00024	5f		 pop	 edi
  00025	33 c0		 xor	 eax, eax
  00027	5b		 pop	 ebx

; 1345 : }

  00028	8b e5		 mov	 esp, ebp
  0002a	5d		 pop	 ebp
  0002b	c2 14 00	 ret	 20			; 00000014H
$LN163@Attack:

; 637  : 	}
; 638  : 
; 639  : 	if ( lpObj->MapNumber != lpTargetObj->MapNumber )

  0002e	8a 8f 49 01 00
	00		 mov	 cl, BYTE PTR [edi+329]
  00034	56		 push	 esi
  00035	8b 75 08	 mov	 esi, DWORD PTR _lpObj$[ebp]
  00038	38 8e 49 01 00
	00		 cmp	 BYTE PTR [esi+329], cl

; 640  : 	{
; 641  : 		return FALSE;

  0003e	0f 85 f0 01 00
	00		 jne	 $LN317@Attack

; 642  : 	}
; 643  : #ifdef IMPERIAL_CONFLICT_NEW
; 644  : 	if( g_ImperialGuardian.IsEventMap(lpObj->MapNumber) )
; 645  : 	{
; 646  : 		if( !g_ImperialGuardian.IsAttackAbleMonster(lpTargetObj->m_Index) )
; 647  : 		{
; 648  : 			return false;
; 649  : 		}
; 650  : 	}
; 651  : #endif
; 652  : //#if(GS_CASTLE==1)
; 653  : 	if( g_Crywolf.GetCrywolfState() == 3 || g_Crywolf.GetCrywolfState() == 5 )

  00044	a1 ec b7 0f 00	 mov	 eax, DWORD PTR ?g_Crywolf@@3VCCrywolf@@A+1030124
  00049	83 f8 03	 cmp	 eax, 3
  0004c	74 05		 je	 SHORT $LN160@Attack
  0004e	83 f8 05	 cmp	 eax, 5
  00051	75 10		 jne	 SHORT $LN158@Attack
$LN160@Attack:

; 654  : 	{
; 655  : 		if(CRYWOLF_MAP_RANGE(lpTargetObj->MapNumber))

  00053	80 f9 22	 cmp	 cl, 34			; 00000022H
  00056	75 0b		 jne	 SHORT $LN158@Attack

; 656  : 		{
; 657  : 			if(lpTargetObj->Type == OBJ_MONSTER)

  00058	66 83 7f 68 02	 cmp	 WORD PTR [edi+104], 2

; 658  : 			{
; 659  : 				return FALSE;

  0005d	0f 84 d1 01 00
	00		 je	 $LN317@Attack
$LN158@Attack:

; 660  : 			}
; 661  : 		}
; 662  : 	}
; 663  : //#endif
; 664  : 
; 665  : 	int skill = 0;
; 666  : 	
; 667  : 	if ( lpMagic )

  00063	8b 45 10	 mov	 eax, DWORD PTR _lpMagic$[ebp]
  00066	89 55 f8	 mov	 DWORD PTR _skill$[ebp], edx
  00069	3b c2		 cmp	 eax, edx
  0006b	74 06		 je	 SHORT $LN157@Attack

; 668  : 	{
; 669  : 		skill = lpMagic->m_Skill;

  0006d	8b 40 08	 mov	 eax, DWORD PTR [eax+8]
  00070	89 45 f8	 mov	 DWORD PTR _skill$[ebp], eax
$LN157@Attack:

; 670  : 	}
; 671  : 
; 672  : 	skillSuccess = TRUE;
; 673  : 
; 674  : 	if ( lpObj->GuildNumber > 0 )

  00073	39 96 34 04 00
	00		 cmp	 DWORD PTR [esi+1076], edx
  00079	7e 2d		 jle	 SHORT $LN231@Attack

; 675  : 	{
; 676  : 		if ( lpObj->lpGuild )

  0007b	8b 86 38 04 00
	00		 mov	 eax, DWORD PTR [esi+1080]
  00081	3b c2		 cmp	 eax, edx
  00083	74 23		 je	 SHORT $LN231@Attack

; 677  : 		{
; 678  : 			if ( lpObj->lpGuild->WarState )

  00085	38 90 91 05 00
	00		 cmp	 BYTE PTR [eax+1425], dl
  0008b	74 1b		 je	 SHORT $LN231@Attack

; 679  : 			{
; 680  : 				if ( lpObj->lpGuild->WarType == 1 )

  0008d	80 b8 92 05 00
	00 01		 cmp	 BYTE PTR [eax+1426], 1
  00094	75 12		 jne	 SHORT $LN231@Attack

; 681  : 				{
; 682  : 					if ( !GetBattleSoccerGoalMove(0) )

  00096	6a 00		 push	 0
  00098	e8 00 00 00 00	 call	 ?GetBattleSoccerGoalMove@@YAHH@Z ; GetBattleSoccerGoalMove
  0009d	83 c4 04	 add	 esp, 4
  000a0	85 c0		 test	 eax, eax

; 683  : 					{
; 684  : 						return TRUE;

  000a2	0f 84 62 0f 00
	00		 je	 $LN227@Attack
$LN231@Attack:

; 685  : 					}
; 686  : 				}
; 687  : 			}
; 688  : 		}
; 689  : 	}
; 690  : 
; 691  : 	if ( lpTargetObj->Type == OBJ_MONSTER )

  000a8	66 83 7f 68 02	 cmp	 WORD PTR [edi+104], 2
  000ad	75 4e		 jne	 SHORT $LN150@Attack

; 692  : 	{
; 693  : 		if ( lpTargetObj->Class == 200 )

  000af	b9 c8 00 00 00	 mov	 ecx, 200		; 000000c8H
  000b4	66 39 8f b8 00
	00 00		 cmp	 WORD PTR [edi+184], cx
  000bb	75 40		 jne	 SHORT $LN150@Attack

; 694  : 		{
; 695  : 			if ( skill )

  000bd	83 7d f8 00	 cmp	 DWORD PTR _skill$[ebp], 0

; 696  : 			{
; 697  : 				gObjMonsterStateProc(lpTargetObj, 7, lpObj->m_Index, 0);

  000c1	6a 00		 push	 0
  000c3	74 1c		 je	 SHORT $LN149@Attack
  000c5	8b 16		 mov	 edx, DWORD PTR [esi]
  000c7	52		 push	 edx
  000c8	6a 07		 push	 7

; 698  : 			}
; 699  : 			else
; 700  : 			{
; 701  : 				gObjMonsterStateProc(lpTargetObj, 6, lpObj->m_Index, 0);

  000ca	57		 push	 edi
  000cb	e8 00 00 00 00	 call	 ?gObjMonsterStateProc@@YAXPAUOBJECTSTRUCT@@HHH@Z ; gObjMonsterStateProc
  000d0	83 c4 10	 add	 esp, 16			; 00000010H
  000d3	5e		 pop	 esi
  000d4	5f		 pop	 edi

; 1341 : 		}
; 1342 : 	}
; 1343 : 
; 1344 : 	return TRUE;

  000d5	b8 01 00 00 00	 mov	 eax, 1
  000da	5b		 pop	 ebx

; 1345 : }

  000db	8b e5		 mov	 esp, ebp
  000dd	5d		 pop	 ebp
  000de	c2 14 00	 ret	 20			; 00000014H
$LN149@Attack:

; 698  : 			}
; 699  : 			else
; 700  : 			{
; 701  : 				gObjMonsterStateProc(lpTargetObj, 6, lpObj->m_Index, 0);

  000e1	8b 06		 mov	 eax, DWORD PTR [esi]
  000e3	50		 push	 eax
  000e4	6a 06		 push	 6
  000e6	57		 push	 edi
  000e7	e8 00 00 00 00	 call	 ?gObjMonsterStateProc@@YAXPAUOBJECTSTRUCT@@HHH@Z ; gObjMonsterStateProc
  000ec	83 c4 10	 add	 esp, 16			; 00000010H
  000ef	5e		 pop	 esi
  000f0	5f		 pop	 edi

; 1341 : 		}
; 1342 : 	}
; 1343 : 
; 1344 : 	return TRUE;

  000f1	b8 01 00 00 00	 mov	 eax, 1
  000f6	5b		 pop	 ebx

; 1345 : }

  000f7	8b e5		 mov	 esp, ebp
  000f9	5d		 pop	 ebp
  000fa	c2 14 00	 ret	 20			; 00000014H
$LN150@Attack:

; 702  : 			}
; 703  : 
; 704  : 			return TRUE;
; 705  : 		}
; 706  : 	}
; 707  : 
; 708  : 	if ( lpObj->Type == OBJ_USER )

  000fd	66 83 7e 68 01	 cmp	 WORD PTR [esi+104], 1
  00102	75 11		 jne	 SHORT $LN232@Attack

; 709  : 	{
; 710  : 		if ( !gObjIsConnected(lpObj))

  00104	56		 push	 esi
  00105	e8 00 00 00 00	 call	 ?gObjIsConnected@@YAHPAUOBJECTSTRUCT@@@Z ; gObjIsConnected
  0010a	83 c4 04	 add	 esp, 4
  0010d	85 c0		 test	 eax, eax

; 711  : 		{
; 712  : 			return FALSE;

  0010f	0f 84 1f 01 00
	00		 je	 $LN317@Attack
$LN232@Attack:

; 713  : 		}
; 714  : 	}
; 715  : 
; 716  : 	if ( lpTargetObj->Type == OBJ_USER )

  00115	66 83 7f 68 01	 cmp	 WORD PTR [edi+104], 1
  0011a	75 11		 jne	 SHORT $LN233@Attack

; 717  : 	{
; 718  : 		if ( !gObjIsConnected(lpTargetObj))

  0011c	57		 push	 edi
  0011d	e8 00 00 00 00	 call	 ?gObjIsConnected@@YAHPAUOBJECTSTRUCT@@@Z ; gObjIsConnected
  00122	83 c4 04	 add	 esp, 4
  00125	85 c0		 test	 eax, eax

; 719  : 		{
; 720  : 			return FALSE;

  00127	0f 84 07 01 00
	00		 je	 $LN317@Attack
$LN233@Attack:

; 721  : 		}
; 722  : 	}
; 723  : 
; 724  : 	if ( lpObj->Type == OBJ_USER && lpTargetObj->Type == OBJ_MONSTER )

  0012d	66 83 7e 68 01	 cmp	 WORD PTR [esi+104], 1
  00132	75 19		 jne	 SHORT $LN141@Attack
  00134	66 83 7f 68 02	 cmp	 WORD PTR [edi+104], 2
  00139	75 12		 jne	 SHORT $LN141@Attack

; 725  : 	{
; 726  : 		if ( lpObj->m_RecallMon >= 0 )

  0013b	8b 86 50 04 00
	00		 mov	 eax, DWORD PTR [esi+1104]
  00141	85 c0		 test	 eax, eax
  00143	78 08		 js	 SHORT $LN141@Attack

; 727  : 		{
; 728  : 			if ( lpObj->m_RecallMon == lpTargetObj->m_Index )

  00145	3b 07		 cmp	 eax, DWORD PTR [edi]

; 729  : 			{
; 730  : 				return FALSE;

  00147	0f 84 e7 00 00
	00		 je	 $LN317@Attack
$LN141@Attack:

; 731  : 			}
; 732  : 		}
; 733  : 	}
; 734  : 
; 735  : 	if ( !gObjAttackQ(lpTargetObj))

  0014d	57		 push	 edi
  0014e	e8 00 00 00 00	 call	 ?gObjAttackQ@@YAHPAUOBJECTSTRUCT@@@Z ; gObjAttackQ
  00153	83 c4 04	 add	 esp, 4
  00156	85 c0		 test	 eax, eax

; 736  : 	{
; 737  : 		return FALSE;

  00158	0f 84 d6 00 00
	00		 je	 $LN317@Attack

; 738  : 	}
; 739  : 
; 740  : //#if(GS_CASTLE==1)
; 741  : 	if ( g_CastleSiege.GetCastleState() == CASTLESIEGE_STATE_STARTSIEGE)

  0015e	83 3d 28 00 00
	00 07		 cmp	 DWORD PTR ?g_CastleSiege@@3VCCastleSiege@@A+40, 7
  00165	75 16		 jne	 SHORT $LN137@Attack

; 742  : 	{
; 743  : 		if( lpObj->m_btCsJoinSide > 0 )

  00167	8a 86 02 1c 00
	00		 mov	 al, BYTE PTR [esi+7170]
  0016d	84 c0		 test	 al, al
  0016f	74 0c		 je	 SHORT $LN137@Attack

; 744  : 		{
; 745  : 			if( lpObj->m_btCsJoinSide == lpTargetObj->m_btCsJoinSide )

  00171	3a 87 02 1c 00
	00		 cmp	 al, BYTE PTR [edi+7170]

; 746  : 			{
; 747  : 				return FALSE;

  00177	0f 84 b7 00 00
	00		 je	 $LN317@Attack
$LN137@Attack:

; 748  : 			}
; 749  : 		}
; 750  : 	}
; 751  : //#endif
; 752  : 
; 753  : 	lpObj->m_TotalAttackCount++;

  0017d	ff 86 98 03 00
	00		 inc	 DWORD PTR [esi+920]

; 754  : 
; 755  : 	if ( this->CheckAttackArea(lpObj, lpTargetObj) == FALSE )

  00183	57		 push	 edi
  00184	56		 push	 esi
  00185	8b cb		 mov	 ecx, ebx
  00187	e8 00 00 00 00	 call	 ?CheckAttackArea@CObjBaseAttack@@QAEHPAUOBJECTSTRUCT@@0@Z ; CObjBaseAttack::CheckAttackArea
  0018c	85 c0		 test	 eax, eax

; 756  : 	{
; 757  : 		return FALSE;

  0018e	0f 84 a0 00 00
	00		 je	 $LN317@Attack

; 758  : 	}
; 759  : 
; 760  : 	lpCallObj = lpObj;
; 761  : 	lpCallTargetObj = lpTargetObj;
; 762  : 
; 763  : 	if ( lpTargetObj->Type == OBJ_MONSTER )
; 764  : 	{
; 765  : 		if ( lpTargetObj->m_RecallMon >= 0 )
; 766  : 		{
; 767  : 			lpCallTargetObj = &gObj[lpTargetObj->m_RecallMon];
; 768  : 		}
; 769  : 	}
; 770  : 
; 771  : 	if ( this->PkCheck(lpCallObj, lpTargetObj) == FALSE )

  00194	57		 push	 edi
  00195	56		 push	 esi
  00196	8b cb		 mov	 ecx, ebx
  00198	e8 00 00 00 00	 call	 ?PkCheck@CObjBaseAttack@@QAEHPAUOBJECTSTRUCT@@0@Z ; CObjBaseAttack::PkCheck
  0019d	85 c0		 test	 eax, eax

; 772  : 	{
; 773  : 		return FALSE;

  0019f	0f 84 8f 00 00
	00		 je	 $LN317@Attack

; 774  : 	}
; 775  : 
; 776  : 	int Strength = lpObj->Strength + lpObj->AddStrength;
; 777  : 	int Dexterity = lpObj->Dexterity + lpObj->AddDexterity;
; 778  : 	int Vitality = lpObj->Vitality + lpObj->AddVitality;
; 779  : 	int Energy = lpObj->Energy + lpObj->AddEnergy;
; 780  : 	BOOL bIsOnDuel = gObjDuelCheck(lpObj, lpTargetObj);

  001a5	57		 push	 edi
  001a6	56		 push	 esi
  001a7	e8 00 00 00 00	 call	 ?gObjDuelCheck@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjDuelCheck
  001ac	83 c4 08	 add	 esp, 8
  001af	89 45 0c	 mov	 DWORD PTR _bIsOnDuel$[ebp], eax

; 781  : 
; 782  : 	if ( bIsOnDuel )

  001b2	85 c0		 test	 eax, eax
  001b4	74 19		 je	 SHORT $LN132@Attack

; 783  : 	{
; 784  : 		lpObj->m_iDuelTickCount = GetTickCount();

  001b6	8b 1d 00 00 00
	00		 mov	 ebx, DWORD PTR __imp__GetTickCount@0
  001bc	ff d3		 call	 ebx
  001be	89 86 c0 0e 00
	00		 mov	 DWORD PTR [esi+3776], eax

; 785  : 		lpTargetObj->m_iDuelTickCount = GetTickCount();

  001c4	ff d3		 call	 ebx
  001c6	8b 5d f4	 mov	 ebx, DWORD PTR _this$[ebp]
  001c9	89 87 c0 0e 00
	00		 mov	 DWORD PTR [edi+3776], eax
$LN132@Attack:

; 786  : 	}
; 787  : 
; 788  : 	int MSBFlag = 0;
; 789  : 	
; 790  : 	if ( criticaldamage )

  001cf	8b 4d 14	 mov	 ecx, DWORD PTR _criticaldamage$[ebp]
  001d2	33 c0		 xor	 eax, eax
  001d4	f7 d9		 neg	 ecx
  001d6	1a c9		 sbb	 cl, cl
  001d8	89 45 10	 mov	 DWORD PTR _MSBFlag$[ebp], eax

; 791  : 	{
; 792  : 		MsgDamage = 3;
; 793  : 	}
; 794  : 	else
; 795  : 	{
; 796  : 		MsgDamage = 0;
; 797  : 	}
; 798  : 
; 799  : 	BOOL bAllMiss = FALSE;

  001db	89 45 08	 mov	 DWORD PTR _bAllMiss$[ebp], eax
  001de	80 e1 03	 and	 cl, 3

; 800  : 	int AttackDamage = 0;
; 801  : 
; 802  : 	if ( g_ShieldSystemOn == TRUE )

  001e1	b8 01 00 00 00	 mov	 eax, 1
  001e6	88 4d ff	 mov	 BYTE PTR _MsgDamage$[ebp], cl
  001e9	39 05 00 00 00
	00		 cmp	 DWORD PTR ?g_ShieldSystemOn@@3HA, eax ; g_ShieldSystemOn
  001ef	75 2c		 jne	 SHORT $LN129@Attack

; 803  : 	{
; 804  : 		if ( lpObj->Type == OBJ_USER && lpTargetObj->Type == OBJ_USER )

  001f1	66 39 46 68	 cmp	 WORD PTR [esi+104], ax
  001f5	75 1a		 jne	 SHORT $LN128@Attack
  001f7	66 39 47 68	 cmp	 WORD PTR [edi+104], ax
  001fb	75 14		 jne	 SHORT $LN128@Attack

; 805  : 		{
; 806  : 			if ( !this->MissCheckPvP(lpObj, lpTargetObj, skill, skillSuccess, bAllMiss) )

  001fd	8d 55 08	 lea	 edx, DWORD PTR _bAllMiss$[ebp]
  00200	52		 push	 edx
  00201	50		 push	 eax
  00202	8b 45 f8	 mov	 eax, DWORD PTR _skill$[ebp]
  00205	50		 push	 eax
  00206	57		 push	 edi
  00207	56		 push	 esi
  00208	8b cb		 mov	 ecx, ebx
  0020a	e8 00 00 00 00	 call	 ?MissCheckPvP@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z ; CDarkSpirit::MissCheckPvP

; 807  : 			{
; 808  : 				return FALSE;

  0020f	eb 1f		 jmp	 SHORT $LN316@Attack
$LN128@Attack:

; 809  : 			}
; 810  : 		}
; 811  : 		else if ( !this->MissCheck(lpObj, lpTargetObj, skill, skillSuccess, bAllMiss) )

  00211	8b 55 f8	 mov	 edx, DWORD PTR _skill$[ebp]
  00214	8d 4d 08	 lea	 ecx, DWORD PTR _bAllMiss$[ebp]
  00217	51		 push	 ecx
  00218	6a 01		 push	 1
  0021a	52		 push	 edx

; 812  : 		{
; 813  : 			return FALSE;

  0021b	eb 0a		 jmp	 SHORT $LN315@Attack
$LN129@Attack:

; 814  : 		}
; 815  : 
; 816  : 	}
; 817  : 	else if ( !this->MissCheck(lpObj, lpTargetObj, skill, skillSuccess, bAllMiss) )

  0021d	8b 4d f8	 mov	 ecx, DWORD PTR _skill$[ebp]
  00220	8d 45 08	 lea	 eax, DWORD PTR _bAllMiss$[ebp]
  00223	50		 push	 eax
  00224	6a 01		 push	 1
  00226	51		 push	 ecx
$LN315@Attack:
  00227	57		 push	 edi
  00228	56		 push	 esi
  00229	8b cb		 mov	 ecx, ebx
  0022b	e8 00 00 00 00	 call	 ?MissCheck@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0HHAAH@Z ; CDarkSpirit::MissCheck
$LN316@Attack:
  00230	85 c0		 test	 eax, eax
  00232	75 0b		 jne	 SHORT $LN209@Attack
$LN317@Attack:
  00234	5e		 pop	 esi
  00235	5f		 pop	 edi

; 818  : 	{
; 819  : 		return FALSE;

  00236	33 c0		 xor	 eax, eax
  00238	5b		 pop	 ebx

; 1345 : }

  00239	8b e5		 mov	 esp, ebp
  0023b	5d		 pop	 ebp
  0023c	c2 14 00	 ret	 20			; 00000014H
$LN209@Attack:

; 820  : 	}
; 821  : 
; 822  : 	int targetdefense = this->GetTargetDefense(lpObj, lpTargetObj, MsgDamage);

  0023f	8b 5d f4	 mov	 ebx, DWORD PTR _this$[ebp]
  00242	8d 55 ff	 lea	 edx, DWORD PTR _MsgDamage$[ebp]
  00245	52		 push	 edx
  00246	57		 push	 edi
  00247	56		 push	 esi
  00248	8b cb		 mov	 ecx, ebx
  0024a	e8 00 00 00 00	 call	 ?GetTargetDefense@CObjBaseAttack@@QAEHPAUOBJECTSTRUCT@@0AAE@Z ; CObjBaseAttack::GetTargetDefense

; 823  : 	AttackDamage = this->GetAttackDamage(lpObj, targetdefense, bIsOnDuel, criticaldamage);

  0024f	8b 4d 14	 mov	 ecx, DWORD PTR _criticaldamage$[ebp]
  00252	8b 55 0c	 mov	 edx, DWORD PTR _bIsOnDuel$[ebp]
  00255	51		 push	 ecx
  00256	52		 push	 edx
  00257	50		 push	 eax
  00258	56		 push	 esi
  00259	8b cb		 mov	 ecx, ebx
  0025b	e8 00 00 00 00	 call	 ?GetAttackDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@HHH@Z ; CDarkSpirit::GetAttackDamage

; 824  : 
; 825  : 	if ( criticaldamage == 0 && iActionType == 0 )
; 826  : 	{
; 827  : 		AttackDamage /= (int)1.5;
; 828  : 	}
; 829  : 
; 830  : 	if ( bAllMiss )

  00260	83 7d 08 00	 cmp	 DWORD PTR _bAllMiss$[ebp], 0
  00264	8b d8		 mov	 ebx, eax
  00266	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
  00269	74 1f		 je	 SHORT $LN210@Attack

; 831  : 	{
; 832  : 		AttackDamage = ( AttackDamage * 30 ) / 100;

  0026b	8b cb		 mov	 ecx, ebx
  0026d	c1 e1 04	 shl	 ecx, 4
  00270	2b cb		 sub	 ecx, ebx
  00272	03 c9		 add	 ecx, ecx
  00274	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00279	f7 e9		 imul	 ecx
  0027b	c1 fa 05	 sar	 edx, 5
  0027e	8b c2		 mov	 eax, edx
  00280	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  00283	03 c2		 add	 eax, edx
  00285	8b d8		 mov	 ebx, eax
  00287	89 45 0c	 mov	 DWORD PTR _AttackDamage$[ebp], eax
$LN210@Attack:

; 833  : 	}
; 834  : 
; 835  : 	if ( lpTargetObj->DamageMinus )

  0028a	8a 87 70 01 00
	00		 mov	 al, BYTE PTR [edi+368]
  00290	84 c0		 test	 al, al
  00292	74 1c		 je	 SHORT $LN120@Attack

; 836  : 	{
; 837  : 		int beforeDamage = AttackDamage;
; 838  : 		AttackDamage -= ( ( AttackDamage * (int)lpTargetObj->DamageMinus) / 100 );

  00294	0f b6 c8	 movzx	 ecx, al
  00297	0f af cb	 imul	 ecx, ebx
  0029a	b8 e1 7a 14 ae	 mov	 eax, -1374389535	; ae147ae1H
  0029f	f7 e9		 imul	 ecx
  002a1	c1 fa 05	 sar	 edx, 5
  002a4	8b ca		 mov	 ecx, edx
  002a6	c1 e9 1f	 shr	 ecx, 31			; 0000001fH
  002a9	03 ca		 add	 ecx, edx
  002ab	03 d9		 add	 ebx, ecx
  002ad	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
$LN120@Attack:

; 839  : 	}
; 840  : 
; 841  : 	int tlevel = lpObj->Level / 10;

  002b0	0f bf 8e be 00
	00 00		 movsx	 ecx, WORD PTR [esi+190]
  002b7	b8 67 66 66 66	 mov	 eax, 1717986919		; 66666667H
  002bc	f7 e9		 imul	 ecx
  002be	c1 fa 02	 sar	 edx, 2
  002c1	8b c2		 mov	 eax, edx
  002c3	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  002c6	03 c2		 add	 eax, edx

; 842  : 
; 843  : 	if ( AttackDamage < tlevel )

  002c8	3b d8		 cmp	 ebx, eax
  002ca	7d 0f		 jge	 SHORT $LN211@Attack

; 844  : 	{
; 845  : 		if ( tlevel < 1 )

  002cc	83 f8 01	 cmp	 eax, 1
  002cf	7d 05		 jge	 SHORT $LN118@Attack

; 846  : 		{
; 847  : 			tlevel = 1;

  002d1	b8 01 00 00 00	 mov	 eax, 1
$LN118@Attack:

; 848  : 		}
; 849  : 
; 850  : 		AttackDamage = tlevel;

  002d6	8b d8		 mov	 ebx, eax
  002d8	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
$LN211@Attack:

; 851  : 	}
; 852  : 
; 853  : 	if ( lpTargetObj->m_SkillNumber == 18 )

  002db	66 83 bf d8 03
	00 00 12	 cmp	 WORD PTR [edi+984], 18	; 00000012H
  002e3	75 0a		 jne	 SHORT $LN116@Attack

; 854  : 	{
; 855  : 		if ( AttackDamage > 1 )

  002e5	83 fb 01	 cmp	 ebx, 1
  002e8	7e 05		 jle	 SHORT $LN116@Attack

; 856  : 		{
; 857  : 			AttackDamage >>= 1;

  002ea	d1 fb		 sar	 ebx, 1
  002ec	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
$LN116@Attack:

; 858  : 		}
; 859  : 	}
; 860  : 
; 861  : 	lpObj->pInventory[1].m_DurabilitySmall += AttackDamage * 2 / 100;

  002ef	8b 8e 24 0e 00
	00		 mov	 ecx, DWORD PTR [esi+3620]
  002f5	8d 14 1b	 lea	 edx, DWORD PTR [ebx+ebx]
  002f8	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  002fd	f7 ea		 imul	 edx
  002ff	c1 fa 05	 sar	 edx, 5
  00302	8b c2		 mov	 eax, edx
  00304	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  00307	03 c2		 add	 eax, edx
  00309	66 01 81 fc 00
	00 00		 add	 WORD PTR [ecx+252], ax

; 862  : 
; 863  : 	if ( lpObj->pInventory[1].m_DurabilitySmall >= ZtConfig.Pet.RavenDurabilitySmall /*800*/ + lpObj->m_MPSkillOpt.MpsPetDurDownSpeed) //season4 changed

  00310	8b 8e 24 0e 00
	00		 mov	 ecx, DWORD PTR [esi+3620]
  00316	0f b7 91 fc 00
	00 00		 movzx	 edx, WORD PTR [ecx+252]
  0031d	89 55 14	 mov	 DWORD PTR tv1652[ebp], edx
  00320	db 45 14	 fild	 DWORD PTR tv1652[ebp]
  00323	d9 86 6c 27 00
	00		 fld	 DWORD PTR [esi+10092]
  00329	da 05 bc 08 00
	00		 fiadd	 DWORD PTR ?ZtConfig@@3VcZtConfigs@@A+2236
  0032f	de d9		 fcompp
  00331	df e0		 fnstsw	 ax
  00333	f6 c4 41	 test	 ah, 65			; 00000041H
  00336	0f 8a 27 01 00
	00		 jp	 $LN115@Attack

; 864  : 	{
; 865  : 		lpObj->pInventory[1].m_DurabilitySmall = 0;

  0033c	33 c0		 xor	 eax, eax
  0033e	66 89 81 fc 00
	00 00		 mov	 WORD PTR [ecx+252], ax

; 866  : 		lpObj->pInventory[1].m_Durability -= 1.0f;

  00345	8b 86 24 0e 00
	00		 mov	 eax, DWORD PTR [esi+3620]
  0034b	d9 80 f8 00 00
	00		 fld	 DWORD PTR [eax+248]
  00351	dc 25 00 00 00
	00		 fsub	 QWORD PTR __real@3ff0000000000000
  00357	d9 98 f8 00 00
	00		 fstp	 DWORD PTR [eax+248]

; 867  : 
; 868  : 		if ( lpObj->pInventory[1].m_Durability < 1.0f )

  0035d	8b 8e 24 0e 00
	00		 mov	 ecx, DWORD PTR [esi+3620]
  00363	d9 e8		 fld1
  00365	d8 99 f8 00 00
	00		 fcomp	 DWORD PTR [ecx+248]
  0036b	df e0		 fnstsw	 ax
  0036d	f6 c4 41	 test	 ah, 65			; 00000041H
  00370	0f 85 b3 00 00
	00		 jne	 $LN114@Attack

; 869  : 		{
; 870  : 			lpObj->pInventory[1].m_Durability = 0;

  00376	d9 ee		 fldz

; 871  : 			int iPetExp = lpObj->pInventory[1].m_PetItem_Exp;
; 872  : 
; 873  : 			if ( lpObj->pInventory[1].DecPetItemExp(10) )

  00378	6a 0a		 push	 10			; 0000000aH
  0037a	d9 99 f8 00 00
	00		 fstp	 DWORD PTR [ecx+248]
  00380	8b 86 24 0e 00
	00		 mov	 eax, DWORD PTR [esi+3620]
  00386	8b 88 94 01 00
	00		 mov	 ecx, DWORD PTR [eax+404]
  0038c	89 4d 14	 mov	 DWORD PTR _iPetExp$215894[ebp], ecx
  0038f	8d 88 d4 00 00
	00		 lea	 ecx, DWORD PTR [eax+212]
  00395	e8 00 00 00 00	 call	 ?DecPetItemExp@CItem@@QAEHH@Z ; CItem::DecPetItemExp
  0039a	85 c0		 test	 eax, eax
  0039c	74 68		 je	 SHORT $LN113@Attack

; 874  : 			{
; 875  : 				LogAddTD("[%s][%s][PetItemExpDown] [%s] Level:[%d]Exp:[%d]DecExp[%d]",	lpObj->AccountID, lpObj->Name, lpObj->pInventory[1].GetName(),	lpObj->pInventory[1].m_PetItem_Level, lpObj->pInventory[1].m_PetItem_Exp, iPetExp - lpObj->pInventory[1].m_PetItem_Exp);

  0039e	8b 86 24 0e 00
	00		 mov	 eax, DWORD PTR [esi+3620]
  003a4	8b 88 94 01 00
	00		 mov	 ecx, DWORD PTR [eax+404]
  003aa	8b 55 14	 mov	 edx, DWORD PTR _iPetExp$215894[ebp]
  003ad	2b d1		 sub	 edx, ecx
  003af	52		 push	 edx
  003b0	8b 90 90 01 00
	00		 mov	 edx, DWORD PTR [eax+400]
  003b6	51		 push	 ecx
  003b7	52		 push	 edx
  003b8	8d 88 d4 00 00
	00		 lea	 ecx, DWORD PTR [eax+212]
  003be	e8 00 00 00 00	 call	 ?GetName@CItem@@QAEPADXZ ; CItem::GetName
  003c3	50		 push	 eax
  003c4	8d 46 77	 lea	 eax, DWORD PTR [esi+119]
  003c7	50		 push	 eax
  003c8	8d 4e 6c	 lea	 ecx, DWORD PTR [esi+108]
  003cb	51		 push	 ecx
  003cc	68 00 00 00 00	 push	 OFFSET ??_C@_0DL@HDCMLJGF@?$FL?$CFs?$FN?$FL?$CFs?$FN?$FLPetItemExpDown?$FN?5?$FL?$CFs?$FN?5Le@
  003d1	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD

; 876  : 
; 877  : 				this->Set(lpObj->m_Index, &lpObj->pInventory[1]);

  003d7	8b 96 24 0e 00
	00		 mov	 edx, DWORD PTR [esi+3620]
  003dd	8b 06		 mov	 eax, DWORD PTR [esi]
  003df	8b 4d f4	 mov	 ecx, DWORD PTR _this$[ebp]
  003e2	83 c4 1c	 add	 esp, 28			; 0000001cH
  003e5	81 c2 d4 00 00
	00		 add	 edx, 212		; 000000d4H
  003eb	52		 push	 edx
  003ec	50		 push	 eax
  003ed	e8 00 00 00 00	 call	 ?Set@CDarkSpirit@@QAEXHPAVCItem@@@Z ; CDarkSpirit::Set

; 878  : 				this->SendLevelmsg(lpObj->m_Index, 1, 0, 0xFF);

  003f2	8b 0e		 mov	 ecx, DWORD PTR [esi]
  003f4	68 ff 00 00 00	 push	 255			; 000000ffH
  003f9	6a 00		 push	 0
  003fb	6a 01		 push	 1
  003fd	51		 push	 ecx
  003fe	e8 00 00 00 00	 call	 ?SendLevelmsg@CDarkSpirit@@SAXHHHH@Z ; CDarkSpirit::SendLevelmsg
  00403	83 c4 10	 add	 esp, 16			; 00000010H
$LN113@Attack:

; 879  : 			}
; 880  : 
; 881  : 			LogAddTD("[%s][%s]  Item is Broken because durability is exhausted [%d]", lpObj->AccountID, lpObj->Name, lpObj->pInventory[1].m_Number);

  00406	8b 96 24 0e 00
	00		 mov	 edx, DWORD PTR [esi+3620]
  0040c	8b 82 d4 00 00
	00		 mov	 eax, DWORD PTR [edx+212]
  00412	50		 push	 eax
  00413	8d 4e 77	 lea	 ecx, DWORD PTR [esi+119]
  00416	51		 push	 ecx
  00417	8d 56 6c	 lea	 edx, DWORD PTR [esi+108]
  0041a	52		 push	 edx
  0041b	68 00 00 00 00	 push	 OFFSET ??_C@_0EO@IMJLIFKK@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$LE?Y?E?$KJ?$LN?$LK?G?G?$LI?$LE?$MA?G?$LJ?$NP?E?i?5Item?5i@
  00420	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  00426	83 c4 10	 add	 esp, 16			; 00000010H
$LN114@Attack:

; 882  : 		}
; 883  : 
; 884  : 		GCItemDurSend(lpObj->m_Index, 1, (BYTE)lpObj->pInventory[1].m_Durability, 0);

  00429	8b 86 24 0e 00
	00		 mov	 eax, DWORD PTR [esi+3620]
  0042f	d9 7d 16	 fnstcw	 WORD PTR tv1630[ebp]
  00432	d9 80 f8 00 00
	00		 fld	 DWORD PTR [eax+248]
  00438	6a 00		 push	 0
  0043a	0f b7 45 16	 movzx	 eax, WORD PTR tv1630[ebp]
  0043e	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  00443	89 45 08	 mov	 DWORD PTR tv1626[ebp], eax
  00446	8b 06		 mov	 eax, DWORD PTR [esi]
  00448	d9 6d 08	 fldcw	 WORD PTR tv1626[ebp]
  0044b	db 5d 08	 fistp	 DWORD PTR tv1624[ebp]
  0044e	8a 4d 08	 mov	 cl, BYTE PTR tv1624[ebp]
  00451	0f b6 d1	 movzx	 edx, cl
  00454	52		 push	 edx
  00455	6a 01		 push	 1
  00457	d9 6d 16	 fldcw	 WORD PTR tv1630[ebp]
  0045a	50		 push	 eax
  0045b	e8 00 00 00 00	 call	 ?GCItemDurSend@@YAXHEEE@Z ; GCItemDurSend
  00460	83 c4 10	 add	 esp, 16			; 00000010H
$LN115@Attack:

; 885  : 	}
; 886  : 
; 887  : 	if ( gObjAngelSprite(lpTargetObj) == TRUE )

  00463	57		 push	 edi
  00464	e8 00 00 00 00	 call	 ?gObjAngelSprite@@YAHPAUOBJECTSTRUCT@@@Z ; gObjAngelSprite
  00469	83 c4 04	 add	 esp, 4
  0046c	83 f8 01	 cmp	 eax, 1
  0046f	75 27		 jne	 SHORT $LN111@Attack

; 888  : 	{
; 889  : 		if ( AttackDamage > 1 )

  00471	3b d8		 cmp	 ebx, eax
  00473	7e 23		 jle	 SHORT $LN111@Attack

; 890  : 		{
; 891  : 			float  damage = (AttackDamage * 8) / 10.0f;

  00475	8d 0c dd 00 00
	00 00		 lea	 ecx, DWORD PTR [ebx*8]

; 892  : 			AttackDamage = (int)damage;

  0047c	89 4d 14	 mov	 DWORD PTR tv1618[ebp], ecx
  0047f	db 45 14	 fild	 DWORD PTR tv1618[ebp]
  00482	dc 35 00 00 00
	00		 fdiv	 QWORD PTR __real@4024000000000000
  00488	d9 5d 14	 fstp	 DWORD PTR tv1616[ebp]
  0048b	d9 45 14	 fld	 DWORD PTR tv1616[ebp]
  0048e	e8 00 00 00 00	 call	 __ftol2_sse
  00493	8b d8		 mov	 ebx, eax
  00495	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
$LN111@Attack:

; 893  : 		}
; 894  : 	}
; 895  : 
; 896  : 	if ( gObjWingSprite(lpTargetObj) == TRUE )

  00498	57		 push	 edi
  00499	e8 00 00 00 00	 call	 ?gObjWingSprite@@YAHPAUOBJECTSTRUCT@@@Z ; gObjWingSprite
  0049e	dd 05 00 00 00
	00		 fld	 QWORD PTR __real@4059000000000000
  004a4	83 c4 04	 add	 esp, 4
  004a7	83 f8 01	 cmp	 eax, 1
  004aa	0f 85 17 03 00
	00		 jne	 $LN240@Attack

; 897  : 	{
; 898  : 		CItem * Wing = &lpTargetObj->pInventory[7];

  004b0	8b 8f 24 0e 00
	00		 mov	 ecx, DWORD PTR [edi+3620]
  004b6	81 c1 cc 05 00
	00		 add	 ecx, 1484		; 000005ccH
  004bc	89 4d 14	 mov	 DWORD PTR _Wing$215904[ebp], ecx

; 899  : 
; 900  : 		if ( AttackDamage > 1 )

  004bf	83 fb 01	 cmp	 ebx, 1
  004c2	0f 8e ff 02 00
	00		 jle	 $LN240@Attack

; 901  : 		{
; 902  : 			if ( Wing->m_Type == ITEMGET(12, 36) || //season 2.5 add-on
; 903  : 				 Wing->m_Type == ITEMGET(12, 37) || 
; 904  : 				 Wing->m_Type == ITEMGET(12, 38) || 
; 905  : 				 Wing->m_Type == ITEMGET(12, 39))

  004c8	0f b7 41 06	 movzx	 eax, WORD PTR [ecx+6]
  004cc	ba 24 18 00 00	 mov	 edx, 6180		; 00001824H
  004d1	66 3b c2	 cmp	 ax, dx
  004d4	0f 84 c5 02 00
	00		 je	 $LN107@Attack
  004da	ba 25 18 00 00	 mov	 edx, 6181		; 00001825H
  004df	66 3b c2	 cmp	 ax, dx
  004e2	0f 84 b7 02 00
	00		 je	 $LN107@Attack
  004e8	ba 26 18 00 00	 mov	 edx, 6182		; 00001826H
  004ed	66 3b c2	 cmp	 ax, dx
  004f0	0f 84 a9 02 00
	00		 je	 $LN107@Attack
  004f6	ba 27 18 00 00	 mov	 edx, 6183		; 00001827H
  004fb	66 3b c2	 cmp	 ax, dx
  004fe	0f 84 9b 02 00
	00		 je	 $LN107@Attack

; 909  : 			}
; 910  : 			else if ( Wing->m_Type == ITEMGET(12, 40) )

  00504	ba 28 18 00 00	 mov	 edx, 6184		; 00001828H
  00509	66 3b c2	 cmp	 ax, dx
  0050c	75 2b		 jne	 SHORT $LN105@Attack

; 911  : 			{
; 912  : 				float damage = (float)(AttackDamage * (76 - (Wing->m_Level*2))) / 100.0f;
; 913  : 				AttackDamage = (int)(damage);	//  #formula

  0050e	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  00512	b9 26 00 00 00	 mov	 ecx, 38			; 00000026H
  00517	2b c8		 sub	 ecx, eax
  00519	0f af cb	 imul	 ecx, ebx
  0051c	03 c9		 add	 ecx, ecx
  0051e	89 4d 14	 mov	 DWORD PTR tv1608[ebp], ecx
  00521	da 7d 14	 fidivr	 DWORD PTR tv1608[ebp]
  00524	d9 5d 14	 fstp	 DWORD PTR tv1606[ebp]
  00527	d9 45 14	 fld	 DWORD PTR tv1606[ebp]
  0052a	e8 00 00 00 00	 call	 __ftol2_sse
  0052f	8b d8		 mov	 ebx, eax
  00531	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
  00534	e9 90 02 00 00	 jmp	 $LN86@Attack
$LN105@Attack:

; 914  : 			}
; 915  : 			else if ( Wing->m_Type == ITEMGET(12, 41) )

  00539	ba 29 18 00 00	 mov	 edx, 6185		; 00001829H
  0053e	66 3b c2	 cmp	 ax, dx
  00541	75 2b		 jne	 SHORT $LN103@Attack

; 916  : 			{
; 917  : 				float damage = (float)(AttackDamage * (88 - (Wing->m_Level*2))) / 100.0f;
; 918  : 				AttackDamage = (int)(damage);	//  #formula

  00543	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  00547	b9 2c 00 00 00	 mov	 ecx, 44			; 0000002cH
  0054c	2b c8		 sub	 ecx, eax
  0054e	0f af cb	 imul	 ecx, ebx
  00551	03 c9		 add	 ecx, ecx
  00553	89 4d 14	 mov	 DWORD PTR tv1599[ebp], ecx
  00556	da 7d 14	 fidivr	 DWORD PTR tv1599[ebp]
  00559	d9 5d 14	 fstp	 DWORD PTR tv1597[ebp]
  0055c	d9 45 14	 fld	 DWORD PTR tv1597[ebp]
  0055f	e8 00 00 00 00	 call	 __ftol2_sse
  00564	8b d8		 mov	 ebx, eax
  00566	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
  00569	e9 5b 02 00 00	 jmp	 $LN86@Attack
$LN103@Attack:

; 919  : 			}
; 920  : 			else if ( Wing->m_Type == ITEMGET(12, 42) )

  0056e	ba 2a 18 00 00	 mov	 edx, 6186		; 0000182aH
  00573	66 3b c2	 cmp	 ax, dx
  00576	75 2b		 jne	 SHORT $LN101@Attack

; 921  : 			{
; 922  : 				float damage = (float)(AttackDamage * (75 - (Wing->m_Level*2))) / 100.0f;
; 923  : 				AttackDamage = (int)(damage);	//  #formula

  00578	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  0057c	03 c0		 add	 eax, eax
  0057e	b9 4b 00 00 00	 mov	 ecx, 75			; 0000004bH
  00583	2b c8		 sub	 ecx, eax
  00585	0f af cb	 imul	 ecx, ebx
  00588	89 4d 14	 mov	 DWORD PTR tv1591[ebp], ecx
  0058b	da 7d 14	 fidivr	 DWORD PTR tv1591[ebp]
  0058e	d9 5d 14	 fstp	 DWORD PTR tv1589[ebp]
  00591	d9 45 14	 fld	 DWORD PTR tv1589[ebp]
  00594	e8 00 00 00 00	 call	 __ftol2_sse
  00599	8b d8		 mov	 ebx, eax
  0059b	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
  0059e	e9 26 02 00 00	 jmp	 $LN86@Attack
$LN101@Attack:

; 924  : 			}
; 925  : 			else if ( Wing->m_Type == ITEMGET(12, 43) )

  005a3	ba 2b 18 00 00	 mov	 edx, 6187		; 0000182bH
  005a8	66 3b c2	 cmp	 ax, dx
  005ab	75 2b		 jne	 SHORT $LN99@Attack

; 926  : 			{
; 927  : 				float damage = (float)(AttackDamage * (61 - (Wing->m_Level*2))) / 100.0f;
; 928  : 				AttackDamage = (int)(damage);	//  #formula

  005ad	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  005b1	03 c0		 add	 eax, eax
  005b3	b9 3d 00 00 00	 mov	 ecx, 61			; 0000003dH
  005b8	2b c8		 sub	 ecx, eax
  005ba	0f af cb	 imul	 ecx, ebx
  005bd	89 4d 14	 mov	 DWORD PTR tv1583[ebp], ecx
  005c0	da 7d 14	 fidivr	 DWORD PTR tv1583[ebp]
  005c3	d9 5d 14	 fstp	 DWORD PTR tv1581[ebp]
  005c6	d9 45 14	 fld	 DWORD PTR tv1581[ebp]
  005c9	e8 00 00 00 00	 call	 __ftol2_sse
  005ce	8b d8		 mov	 ebx, eax
  005d0	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
  005d3	e9 f1 01 00 00	 jmp	 $LN86@Attack
$LN99@Attack:

; 929  : 			}
; 930  : 			else if ( Wing->m_Type > ITEMGET(12, 2) )

  005d8	ba 02 18 00 00	 mov	 edx, 6146		; 00001802H
  005dd	66 3b c2	 cmp	 ax, dx
  005e0	7e 2b		 jle	 SHORT $LN97@Attack

; 931  : 			{
; 932  : 				float damage = (float)(AttackDamage * (75 - (Wing->m_Level*2))) / 100.0f;
; 933  : 				AttackDamage = (int)(damage);	//  #formula

  005e2	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  005e6	03 c0		 add	 eax, eax
  005e8	b9 4b 00 00 00	 mov	 ecx, 75			; 0000004bH
  005ed	2b c8		 sub	 ecx, eax
  005ef	0f af cb	 imul	 ecx, ebx
  005f2	89 4d 14	 mov	 DWORD PTR tv1575[ebp], ecx
  005f5	da 7d 14	 fidivr	 DWORD PTR tv1575[ebp]
  005f8	d9 5d 14	 fstp	 DWORD PTR tv1573[ebp]
  005fb	d9 45 14	 fld	 DWORD PTR tv1573[ebp]
  005fe	e8 00 00 00 00	 call	 __ftol2_sse
  00603	8b d8		 mov	 ebx, eax
  00605	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
  00608	e9 bc 01 00 00	 jmp	 $LN86@Attack
$LN97@Attack:

; 934  : 			}
; 935  : 			else if (Wing->m_Type == ITEMGET(12,50))

  0060d	ba 32 18 00 00	 mov	 edx, 6194		; 00001832H
  00612	66 3b c2	 cmp	 ax, dx
  00615	75 2b		 jne	 SHORT $LN95@Attack

; 936  : 			{
; 937  : 				float damage = (float)(AttackDamage * (76 - (Wing->m_Level*2))) / 100.0f;
; 938  : 				AttackDamage = (int)(damage);

  00617	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  0061b	b9 26 00 00 00	 mov	 ecx, 38			; 00000026H
  00620	2b c8		 sub	 ecx, eax
  00622	0f af cb	 imul	 ecx, ebx
  00625	03 c9		 add	 ecx, ecx
  00627	89 4d 14	 mov	 DWORD PTR tv1567[ebp], ecx
  0062a	da 7d 14	 fidivr	 DWORD PTR tv1567[ebp]
  0062d	d9 5d 14	 fstp	 DWORD PTR tv1565[ebp]
  00630	d9 45 14	 fld	 DWORD PTR tv1565[ebp]
  00633	e8 00 00 00 00	 call	 __ftol2_sse
  00638	8b d8		 mov	 ebx, eax
  0063a	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
  0063d	e9 87 01 00 00	 jmp	 $LN86@Attack
$LN95@Attack:

; 939  : 			}
; 940  : #ifdef NEWWINGS_6
; 941  : 
; 942  : 			else if ( IS_NEWWINGS_6(Wing->m_Type) )

  00642	ba c3 18 00 00	 mov	 edx, 6339		; 000018c3H
  00647	66 3b c2	 cmp	 ax, dx
  0064a	7c 44		 jl	 SHORT $LN93@Attack
  0064c	33 d2		 xor	 edx, edx
  0064e	b9 dc 18 00 00	 mov	 ecx, 6364		; 000018dcH
  00653	66 3b c1	 cmp	 ax, cx
  00656	0f 9e c2	 setle	 dl
  00659	8b ca		 mov	 ecx, edx
  0065b	85 c9		 test	 ecx, ecx
  0065d	74 2e		 je	 SHORT $LN212@Attack

; 943  : 			{
; 944  : 				///if(g_ZtLicense.CheckUser(eZtUB::PrideMuLocal || eZtUB::PrideMu || eZtUB::Local3 || eZtUB::Local2)){
; 945  : 			
; 946  : 				float damage = (float)(AttackDamage * (45/*50*/ - (Wing->m_Level*2))) / 100.0f;   // Fix Damage wings 5lvl in Pvp
; 947  : 				AttackDamage = (int)(damage);	//  #formula

  0065f	8b 45 14	 mov	 eax, DWORD PTR _Wing$215904[ebp]
  00662	0f bf 48 08	 movsx	 ecx, WORD PTR [eax+8]
  00666	03 c9		 add	 ecx, ecx
  00668	ba 2d 00 00 00	 mov	 edx, 45			; 0000002dH
  0066d	2b d1		 sub	 edx, ecx
  0066f	0f af d3	 imul	 edx, ebx
  00672	89 55 14	 mov	 DWORD PTR tv1557[ebp], edx
  00675	da 7d 14	 fidivr	 DWORD PTR tv1557[ebp]
  00678	d9 5d 14	 fstp	 DWORD PTR tv1555[ebp]
  0067b	d9 45 14	 fld	 DWORD PTR tv1555[ebp]
  0067e	e8 00 00 00 00	 call	 __ftol2_sse
  00683	8b d8		 mov	 ebx, eax
  00685	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
  00688	e9 3c 01 00 00	 jmp	 $LN86@Attack
$LN212@Attack:
  0068d	8b 4d 14	 mov	 ecx, DWORD PTR _Wing$215904[ebp]
$LN93@Attack:

; 948  : 				//}
; 949  : 			}
; 950  : #endif
; 951  : #ifdef NEWWINGS_5
; 952  : 			else if ( IS_NEWWINGS_5(Wing->m_Type) )

  00690	ba bd 18 00 00	 mov	 edx, 6333		; 000018bdH
  00695	66 3b c2	 cmp	 ax, dx
  00698	7c 44		 jl	 SHORT $LN91@Attack
  0069a	33 d2		 xor	 edx, edx
  0069c	b9 c2 18 00 00	 mov	 ecx, 6338		; 000018c2H
  006a1	66 3b c1	 cmp	 ax, cx
  006a4	0f 9e c2	 setle	 dl
  006a7	8b ca		 mov	 ecx, edx
  006a9	85 c9		 test	 ecx, ecx
  006ab	74 2e		 je	 SHORT $LN213@Attack

; 953  : 			{
; 954  : 				float damage = (float)(AttackDamage * (50/*50*/ - (Wing->m_Level*2))) / 100.0f;   // Fix Damage wings 5lvl in Pvp
; 955  : 				AttackDamage = (int)(damage);	//  #formula

  006ad	8b 45 14	 mov	 eax, DWORD PTR _Wing$215904[ebp]
  006b0	0f bf 48 08	 movsx	 ecx, WORD PTR [eax+8]
  006b4	ba 19 00 00 00	 mov	 edx, 25			; 00000019H
  006b9	2b d1		 sub	 edx, ecx
  006bb	0f af d3	 imul	 edx, ebx
  006be	03 d2		 add	 edx, edx
  006c0	89 55 14	 mov	 DWORD PTR tv1547[ebp], edx
  006c3	da 7d 14	 fidivr	 DWORD PTR tv1547[ebp]
  006c6	d9 5d 14	 fstp	 DWORD PTR tv1545[ebp]
  006c9	d9 45 14	 fld	 DWORD PTR tv1545[ebp]
  006cc	e8 00 00 00 00	 call	 __ftol2_sse
  006d1	8b d8		 mov	 ebx, eax
  006d3	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
  006d6	e9 ee 00 00 00	 jmp	 $LN86@Attack
$LN213@Attack:
  006db	8b 4d 14	 mov	 ecx, DWORD PTR _Wing$215904[ebp]
$LN91@Attack:

; 956  : 			}
; 957  : #endif
; 958  : #ifdef NEWWINGS_4
; 959  : 			else if ( IS_NEWWINGS_4(Wing->m_Type) )	//Custom Wings4

  006de	ba b4 18 00 00	 mov	 edx, 6324		; 000018b4H
  006e3	66 3b c2	 cmp	 ax, dx
  006e6	7c 44		 jl	 SHORT $LN89@Attack
  006e8	33 d2		 xor	 edx, edx
  006ea	b9 b9 18 00 00	 mov	 ecx, 6329		; 000018b9H
  006ef	66 3b c1	 cmp	 ax, cx
  006f2	0f 9e c2	 setle	 dl
  006f5	8b ca		 mov	 ecx, edx
  006f7	85 c9		 test	 ecx, ecx
  006f9	74 2e		 je	 SHORT $LN214@Attack

; 960  : 			{
; 961  : 				float damage = (float)(AttackDamage * (55 - (Wing->m_Level*2))) / 100.0f;
; 962  : 				AttackDamage = (int)(damage);	//  #formula

  006fb	8b 45 14	 mov	 eax, DWORD PTR _Wing$215904[ebp]
  006fe	0f bf 48 08	 movsx	 ecx, WORD PTR [eax+8]
  00702	03 c9		 add	 ecx, ecx
  00704	ba 37 00 00 00	 mov	 edx, 55			; 00000037H
  00709	2b d1		 sub	 edx, ecx
  0070b	0f af d3	 imul	 edx, ebx
  0070e	89 55 14	 mov	 DWORD PTR tv1537[ebp], edx
  00711	da 7d 14	 fidivr	 DWORD PTR tv1537[ebp]
  00714	d9 5d 14	 fstp	 DWORD PTR tv1535[ebp]
  00717	d9 45 14	 fld	 DWORD PTR tv1535[ebp]
  0071a	e8 00 00 00 00	 call	 __ftol2_sse
  0071f	8b d8		 mov	 ebx, eax
  00721	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
  00724	e9 a0 00 00 00	 jmp	 $LN86@Attack
$LN214@Attack:
  00729	8b 4d 14	 mov	 ecx, DWORD PTR _Wing$215904[ebp]
$LN89@Attack:

; 963  : 			}
; 964  : #endif
; 965  : #ifdef NEWWINGS_2_5
; 966  : 			else if ( IS_NEWWINGS_2_5(Wing->m_Type) )	//Custom Wings2.5

  0072c	ba ba 18 00 00	 mov	 edx, 6330		; 000018baH
  00731	66 3b c2	 cmp	 ax, dx
  00734	7c 41		 jl	 SHORT $LN87@Attack
  00736	33 d2		 xor	 edx, edx
  00738	b9 bc 18 00 00	 mov	 ecx, 6332		; 000018bcH
  0073d	66 3b c1	 cmp	 ax, cx
  00740	0f 9e c2	 setle	 dl
  00743	8b c2		 mov	 eax, edx
  00745	85 c0		 test	 eax, eax
  00747	74 2b		 je	 SHORT $LN215@Attack

; 967  : 			{
; 968  : 				float damage = (float)(AttackDamage * (65 - (Wing->m_Level*2))) / 100.0f;
; 969  : 				AttackDamage = (int)(damage);	//  #formula

  00749	8b 45 14	 mov	 eax, DWORD PTR _Wing$215904[ebp]
  0074c	0f bf 48 08	 movsx	 ecx, WORD PTR [eax+8]
  00750	03 c9		 add	 ecx, ecx
  00752	ba 41 00 00 00	 mov	 edx, 65			; 00000041H
  00757	2b d1		 sub	 edx, ecx
  00759	0f af d3	 imul	 edx, ebx
  0075c	89 55 14	 mov	 DWORD PTR tv1527[ebp], edx
  0075f	da 7d 14	 fidivr	 DWORD PTR tv1527[ebp]
  00762	d9 5d 14	 fstp	 DWORD PTR tv1525[ebp]
  00765	d9 45 14	 fld	 DWORD PTR tv1525[ebp]
  00768	e8 00 00 00 00	 call	 __ftol2_sse
  0076d	8b d8		 mov	 ebx, eax
  0076f	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx

; 970  : 			}
; 971  : #endif
; 972  : 			else

  00772	eb 55		 jmp	 SHORT $LN86@Attack
$LN215@Attack:
  00774	8b 4d 14	 mov	 ecx, DWORD PTR _Wing$215904[ebp]
$LN87@Attack:

; 973  : 			{
; 974  : 				float damage = (float)(AttackDamage * (88 - (Wing->m_Level*2))) / 100.0f;
; 975  : 				AttackDamage = (int)(damage);	//  #formula

  00777	0f bf 41 08	 movsx	 eax, WORD PTR [ecx+8]
  0077b	b9 2c 00 00 00	 mov	 ecx, 44			; 0000002cH
  00780	2b c8		 sub	 ecx, eax
  00782	0f af cb	 imul	 ecx, ebx
  00785	03 c9		 add	 ecx, ecx
  00787	89 4d 14	 mov	 DWORD PTR tv1519[ebp], ecx
  0078a	da 7d 14	 fidivr	 DWORD PTR tv1519[ebp]
  0078d	d9 5d 14	 fstp	 DWORD PTR tv1517[ebp]
  00790	d9 45 14	 fld	 DWORD PTR tv1517[ebp]
  00793	e8 00 00 00 00	 call	 __ftol2_sse
  00798	8b d8		 mov	 ebx, eax
  0079a	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
  0079d	eb 2a		 jmp	 SHORT $LN86@Attack
$LN107@Attack:

; 906  : 			{
; 907  : 				float damage = (float)(AttackDamage * (61 - (Wing->m_Level*2))) / 100.0f;
; 908  : 				AttackDamage = (int)(damage);	//  #formula

  0079f	0f bf 51 08	 movsx	 edx, WORD PTR [ecx+8]
  007a3	03 d2		 add	 edx, edx
  007a5	b8 3d 00 00 00	 mov	 eax, 61			; 0000003dH
  007aa	2b c2		 sub	 eax, edx
  007ac	0f af c3	 imul	 eax, ebx
  007af	89 45 14	 mov	 DWORD PTR tv1510[ebp], eax
  007b2	da 7d 14	 fidivr	 DWORD PTR tv1510[ebp]
  007b5	d9 5d 14	 fstp	 DWORD PTR tv1508[ebp]
  007b8	d9 45 14	 fld	 DWORD PTR tv1508[ebp]
  007bb	e8 00 00 00 00	 call	 __ftol2_sse
  007c0	8b d8		 mov	 ebx, eax
  007c2	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
  007c5	eb 02		 jmp	 SHORT $LN86@Attack
$LN240@Attack:

; 899  : 
; 900  : 		if ( AttackDamage > 1 )

  007c7	dd d8		 fstp	 ST(0)
$LN86@Attack:

; 976  : 			}
; 977  : 		}
; 978  : 	}
; 979  : 
; 980  : 	if ( gObjDenorantSprite(lpTargetObj ) )

  007c9	57		 push	 edi
  007ca	e8 00 00 00 00	 call	 ?gObjDenorantSprite@@YAHPAUOBJECTSTRUCT@@@Z ; gObjDenorantSprite
  007cf	83 c4 04	 add	 esp, 4
  007d2	85 c0		 test	 eax, eax
  007d4	0f 84 83 00 00
	00		 je	 $LN85@Attack

; 981  : 	{
; 982  : 		CItem * Dinorant = &lpTargetObj->pInventory[8];

  007da	8b 8f 24 0e 00
	00		 mov	 ecx, DWORD PTR [edi+3620]
  007e0	81 c1 a0 06 00
	00		 add	 ecx, 1696		; 000006a0H

; 983  : 		int dinorantdecdamage = 90 - Dinorant->IsDinorantReduceAttackDamaege();

  007e6	e8 00 00 00 00	 call	 ?IsDinorantReduceAttackDamaege@CItem@@QAEHXZ ; CItem::IsDinorantReduceAttackDamaege

; 984  : 		lpObj->Life -= 1.0f;

  007eb	d9 86 fc 00 00
	00		 fld	 DWORD PTR [esi+252]
  007f1	dc 25 00 00 00
	00		 fsub	 QWORD PTR __real@3ff0000000000000
  007f7	b9 5a 00 00 00	 mov	 ecx, 90			; 0000005aH
  007fc	2b c8		 sub	 ecx, eax
  007fe	d9 5d 14	 fstp	 DWORD PTR tv1610[ebp]
  00801	d9 45 14	 fld	 DWORD PTR tv1610[ebp]
  00804	d9 96 fc 00 00
	00		 fst	 DWORD PTR [esi+252]

; 985  : 
; 986  : 		if ( lpObj->Life < 0.0f )

  0080a	d9 ee		 fldz
  0080c	d8 d1		 fcom	 ST(1)
  0080e	df e0		 fnstsw	 ax
  00810	dd d9		 fstp	 ST(1)
  00812	f6 c4 41	 test	 ah, 65			; 00000041H
  00815	75 08		 jne	 SHORT $LN294@Attack

; 987  : 		{
; 988  : 			lpObj->Life = 0.0f;

  00817	d9 9e fc 00 00
	00		 fstp	 DWORD PTR [esi+252]

; 989  : 		}
; 990  : 		else

  0081d	eb 19		 jmp	 SHORT $LN83@Attack
$LN294@Attack:

; 991  : 		{
; 992  : 			AttackDamage = AttackDamage * dinorantdecdamage / 100;

  0081f	0f af cb	 imul	 ecx, ebx
  00822	dd d8		 fstp	 ST(0)
  00824	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00829	f7 e9		 imul	 ecx
  0082b	c1 fa 05	 sar	 edx, 5
  0082e	8b da		 mov	 ebx, edx
  00830	c1 eb 1f	 shr	 ebx, 31			; 0000001fH
  00833	03 da		 add	 ebx, edx
  00835	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
$LN83@Attack:

; 993  : 		}
; 994  : 
; 995  : 		GCReFillSend(lpObj->m_Index, lpObj->Life, 0xFF, 0, lpObj->iShield);

  00838	8b 96 54 01 00
	00		 mov	 edx, DWORD PTR [esi+340]
  0083e	d9 86 fc 00 00
	00		 fld	 DWORD PTR [esi+252]
  00844	52		 push	 edx
  00845	6a 00		 push	 0
  00847	68 ff 00 00 00	 push	 255			; 000000ffH
  0084c	e8 00 00 00 00	 call	 __ftol2_sse
  00851	50		 push	 eax
  00852	8b 06		 mov	 eax, DWORD PTR [esi]
  00854	50		 push	 eax
  00855	e8 00 00 00 00	 call	 ?GCReFillSend@@YAXHHEEH@Z ; GCReFillSend
  0085a	83 c4 14	 add	 esp, 20			; 00000014H
$LN85@Attack:

; 996  : 	}
; 997  : 
; 998  : 	if ( gObjDarkHorse(lpTargetObj ) )

  0085d	57		 push	 edi
  0085e	e8 00 00 00 00	 call	 ?gObjDarkHorse@@YAHPAUOBJECTSTRUCT@@@Z ; gObjDarkHorse
  00863	83 c4 04	 add	 esp, 4
  00866	85 c0		 test	 eax, eax
  00868	0f 84 ac 00 00
	00		 je	 $LN82@Attack

; 999  : 	{
; 1000 : 		CItem * Darkhorse = &lpTargetObj->pInventory[8];

  0086e	8b 8f 24 0e 00
	00		 mov	 ecx, DWORD PTR [edi+3620]

; 1001 : 		int decdamage = 100 - ((Darkhorse->m_PetItem_Level + 30) / 2 );

  00874	8b 81 5c 07 00
	00		 mov	 eax, DWORD PTR [ecx+1884]
  0087a	83 c0 1e	 add	 eax, 30			; 0000001eH
  0087d	99		 cdq
  0087e	2b c2		 sub	 eax, edx
  00880	d1 f8		 sar	 eax, 1
  00882	ba 64 00 00 00	 mov	 edx, 100		; 00000064H
  00887	2b d0		 sub	 edx, eax

; 1002 : #ifdef _WINGS_DAMAGE_
; 1003 : 		gWingsDamage.SetCharHorseAttack(lpTargetObj->m_Index, Darkhorse->m_Type, Darkhorse->m_PetItem_Level, decdamage);

  00889	8d 45 14	 lea	 eax, DWORD PTR _decdamage$215972[ebp]
  0088c	50		 push	 eax
  0088d	89 55 14	 mov	 DWORD PTR _decdamage$215972[ebp], edx
  00890	8b 91 5c 07 00
	00		 mov	 edx, DWORD PTR [ecx+1884]
  00896	0f bf 81 a6 06
	00 00		 movsx	 eax, WORD PTR [ecx+1702]
  0089d	8b 0f		 mov	 ecx, DWORD PTR [edi]
  0089f	52		 push	 edx
  008a0	50		 push	 eax
  008a1	51		 push	 ecx
  008a2	b9 00 00 00 00	 mov	 ecx, OFFSET ?gWingsDamage@@3VcWingsDamage@@A ; gWingsDamage
  008a7	e8 00 00 00 00	 call	 ?SetCharHorseAttack@cWingsDamage@@QAEXHHHAAH@Z ; cWingsDamage::SetCharHorseAttack

; 1004 : #endif
; 1005 : 		lpTargetObj->Life -= 1.0f;

  008ac	d9 87 fc 00 00
	00		 fld	 DWORD PTR [edi+252]
  008b2	dc 25 00 00 00
	00		 fsub	 QWORD PTR __real@3ff0000000000000
  008b8	d9 5d 08	 fstp	 DWORD PTR tv1634[ebp]
  008bb	d9 45 08	 fld	 DWORD PTR tv1634[ebp]
  008be	d9 97 fc 00 00
	00		 fst	 DWORD PTR [edi+252]

; 1006 : 
; 1007 : 		if ( lpTargetObj->Life < 0.0f )

  008c4	d9 ee		 fldz
  008c6	d8 d1		 fcom	 ST(1)
  008c8	df e0		 fnstsw	 ax
  008ca	dd d9		 fstp	 ST(1)
  008cc	f6 c4 41	 test	 ah, 65			; 00000041H
  008cf	75 08		 jne	 SHORT $LN297@Attack

; 1008 : 		{
; 1009 : 			lpTargetObj->Life = 0.0f;

  008d1	d9 9f fc 00 00
	00		 fstp	 DWORD PTR [edi+252]

; 1010 : 		}
; 1011 : 		else

  008d7	eb 1c		 jmp	 SHORT $LN80@Attack
$LN297@Attack:

; 1012 : 		{
; 1013 : 			AttackDamage = AttackDamage * decdamage / 100;

  008d9	8b 4d 14	 mov	 ecx, DWORD PTR _decdamage$215972[ebp]
  008dc	dd d8		 fstp	 ST(0)
  008de	0f af cb	 imul	 ecx, ebx
  008e1	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  008e6	f7 e9		 imul	 ecx
  008e8	c1 fa 05	 sar	 edx, 5
  008eb	8b da		 mov	 ebx, edx
  008ed	c1 eb 1f	 shr	 ebx, 31			; 0000001fH
  008f0	03 da		 add	 ebx, edx
  008f2	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
$LN80@Attack:

; 1014 : 		}
; 1015 : 
; 1016 : 		GCReFillSend(lpTargetObj->m_Index, lpTargetObj->Life, 0xFF, 0,lpTargetObj->iShield);

  008f5	8b 8f 54 01 00
	00		 mov	 ecx, DWORD PTR [edi+340]
  008fb	d9 87 fc 00 00
	00		 fld	 DWORD PTR [edi+252]
  00901	51		 push	 ecx
  00902	6a 00		 push	 0
  00904	68 ff 00 00 00	 push	 255			; 000000ffH
  00909	e8 00 00 00 00	 call	 __ftol2_sse
  0090e	8b 17		 mov	 edx, DWORD PTR [edi]
  00910	50		 push	 eax
  00911	52		 push	 edx
  00912	e8 00 00 00 00	 call	 ?GCReFillSend@@YAXHHEEH@Z ; GCReFillSend
  00917	83 c4 14	 add	 esp, 20			; 00000014H
$LN82@Attack:

; 1017 : 	}
; 1018 : 
; 1019 : 	if ( lpTargetObj->Live )

  0091a	80 7f 6a 00	 cmp	 BYTE PTR [edi+106], 0
  0091e	0f 84 69 03 00
	00		 je	 $LN219@Attack

; 1020 : 	{
; 1021 : 		if(gObjSearchActiveEffect(lpTargetObj, AT_WIZARD_DEFENSE) == 1 && AttackDamage > 0)

  00924	6a 04		 push	 4
  00926	57		 push	 edi
  00927	e8 00 00 00 00	 call	 ?gObjSearchActiveEffect@@YAEPAUOBJECTSTRUCT@@H@Z ; gObjSearchActiveEffect
  0092c	83 c4 08	 add	 esp, 8
  0092f	3c 01		 cmp	 al, 1
  00931	0f 85 ee 00 00
	00		 jne	 $LN217@Attack
  00937	85 db		 test	 ebx, ebx
  00939	0f 8e e6 00 00
	00		 jle	 $LN217@Attack

; 1022 : 		{
; 1023 : 			int iWizardSkillDefense = 0;

  0093f	33 c0		 xor	 eax, eax
  00941	89 45 08	 mov	 DWORD PTR _iWizardSkillDefense$215977[ebp], eax

; 1024 : 			int iWizardSkillTime = 0;

  00944	89 45 14	 mov	 DWORD PTR _iWizardSkillTime$215978[ebp], eax

; 1025 : 
; 1026 : 			gObjUpdateAppliedBuffEffect(lpTargetObj, AT_WIZARD_DEFENSE, &iWizardSkillDefense, &iWizardSkillTime);

  00947	8d 45 14	 lea	 eax, DWORD PTR _iWizardSkillTime$215978[ebp]
  0094a	50		 push	 eax
  0094b	8d 4d 08	 lea	 ecx, DWORD PTR _iWizardSkillDefense$215977[ebp]
  0094e	51		 push	 ecx
  0094f	6a 04		 push	 4
  00951	57		 push	 edi
  00952	e8 00 00 00 00	 call	 ?gObjUpdateAppliedBuffEffect@@YAEPAUOBJECTSTRUCT@@HPAH1@Z ; gObjUpdateAppliedBuffEffect

; 1027 : 
; 1028 : 			int replacemana = 0;
; 1029 : 
; 1030 : 			if(iWizardSkillTime > 0)
; 1031 : 			{
; 1032 : 				replacemana = (WORD)lpTargetObj->Mana * iWizardSkillTime / 1000;

  00957	d9 87 10 01 00
	00		 fld	 DWORD PTR [edi+272]
  0095d	8b 55 14	 mov	 edx, DWORD PTR _iWizardSkillTime$215978[ebp]
  00960	83 c4 10	 add	 esp, 16			; 00000010H
  00963	85 d2		 test	 edx, edx
  00965	7e 38		 jle	 SHORT $LN77@Attack
  00967	d9 7d 16	 fnstcw	 WORD PTR tv1445[ebp]
  0096a	0f b7 45 16	 movzx	 eax, WORD PTR tv1445[ebp]
  0096e	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  00973	89 45 e8	 mov	 DWORD PTR tv1442[ebp], eax
  00976	d9 6d e8	 fldcw	 WORD PTR tv1442[ebp]
  00979	db 5d e8	 fistp	 DWORD PTR tv1440[ebp]
  0097c	66 8b 45 e8	 mov	 ax, WORD PTR tv1440[ebp]
  00980	0f b7 c8	 movzx	 ecx, ax
  00983	b8 d3 4d 62 10	 mov	 eax, 274877907		; 10624dd3H
  00988	0f af ca	 imul	 ecx, edx
  0098b	d9 6d 16	 fldcw	 WORD PTR tv1445[ebp]
  0098e	f7 e9		 imul	 ecx
  00990	c1 fa 06	 sar	 edx, 6
  00993	8b ca		 mov	 ecx, edx
  00995	c1 e9 1f	 shr	 ecx, 31			; 0000001fH
  00998	03 ca		 add	 ecx, edx
  0099a	89 4d 14	 mov	 DWORD PTR _replacemana$215979[ebp], ecx

; 1033 : 			}
; 1034 : 			else

  0099d	eb 35		 jmp	 SHORT $LN76@Attack
$LN77@Attack:

; 1035 : 			{
; 1036 : 				replacemana = (WORD)lpTargetObj->Mana * 2 / 100;

  0099f	d9 7d 16	 fnstcw	 WORD PTR tv1432[ebp]
  009a2	0f b7 45 16	 movzx	 eax, WORD PTR tv1432[ebp]
  009a6	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  009ab	89 45 e8	 mov	 DWORD PTR tv1429[ebp], eax
  009ae	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  009b3	d9 6d e8	 fldcw	 WORD PTR tv1429[ebp]
  009b6	db 5d e8	 fistp	 DWORD PTR tv1427[ebp]
  009b9	66 8b 55 e8	 mov	 dx, WORD PTR tv1427[ebp]
  009bd	0f b7 ca	 movzx	 ecx, dx
  009c0	03 c9		 add	 ecx, ecx
  009c2	d9 6d 16	 fldcw	 WORD PTR tv1432[ebp]
  009c5	f7 e9		 imul	 ecx
  009c7	c1 fa 05	 sar	 edx, 5
  009ca	8b c2		 mov	 eax, edx
  009cc	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  009cf	03 c2		 add	 eax, edx
  009d1	89 45 14	 mov	 DWORD PTR _replacemana$215979[ebp], eax
$LN76@Attack:

; 1037 : 			}
; 1038 : 
; 1039 : 			if ( replacemana < lpTargetObj->Mana )

  009d4	db 45 14	 fild	 DWORD PTR _replacemana$215979[ebp]
  009d7	d9 5d 14	 fstp	 DWORD PTR tv1658[ebp]
  009da	d9 45 14	 fld	 DWORD PTR tv1658[ebp]
  009dd	d9 87 10 01 00
	00		 fld	 DWORD PTR [edi+272]
  009e3	d8 d9		 fcomp	 ST(1)
  009e5	df e0		 fnstsw	 ax
  009e7	f6 c4 41	 test	 ah, 65			; 00000041H
  009ea	75 37		 jne	 SHORT $LN300@Attack

; 1040 : 			{
; 1041 : 				lpTargetObj->Mana -= replacemana;

  009ec	d8 af 10 01 00
	00		 fsubr	 DWORD PTR [edi+272]

; 1042 : 
; 1043 : 				int decattackdamage = 0; //200
; 1044 : 
; 1045 : 				if(iWizardSkillDefense > 0)

  009f2	8b 4d 08	 mov	 ecx, DWORD PTR _iWizardSkillDefense$215977[ebp]
  009f5	33 c0		 xor	 eax, eax
  009f7	d9 9f 10 01 00
	00		 fstp	 DWORD PTR [edi+272]
  009fd	85 c9		 test	 ecx, ecx
  009ff	7e 14		 jle	 SHORT $LN216@Attack

; 1046 : 				{
; 1047 : 					decattackdamage = AttackDamage * iWizardSkillDefense / 100;

  00a01	0f af cb	 imul	 ecx, ebx
  00a04	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00a09	f7 e9		 imul	 ecx
  00a0b	c1 fa 05	 sar	 edx, 5
  00a0e	8b c2		 mov	 eax, edx
  00a10	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  00a13	03 c2		 add	 eax, edx
$LN216@Attack:

; 1048 : 				}
; 1049 : 
; 1050 : 				AttackDamage -= decattackdamage;

  00a15	2b d8		 sub	 ebx, eax
  00a17	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx

; 1051 : 				ManaChange = TRUE;

  00a1a	c7 45 f0 01 00
	00 00		 mov	 DWORD PTR _ManaChange$[ebp], 1
  00a21	eb 02		 jmp	 SHORT $LN217@Attack
$LN300@Attack:
  00a23	dd d8		 fstp	 ST(0)
$LN217@Attack:

; 1052 : 			}
; 1053 : 		}
; 1054 : 
; 1055 : 		if ( g_ShieldSystemOn == FALSE )

  00a25	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_ShieldSystemOn@@3HA ; g_ShieldSystemOn
  00a2b	85 c9		 test	 ecx, ecx
  00a2d	75 58		 jne	 SHORT $LN230@Attack

; 1056 : 		{
; 1057 : 			if ( lpObj->Type == OBJ_USER && lpTargetObj->Type == OBJ_USER )

  00a2f	b8 01 00 00 00	 mov	 eax, 1
  00a34	66 39 46 68	 cmp	 WORD PTR [esi+104], ax
  00a38	75 4d		 jne	 SHORT $LN230@Attack
  00a3a	66 39 47 68	 cmp	 WORD PTR [edi+104], ax
  00a3e	75 47		 jne	 SHORT $LN230@Attack

; 1058 : 			{
; 1059 : 				if ( CC_MAP_RANGE(lpObj->MapNumber ) && CC_MAP_RANGE(lpTargetObj->MapNumber) )

  00a40	0f b6 86 49 01
	00 00		 movzx	 eax, BYTE PTR [esi+329]
  00a47	3c 35		 cmp	 al, 53			; 00000035H
  00a49	74 0d		 je	 SHORT $LN204@Attack
  00a4b	3c 12		 cmp	 al, 18			; 00000012H
  00a4d	72 38		 jb	 SHORT $LN230@Attack
  00a4f	b2 17		 mov	 dl, 23			; 00000017H
  00a51	3a d0		 cmp	 dl, al
  00a53	1b c0		 sbb	 eax, eax
  00a55	40		 inc	 eax
  00a56	74 2f		 je	 SHORT $LN230@Attack
$LN204@Attack:
  00a58	0f b6 87 49 01
	00 00		 movzx	 eax, BYTE PTR [edi+329]
  00a5f	3c 35		 cmp	 al, 53			; 00000035H
  00a61	74 0d		 je	 SHORT $LN205@Attack
  00a63	3c 12		 cmp	 al, 18			; 00000012H
  00a65	72 20		 jb	 SHORT $LN230@Attack
  00a67	b2 17		 mov	 dl, 23			; 00000017H
  00a69	3a d0		 cmp	 dl, al
  00a6b	1b c0		 sbb	 eax, eax
  00a6d	40		 inc	 eax
  00a6e	74 17		 je	 SHORT $LN230@Attack
$LN205@Attack:

; 1060 : 				{
; 1061 : 					AttackDamage = AttackDamage * 50 / 100;

  00a70	6b db 32	 imul	 ebx, 50			; 00000032H
  00a73	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00a78	f7 eb		 imul	 ebx
  00a7a	c1 fa 05	 sar	 edx, 5
  00a7d	8b da		 mov	 ebx, edx
  00a7f	c1 eb 1f	 shr	 ebx, 31			; 0000001fH
  00a82	03 da		 add	 ebx, edx
  00a84	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
$LN230@Attack:

; 1062 : 				}
; 1063 : 			}
; 1064 : 		}
; 1065 : 
; 1066 : //#if(GS_CASTLE==1)
; 1067 : 		if ( g_CastleSiege.GetCastleState() == CASTLESIEGE_STATE_STARTSIEGE)

  00a87	83 3d 28 00 00
	00 07		 cmp	 DWORD PTR ?g_CastleSiege@@3VCCastleSiege@@A+40, 7
  00a8e	75 5a		 jne	 SHORT $LN65@Attack

; 1068 : 		{
; 1069 : 			if ( lpObj->Type == OBJ_USER && lpTargetObj->Type == OBJ_USER )

  00a90	b8 01 00 00 00	 mov	 eax, 1
  00a95	66 39 46 68	 cmp	 WORD PTR [esi+104], ax
  00a99	75 4f		 jne	 SHORT $LN65@Attack
  00a9b	66 39 47 68	 cmp	 WORD PTR [edi+104], ax
  00a9f	75 49		 jne	 SHORT $LN65@Attack

; 1070 : 			{
; 1071 : 				if ( lpObj->MapNumber == MAP_INDEX_CASTLESIEGE && lpTargetObj->MapNumber == MAP_INDEX_CASTLESIEGE )

  00aa1	80 be 49 01 00
	00 1e		 cmp	 BYTE PTR [esi+329], 30	; 0000001eH
  00aa8	75 40		 jne	 SHORT $LN65@Attack
  00aaa	80 bf 49 01 00
	00 1e		 cmp	 BYTE PTR [edi+329], 30	; 0000001eH
  00ab1	75 37		 jne	 SHORT $LN65@Attack

; 1072 : 				{
; 1073 : 					if( lpObj->m_btCsJoinSide == lpTargetObj->m_btCsJoinSide)

  00ab3	8a 96 02 1c 00
	00		 mov	 dl, BYTE PTR [esi+7170]
  00ab9	3a 97 02 1c 00
	00		 cmp	 dl, BYTE PTR [edi+7170]
  00abf	75 08		 jne	 SHORT $LN67@Attack

; 1074 : 					{
; 1075 : 						//int PetAttackByNPC = GetPrivateProfileInt("CastleSiegePet","PetAttackByNPC",20,"..\\Data\\ZtData\\Skills.ini");
; 1076 : 						AttackDamage = ( AttackDamage * ZtConfig.Character.PetCastleAttackByNPC ) / 100;		//AttackDamage = AttackDamage * 20 / 100;

  00ac1	8b 0d 78 01 00
	00		 mov	 ecx, DWORD PTR ?ZtConfig@@3VcZtConfigs@@A+376
  00ac7	eb 0a		 jmp	 SHORT $LN310@Attack
$LN67@Attack:

; 1077 : 					}
; 1078 : 					else if(g_ShieldSystemOn == FALSE)

  00ac9	85 c9		 test	 ecx, ecx
  00acb	75 1d		 jne	 SHORT $LN65@Attack

; 1079 : 					{
; 1080 : 						//int PetAttackByPlayer = GetPrivateProfileInt("CastleSiegePet","PetAttackByPlayer",40,"..\\Data\\ZtData\\Skills.ini");
; 1081 : 						AttackDamage = AttackDamage * ZtConfig.Character.PetCastleAttackByPlayer / 100;	//AttackDamage = AttackDamage * 40 / 100;

  00acd	8b 0d 7c 01 00
	00		 mov	 ecx, DWORD PTR ?ZtConfig@@3VcZtConfigs@@A+380
$LN310@Attack:
  00ad3	0f af cb	 imul	 ecx, ebx
  00ad6	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00adb	f7 e9		 imul	 ecx
  00add	c1 fa 05	 sar	 edx, 5
  00ae0	8b da		 mov	 ebx, edx
  00ae2	c1 eb 1f	 shr	 ebx, 31			; 0000001fH
  00ae5	03 da		 add	 ebx, edx
  00ae7	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
$LN65@Attack:

; 1082 : 					}
; 1083 : 				}
; 1084 : 			}
; 1085 : 		}
; 1086 : //#endif
; 1087 : 
; 1088 : 		if ( lpObj->Type == OBJ_USER && lpTargetObj->Type == OBJ_MONSTER )

  00aea	66 83 7e 68 01	 cmp	 WORD PTR [esi+104], 1
  00aef	0f 85 2f 01 00
	00		 jne	 $LN218@Attack
  00af5	66 83 7f 68 02	 cmp	 WORD PTR [edi+104], 2
  00afa	0f 85 24 01 00
	00		 jne	 $LN218@Attack

; 1089 : 		{
; 1090 : 			if ( lpTargetObj->Class == 283 )

  00b00	ba 1b 01 00 00	 mov	 edx, 283		; 0000011bH
  00b05	66 39 97 b8 00
	00 00		 cmp	 WORD PTR [edi+184], dx
  00b0c	0f 85 80 00 00
	00		 jne	 $LN60@Attack

; 1091 : 			{
; 1092 : 				if(gObjSearchActiveEffect(lpObj, AT_POTION_OF_BLESS) != 0 || gObjSearchActiveEffect(lpObj, AT_POTION_OF_SOUL) != 0)

  00b12	6a 0a		 push	 10			; 0000000aH
  00b14	56		 push	 esi
  00b15	e8 00 00 00 00	 call	 ?gObjSearchActiveEffect@@YAEPAUOBJECTSTRUCT@@H@Z ; gObjSearchActiveEffect
  00b1a	83 c4 08	 add	 esp, 8
  00b1d	84 c0		 test	 al, al
  00b1f	75 54		 jne	 SHORT $LN61@Attack
  00b21	6a 0b		 push	 11			; 0000000bH
  00b23	56		 push	 esi
  00b24	e8 00 00 00 00	 call	 ?gObjSearchActiveEffect@@YAEPAUOBJECTSTRUCT@@H@Z ; gObjSearchActiveEffect
  00b29	83 c4 08	 add	 esp, 8
  00b2c	84 c0		 test	 al, al
  00b2e	75 45		 jne	 SHORT $LN61@Attack

; 1095 : 				}
; 1096 : 				else
; 1097 : 				{
; 1098 : 					if ( lpObj->m_iAccumulatedDamage > 100 )

  00b30	8b 86 10 1c 00
	00		 mov	 eax, DWORD PTR [esi+7184]
  00b36	83 f8 64	 cmp	 eax, 100		; 00000064H
  00b39	7e 18		 jle	 SHORT $LN59@Attack

; 1099 : 					{
; 1100 : 						gObjWeaponDurDownInCastle(lpObj, lpTargetObj, 1);

  00b3b	6a 01		 push	 1
  00b3d	57		 push	 edi
  00b3e	56		 push	 esi
  00b3f	e8 00 00 00 00	 call	 ?gObjWeaponDurDownInCastle@@YAXPAUOBJECTSTRUCT@@0H@Z ; gObjWeaponDurDownInCastle
  00b44	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1101 : 						lpObj->m_iAccumulatedDamage = 0;

  00b47	c7 86 10 1c 00
	00 00 00 00 00	 mov	 DWORD PTR [esi+7184], 0

; 1102 : 					}
; 1103 : 					else

  00b51	eb 08		 jmp	 SHORT $LN58@Attack
$LN59@Attack:

; 1104 : 					{
; 1105 : 						lpObj->m_iAccumulatedDamage += AttackDamage;

  00b53	03 c3		 add	 eax, ebx
  00b55	89 86 10 1c 00
	00		 mov	 DWORD PTR [esi+7184], eax
$LN58@Attack:

; 1106 : 					}
; 1107 : 
; 1108 : 					AttackDamage = AttackDamage * 20 / 100;

  00b5b	8d 1c 9b	 lea	 ebx, DWORD PTR [ebx+ebx*4]
  00b5e	03 db		 add	 ebx, ebx
  00b60	03 db		 add	 ebx, ebx
  00b62	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00b67	f7 eb		 imul	 ebx
  00b69	c1 fa 05	 sar	 edx, 5
  00b6c	8b da		 mov	 ebx, edx
  00b6e	c1 eb 1f	 shr	 ebx, 31			; 0000001fH
  00b71	03 da		 add	 ebx, edx
  00b73	eb 1a		 jmp	 SHORT $LN311@Attack
$LN61@Attack:

; 1093 : 				{
; 1094 : 					AttackDamage += (AttackDamage * 20) / 100;

  00b75	8d 0c 9b	 lea	 ecx, DWORD PTR [ebx+ebx*4]
  00b78	03 c9		 add	 ecx, ecx
  00b7a	03 c9		 add	 ecx, ecx
  00b7c	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00b81	f7 e9		 imul	 ecx
  00b83	c1 fa 05	 sar	 edx, 5
  00b86	8b ca		 mov	 ecx, edx
  00b88	c1 e9 1f	 shr	 ecx, 31			; 0000001fH
  00b8b	03 ca		 add	 ecx, edx
  00b8d	03 d9		 add	 ebx, ecx
$LN311@Attack:
  00b8f	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
$LN60@Attack:

; 1109 : 				}
; 1110 : 			}
; 1111 : 
; 1112 : 			if ( lpTargetObj->Class == 277 )

  00b92	ba 15 01 00 00	 mov	 edx, 277		; 00000115H
  00b97	66 39 97 b8 00
	00 00		 cmp	 WORD PTR [edi+184], dx
  00b9e	0f 85 80 00 00
	00		 jne	 $LN218@Attack

; 1113 : 			{
; 1114 : 				if(gObjSearchActiveEffect(lpObj, AT_POTION_OF_BLESS) != 0 || gObjSearchActiveEffect(lpObj, AT_POTION_OF_SOUL) != 0)

  00ba4	6a 0a		 push	 10			; 0000000aH
  00ba6	56		 push	 esi
  00ba7	e8 00 00 00 00	 call	 ?gObjSearchActiveEffect@@YAEPAUOBJECTSTRUCT@@H@Z ; gObjSearchActiveEffect
  00bac	83 c4 08	 add	 esp, 8
  00baf	84 c0		 test	 al, al
  00bb1	75 54		 jne	 SHORT $LN55@Attack
  00bb3	6a 0b		 push	 11			; 0000000bH
  00bb5	56		 push	 esi
  00bb6	e8 00 00 00 00	 call	 ?gObjSearchActiveEffect@@YAEPAUOBJECTSTRUCT@@H@Z ; gObjSearchActiveEffect
  00bbb	83 c4 08	 add	 esp, 8
  00bbe	84 c0		 test	 al, al
  00bc0	75 45		 jne	 SHORT $LN55@Attack

; 1117 : 				}
; 1118 : 				else
; 1119 : 				{					
; 1120 : 					if ( lpObj->m_iAccumulatedDamage > 100 )

  00bc2	8b 86 10 1c 00
	00		 mov	 eax, DWORD PTR [esi+7184]
  00bc8	83 f8 64	 cmp	 eax, 100		; 00000064H
  00bcb	7e 18		 jle	 SHORT $LN53@Attack

; 1121 : 					{
; 1122 : 						gObjWeaponDurDownInCastle(lpObj, lpTargetObj, 1);

  00bcd	6a 01		 push	 1
  00bcf	57		 push	 edi
  00bd0	56		 push	 esi
  00bd1	e8 00 00 00 00	 call	 ?gObjWeaponDurDownInCastle@@YAXPAUOBJECTSTRUCT@@0H@Z ; gObjWeaponDurDownInCastle
  00bd6	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1123 : 						lpObj->m_iAccumulatedDamage = 0;

  00bd9	c7 86 10 1c 00
	00 00 00 00 00	 mov	 DWORD PTR [esi+7184], 0

; 1124 : 					}
; 1125 : 					else

  00be3	eb 08		 jmp	 SHORT $LN52@Attack
$LN53@Attack:

; 1126 : 					{
; 1127 : 						lpObj->m_iAccumulatedDamage += AttackDamage;

  00be5	03 c3		 add	 eax, ebx
  00be7	89 86 10 1c 00
	00		 mov	 DWORD PTR [esi+7184], eax
$LN52@Attack:

; 1128 : 					}
; 1129 : 
; 1130 : 					AttackDamage = AttackDamage * 20 / 100;

  00bed	8d 1c 9b	 lea	 ebx, DWORD PTR [ebx+ebx*4]
  00bf0	03 db		 add	 ebx, ebx
  00bf2	03 db		 add	 ebx, ebx
  00bf4	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00bf9	f7 eb		 imul	 ebx
  00bfb	c1 fa 05	 sar	 edx, 5
  00bfe	8b da		 mov	 ebx, edx
  00c00	c1 eb 1f	 shr	 ebx, 31			; 0000001fH
  00c03	03 da		 add	 ebx, edx
  00c05	eb 1a		 jmp	 SHORT $LN312@Attack
$LN55@Attack:

; 1115 : 				{
; 1116 : 					AttackDamage += (AttackDamage * 20) / 100;

  00c07	8d 0c 9b	 lea	 ecx, DWORD PTR [ebx+ebx*4]
  00c0a	03 c9		 add	 ecx, ecx
  00c0c	03 c9		 add	 ecx, ecx
  00c0e	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00c13	f7 e9		 imul	 ecx
  00c15	c1 fa 05	 sar	 edx, 5
  00c18	8b ca		 mov	 ecx, edx
  00c1a	c1 e9 1f	 shr	 ecx, 31			; 0000001fH
  00c1d	03 ca		 add	 ecx, edx
  00c1f	03 d9		 add	 ebx, ecx
$LN312@Attack:
  00c21	89 5d 0c	 mov	 DWORD PTR _AttackDamage$[ebp], ebx
$LN218@Attack:

; 1131 : 				}
; 1132 : 			}
; 1133 : 		}
; 1134 : 
; 1135 : 		if ( lpObj->Type == OBJ_USER && lpTargetObj->Type == OBJ_USER )

  00c24	b8 01 00 00 00	 mov	 eax, 1
  00c29	66 39 46 68	 cmp	 WORD PTR [esi+104], ax
  00c2d	75 4b		 jne	 SHORT $LN51@Attack
  00c2f	66 39 47 68	 cmp	 WORD PTR [edi+104], ax
  00c33	75 45		 jne	 SHORT $LN51@Attack

; 1136 : 		{
; 1137 : 			iTempShieldDamage = this->GetShieldDamage(lpObj, lpTargetObj, AttackDamage);

  00c35	8b 4d f4	 mov	 ecx, DWORD PTR _this$[ebp]
  00c38	53		 push	 ebx
  00c39	57		 push	 edi
  00c3a	56		 push	 esi
  00c3b	e8 00 00 00 00	 call	 ?GetShieldDamage@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0H@Z ; CDarkSpirit::GetShieldDamage

; 1138 : 			lpTargetObj->iShield -= iTempShieldDamage;
; 1139 : 			lpTargetObj->Life -= AttackDamage - iTempShieldDamage;

  00c40	d9 87 fc 00 00
	00		 fld	 DWORD PTR [edi+252]
  00c46	29 87 54 01 00
	00		 sub	 DWORD PTR [edi+340], eax
  00c4c	8b d3		 mov	 edx, ebx
  00c4e	2b d0		 sub	 edx, eax
  00c50	89 55 14	 mov	 DWORD PTR tv1370[ebp], edx
  00c53	da 65 14	 fisub	 DWORD PTR tv1370[ebp]

; 1140 : 			iTotalShieldDamage += iTempShieldDamage;

  00c56	89 45 ec	 mov	 DWORD PTR _iTotalShieldDamage$[ebp], eax
  00c59	d9 5d 14	 fstp	 DWORD PTR tv1704[ebp]
  00c5c	d9 45 14	 fld	 DWORD PTR tv1704[ebp]
$LN318@Attack:

; 1141 : 
; 1142 : 			if ( lpTargetObj->Life < 0.0f )

  00c5f	d9 97 fc 00 00
	00		 fst	 DWORD PTR [edi+252]
  00c65	d9 ee		 fldz
  00c67	d8 d1		 fcom	 ST(1)
  00c69	df e0		 fnstsw	 ax
  00c6b	dd d9		 fstp	 ST(1)
  00c6d	f6 c4 41	 test	 ah, 65			; 00000041H
  00c70	75 19		 jne	 SHORT $LN306@Attack

; 1143 : 			{
; 1144 : 				lpTargetObj->Life = 0.0f;

  00c72	d9 9f fc 00 00
	00		 fstp	 DWORD PTR [edi+252]

; 1145 : 			}
; 1146 : 		}
; 1147 : 		else

  00c78	eb 13		 jmp	 SHORT $LN219@Attack
$LN51@Attack:

; 1148 : 		{
; 1149 : 			lpTargetObj->Life -= AttackDamage;

  00c7a	d9 87 fc 00 00
	00		 fld	 DWORD PTR [edi+252]
  00c80	da 65 0c	 fisub	 DWORD PTR _AttackDamage$[ebp]
  00c83	d9 5d 14	 fstp	 DWORD PTR tv1709[ebp]
  00c86	d9 45 14	 fld	 DWORD PTR tv1709[ebp]

; 1152 : 			{
; 1153 : 				lpTargetObj->Life = 0.0f;

  00c89	eb d4		 jmp	 SHORT $LN318@Attack
$LN306@Attack:

; 1150 : 
; 1151 : 			if ( lpTargetObj->Life < 0.0f )

  00c8b	dd d8		 fstp	 ST(0)
$LN219@Attack:

; 1154 : 			}
; 1155 : 		}
; 1156 : 	}
; 1157 : 
; 1158 : 	if ( lpTargetObj->Type == OBJ_MONSTER )

  00c8d	66 83 7f 68 02	 cmp	 WORD PTR [edi+104], 2
  00c92	75 45		 jne	 SHORT $LN220@Attack

; 1159 : 	{
; 1160 : 		gObjAddMsgSendDelay(lpTargetObj, 0, lpObj->m_Index, 100, 0);

  00c94	8b 06		 mov	 eax, DWORD PTR [esi]
  00c96	6a 00		 push	 0
  00c98	6a 64		 push	 100			; 00000064H
  00c9a	50		 push	 eax
  00c9b	6a 00		 push	 0
  00c9d	57		 push	 edi
  00c9e	e8 00 00 00 00	 call	 ?gObjAddMsgSendDelay@@YAXPAUOBJECTSTRUCT@@HHHH@Z ; gObjAddMsgSendDelay

; 1161 : 		lpTargetObj->LastAttackerID = lpObj->m_Index;

  00ca3	66 8b 0e	 mov	 cx, WORD PTR [esi]
  00ca6	83 c4 14	 add	 esp, 20			; 00000014H

; 1162 : 
; 1163 : 		if ( lpTargetObj->m_iCurrentAI )

  00ca9	83 bf 78 1c 00
	00 00		 cmp	 DWORD PTR [edi+7288], 0
  00cb0	66 89 8f 5e 04
	00 00		 mov	 WORD PTR [edi+1118], cx
  00cb7	74 20		 je	 SHORT $LN220@Attack

; 1164 : 		{
; 1165 : 			lpTargetObj->m_Agro.IncAgro(lpObj->m_Index, AttackDamage / 100);

  00cb9	8b 0e		 mov	 ecx, DWORD PTR [esi]
  00cbb	b8 1f 85 eb 51	 mov	 eax, 1374389535		; 51eb851fH
  00cc0	f7 eb		 imul	 ebx
  00cc2	c1 fa 05	 sar	 edx, 5
  00cc5	8b c2		 mov	 eax, edx
  00cc7	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  00cca	03 c2		 add	 eax, edx
  00ccc	50		 push	 eax
  00ccd	51		 push	 ecx
  00cce	8d 8f 94 1c 00
	00		 lea	 ecx, DWORD PTR [edi+7316]
  00cd4	e8 00 00 00 00	 call	 ?IncAgro@TMonsterAIAgro@@QAEHHH@Z ; TMonsterAIAgro::IncAgro
$LN220@Attack:

; 1166 : 		}
; 1167 : 	}
; 1168 : 
; 1169 : 	BOOL selfdefense = 0;
; 1170 : 	lpCallObj = lpTargetObj;
; 1171 : 	
; 1172 : 	if ( lpTargetObj->Type == OBJ_MONSTER )

  00cd9	0f b7 4f 68	 movzx	 ecx, WORD PTR [edi+104]
  00cdd	c7 45 14 00 00
	00 00		 mov	 DWORD PTR _selfdefense$[ebp], 0
  00ce4	89 7d 08	 mov	 DWORD PTR _lpCallObj$[ebp], edi
  00ce7	83 f9 02	 cmp	 ecx, 2
  00cea	75 19		 jne	 SHORT $LN44@Attack

; 1173 : 	{
; 1174 : 		if ( lpTargetObj->m_RecallMon >= 0 )

  00cec	8b 87 50 04 00
	00		 mov	 eax, DWORD PTR [edi+1104]
  00cf2	85 c0		 test	 eax, eax
  00cf4	78 0f		 js	 SHORT $LN44@Attack

; 1175 : 		{
; 1176 : 			lpCallObj = &gObj[lpTargetObj->m_RecallMon];

  00cf6	69 c0 50 2b 00
	00		 imul	 eax, 11088		; 00002b50H
  00cfc	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00d02	89 45 08	 mov	 DWORD PTR _lpCallObj$[ebp], eax
$LN44@Attack:

; 1177 : 		}
; 1178 : 	}
; 1179 : 
; 1180 : 	if ( AttackDamage >= 1 )

  00d05	83 fb 01	 cmp	 ebx, 1
  00d08	0f 8c 0e 01 00
	00		 jl	 $LN224@Attack

; 1181 : 	{
; 1182 : 		if ( lpObj->Type == OBJ_USER && lpTargetObj->Type == OBJ_USER )

  00d0e	0f b7 46 68	 movzx	 eax, WORD PTR [esi+104]
  00d12	83 f8 01	 cmp	 eax, 1
  00d15	0f 85 b8 00 00
	00		 jne	 $LN42@Attack
  00d1b	3b c8		 cmp	 ecx, eax
  00d1d	0f 85 b0 00 00
	00		 jne	 $LN42@Attack

; 1183 : 		{
; 1184 : 			if ( gObjDuelCheck(lpObj, lpTargetObj) )

  00d23	57		 push	 edi
  00d24	56		 push	 esi
  00d25	e8 00 00 00 00	 call	 ?gObjDuelCheck@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjDuelCheck
  00d2a	83 c4 08	 add	 esp, 8
  00d2d	85 c0		 test	 eax, eax

; 1185 : 			{
; 1186 : 				selfdefense = 0;

  00d2f	75 39		 jne	 SHORT $LN222@Attack

; 1187 : 			}
; 1188 : 			else if ( CC_MAP_RANGE(lpObj->MapNumber) || CC_MAP_RANGE(lpTargetObj->MapNumber) )

  00d31	0f b6 86 49 01
	00 00		 movzx	 eax, BYTE PTR [esi+329]
  00d38	3c 35		 cmp	 al, 53			; 00000035H
  00d3a	74 2e		 je	 SHORT $LN222@Attack
  00d3c	3c 12		 cmp	 al, 18			; 00000012H
  00d3e	72 09		 jb	 SHORT $LN221@Attack
  00d40	b2 17		 mov	 dl, 23			; 00000017H
  00d42	3a d0		 cmp	 dl, al
  00d44	1b c0		 sbb	 eax, eax
  00d46	40		 inc	 eax
  00d47	75 21		 jne	 SHORT $LN222@Attack
$LN221@Attack:
  00d49	0f b6 87 49 01
	00 00		 movzx	 eax, BYTE PTR [edi+329]
  00d50	3c 35		 cmp	 al, 53			; 00000035H
  00d52	74 16		 je	 SHORT $LN222@Attack
  00d54	3c 12		 cmp	 al, 18			; 00000012H
  00d56	72 09		 jb	 SHORT $LN207@Attack
  00d58	b1 17		 mov	 cl, 23			; 00000017H
  00d5a	3a c8		 cmp	 cl, al
  00d5c	1b c0		 sbb	 eax, eax
  00d5e	40		 inc	 eax
  00d5f	75 09		 jne	 SHORT $LN222@Attack
$LN207@Attack:

; 1191 : 			}
; 1192 : 			else
; 1193 : 			{
; 1194 : 				selfdefense = 1;

  00d61	c7 45 14 01 00
	00 00		 mov	 DWORD PTR _selfdefense$[ebp], 1
  00d68	eb 07		 jmp	 SHORT $LN37@Attack
$LN222@Attack:

; 1189 : 			{
; 1190 : 				selfdefense = 0;

  00d6a	c7 45 14 00 00
	00 00		 mov	 DWORD PTR _selfdefense$[ebp], 0
$LN37@Attack:

; 1195 : 			}
; 1196 : 			if ( gObjGetRelationShip(lpObj, lpTargetObj) == 2 )

  00d71	57		 push	 edi
  00d72	56		 push	 esi
  00d73	e8 00 00 00 00	 call	 ?gObjGetRelationShip@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjGetRelationShip
  00d78	83 c4 08	 add	 esp, 8
  00d7b	83 f8 02	 cmp	 eax, 2
  00d7e	75 07		 jne	 SHORT $LN223@Attack

; 1197 : 			{
; 1198 : 				selfdefense = FALSE;

  00d80	c7 45 14 00 00
	00 00		 mov	 DWORD PTR _selfdefense$[ebp], 0
$LN223@Attack:

; 1199 : 			}
; 1200 : //#if(GS_CASTLE==1)
; 1201 : 			if ( g_CastleSiege.GetCastleState() == CASTLESIEGE_STATE_STARTSIEGE)

  00d87	83 3d 28 00 00
	00 07		 cmp	 DWORD PTR ?g_CastleSiege@@3VCCastleSiege@@A+40, 7
  00d8e	75 12		 jne	 SHORT $LN35@Attack

; 1202 : 			{
; 1203 : 				if( lpObj->m_btCsJoinSide > 0 )

  00d90	80 be 02 1c 00
	00 00		 cmp	 BYTE PTR [esi+7170], 0
  00d97	76 50		 jbe	 SHORT $LN28@Attack

; 1204 : 				{
; 1205 : 					selfdefense = FALSE;

  00d99	c7 45 14 00 00
	00 00		 mov	 DWORD PTR _selfdefense$[ebp], 0

; 1206 : 				}
; 1207 : 			}

  00da0	eb 47		 jmp	 SHORT $LN28@Attack
$LN35@Attack:

; 1208 : //#endif
; 1209 : 			else if ( IT_MAP_RANGE(lpObj->MapNumber) || IT_MAP_RANGE(lpTargetObj->MapNumber) ) //season 2.5 add-on

  00da2	0f b6 86 49 01
	00 00		 movzx	 eax, BYTE PTR [esi+329]
  00da9	3c 2d		 cmp	 al, 45			; 0000002dH
  00dab	72 09		 jb	 SHORT $LN208@Attack
  00dad	b2 32		 mov	 dl, 50			; 00000032H
  00daf	3a d0		 cmp	 dl, al
  00db1	1b c0		 sbb	 eax, eax
  00db3	40		 inc	 eax
  00db4	75 14		 jne	 SHORT $LN31@Attack
$LN208@Attack:
  00db6	0f b6 87 49 01
	00 00		 movzx	 eax, BYTE PTR [edi+329]
  00dbd	3c 2d		 cmp	 al, 45			; 0000002dH
  00dbf	72 28		 jb	 SHORT $LN28@Attack
  00dc1	b1 32		 mov	 cl, 50			; 00000032H
  00dc3	3a c8		 cmp	 cl, al
  00dc5	1b c0		 sbb	 eax, eax
  00dc7	40		 inc	 eax
  00dc8	74 1f		 je	 SHORT $LN28@Attack
$LN31@Attack:

; 1210 : 			{
; 1211 : 				selfdefense = 0;

  00dca	c7 45 14 00 00
	00 00		 mov	 DWORD PTR _selfdefense$[ebp], 0

; 1212 : 			}
; 1213 : 		}

  00dd1	eb 16		 jmp	 SHORT $LN28@Attack
$LN42@Attack:

; 1214 : 		else if ( lpTargetObj->Type == OBJ_MONSTER && lpObj->Type == OBJ_USER )

  00dd3	83 f9 02	 cmp	 ecx, 2
  00dd6	75 11		 jne	 SHORT $LN28@Attack
  00dd8	83 f8 01	 cmp	 eax, 1
  00ddb	75 0c		 jne	 SHORT $LN28@Attack

; 1215 : 		{
; 1216 : 			if ( lpTargetObj->m_RecallMon >= 0 )

  00ddd	83 bf 50 04 00
	00 00		 cmp	 DWORD PTR [edi+1104], 0
  00de4	7c 03		 jl	 SHORT $LN28@Attack

; 1217 : 			{
; 1218 : 				selfdefense = TRUE;

  00de6	89 45 14	 mov	 DWORD PTR _selfdefense$[ebp], eax
$LN28@Attack:

; 1219 : 			}
; 1220 : 		}
; 1221 : 
; 1222 : 		if ( lpTargetObj->Type == OBJ_USER )

  00de9	66 83 7f 68 01	 cmp	 WORD PTR [edi+104], 1
  00dee	75 0a		 jne	 SHORT $LN27@Attack

; 1223 : 		{
; 1224 : 			gObjArmorRandomDurDown(lpTargetObj, lpObj);

  00df0	56		 push	 esi
  00df1	57		 push	 edi
  00df2	e8 00 00 00 00	 call	 ?gObjArmorRandomDurDown@@YAXPAUOBJECTSTRUCT@@0@Z ; gObjArmorRandomDurDown
  00df7	83 c4 08	 add	 esp, 8
$LN27@Attack:

; 1225 : 		}
; 1226 : 
; 1227 : 		if(gObjSearchActiveEffect(lpTargetObj, AT_ICE_ARROW) == 1)

  00dfa	6a 39		 push	 57			; 00000039H
  00dfc	57		 push	 edi
  00dfd	e8 00 00 00 00	 call	 ?gObjSearchActiveEffect@@YAEPAUOBJECTSTRUCT@@H@Z ; gObjSearchActiveEffect
  00e02	83 c4 08	 add	 esp, 8
  00e05	3c 01		 cmp	 al, 1
  00e07	75 13		 jne	 SHORT $LN224@Attack

; 1228 : 		{
; 1229 : 			gObjRemoveBuffEffect(lpTargetObj, AT_ICE_ARROW);

  00e09	6a 39		 push	 57			; 00000039H
  00e0b	57		 push	 edi
  00e0c	e8 00 00 00 00	 call	 ?gObjRemoveBuffEffect@@YAEPAUOBJECTSTRUCT@@H@Z ; gObjRemoveBuffEffect

; 1230 : 			GCMagicCancelSend(lpTargetObj, 51);

  00e11	6a 33		 push	 51			; 00000033H
  00e13	57		 push	 edi
  00e14	e8 00 00 00 00	 call	 ?GCMagicCancelSend@@YAXPAUOBJECTSTRUCT@@G@Z ; GCMagicCancelSend
  00e19	83 c4 10	 add	 esp, 16			; 00000010H
$LN224@Attack:

; 1231 : 		}
; 1232 : 	}
; 1233 : 
; 1234 : 	if(lpObj->PartyNumber >= 0) //Season 2.5 add-on

  00e1c	8b 8e 2c 04 00
	00		 mov	 ecx, DWORD PTR [esi+1068]
  00e22	85 c9		 test	 ecx, ecx
  00e24	78 11		 js	 SHORT $LN23@Attack

; 1235 : 	{
; 1236 : 		if(lpCallObj->PartyNumber >= 0)

  00e26	8b 55 08	 mov	 edx, DWORD PTR _lpCallObj$[ebp]
  00e29	8b 82 2c 04 00
	00		 mov	 eax, DWORD PTR [edx+1068]
  00e2f	85 c0		 test	 eax, eax
  00e31	78 04		 js	 SHORT $LN23@Attack

; 1237 : 		{
; 1238 : 			if(lpObj->PartyNumber == lpCallObj->PartyNumber)

  00e33	3b c8		 cmp	 ecx, eax

; 1239 : 			{
; 1240 : 				selfdefense = FALSE;
; 1241 : 			}
; 1242 : 		}
; 1243 : 
; 1244 : 	}
; 1245 : 
; 1246 : 	if ( selfdefense == TRUE )

  00e35	74 52		 je	 SHORT $LN225@Attack
$LN23@Attack:
  00e37	83 7d 14 01	 cmp	 DWORD PTR _selfdefense$[ebp], 1
  00e3b	75 4c		 jne	 SHORT $LN225@Attack

; 1247 : 	{
; 1248 : 		if ( !gObjTargetGuildWarCheck(lpObj, lpCallObj) )

  00e3d	8b 45 08	 mov	 eax, DWORD PTR _lpCallObj$[ebp]
  00e40	50		 push	 eax
  00e41	56		 push	 esi
  00e42	e8 00 00 00 00	 call	 ?gObjTargetGuildWarCheck@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjTargetGuildWarCheck
  00e47	83 c4 08	 add	 esp, 8
  00e4a	85 c0		 test	 eax, eax
  00e4c	75 3b		 jne	 SHORT $LN225@Attack

; 1249 : 		{
; 1250 : 
; 1251 : 			if(ZtConfig.PvP.ZtPkPartySystem && lpCallObj->PartyNumber >= 0) //Season 2.5 add-on

  00e4e	39 05 38 09 00
	00		 cmp	 DWORD PTR ?ZtConfig@@3VcZtConfigs@@A+2360, eax
  00e54	74 24		 je	 SHORT $LN20@Attack
  00e56	8b 4d 08	 mov	 ecx, DWORD PTR _lpCallObj$[ebp]
  00e59	8b 81 2c 04 00
	00		 mov	 eax, DWORD PTR [ecx+1068]
  00e5f	85 c0		 test	 eax, eax
  00e61	78 17		 js	 SHORT $LN20@Attack

; 1252 : 			{
; 1253 : 				//season3 removed party for LOL
; 1254 : 				int number = 0;
; 1255 : 				int partynum = lpCallObj->PartyNumber;
; 1256 : 				
; 1257 : 				if( (gParty.GetPkLevel(partynum)) < 5)

  00e63	50		 push	 eax
  00e64	b9 00 00 00 00	 mov	 ecx, OFFSET ?gParty@@3VPartyClass@@A ; gParty
  00e69	e8 00 00 00 00	 call	 ?GetPkLevel@PartyClass@@QAEDH@Z ; PartyClass::GetPkLevel
  00e6e	3c 05		 cmp	 al, 5
  00e70	7d 17		 jge	 SHORT $LN225@Attack

; 1258 : 				{
; 1259 : 					gObjCheckSelfDefense(lpObj, lpCallObj->m_Index);

  00e72	8b 55 08	 mov	 edx, DWORD PTR _lpCallObj$[ebp]
  00e75	8b 02		 mov	 eax, DWORD PTR [edx]
  00e77	50		 push	 eax

; 1260 : 				}	
; 1261 : 			}
; 1262 : 			else

  00e78	eb 06		 jmp	 SHORT $LN314@Attack
$LN20@Attack:

; 1263 : 			{
; 1264 : 				gObjCheckSelfDefense(lpObj, lpCallObj->m_Index);

  00e7a	8b 4d 08	 mov	 ecx, DWORD PTR _lpCallObj$[ebp]
  00e7d	8b 11		 mov	 edx, DWORD PTR [ecx]
  00e7f	52		 push	 edx
$LN314@Attack:
  00e80	56		 push	 esi
  00e81	e8 00 00 00 00	 call	 ?gObjCheckSelfDefense@@YAXPAUOBJECTSTRUCT@@H@Z ; gObjCheckSelfDefense
  00e86	83 c4 08	 add	 esp, 8
$LN225@Attack:

; 1265 : 			}
; 1266 : 		}
; 1267 : 	}
; 1268 : 
; 1269 : 	if ( AttackDamage >= 5 )

  00e89	83 fb 05	 cmp	 ebx, 5
  00e8c	7c 52		 jl	 SHORT $LN226@Attack

; 1270 : 	{
; 1271 : 		if ( lpTargetObj->Type == OBJ_MONSTER )

  00e8e	66 83 7f 68 02	 cmp	 WORD PTR [edi+104], 2
  00e93	75 24		 jne	 SHORT $LN16@Attack

; 1272 : 		{
; 1273 : 			if ( (rand()%26) == 0 )

  00e95	e8 00 00 00 00	 call	 _rand
  00e9a	99		 cdq
  00e9b	b9 1a 00 00 00	 mov	 ecx, 26			; 0000001aH
  00ea0	f7 f9		 idiv	 ecx
  00ea2	85 d2		 test	 edx, edx
  00ea4	75 3a		 jne	 SHORT $LN226@Attack

; 1274 : 			{
; 1275 : 				gObjAddMsgSendDelay(lpTargetObj,4, lpObj->m_Index, 100, 0);

  00ea6	52		 push	 edx
  00ea7	8b 16		 mov	 edx, DWORD PTR [esi]
  00ea9	6a 64		 push	 100			; 00000064H
  00eab	52		 push	 edx
  00eac	6a 04		 push	 4
  00eae	57		 push	 edi
  00eaf	e8 00 00 00 00	 call	 ?gObjAddMsgSendDelay@@YAXPAUOBJECTSTRUCT@@HHHH@Z ; gObjAddMsgSendDelay
  00eb4	83 c4 14	 add	 esp, 20			; 00000014H

; 1276 : 			}
; 1277 : 		}

  00eb7	eb 27		 jmp	 SHORT $LN226@Attack
$LN16@Attack:

; 1278 : 		else if ( (rand()%4) == 0 )

  00eb9	e8 00 00 00 00	 call	 _rand
  00ebe	25 03 00 00 80	 and	 eax, -2147483645	; 80000003H
  00ec3	79 05		 jns	 SHORT $LN308@Attack
  00ec5	48		 dec	 eax
  00ec6	83 c8 fc	 or	 eax, -4			; fffffffcH
  00ec9	40		 inc	 eax
$LN308@Attack:
  00eca	75 14		 jne	 SHORT $LN226@Attack

; 1279 : 		{
; 1280 : 			if ( !gObjUniriaSprite(lpTargetObj) )

  00ecc	57		 push	 edi
  00ecd	e8 00 00 00 00	 call	 ?gObjUniriaSprite@@YAHPAUOBJECTSTRUCT@@@Z ; gObjUniriaSprite
  00ed2	83 c4 04	 add	 esp, 4
  00ed5	85 c0		 test	 eax, eax
  00ed7	75 07		 jne	 SHORT $LN226@Attack

; 1281 : 			{
; 1282 : 				MSBFlag = 1;

  00ed9	c7 45 10 01 00
	00 00		 mov	 DWORD PTR _MSBFlag$[ebp], 1
$LN226@Attack:

; 1283 : 			}
; 1284 : 		}
; 1285 : 	}
; 1286 : 
; 1287 : 	if ( ManaChange )

  00ee0	83 7d f0 00	 cmp	 DWORD PTR _ManaChange$[ebp], 0
  00ee4	74 25		 je	 SHORT $LN11@Attack

; 1288 : 	{
; 1289 : 		GCManaSend(lpTargetObj->m_Index, lpTargetObj->Mana, 0xFF, 0, lpTargetObj->BP);

  00ee6	8b 87 28 01 00
	00		 mov	 eax, DWORD PTR [edi+296]
  00eec	d9 87 10 01 00
	00		 fld	 DWORD PTR [edi+272]
  00ef2	50		 push	 eax
  00ef3	6a 00		 push	 0
  00ef5	68 ff 00 00 00	 push	 255			; 000000ffH
  00efa	e8 00 00 00 00	 call	 __ftol2_sse
  00eff	8b 0f		 mov	 ecx, DWORD PTR [edi]
  00f01	50		 push	 eax
  00f02	51		 push	 ecx
  00f03	e8 00 00 00 00	 call	 ?GCManaSend@@YAXHHEEH@Z	; GCManaSend
  00f08	83 c4 14	 add	 esp, 20			; 00000014H
$LN11@Attack:

; 1290 : 	}
; 1291 : 
; 1292 : 	if ( lpObj->Type == OBJ_USER )

  00f0b	66 83 7e 68 01	 cmp	 WORD PTR [esi+104], 1
  00f10	75 19		 jne	 SHORT $LN9@Attack

; 1293 : 	{
; 1294 : 		if ( lpObj->m_Change == 9 )

  00f12	83 be 54 04 00
	00 09		 cmp	 DWORD PTR [esi+1108], 9
  00f19	75 10		 jne	 SHORT $LN9@Attack

; 1295 : 		{
; 1296 : 			GCMagicAttackNumberSend(lpObj, 3, lpTargetObj->m_Index, 1);

  00f1b	8b 17		 mov	 edx, DWORD PTR [edi]
  00f1d	6a 01		 push	 1
  00f1f	52		 push	 edx
  00f20	6a 03		 push	 3
  00f22	56		 push	 esi
  00f23	e8 00 00 00 00	 call	 ?GCMagicAttackNumberSend@@YAXPAUOBJECTSTRUCT@@GHE@Z ; GCMagicAttackNumberSend
  00f28	83 c4 10	 add	 esp, 16			; 00000010H
$LN9@Attack:

; 1297 : 		}
; 1298 : 	}
; 1299 : 
; 1300 : 	lpObj->m_Rest = 0;

  00f2b	c6 86 25 02 00
	00 00		 mov	 BYTE PTR [esi+549], 0

; 1301 : 
; 1302 : 	if ( AttackDamage > 0 )

  00f32	85 db		 test	 ebx, ebx
  00f34	7e 7b		 jle	 SHORT $LN8@Attack

; 1303 : 	{
; 1304 : 		int atd_reflect = (int)((float)AttackDamage * lpTargetObj->DamageReflect / 100.0f);

  00f36	0f b6 87 71 01
	00 00		 movzx	 eax, BYTE PTR [edi+369]
  00f3d	89 45 14	 mov	 DWORD PTR tv1305[ebp], eax
  00f40	db 45 14	 fild	 DWORD PTR tv1305[ebp]
  00f43	da 4d 0c	 fimul	 DWORD PTR _AttackDamage$[ebp]
  00f46	dc 35 00 00 00
	00		 fdiv	 QWORD PTR __real@4059000000000000
  00f4c	e8 00 00 00 00	 call	 __ftol2_sse

; 1305 : 
; 1306 : 		if ( atd_reflect )

  00f51	85 c0		 test	 eax, eax
  00f53	74 11		 je	 SHORT $LN7@Attack

; 1307 : 		{
; 1308 : 			gObjAddMsgSendDelay(lpTargetObj, 10, lpObj->m_Index, 10, atd_reflect);

  00f55	8b 0e		 mov	 ecx, DWORD PTR [esi]
  00f57	50		 push	 eax
  00f58	6a 0a		 push	 10			; 0000000aH
  00f5a	51		 push	 ecx
  00f5b	6a 0a		 push	 10			; 0000000aH
  00f5d	57		 push	 edi
  00f5e	e8 00 00 00 00	 call	 ?gObjAddMsgSendDelay@@YAXPAUOBJECTSTRUCT@@HHHH@Z ; gObjAddMsgSendDelay
  00f63	83 c4 14	 add	 esp, 20			; 00000014H
$LN7@Attack:

; 1309 : 		}
; 1310 : 
; 1311 : 		if ( (rand()%100) < lpObj->SetOpReflectionDamage )

  00f66	e8 00 00 00 00	 call	 _rand
  00f6b	99		 cdq
  00f6c	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  00f71	f7 f9		 idiv	 ecx
  00f73	0f b6 86 42 11
	00 00		 movzx	 eax, BYTE PTR [esi+4418]
  00f7a	3b d0		 cmp	 edx, eax
  00f7c	7d 11		 jge	 SHORT $LN6@Attack

; 1312 : 		{
; 1313 : 			gObjAddMsgSendDelay(lpTargetObj, 10, lpObj->m_Index, 10, AttackDamage);

  00f7e	8b 0e		 mov	 ecx, DWORD PTR [esi]
  00f80	53		 push	 ebx
  00f81	6a 0a		 push	 10			; 0000000aH
  00f83	51		 push	 ecx
  00f84	6a 0a		 push	 10			; 0000000aH
  00f86	57		 push	 edi
  00f87	e8 00 00 00 00	 call	 ?gObjAddMsgSendDelay@@YAXPAUOBJECTSTRUCT@@HHHH@Z ; gObjAddMsgSendDelay
  00f8c	83 c4 14	 add	 esp, 20			; 00000014H
$LN6@Attack:

; 1314 : 		}
; 1315 : 
; 1316 : 		AttackDamage -= iTotalShieldDamage;
; 1317 : 
; 1318 : 		gObjLifeCheck(lpTargetObj, lpObj, AttackDamage, 0, MSBFlag, MsgDamage, skill, iTotalShieldDamage);

  00f8f	8b 45 ec	 mov	 eax, DWORD PTR _iTotalShieldDamage$[ebp]
  00f92	8b 55 f8	 mov	 edx, DWORD PTR _skill$[ebp]
  00f95	0f b6 4d ff	 movzx	 ecx, BYTE PTR _MsgDamage$[ebp]
  00f99	50		 push	 eax
  00f9a	52		 push	 edx
  00f9b	8b 55 10	 mov	 edx, DWORD PTR _MSBFlag$[ebp]
  00f9e	51		 push	 ecx
  00f9f	52		 push	 edx
  00fa0	6a 00		 push	 0
  00fa2	2b d8		 sub	 ebx, eax
  00fa4	53		 push	 ebx
  00fa5	56		 push	 esi
  00fa6	57		 push	 edi
  00fa7	e8 00 00 00 00	 call	 ?gObjLifeCheck@@YAXPAUOBJECTSTRUCT@@0HHHHGH@Z ; gObjLifeCheck
  00fac	83 c4 20	 add	 esp, 32			; 00000020H

; 1319 : 	}
; 1320 : 	else

  00faf	eb 19		 jmp	 SHORT $LN5@Attack
$LN8@Attack:

; 1321 : 	{
; 1322 : 		GCDamageSend(lpObj->m_Index, lpTargetObj->m_Index, 0, 0, MsgDamage, 0);

  00fb1	0f b6 45 ff	 movzx	 eax, BYTE PTR _MsgDamage$[ebp]
  00fb5	8b 0f		 mov	 ecx, DWORD PTR [edi]
  00fb7	8b 16		 mov	 edx, DWORD PTR [esi]
  00fb9	6a 00		 push	 0
  00fbb	50		 push	 eax
  00fbc	6a 00		 push	 0
  00fbe	6a 00		 push	 0
  00fc0	51		 push	 ecx
  00fc1	52		 push	 edx
  00fc2	e8 00 00 00 00	 call	 ?GCDamageSend@@YAXHHHHHH@Z ; GCDamageSend
  00fc7	83 c4 18	 add	 esp, 24			; 00000018H
$LN5@Attack:

; 1323 : 	}
; 1324 : 
; 1325 : 	if ( lpObj->Life <= 0.0f && lpObj->Type == OBJ_USER )

  00fca	d9 ee		 fldz
  00fcc	d8 9e fc 00 00
	00		 fcomp	 DWORD PTR [esi+252]
  00fd2	df e0		 fnstsw	 ax
  00fd4	f6 c4 01	 test	 ah, 1
  00fd7	75 31		 jne	 SHORT $LN227@Attack
  00fd9	b8 01 00 00 00	 mov	 eax, 1
  00fde	66 39 46 68	 cmp	 WORD PTR [esi+104], ax
  00fe2	75 26		 jne	 SHORT $LN227@Attack

; 1326 : 	{
; 1327 : 		if ( lpObj->m_CheckLifeTime <= 0 )

  00fe4	83 be d4 10 00
	00 00		 cmp	 DWORD PTR [esi+4308], 0
  00feb	7f 1d		 jg	 SHORT $LN227@Attack

; 1328 : 		{
; 1329 : 			lpObj->lpAttackObj = lpTargetObj;

  00fed	89 be d4 03 00
	00		 mov	 DWORD PTR [esi+980], edi

; 1330 : 
; 1331 : 			if ( lpTargetObj->Type == OBJ_USER )

  00ff3	66 39 47 68	 cmp	 WORD PTR [edi+104], ax

; 1332 : 			{
; 1333 : 				lpObj->m_bAttackerKilled = true;
; 1334 : 			}
; 1335 : 			else
; 1336 : 			{
; 1337 : 				lpObj->m_bAttackerKilled = false;
; 1338 : 			}
; 1339 : 
; 1340 : 			lpObj->m_CheckLifeTime = 3;

  00ff7	c7 86 d4 10 00
	00 03 00 00 00	 mov	 DWORD PTR [esi+4308], 3
  01001	0f 94 c0	 sete	 al
  01004	88 86 e0 03 00
	00		 mov	 BYTE PTR [esi+992], al
$LN227@Attack:

; 1341 : 		}
; 1342 : 	}
; 1343 : 
; 1344 : 	return TRUE;

  0100a	5e		 pop	 esi
  0100b	5f		 pop	 edi
  0100c	b8 01 00 00 00	 mov	 eax, 1
  01011	5b		 pop	 ebx

; 1345 : }

  01012	8b e5		 mov	 esp, ebp
  01014	5d		 pop	 ebp
  01015	c2 14 00	 ret	 20			; 00000014H
?Attack@CDarkSpirit@@QAEHPAUOBJECTSTRUCT@@0PAVCMagicInf@@HH@Z ENDP ; CDarkSpirit::Attack
_TEXT	ENDS
PUBLIC	?ChangeCommand@CDarkSpirit@@QAEXHH@Z		; CDarkSpirit::ChangeCommand
; Function compile flags: /Ogtp
;	COMDAT ?ChangeCommand@CDarkSpirit@@QAEXHH@Z
_TEXT	SEGMENT
_command$ = 8						; size = 4
_targetindex$ = 12					; size = 4
?ChangeCommand@CDarkSpirit@@QAEXHH@Z PROC		; CDarkSpirit::ChangeCommand, COMDAT
; _this$ = ecx

; 1608 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 1609 : 	CDarkSpirit::ePetItem_Mode setmode = PetItem_Mode_Normal;
; 1610 : 
; 1611 : 	if ( command == PetItem_Mode_Normal )

  00003	8b 55 08	 mov	 edx, DWORD PTR _command$[ebp]
  00006	33 c0		 xor	 eax, eax
  00008	85 d2		 test	 edx, edx
  0000a	75 0e		 jne	 SHORT $LN7@ChangeComm

; 1626 : 	}
; 1627 : 
; 1628 : 	this->SetMode(setmode, targetindex);

  0000c	8b 55 0c	 mov	 edx, DWORD PTR _targetindex$[ebp]
  0000f	52		 push	 edx
  00010	50		 push	 eax
  00011	e8 00 00 00 00	 call	 ?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z ; CDarkSpirit::SetMode

; 1629 : }

  00016	5d		 pop	 ebp
  00017	c2 08 00	 ret	 8
$LN7@ChangeComm:

; 1612 : 	{
; 1613 : 		setmode = PetItem_Mode_Normal;
; 1614 : 	}
; 1615 : 	else if ( command == PetItem_Mode_Attack_Random )

  0001a	83 fa 01	 cmp	 edx, 1
  0001d	75 10		 jne	 SHORT $LN5@ChangeComm

; 1616 : 	{
; 1617 : 		setmode = PetItem_Mode_Attack_Random;

  0001f	8b c2		 mov	 eax, edx

; 1626 : 	}
; 1627 : 
; 1628 : 	this->SetMode(setmode, targetindex);

  00021	8b 55 0c	 mov	 edx, DWORD PTR _targetindex$[ebp]
  00024	52		 push	 edx
  00025	50		 push	 eax
  00026	e8 00 00 00 00	 call	 ?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z ; CDarkSpirit::SetMode

; 1629 : }

  0002b	5d		 pop	 ebp
  0002c	c2 08 00	 ret	 8
$LN5@ChangeComm:

; 1618 : 	}
; 1619 : 	else if ( command == PetItem_Mode_Attack_WithMaster )

  0002f	83 fa 02	 cmp	 edx, 2
  00032	75 10		 jne	 SHORT $LN3@ChangeComm

; 1620 : 	{
; 1621 : 		setmode = PetItem_Mode_Attack_WithMaster;

  00034	8b c2		 mov	 eax, edx

; 1626 : 	}
; 1627 : 
; 1628 : 	this->SetMode(setmode, targetindex);

  00036	8b 55 0c	 mov	 edx, DWORD PTR _targetindex$[ebp]
  00039	52		 push	 edx
  0003a	50		 push	 eax
  0003b	e8 00 00 00 00	 call	 ?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z ; CDarkSpirit::SetMode

; 1629 : }

  00040	5d		 pop	 ebp
  00041	c2 08 00	 ret	 8
$LN3@ChangeComm:

; 1622 : 	}
; 1623 : 	else if ( command == PetItem_Mode_Attack_Target )

  00044	83 fa 03	 cmp	 edx, 3
  00047	75 02		 jne	 SHORT $LN1@ChangeComm

; 1624 : 	{
; 1625 : 		setmode = PetItem_Mode_Attack_Target;

  00049	8b c2		 mov	 eax, edx
$LN1@ChangeComm:

; 1626 : 	}
; 1627 : 
; 1628 : 	this->SetMode(setmode, targetindex);

  0004b	8b 55 0c	 mov	 edx, DWORD PTR _targetindex$[ebp]
  0004e	52		 push	 edx
  0004f	50		 push	 eax
  00050	e8 00 00 00 00	 call	 ?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z ; CDarkSpirit::SetMode

; 1629 : }

  00055	5d		 pop	 ebp
  00056	c2 08 00	 ret	 8
?ChangeCommand@CDarkSpirit@@QAEXHH@Z ENDP		; CDarkSpirit::ChangeCommand
_TEXT	ENDS
PUBLIC	_this$GSCopy$
PUBLIC	__$ArrayPad$
PUBLIC	?ModeAttackRandom@CDarkSpirit@@QAEXXZ		; CDarkSpirit::ModeAttackRandom
; Function compile flags: /Ogtp
;	COMDAT ?ModeAttackRandom@CDarkSpirit@@QAEXXZ
_TEXT	SEGMENT
_DuelIndex$ = -332					; size = 4
_this$GSCopy$ = -328					; size = 4
tv566 = -324						; size = 8
tv558 = -324						; size = 8
tv464 = -320						; size = 4
_criticaldamage$ = -316					; size = 4
_FindObjCount$ = -312					; size = 4
tv495 = -308						; size = 4
tv483 = -308						; size = 4
tv79 = -308						; size = 4
_FindObj$ = -304					; size = 300
__$ArrayPad$ = -4					; size = 4
?ModeAttackRandom@CDarkSpirit@@QAEXXZ PROC		; CDarkSpirit::ModeAttackRandom, COMDAT
; _this$ = ecx

; 121  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 4c 01 00
	00		 sub	 esp, 332		; 0000014cH
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	53		 push	 ebx
  00014	56		 push	 esi

; 122  : 	LPOBJ lpObj = &gObj[this->m_iMasterIndex];

  00015	8b 71 14	 mov	 esi, DWORD PTR [ecx+20]
  00018	69 f6 50 2b 00
	00		 imul	 esi, 11088		; 00002b50H
  0001e	03 35 00 00 00
	00		 add	 esi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj

; 123  : 	int tObjNum;
; 124  : 	int count = 0;
; 125  : 	int FindObj[MAX_VIEWPORT];
; 126  : 	int FindObjCount = 0;

  00024	89 8d b8 fe ff
	ff		 mov	 DWORD PTR _this$GSCopy$[ebp], ecx

; 127  : 	int dis;
; 128  : 	int DuelIndex = lpObj->m_iDuelUser;

  0002a	8b 8e b8 0e 00
	00		 mov	 ecx, DWORD PTR [esi+3768]
  00030	33 c0		 xor	 eax, eax

; 129  : 	BOOL EnableAttack;
; 130  : 	int criticaldamage = 0;
; 131  : 
; 132  : 	if( 30 + lpObj->m_MPSkillOpt.MpsDarkSpiritStr2 > rand() % 100 )

  00032	d9 86 08 27 00
	00		 fld	 DWORD PTR [esi+9992]
  00038	57		 push	 edi
  00039	dc 05 00 00 00
	00		 fadd	 QWORD PTR __real@403e000000000000
  0003f	89 85 c8 fe ff
	ff		 mov	 DWORD PTR _FindObjCount$[ebp], eax
  00045	89 8d b4 fe ff
	ff		 mov	 DWORD PTR _DuelIndex$[ebp], ecx
  0004b	89 85 c4 fe ff
	ff		 mov	 DWORD PTR _criticaldamage$[ebp], eax
  00051	dd 9d bc fe ff
	ff		 fstp	 QWORD PTR tv566[ebp]
  00057	e8 00 00 00 00	 call	 _rand
  0005c	99		 cdq
  0005d	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  00062	f7 f9		 idiv	 ecx
  00064	89 95 cc fe ff
	ff		 mov	 DWORD PTR tv495[ebp], edx
  0006a	db 85 cc fe ff
	ff		 fild	 DWORD PTR tv495[ebp]
  00070	dc 9d bc fe ff
	ff		 fcomp	 QWORD PTR tv566[ebp]
  00076	df e0		 fnstsw	 ax
  00078	f6 c4 05	 test	 ah, 5
  0007b	7a 0a		 jp	 SHORT $LN35@ModeAttack

; 133  : 	{
; 134  : 		criticaldamage	= 1;

  0007d	c7 85 c4 fe ff
	ff 01 00 00 00	 mov	 DWORD PTR _criticaldamage$[ebp], 1
$LN35@ModeAttack:

; 135  : 		//iActionType		= 1;	
; 136  : 	}
; 137  : 	// ----
; 138  : 	if( 30 + lpObj->m_MPSkillOpt.MpsDarkSpiritStr3 > rand() % 100 )

  00087	d9 86 0c 27 00
	00		 fld	 DWORD PTR [esi+9996]
  0008d	dc 05 00 00 00
	00		 fadd	 QWORD PTR __real@403e000000000000
  00093	dd 9d bc fe ff
	ff		 fstp	 QWORD PTR tv558[ebp]
  00099	e8 00 00 00 00	 call	 _rand
  0009e	99		 cdq
  0009f	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  000a4	f7 f9		 idiv	 ecx
  000a6	89 95 cc fe ff
	ff		 mov	 DWORD PTR tv483[ebp], edx
  000ac	db 85 cc fe ff
	ff		 fild	 DWORD PTR tv483[ebp]
  000b2	dc 9d bc fe ff
	ff		 fcomp	 QWORD PTR tv558[ebp]
  000b8	df e0		 fnstsw	 ax
  000ba	f6 c4 05	 test	 ah, 5
  000bd	7a 0a		 jp	 SHORT $LN30@ModeAttack

; 139  : 	{
; 140  : 		criticaldamage	= 2;

  000bf	c7 85 c4 fe ff
	ff 02 00 00 00	 mov	 DWORD PTR _criticaldamage$[ebp], 2
$LN30@ModeAttack:

; 141  : 		//iActionType		= 1;
; 142  : 	}
; 143  : 
; 144  : 	while ( true )
; 145  : 	{
; 146  : 		if ( lpObj->VpPlayer2[count].state != 0 )

  000c9	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  000cf	8d 86 b0 08 00
	00		 lea	 eax, DWORD PTR [esi+2224]
  000d5	89 85 c0 fe ff
	ff		 mov	 DWORD PTR tv464[ebp], eax
  000db	c7 85 cc fe ff
	ff 4b 00 00 00	 mov	 DWORD PTR tv79[ebp], 75	; 0000004bH
$LL21@ModeAttack:
  000e5	80 78 fc 00	 cmp	 BYTE PTR [eax-4], 0
  000e9	0f 84 c8 00 00
	00		 je	 $LN36@ModeAttack

; 147  : 		{
; 148  : 			if ( lpObj->VpPlayer2[count].type == OBJ_MONSTER )

  000ef	80 38 02	 cmp	 BYTE PTR [eax], 2
  000f2	0f 85 bf 00 00
	00		 jne	 $LN36@ModeAttack

; 149  : 			{
; 150  : 				tObjNum = lpObj->VpPlayer2[count].number;

  000f8	0f bf 58 fe	 movsx	 ebx, WORD PTR [eax-2]

; 151  : 
; 152  : 				if ( tObjNum >= 0 )

  000fc	85 db		 test	 ebx, ebx
  000fe	0f 88 b3 00 00
	00		 js	 $LN36@ModeAttack

; 153  : 				{
; 154  : 					EnableAttack = FALSE;
; 155  : 
; 156  : 					if ( gObj[tObjNum].Life > 0.0f && (gObj[tObjNum].Class < 100 || gObj[tObjNum].Class  > 110 ) )

  00104	d9 ee		 fldz
  00106	8b fb		 mov	 edi, ebx
  00108	69 ff 50 2b 00
	00		 imul	 edi, 11088		; 00002b50H
  0010e	d8 9c 0f fc 00
	00 00		 fcomp	 DWORD PTR [edi+ecx+252]
  00115	df e0		 fnstsw	 ax
  00117	f6 c4 05	 test	 ah, 5
  0011a	0f 8a 97 00 00
	00		 jp	 $LN36@ModeAttack
  00120	0f b7 84 0f b8
	00 00 00	 movzx	 eax, WORD PTR [edi+ecx+184]
  00128	83 f8 64	 cmp	 eax, 100		; 00000064H
  0012b	72 09		 jb	 SHORT $LN15@ModeAttack
  0012d	83 f8 6e	 cmp	 eax, 110		; 0000006eH
  00130	0f 86 81 00 00
	00		 jbe	 $LN36@ModeAttack
$LN15@ModeAttack:

; 157  : 					{
; 158  : 						if ( lpObj->VpPlayer2[count].type == OBJ_MONSTER && gObj[tObjNum].m_RecallMon < 0)

  00136	8b 94 0f 50 04
	00 00		 mov	 edx, DWORD PTR [edi+ecx+1104]
  0013d	85 d2		 test	 edx, edx

; 159  : 						{
; 160  : 							EnableAttack = TRUE;

  0013f	78 3d		 js	 SHORT $LN33@ModeAttack

; 161  : 						}
; 162  : 						else if ( DuelIndex == tObjNum )

  00141	39 9d b4 fe ff
	ff		 cmp	 DWORD PTR _DuelIndex$[ebp], ebx

; 163  : 						{
; 164  : 							EnableAttack = TRUE;
; 165  : 						}
; 166  : 						else

  00147	74 35		 je	 SHORT $LN33@ModeAttack

; 167  : 						{
; 168  : 							int lc85 = gObj[tObjNum].m_Index;
; 169  : 
; 170  : 							if ( gObj[tObjNum].Type == OBJ_MONSTER )

  00149	66 83 7c 0f 68
	02		 cmp	 WORD PTR [edi+ecx+104], 2
  0014f	8b 04 0f	 mov	 eax, DWORD PTR [edi+ecx]
  00152	75 0d		 jne	 SHORT $LN32@ModeAttack

; 171  : 							{
; 172  : 								if ( gObj[tObjNum].m_RecallMon >= 0 )

  00154	85 d2		 test	 edx, edx
  00156	78 09		 js	 SHORT $LN32@ModeAttack

; 173  : 								{
; 174  : 									lc85 = gObj[gObj[tObjNum].m_RecallMon].m_Index; 

  00158	69 d2 50 2b 00
	00		 imul	 edx, 11088		; 00002b50H
  0015e	8b 04 0a	 mov	 eax, DWORD PTR [edx+ecx]
$LN32@ModeAttack:

; 175  : 								}
; 176  : 							}
; 177  : 
; 178  : 							if ( gObjTargetGuildWarCheck(lpObj, &gObj[lc85]) == TRUE )

  00161	69 c0 50 2b 00
	00		 imul	 eax, 11088		; 00002b50H
  00167	03 c1		 add	 eax, ecx
  00169	50		 push	 eax
  0016a	56		 push	 esi
  0016b	e8 00 00 00 00	 call	 ?gObjTargetGuildWarCheck@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjTargetGuildWarCheck
  00170	83 c4 08	 add	 esp, 8
  00173	83 f8 01	 cmp	 eax, 1
  00176	75 39		 jne	 SHORT $LN34@ModeAttack
  00178	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
$LN33@ModeAttack:

; 179  : 							{
; 180  : 								EnableAttack = TRUE;
; 181  : 							}
; 182  : 						}
; 183  : 						// ----
; 184  : #ifdef IMPERIAL_CONFLICT_NEW
; 185  : 						if( g_ImperialGuardian.IsEventMap(gObj[tObjNum].MapNumber) )
; 186  : 						{
; 187  : 							if( gObj[tObjNum].Live && g_ImperialGuardian.IsAttackAbleMonster(gObj[tObjNum].m_Index) )
; 188  : 							{
; 189  : 								EnableAttack = true;
; 190  : 							}
; 191  : 						}
; 192  : #endif
; 193  : 						// ----
; 194  : 
; 195  : 						if ( EnableAttack != FALSE )
; 196  : 						{
; 197  : 							if ( lpObj->MapNumber == gObj[tObjNum].MapNumber )

  0017e	8a 96 49 01 00
	00		 mov	 dl, BYTE PTR [esi+329]
  00184	03 f9		 add	 edi, ecx
  00186	3a 97 49 01 00
	00		 cmp	 dl, BYTE PTR [edi+329]
  0018c	75 29		 jne	 SHORT $LN36@ModeAttack

; 198  : 							{
; 199  : 								dis = gObjCalDistance(lpObj, &gObj[tObjNum]);

  0018e	57		 push	 edi
  0018f	56		 push	 esi
  00190	e8 00 00 00 00	 call	 ?gObjCalDistance@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjCalDistance
  00195	83 c4 08	 add	 esp, 8

; 200  : 
; 201  : 								if ( dis < RAVEN_ATTACK_DISTANCE-2 )

  00198	83 f8 05	 cmp	 eax, 5
  0019b	7d 14		 jge	 SHORT $LN34@ModeAttack

; 202  : 								{
; 203  : 									FindObj[FindObjCount] = tObjNum;

  0019d	8b 85 c8 fe ff
	ff		 mov	 eax, DWORD PTR _FindObjCount$[ebp]
  001a3	89 9c 85 d0 fe
	ff ff		 mov	 DWORD PTR _FindObj$[ebp+eax*4], ebx

; 204  : 									FindObjCount++;

  001aa	40		 inc	 eax
  001ab	89 85 c8 fe ff
	ff		 mov	 DWORD PTR _FindObjCount$[ebp], eax
$LN34@ModeAttack:
  001b1	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
$LN36@ModeAttack:

; 205  : 								}
; 206  : 							}
; 207  : 						}
; 208  : 					}
; 209  : 				}
; 210  : 			}
; 211  : 		}
; 212  : 
; 213  : 		count++;

  001b7	8b 85 c0 fe ff
	ff		 mov	 eax, DWORD PTR tv464[ebp]
  001bd	83 c0 0c	 add	 eax, 12			; 0000000cH

; 214  : 
; 215  : 		if ( count > MAX_VIEWPORT-1 )

  001c0	ff 8d cc fe ff
	ff		 dec	 DWORD PTR tv79[ebp]
  001c6	89 85 c0 fe ff
	ff		 mov	 DWORD PTR tv464[ebp], eax
  001cc	0f 85 13 ff ff
	ff		 jne	 $LL21@ModeAttack

; 216  : 		{
; 217  : 			break;
; 218  : 		}
; 219  : 	}
; 220  : 
; 221  : 	if ( FindObjCount != 0 )

  001d2	8b bd c8 fe ff
	ff		 mov	 edi, DWORD PTR _FindObjCount$[ebp]
  001d8	85 ff		 test	 edi, edi
  001da	74 4b		 je	 SHORT $LN1@ModeAttack

; 222  : 	{
; 223  : 		if ( criticaldamage != 0 )

  001dc	8b 9d c4 fe ff
	ff		 mov	 ebx, DWORD PTR _criticaldamage$[ebp]

; 224  : 		{
; 225  : 			int target = FindObj[rand()%FindObjCount];

  001e2	e8 00 00 00 00	 call	 _rand
  001e7	99		 cdq
  001e8	f7 ff		 idiv	 edi
  001ea	8b 94 95 d0 fe
	ff ff		 mov	 edx, DWORD PTR _FindObj$[ebp+edx*4]
  001f1	85 db		 test	 ebx, ebx
  001f3	74 23		 je	 SHORT $LN2@ModeAttack

; 226  : 			this->SendAttackMsg( lpObj->m_Index, target, criticaldamage, 0);

  001f5	8b 06		 mov	 eax, DWORD PTR [esi]
  001f7	8b 8d b8 fe ff
	ff		 mov	 ecx, DWORD PTR _this$GSCopy$[ebp]
  001fd	6a 00		 push	 0
  001ff	53		 push	 ebx
  00200	52		 push	 edx
  00201	50		 push	 eax
  00202	e8 00 00 00 00	 call	 ?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z ; CDarkSpirit::SendAttackMsg
  00207	5f		 pop	 edi
  00208	5e		 pop	 esi
  00209	5b		 pop	 ebx

; 232  : 		}
; 233  : 	}
; 234  : }

  0020a	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  0020d	33 cd		 xor	 ecx, ebp
  0020f	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00214	8b e5		 mov	 esp, ebp
  00216	5d		 pop	 ebp
  00217	c3		 ret	 0
$LN2@ModeAttack:

; 227  : 		}
; 228  : 		else
; 229  : 		{
; 230  : 			int target = FindObj[rand()%FindObjCount];
; 231  : 			this->RangeAttack( lpObj->m_Index, target);

  00218	8b 0e		 mov	 ecx, DWORD PTR [esi]
  0021a	52		 push	 edx
  0021b	51		 push	 ecx
  0021c	8b 8d b8 fe ff
	ff		 mov	 ecx, DWORD PTR _this$GSCopy$[ebp]
  00222	e8 00 00 00 00	 call	 ?RangeAttack@CDarkSpirit@@QAEXHH@Z ; CDarkSpirit::RangeAttack
$LN1@ModeAttack:

; 232  : 		}
; 233  : 	}
; 234  : }

  00227	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  0022a	5f		 pop	 edi
  0022b	5e		 pop	 esi
  0022c	33 cd		 xor	 ecx, ebp
  0022e	5b		 pop	 ebx
  0022f	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00234	8b e5		 mov	 esp, ebp
  00236	5d		 pop	 ebp
  00237	c3		 ret	 0
?ModeAttackRandom@CDarkSpirit@@QAEXXZ ENDP		; CDarkSpirit::ModeAttackRandom
_TEXT	ENDS
PUBLIC	?ReSetTarget@CDarkSpirit@@QAEXH@Z		; CDarkSpirit::ReSetTarget
; Function compile flags: /Ogtp
;	COMDAT ?ReSetTarget@CDarkSpirit@@QAEXH@Z
_TEXT	SEGMENT
_aTargetIndex$ = 8					; size = 4
?ReSetTarget@CDarkSpirit@@QAEXH@Z PROC			; CDarkSpirit::ReSetTarget, COMDAT
; _this$ = ecx

; 478  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 479  : 	if ( this->m_iMasterIndex == -1 )

  00003	8b 41 14	 mov	 eax, DWORD PTR [ecx+20]
  00006	83 f8 ff	 cmp	 eax, -1
  00009	74 35		 je	 SHORT $LN1@ReSetTarge

; 480  : 	{
; 481  : 		return;
; 482  : 	}
; 483  : 
; 484  : 	LPOBJ lpObj = &gObj[this->m_iMasterIndex];
; 485  : 
; 486  : 	if ( lpObj->Class != CLASS_DARKLORD )

  0000b	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00011	69 c0 50 2b 00
	00		 imul	 eax, 11088		; 00002b50H
  00017	66 83 bc 10 b8
	00 00 00 04	 cmp	 WORD PTR [eax+edx+184], 4
  00020	75 1e		 jne	 SHORT $LN1@ReSetTarge

; 487  : 	{
; 488  : 		return;
; 489  : 	}
; 490  : 
; 491  : 	if ( aTargetIndex == this->m_iTargetIndex )

  00022	8b 45 08	 mov	 eax, DWORD PTR _aTargetIndex$[ebp]
  00025	3b 41 18	 cmp	 eax, DWORD PTR [ecx+24]
  00028	75 16		 jne	 SHORT $LN1@ReSetTarge

; 492  : 	{
; 493  : 		this->m_iTargetIndex = -1;
; 494  : 
; 495  : 		if ( this->m_ActionMode == PetItem_Mode_Attack_Target )

  0002a	83 79 20 03	 cmp	 DWORD PTR [ecx+32], 3
  0002e	c7 41 18 ff ff
	ff ff		 mov	 DWORD PTR [ecx+24], -1
  00035	75 09		 jne	 SHORT $LN1@ReSetTarge

; 496  : 		{
; 497  : 			this->SetMode(PetItem_Mode_Normal, -1);

  00037	6a ff		 push	 -1
  00039	6a 00		 push	 0
  0003b	e8 00 00 00 00	 call	 ?SetMode@CDarkSpirit@@QAEXW4ePetItem_Mode@1@H@Z ; CDarkSpirit::SetMode
$LN1@ReSetTarge:

; 498  : 		}
; 499  : 	}
; 500  : }

  00040	5d		 pop	 ebp
  00041	c2 04 00	 ret	 4
?ReSetTarget@CDarkSpirit@@QAEXH@Z ENDP			; CDarkSpirit::ReSetTarget
_TEXT	ENDS
PUBLIC	?ModeAttackWithMaster@CDarkSpirit@@QAEXXZ	; CDarkSpirit::ModeAttackWithMaster
; Function compile flags: /Ogtp
;	COMDAT ?ModeAttackWithMaster@CDarkSpirit@@QAEXXZ
_TEXT	SEGMENT
?ModeAttackWithMaster@CDarkSpirit@@QAEXXZ PROC		; CDarkSpirit::ModeAttackWithMaster, COMDAT
; _this$ = ecx

; 238  : 	LPOBJ lpObj = &gObj[this->m_iMasterIndex];

  00000	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00005	56		 push	 esi
  00006	57		 push	 edi
  00007	8b f9		 mov	 edi, ecx
  00009	8b 77 14	 mov	 esi, DWORD PTR [edi+20]

; 239  : 	int count = 0;
; 240  : 	int dis;
; 241  : 
; 242  : 	if ( this->m_iTargetIndex == -1 )

  0000c	8b 4f 18	 mov	 ecx, DWORD PTR [edi+24]
  0000f	69 f6 50 2b 00
	00		 imul	 esi, 11088		; 00002b50H
  00015	03 f0		 add	 esi, eax
  00017	83 f9 ff	 cmp	 ecx, -1
  0001a	74 54		 je	 SHORT $LN1@ModeAttack@2

; 243  : 	{
; 244  : 		return;
; 245  : 	}
; 246  : 
; 247  : 	if ( lpObj->MapNumber == gObj[this->m_iTargetIndex].MapNumber )

  0001c	8b d1		 mov	 edx, ecx
  0001e	69 d2 50 2b 00
	00		 imul	 edx, 11088		; 00002b50H
  00024	03 d0		 add	 edx, eax
  00026	8a 86 49 01 00
	00		 mov	 al, BYTE PTR [esi+329]
  0002c	3a 82 49 01 00
	00		 cmp	 al, BYTE PTR [edx+329]
  00032	75 3c		 jne	 SHORT $LN1@ModeAttack@2

; 248  : 	{
; 249  : 		if ( gObj[this->m_iTargetIndex].Life > 0.0f )

  00034	d9 ee		 fldz
  00036	d8 9a fc 00 00
	00		 fcomp	 DWORD PTR [edx+252]
  0003c	df e0		 fnstsw	 ax
  0003e	f6 c4 05	 test	 ah, 5
  00041	7a 25		 jp	 SHORT $LN6@ModeAttack@2

; 250  : 		{
; 251  : 			dis = gObjCalDistance(lpObj, &gObj[this->m_iTargetIndex]);

  00043	52		 push	 edx
  00044	56		 push	 esi
  00045	e8 00 00 00 00	 call	 ?gObjCalDistance@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjCalDistance
  0004a	83 c4 08	 add	 esp, 8

; 252  : 
; 253  : 			if ( dis < RAVEN_ATTACK_DISTANCE )

  0004d	83 f8 07	 cmp	 eax, 7
  00050	7d 1e		 jge	 SHORT $LN1@ModeAttack@2

; 254  : 			{
; 255  : 				int criticaldamage = 0;
; 256  : 
; 257  : 				if ( (rand()%10) < 3 )

  00052	e8 00 00 00 00	 call	 _rand

; 258  : 				{
; 259  : 					criticaldamage = FALSE;
; 260  : 				}
; 261  : 
; 262  : 				if ( criticaldamage != FALSE )
; 263  : 				{
; 264  : 					this->SendAttackMsg(lpObj->m_Index, this->m_iTargetIndex, criticaldamage, 0);
; 265  : 				}
; 266  : 				else
; 267  : 				{
; 268  : 					this->RangeAttack(lpObj->m_Index, this->m_iTargetIndex);

  00057	8b 4f 18	 mov	 ecx, DWORD PTR [edi+24]
  0005a	8b 16		 mov	 edx, DWORD PTR [esi]
  0005c	51		 push	 ecx
  0005d	52		 push	 edx
  0005e	8b cf		 mov	 ecx, edi
  00060	e8 00 00 00 00	 call	 ?RangeAttack@CDarkSpirit@@QAEXHH@Z ; CDarkSpirit::RangeAttack
  00065	5f		 pop	 edi
  00066	5e		 pop	 esi

; 275  : 		}
; 276  : 	}
; 277  : }

  00067	c3		 ret	 0
$LN6@ModeAttack@2:

; 269  : 				}
; 270  : 			}
; 271  : 		}
; 272  : 		else
; 273  : 		{
; 274  : 			this->ReSetTarget(this->m_iTargetIndex);

  00068	51		 push	 ecx
  00069	8b cf		 mov	 ecx, edi
  0006b	e8 00 00 00 00	 call	 ?ReSetTarget@CDarkSpirit@@QAEXH@Z ; CDarkSpirit::ReSetTarget
$LN1@ModeAttack@2:

; 275  : 		}
; 276  : 	}
; 277  : }

  00070	5f		 pop	 edi
  00071	5e		 pop	 esi
  00072	c3		 ret	 0
?ModeAttackWithMaster@CDarkSpirit@@QAEXXZ ENDP		; CDarkSpirit::ModeAttackWithMaster
_TEXT	ENDS
PUBLIC	?ModeAttakTarget@CDarkSpirit@@QAEXXZ		; CDarkSpirit::ModeAttakTarget
; Function compile flags: /Ogtp
;	COMDAT ?ModeAttakTarget@CDarkSpirit@@QAEXXZ
_TEXT	SEGMENT
?ModeAttakTarget@CDarkSpirit@@QAEXXZ PROC		; CDarkSpirit::ModeAttakTarget, COMDAT
; _this$ = ecx

; 281  : 	LPOBJ lpObj = &gObj[this->m_iMasterIndex];

  00000	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00005	56		 push	 esi
  00006	57		 push	 edi
  00007	8b f9		 mov	 edi, ecx
  00009	8b 77 14	 mov	 esi, DWORD PTR [edi+20]

; 282  : 	int count = 0;
; 283  : 	int dis;
; 284  : 
; 285  : 	if ( this->m_iTargetIndex == -1 )

  0000c	8b 4f 18	 mov	 ecx, DWORD PTR [edi+24]
  0000f	69 f6 50 2b 00
	00		 imul	 esi, 11088		; 00002b50H
  00015	03 f0		 add	 esi, eax
  00017	83 f9 ff	 cmp	 ecx, -1
  0001a	74 53		 je	 SHORT $LN1@ModeAttakT

; 286  : 	{
; 287  : 		return;
; 288  : 	}
; 289  : 
; 290  : 	if ( lpObj->MapNumber == gObj[this->m_iTargetIndex].MapNumber )

  0001c	8b d1		 mov	 edx, ecx
  0001e	69 d2 50 2b 00
	00		 imul	 edx, 11088		; 00002b50H
  00024	03 d0		 add	 edx, eax
  00026	8a 86 49 01 00
	00		 mov	 al, BYTE PTR [esi+329]
  0002c	3a 82 49 01 00
	00		 cmp	 al, BYTE PTR [edx+329]
  00032	75 3b		 jne	 SHORT $LN1@ModeAttakT

; 291  : 	{
; 292  : 		if ( gObj[this->m_iTargetIndex].Life > 0.0f )

  00034	d9 ee		 fldz
  00036	d8 9a fc 00 00
	00		 fcomp	 DWORD PTR [edx+252]
  0003c	df e0		 fnstsw	 ax
  0003e	f6 c4 05	 test	 ah, 5
  00041	7a 24		 jp	 SHORT $LN5@ModeAttakT

; 293  : 		{
; 294  : 			dis = gObjCalDistance(lpObj, &gObj[this->m_iTargetIndex]);

  00043	52		 push	 edx
  00044	56		 push	 esi
  00045	e8 00 00 00 00	 call	 ?gObjCalDistance@@YAHPAUOBJECTSTRUCT@@0@Z ; gObjCalDistance
  0004a	83 c4 08	 add	 esp, 8

; 295  : 
; 296  : 			if ( dis < RAVEN_ATTACK_DISTANCE )

  0004d	83 f8 07	 cmp	 eax, 7
  00050	7d 1d		 jge	 SHORT $LN1@ModeAttakT

; 297  : 			{
; 298  : 				int criticaldamage = TRUE;
; 299  : 				int msg = 1;
; 300  : 
; 301  : 				if ( criticaldamage != FALSE )
; 302  : 				{
; 303  : 					this->SendAttackMsg(lpObj->m_Index, this->m_iTargetIndex, criticaldamage, msg);

  00052	8b 4f 18	 mov	 ecx, DWORD PTR [edi+24]
  00055	8b 16		 mov	 edx, DWORD PTR [esi]
  00057	6a 01		 push	 1
  00059	6a 01		 push	 1
  0005b	51		 push	 ecx
  0005c	52		 push	 edx
  0005d	8b cf		 mov	 ecx, edi
  0005f	e8 00 00 00 00	 call	 ?SendAttackMsg@CDarkSpirit@@QAEXHHHH@Z ; CDarkSpirit::SendAttackMsg
  00064	5f		 pop	 edi
  00065	5e		 pop	 esi

; 314  : 		}
; 315  : 	}
; 316  : }

  00066	c3		 ret	 0
$LN5@ModeAttakT:

; 304  : 				}
; 305  : 				else
; 306  : 				{
; 307  : 					this->RangeAttack(lpObj->m_Index, this->m_iTargetIndex);
; 308  : 				}
; 309  : 			}
; 310  : 		}
; 311  : 		else
; 312  : 		{
; 313  : 			this->ReSetTarget(this->m_iTargetIndex);

  00067	51		 push	 ecx
  00068	8b cf		 mov	 ecx, edi
  0006a	e8 00 00 00 00	 call	 ?ReSetTarget@CDarkSpirit@@QAEXH@Z ; CDarkSpirit::ReSetTarget
$LN1@ModeAttakT:

; 314  : 		}
; 315  : 	}
; 316  : }

  0006f	5f		 pop	 edi
  00070	5e		 pop	 esi
  00071	c3		 ret	 0
?ModeAttakTarget@CDarkSpirit@@QAEXXZ ENDP		; CDarkSpirit::ModeAttakTarget
_TEXT	ENDS
PUBLIC	?Run@CDarkSpirit@@QAEXXZ			; CDarkSpirit::Run
EXTRN	?GetAttr@MapClass@@QAEEHH@Z:PROC		; MapClass::GetAttr
EXTRN	?MapC@@3PAVMapClass@@A:BYTE			; MapC
; Function compile flags: /Ogtp
;	COMDAT ?Run@CDarkSpirit@@QAEXXZ
_TEXT	SEGMENT
?Run@CDarkSpirit@@QAEXXZ PROC				; CDarkSpirit::Run, COMDAT
; _this$ = ecx

; 52   : {

  00000	56		 push	 esi
  00001	8b f1		 mov	 esi, ecx

; 53   : 	if ( this->m_iMasterIndex == -1 )

  00003	8b 46 14	 mov	 eax, DWORD PTR [esi+20]
  00006	83 f8 ff	 cmp	 eax, -1
  00009	0f 84 cf 00 00
	00		 je	 $LN5@Run

; 54   : 	{
; 55   : 		return;
; 56   : 	}
; 57   : 
; 58   : 	LPOBJ lpObj = &gObj[this->m_iMasterIndex];

  0000f	69 c0 50 2b 00
	00		 imul	 eax, 11088		; 00002b50H
  00015	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0001b	57		 push	 edi
  0001c	8b f8		 mov	 edi, eax

; 59   : 
; 60   : 	if ( lpObj->Class != CLASS_DARKLORD )

  0001e	66 83 bf b8 00
	00 00 04	 cmp	 WORD PTR [edi+184], 4
  00026	0f 85 b1 00 00
	00		 jne	 $LN16@Run

; 61   : 	{
; 62   : 		return;
; 63   : 	}
; 64   : 
; 65   : 	if ( this->m_pPetItem == NULL )

  0002c	8b 46 24	 mov	 eax, DWORD PTR [esi+36]
  0002f	85 c0		 test	 eax, eax
  00031	0f 84 a6 00 00
	00		 je	 $LN16@Run

; 66   : 	{
; 67   : 		return;
; 68   : 	}
; 69   : 
; 70   : 	if ( this->m_pPetItem->m_Durability <= 0.0f )

  00037	d9 ee		 fldz
  00039	d8 58 24	 fcomp	 DWORD PTR [eax+36]
  0003c	df e0		 fnstsw	 ax
  0003e	f6 c4 01	 test	 ah, 1
  00041	0f 84 96 00 00
	00		 je	 $LN16@Run

; 71   : 	{
; 72   : 		return;
; 73   : 	}
; 74   : 
; 75   : 	BYTE attr = MapC[lpObj->MapNumber].GetAttr(lpObj->X, lpObj->Y);
; 76   : 
; 77   : 	if ( (attr&1) != 0 )

  00047	0f bf 87 46 01
	00 00		 movsx	 eax, WORD PTR [edi+326]
  0004e	0f bf 8f 44 01
	00 00		 movsx	 ecx, WORD PTR [edi+324]
  00055	50		 push	 eax
  00056	51		 push	 ecx
  00057	0f b6 8f 49 01
	00 00		 movzx	 ecx, BYTE PTR [edi+329]
  0005e	69 c9 48 3d 05
	00		 imul	 ecx, 343368		; 00053d48H
  00064	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  0006a	e8 00 00 00 00	 call	 ?GetAttr@MapClass@@QAEEHH@Z ; MapClass::GetAttr
  0006f	a8 01		 test	 al, 1
  00071	75 6a		 jne	 SHORT $LN16@Run

; 78   : 	{
; 79   : 		return;
; 80   : 	}
; 81   : 
; 82   : 	if(this->m_pPetItem->m_RequireLeaderShip != 0 && //season4 add-on
; 83   : 		(lpObj->Leadership + lpObj->AddLeadership < this->m_pPetItem->m_RequireLeaderShip))

  00073	8b 56 24	 mov	 edx, DWORD PTR [esi+36]
  00076	0f b7 42 54	 movzx	 eax, WORD PTR [edx+84]
  0007a	66 85 c0	 test	 ax, ax
  0007d	74 14		 je	 SHORT $LN8@Run
  0007f	0f b7 8f 1a 01
	00 00		 movzx	 ecx, WORD PTR [edi+282]
  00086	0f b7 97 18 01
	00 00		 movzx	 edx, WORD PTR [edi+280]
  0008d	03 ca		 add	 ecx, edx
  0008f	3b c8		 cmp	 ecx, eax
  00091	7c 4a		 jl	 SHORT $LN16@Run
$LN8@Run:

; 84   : 	{
; 85   : 		return;
; 86   : 	}
; 87   : 
; 88   : 	if ( this->m_dwLastAttackTime > GetTickCount() )

  00093	8b 3d 00 00 00
	00		 mov	 edi, DWORD PTR __imp__GetTickCount@0
  00099	ff d7		 call	 edi
  0009b	39 46 1c	 cmp	 DWORD PTR [esi+28], eax
  0009e	77 3d		 ja	 SHORT $LN16@Run

; 89   : 	{
; 90   : 		return;
; 91   : 	}
; 92   : 
; 93   : 	this->m_dwLastAttackTime = ( GetTickCount() + 1500 ) - ( this->m_AttackSpeed * 10 );

  000a0	ff d7		 call	 edi
  000a2	b9 96 00 00 00	 mov	 ecx, 150		; 00000096H
  000a7	2b 4e 0c	 sub	 ecx, DWORD PTR [esi+12]
  000aa	8d 0c 89	 lea	 ecx, DWORD PTR [ecx+ecx*4]
  000ad	8d 14 48	 lea	 edx, DWORD PTR [eax+ecx*2]

; 94   : 
; 95   : 	switch ( this->m_ActionMode )

  000b0	8b 46 20	 mov	 eax, DWORD PTR [esi+32]
  000b3	89 56 1c	 mov	 DWORD PTR [esi+28], edx
  000b6	83 f8 03	 cmp	 eax, 3
  000b9	77 22		 ja	 SHORT $LN16@Run
  000bb	ff 24 85 00 00
	00 00		 jmp	 DWORD PTR $LN19@Run[eax*4]
$LN3@Run:
  000c2	5f		 pop	 edi

; 96   : 	{
; 97   : 		case PetItem_Mode_Normal:
; 98   : 			this->ModeNormal();
; 99   : 			break;
; 100  : 
; 101  : 		case PetItem_Mode_Attack_Random:
; 102  : 			this->ModeAttackRandom();

  000c3	8b ce		 mov	 ecx, esi
  000c5	5e		 pop	 esi
  000c6	e9 00 00 00 00	 jmp	 ?ModeAttackRandom@CDarkSpirit@@QAEXXZ ; CDarkSpirit::ModeAttackRandom
$LN2@Run:
  000cb	5f		 pop	 edi

; 103  : 			break;
; 104  : 
; 105  : 		case PetItem_Mode_Attack_WithMaster:
; 106  : 			this->ModeAttackWithMaster();

  000cc	8b ce		 mov	 ecx, esi
  000ce	5e		 pop	 esi
  000cf	e9 00 00 00 00	 jmp	 ?ModeAttackWithMaster@CDarkSpirit@@QAEXXZ ; CDarkSpirit::ModeAttackWithMaster
$LN1@Run:
  000d4	5f		 pop	 edi

; 107  : 			break;
; 108  : 
; 109  : 		case PetItem_Mode_Attack_Target:
; 110  : 			this->ModeAttakTarget();

  000d5	8b ce		 mov	 ecx, esi
  000d7	5e		 pop	 esi
  000d8	e9 00 00 00 00	 jmp	 ?ModeAttakTarget@CDarkSpirit@@QAEXXZ ; CDarkSpirit::ModeAttakTarget
$LN16@Run:
  000dd	5f		 pop	 edi
$LN5@Run:
  000de	5e		 pop	 esi

; 111  : 			break;
; 112  : 	}
; 113  : }

  000df	c3		 ret	 0
$LN19@Run:
  000e0	00 00 00 00	 DD	 $LN16@Run
  000e4	00 00 00 00	 DD	 $LN3@Run
  000e8	00 00 00 00	 DD	 $LN2@Run
  000ec	00 00 00 00	 DD	 $LN1@Run
?Run@CDarkSpirit@@QAEXXZ ENDP				; CDarkSpirit::Run
_TEXT	ENDS
EXTRN	_atexit:PROC
EXTRN	??_L@YGXPAXIHP6EX0@Z1@Z:PROC			; `eh vector constructor iterator'
; Function compile flags: /Ogtp
;	COMDAT ??__EgDarkSpirit@@YAXXZ
text$yc	SEGMENT
??__EgDarkSpirit@@YAXXZ PROC				; `dynamic initializer for 'gDarkSpirit'', COMDAT

; 27   : CDarkSpirit gDarkSpirit[OBJMAX];

  00000	68 00 00 00 00	 push	 OFFSET ??1CDarkSpirit@@UAE@XZ ; CDarkSpirit::~CDarkSpirit
  00005	68 00 00 00 00	 push	 OFFSET ??0CDarkSpirit@@QAE@XZ ; CDarkSpirit::CDarkSpirit
  0000a	68 98 3a 00 00	 push	 15000			; 00003a98H
  0000f	6a 28		 push	 40			; 00000028H
  00011	68 00 00 00 00	 push	 OFFSET ?gDarkSpirit@@3PAVCDarkSpirit@@A ; gDarkSpirit
  00016	e8 00 00 00 00	 call	 ??_L@YGXPAXIHP6EX0@Z1@Z
  0001b	68 00 00 00 00	 push	 OFFSET ??__FgDarkSpirit@@YAXXZ ; `dynamic atexit destructor for 'gDarkSpirit''
  00020	e8 00 00 00 00	 call	 _atexit
  00025	59		 pop	 ecx
  00026	c3		 ret	 0
??__EgDarkSpirit@@YAXXZ ENDP				; `dynamic initializer for 'gDarkSpirit''
text$yc	ENDS
EXTRN	??_M@YGXPAXIHP6EX0@Z@Z:PROC			; `eh vector destructor iterator'
; Function compile flags: /Ogtp
;	COMDAT ??__FgDarkSpirit@@YAXXZ
text$yd	SEGMENT
??__FgDarkSpirit@@YAXXZ PROC				; `dynamic atexit destructor for 'gDarkSpirit'', COMDAT
  00000	68 00 00 00 00	 push	 OFFSET ??1CDarkSpirit@@UAE@XZ ; CDarkSpirit::~CDarkSpirit
  00005	68 98 3a 00 00	 push	 15000			; 00003a98H
  0000a	6a 28		 push	 40			; 00000028H
  0000c	68 00 00 00 00	 push	 OFFSET ?gDarkSpirit@@3PAVCDarkSpirit@@A ; gDarkSpirit
  00011	e8 00 00 00 00	 call	 ??_M@YGXPAXIHP6EX0@Z@Z
  00016	c3		 ret	 0
??__FgDarkSpirit@@YAXXZ ENDP				; `dynamic atexit destructor for 'gDarkSpirit''
text$yd	ENDS
PUBLIC	?gDarkSpirit@@3PAVCDarkSpirit@@A		; gDarkSpirit
_BSS	SEGMENT
?gDarkSpirit@@3PAVCDarkSpirit@@A DB 0927c0H DUP (?)	; gDarkSpirit
_BSS	ENDS
CRT$XCU	SEGMENT
_gDarkSpirit$initializer$ DD FLAT:??__EgDarkSpirit@@YAXXZ
CRT$XCU	ENDS
END
