; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.30319.01 

	TITLE	E:\work\tranet_version\GS\GameServer\ItemBagZt.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

_DATA	SEGMENT
_g_iNpcUpDfLevel_CGATE DD 01H
	DD	02H
	DD	02dc6c0H
	DD	02H
	DD	03H
	DD	02dc6c0H
	DD	03H
	DD	04H
	DD	02dc6c0H
_g_iNpcUpDfLevel_CSTATUE DD 01H
	DD	03H
	DD	02dc6c0H
	DD	02H
	DD	05H
	DD	02dc6c0H
	DD	03H
	DD	07H
	DD	02dc6c0H
_g_iNpcUpMaxHP_CGATE DD 02625a0H
	DD	02H
	DD	0f4240H
	DD	03567e0H
	DD	03H
	DD	0f4240H
	DD	04f5880H
	DD	04H
	DD	0f4240H
_g_iNpcUpMaxHP_CSTATUE DD 02191c0H
	DD	03H
	DD	0f4240H
	DD	033e140H
	DD	05H
	DD	0f4240H
	DD	04c4b40H
	DD	07H
	DD	0f4240H
_g_iNpcUpRgLevel_CSTATUE DD 01H
	DD	03H
	DD	04c4b40H
	DD	02H
	DD	05H
	DD	04c4b40H
	DD	03H
	DD	07H
	DD	04c4b40H
_g_iCsUserReSpawnArea DD 023H
	DD	011H
	DD	090H
	DD	030H
	DD	04aH
	DD	090H
	DD	073H
	DD	09aH
	DD	023H
	DD	011H
	DD	090H
	DD	030H
_g_iNpcDefense_CGATE DD 064H
	DD	0b4H
	DD	012cH
	DD	0208H
_g_iNpcDefense_CSTATUE DD 050H
	DD	0b4H
	DD	0154H
	DD	0226H
_g_iCastleWallStepAxisY DD 071H
	DD	0a0H
	DD	0cbH
_DATA	ENDS
PUBLIC	??_H@YGXPAXIHP6EPAX0@Z@Z			; `vector constructor iterator'
; Function compile flags: /Ogtp
;	COMDAT ??_H@YGXPAXIHP6EPAX0@Z@Z
_TEXT	SEGMENT
___t$ = 8						; size = 4
___s$ = 12						; size = 4
___n$ = 16						; size = 4
___f$ = 20						; size = 4
??_H@YGXPAXIHP6EPAX0@Z@Z PROC				; `vector constructor iterator', COMDAT
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	57		 push	 edi
  00004	8b 7d 10	 mov	 edi, DWORD PTR ___n$[ebp]
  00007	4f		 dec	 edi
  00008	78 14		 js	 SHORT $LN1@vector
  0000a	53		 push	 ebx
  0000b	8b 5d 14	 mov	 ebx, DWORD PTR ___f$[ebp]
  0000e	56		 push	 esi
  0000f	8b 75 08	 mov	 esi, DWORD PTR ___t$[ebp]
$LL2@vector:
  00012	8b ce		 mov	 ecx, esi
  00014	ff d3		 call	 ebx
  00016	03 75 0c	 add	 esi, DWORD PTR ___s$[ebp]
  00019	4f		 dec	 edi
  0001a	79 f6		 jns	 SHORT $LL2@vector
  0001c	5e		 pop	 esi
  0001d	5b		 pop	 ebx
$LN1@vector:
  0001e	5f		 pop	 edi
  0001f	5d		 pop	 ebp
  00020	c2 10 00	 ret	 16			; 00000010H
??_H@YGXPAXIHP6EPAX0@Z@Z ENDP				; `vector constructor iterator'
_TEXT	ENDS
PUBLIC	??0CItemBagAttrZt@@QAE@XZ			; CItemBagAttrZt::CItemBagAttrZt
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\gamblesystem.h
;	COMDAT ??0CItemBagAttrZt@@QAE@XZ
_TEXT	SEGMENT
??0CItemBagAttrZt@@QAE@XZ PROC				; CItemBagAttrZt::CItemBagAttrZt, COMDAT
; _this$ = ecx

; 23   : 	CItemBagAttrZt()

  00000	8b c1		 mov	 eax, ecx

; 24   : 	{
; 25   : 		this->m_type = 0;

  00002	c7 00 00 00 00
	00		 mov	 DWORD PTR [eax], 0

; 26   : 		this->m_index = 0;
; 27   : 		this->m_minLevel = 0;
; 28   : 		this->m_maxLevel = 0;
; 29   : 		this->m_isskill = 0;

  00008	c7 40 04 00 00
	00 00		 mov	 DWORD PTR [eax+4], 0

; 30   : 		this->m_isluck = 0;
; 31   : 		this->m_isoption = 0;
; 32   : 		this->m_isexitem = 0;
; 33   : 	}

  0000f	c3		 ret	 0
??0CItemBagAttrZt@@QAE@XZ ENDP				; CItemBagAttrZt::CItemBagAttrZt
_TEXT	ENDS
PUBLIC	?Init@CItemBagDropMapInfo@@QAEXXZ		; CItemBagDropMapInfo::Init
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
;	COMDAT ?Init@CItemBagDropMapInfo@@QAEXXZ
_TEXT	SEGMENT
?Init@CItemBagDropMapInfo@@QAEXXZ PROC			; CItemBagDropMapInfo::Init, COMDAT
; _this$ = ecx

; 26   : 		this->m_bIsDrop = false;

  00000	32 c0		 xor	 al, al
  00002	66 c7 01 00 00	 mov	 WORD PTR [ecx], 0

; 27   : 		this->m_MinMonsterLevel = 0;
; 28   : 		this->m_MaxMonsterLevel = 0;

  00007	88 41 02	 mov	 BYTE PTR [ecx+2], al

; 29   : 	};

  0000a	c3		 ret	 0
?Init@CItemBagDropMapInfo@@QAEXXZ ENDP			; CItemBagDropMapInfo::Init
_TEXT	ENDS
PUBLIC	?GetBagCount@CItemBagZt@@AAEHXZ			; CItemBagZt::GetBagCount
; Function compile flags: /Ogtp
;	COMDAT ?GetBagCount@CItemBagZt@@AAEHXZ
_TEXT	SEGMENT
?GetBagCount@CItemBagZt@@AAEHXZ PROC			; CItemBagZt::GetBagCount, COMDAT
; _this$ = ecx

; 88   : 	int GetBagCount(){return this->m_iBagObjectCount;}

  00000	8b 81 20 01 00
	00		 mov	 eax, DWORD PTR [ecx+288]
  00006	c3		 ret	 0
?GetBagCount@CItemBagZt@@AAEHXZ ENDP			; CItemBagZt::GetBagCount
_TEXT	ENDS
PUBLIC	__$ArrayPad$
EXTRN	_isalnum:PROC
EXTRN	_isalpha:PROC
EXTRN	_atof:PROC
EXTRN	_isdigit:PROC
EXTRN	_getc:PROC
EXTRN	_ungetc:PROC
EXTRN	_isspace:PROC
EXTRN	_fgetc:PROC
EXTRN	___security_cookie:DWORD
EXTRN	__fltused:DWORD
EXTRN	@__security_check_cookie@4:PROC
_BSS	SEGMENT
_CurrentToken DD 01H DUP (?)
_TokenNumber DD	01H DUP (?)
_SMDFile DD	01H DUP (?)
_TokenString DB	064H DUP (?)
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\include\readscript.h
_BSS	ENDS
;	COMDAT ?GetToken@@YA?AW4SMDToken@@XZ
_TEXT	SEGMENT
_TempString$ = -104					; size = 100
__$ArrayPad$ = -4					; size = 4
?GetToken@@YA?AW4SMDToken@@XZ PROC			; GetToken, COMDAT

; 24   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 68	 sub	 esp, 104		; 00000068H
  00006	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000b	33 c5		 xor	 eax, ebp
  0000d	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax

; 25   : 	char ch;
; 26   : 	char* p;
; 27   : 	char TempString[100];
; 28   : 
; 29   : 	TokenString[0]=0;

  00010	c6 05 00 00 00
	00 00		 mov	 BYTE PTR _TokenString, 0
  00017	53		 push	 ebx
  00018	eb 06 8d 9b 00
	00 00 00	 npad	 8
$LL31@GetToken:

; 30   : 
; 31   : 	do
; 32   : 	{
; 33   : 		if ((ch=fgetc(SMDFile)) == -1)

  00020	a1 00 00 00 00	 mov	 eax, DWORD PTR _SMDFile
  00025	50		 push	 eax
  00026	e8 00 00 00 00	 call	 _fgetc
  0002b	8a d8		 mov	 bl, al
  0002d	83 c4 04	 add	 esp, 4
  00030	80 fb ff	 cmp	 bl, -1
  00033	74 64		 je	 SHORT $LN39@GetToken

; 36   : 		}
; 37   : 		else
; 38   : 		{	
; 39   : 			if (ch=='/')		// this is /

  00035	80 fb 2f	 cmp	 bl, 47			; 0000002fH
  00038	75 31		 jne	 SHORT $LN30@GetToken

; 40   : 			{
; 41   : 				if((ch=fgetc(SMDFile)) == '/')

  0003a	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR _SMDFile
  00040	51		 push	 ecx
  00041	e8 00 00 00 00	 call	 _fgetc
  00046	8a d8		 mov	 bl, al
  00048	83 c4 04	 add	 esp, 4
  0004b	80 fb 2f	 cmp	 bl, 47			; 0000002fH
  0004e	75 1b		 jne	 SHORT $LN30@GetToken
$LL24@GetToken:

; 42   : 				{
; 43   : 					while ((ch != '\n') && (ch != -1))	// End of Line (EOL)

  00050	80 fb ff	 cmp	 bl, -1
  00053	74 44		 je	 SHORT $LN39@GetToken

; 44   : 					{
; 45   : 						ch=fgetc(SMDFile);

  00055	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR _SMDFile
  0005b	52		 push	 edx
  0005c	e8 00 00 00 00	 call	 _fgetc
  00061	8a d8		 mov	 bl, al
  00063	83 c4 04	 add	 esp, 4
  00066	80 fb 0a	 cmp	 bl, 10			; 0000000aH
  00069	75 e5		 jne	 SHORT $LL24@GetToken
$LN30@GetToken:

; 46   : 					}
; 47   : 	
; 48   : 					if (ch == -1)
; 49   : 					{
; 50   : 						return END;	// End of FILE
; 51   : 					}
; 52   : 				}
; 53   : 			}
; 54   : 		}
; 55   : 	}
; 56   : 	while (isspace(ch) != 0);

  0006b	0f be c3	 movsx	 eax, bl
  0006e	50		 push	 eax
  0006f	e8 00 00 00 00	 call	 _isspace
  00074	83 c4 04	 add	 esp, 4
  00077	85 c0		 test	 eax, eax
  00079	75 a5		 jne	 SHORT $LL31@GetToken

; 57   : 
; 58   : 	
; 59   : 	switch(ch)

  0007b	0f be c3	 movsx	 eax, bl
  0007e	8d 48 de	 lea	 ecx, DWORD PTR [eax-34]
  00081	56		 push	 esi
  00082	83 f9 5b	 cmp	 ecx, 91			; 0000005bH
  00085	0f 87 2b 01 00
	00		 ja	 $LN6@GetToken
  0008b	0f b6 89 00 00
	00 00		 movzx	 ecx, BYTE PTR $LN46@GetToken[ecx]
  00092	ff 24 8d 00 00
	00 00		 jmp	 DWORD PTR $LN50@GetToken[ecx*4]
$LN39@GetToken:

; 34   : 		{
; 35   : 			return END;	// End of FILE (EOF)

  00099	b8 02 00 00 00	 mov	 eax, 2
  0009e	5b		 pop	 ebx

; 147  : 		}
; 148  : 		break;
; 149  : 
; 150  : 	}
; 151  : 
; 152  : 	return NAME;
; 153  : }

  0009f	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  000a2	33 cd		 xor	 ecx, ebp
  000a4	e8 00 00 00 00	 call	 @__security_check_cookie@4
  000a9	8b e5		 mov	 esp, ebp
  000ab	5d		 pop	 ebp
  000ac	c3		 ret	 0
$LN19@GetToken:

; 60   : 	{
; 61   : 
; 62   : 	case 0x23:	// #
; 63   : 		return CurrentToken=COMMAND;

  000ad	b8 23 00 00 00	 mov	 eax, 35			; 00000023H
  000b2	e9 99 01 00 00	 jmp	 $LN48@GetToken
$LN18@GetToken:

; 64   : 		break;
; 65   : 	
; 66   : 	case 0x3B:	// ;
; 67   : 		return CurrentToken=SEMICOLON;

  000b7	b8 3b 00 00 00	 mov	 eax, 59			; 0000003bH
  000bc	e9 8f 01 00 00	 jmp	 $LN48@GetToken
$LN17@GetToken:

; 68   : 		break;
; 69   : 	
; 70   : 	case 0x2C:	// ,
; 71   : 
; 72   : 		return CurrentToken=COMMA;

  000c1	b8 2c 00 00 00	 mov	 eax, 44			; 0000002cH
  000c6	e9 85 01 00 00	 jmp	 $LN48@GetToken
$LN16@GetToken:

; 73   : 		break;
; 74   : 	
; 75   : 	case 0x7B:	// {
; 76   : 		return CurrentToken = LP;

  000cb	b8 7b 00 00 00	 mov	 eax, 123		; 0000007bH
  000d0	e9 7b 01 00 00	 jmp	 $LN48@GetToken
$LN15@GetToken:

; 77   : 		break;
; 78   : 
; 79   : 	case 0x7D:	// }
; 80   : 		return CurrentToken = RP;

  000d5	b8 7d 00 00 00	 mov	 eax, 125		; 0000007dH
  000da	e9 71 01 00 00	 jmp	 $LN48@GetToken
$LN14@GetToken:

; 81   : 		break;
; 82   : 	// Nice Index Table :)	by Deathway
; 83   : 	// Numbers Case
; 84   : 	case 0x2D:	//-
; 85   : 	case 0x2E:	//.
; 86   : 	case '0':	//0
; 87   : 	case '1':	//1
; 88   : 	case '2':	//2
; 89   : 	case '3':	//3
; 90   : 	case '4':	//4		
; 91   : 	case '5':	//5
; 92   : 	case '6':	//6
; 93   : 	case '7':	//7
; 94   : 	case '8':	//8
; 95   : 	case '9':	//9
; 96   : 		ungetc(ch, SMDFile);

  000df	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR _SMDFile
  000e5	52		 push	 edx
  000e6	50		 push	 eax
  000e7	e8 00 00 00 00	 call	 _ungetc

; 97   : 		p = TempString;
; 98   : 		
; 99   : 		while (((ch=getc(SMDFile)) != -1) && ((ch == 0x2E) || (isdigit(ch) != 0) || (ch == 0x2D)))  // 2e '.'  2D '-'

  000ec	a1 00 00 00 00	 mov	 eax, DWORD PTR _SMDFile
  000f1	50		 push	 eax
  000f2	8d 75 98	 lea	 esi, DWORD PTR _TempString$[ebp]
  000f5	e8 00 00 00 00	 call	 _getc
  000fa	8a d8		 mov	 bl, al
  000fc	83 c4 0c	 add	 esp, 12			; 0000000cH
  000ff	80 fb ff	 cmp	 bl, -1
  00102	74 33		 je	 SHORT $LN12@GetToken
$LL13@GetToken:
  00104	80 fb 2e	 cmp	 bl, 46			; 0000002eH
  00107	74 15		 je	 SHORT $LN11@GetToken
  00109	0f be cb	 movsx	 ecx, bl
  0010c	51		 push	 ecx
  0010d	e8 00 00 00 00	 call	 _isdigit
  00112	83 c4 04	 add	 esp, 4
  00115	85 c0		 test	 eax, eax
  00117	75 05		 jne	 SHORT $LN11@GetToken
  00119	80 fb 2d	 cmp	 bl, 45			; 0000002dH
  0011c	75 19		 jne	 SHORT $LN12@GetToken
$LN11@GetToken:
  0011e	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR _SMDFile

; 100  : 		{
; 101  : 			*p = ch;	// Construct a String

  00124	88 1e		 mov	 BYTE PTR [esi], bl
  00126	52		 push	 edx

; 102  : 			p++;

  00127	46		 inc	 esi
  00128	e8 00 00 00 00	 call	 _getc
  0012d	8a d8		 mov	 bl, al
  0012f	83 c4 04	 add	 esp, 4
  00132	80 fb ff	 cmp	 bl, -1
  00135	75 cd		 jne	 SHORT $LL13@GetToken
$LN12@GetToken:

; 103  : 		}		
; 104  : 		*p = 0;
; 105  : 		TokenNumber = atof( TempString);	// Select the first Byte as Main ID

  00137	8d 45 98	 lea	 eax, DWORD PTR _TempString$[ebp]
  0013a	50		 push	 eax
  0013b	c6 06 00	 mov	 BYTE PTR [esi], 0
  0013e	e8 00 00 00 00	 call	 _atof
  00143	d9 1d 00 00 00
	00		 fstp	 DWORD PTR _TokenNumber
  00149	83 c4 04	 add	 esp, 4
  0014c	5e		 pop	 esi

; 106  : 		return CurrentToken  = NUMBER ;

  0014d	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR _CurrentToken, 1
  00157	b8 01 00 00 00	 mov	 eax, 1
  0015c	5b		 pop	 ebx

; 147  : 		}
; 148  : 		break;
; 149  : 
; 150  : 	}
; 151  : 
; 152  : 	return NAME;
; 153  : }

  0015d	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00160	33 cd		 xor	 ecx, ebp
  00162	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00167	8b e5		 mov	 esp, ebp
  00169	5d		 pop	 ebp
  0016a	c3		 ret	 0
$LN10@GetToken:

; 107  : 		break;
; 108  : 
; 109  : 	case '\"':	// "	String Case
; 110  : 		p=&TokenString[0];
; 111  : 		
; 112  : 		while (((ch=getc(SMDFile)) != -1 ) && (ch != 0x22))	// nice

  0016b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR _SMDFile
  00171	51		 push	 ecx
  00172	be 00 00 00 00	 mov	 esi, OFFSET _TokenString
  00177	e8 00 00 00 00	 call	 _getc
  0017c	83 c4 04	 add	 esp, 4
  0017f	3c ff		 cmp	 al, -1
  00181	74 1e		 je	 SHORT $LN8@GetToken
$LL9@GetToken:
  00183	3c 22		 cmp	 al, 34			; 00000022H
  00185	0f 84 a1 00 00
	00		 je	 $LN7@GetToken
  0018b	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR _SMDFile

; 113  : 		{
; 114  : 			*p = ch;

  00191	88 06		 mov	 BYTE PTR [esi], al
  00193	52		 push	 edx

; 115  : 			p++;

  00194	46		 inc	 esi
  00195	e8 00 00 00 00	 call	 _getc
  0019a	83 c4 04	 add	 esp, 4
  0019d	3c ff		 cmp	 al, -1
  0019f	75 e2		 jne	 SHORT $LL9@GetToken
$LN8@GetToken:

; 116  : 		}
; 117  : 		if (ch != 0x22 )

  001a1	3c 22		 cmp	 al, 34			; 00000022H
  001a3	0f 84 83 00 00
	00		 je	 $LN7@GetToken

; 118  : 		{
; 119  : 			ungetc(ch, SMDFile);

  001a9	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR _SMDFile
  001af	0f be d0	 movsx	 edx, al
  001b2	51		 push	 ecx
  001b3	52		 push	 edx

; 120  : 		}
; 121  : 		*p = 0;
; 122  : 		return CurrentToken = NAME;

  001b4	eb 6e		 jmp	 SHORT $LN49@GetToken
$LN6@GetToken:

; 123  : 		break;
; 124  : 
; 125  : 	default:	// Others
; 126  : 		if (isalpha(ch))

  001b6	50		 push	 eax
  001b7	e8 00 00 00 00	 call	 _isalpha
  001bc	83 c4 04	 add	 esp, 4
  001bf	85 c0		 test	 eax, eax
  001c1	0f 84 84 00 00
	00		 je	 $LN5@GetToken

; 127  : 		{
; 128  : 			p=&TokenString[0];
; 129  : 			*p=ch;
; 130  : 			p++;
; 131  : 
; 132  : 			while ( ((ch=getc(SMDFile)) != -1) && ( (ch == 0x2E) || (ch == 0x5F) || (isalnum(ch) != 0) ) )

  001c7	a1 00 00 00 00	 mov	 eax, DWORD PTR _SMDFile
  001cc	50		 push	 eax
  001cd	88 1d 00 00 00
	00		 mov	 BYTE PTR _TokenString, bl
  001d3	be 01 00 00 00	 mov	 esi, OFFSET _TokenString+1
  001d8	e8 00 00 00 00	 call	 _getc
  001dd	8a d8		 mov	 bl, al
  001df	83 c4 04	 add	 esp, 4
  001e2	80 fb ff	 cmp	 bl, -1
  001e5	74 33		 je	 SHORT $LN3@GetToken
$LL4@GetToken:
  001e7	80 fb 2e	 cmp	 bl, 46			; 0000002eH
  001ea	74 15		 je	 SHORT $LN2@GetToken
  001ec	80 fb 5f	 cmp	 bl, 95			; 0000005fH
  001ef	74 10		 je	 SHORT $LN2@GetToken
  001f1	0f be cb	 movsx	 ecx, bl
  001f4	51		 push	 ecx
  001f5	e8 00 00 00 00	 call	 _isalnum
  001fa	83 c4 04	 add	 esp, 4
  001fd	85 c0		 test	 eax, eax
  001ff	74 19		 je	 SHORT $LN3@GetToken
$LN2@GetToken:
  00201	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR _SMDFile

; 133  : 			{
; 134  : 				*p=ch;

  00207	88 1e		 mov	 BYTE PTR [esi], bl
  00209	52		 push	 edx

; 135  : 				p++;

  0020a	46		 inc	 esi
  0020b	e8 00 00 00 00	 call	 _getc
  00210	8a d8		 mov	 bl, al
  00212	83 c4 04	 add	 esp, 4
  00215	80 fb ff	 cmp	 bl, -1
  00218	75 cd		 jne	 SHORT $LL4@GetToken
$LN3@GetToken:

; 136  : 				
; 137  : 			}
; 138  : 
; 139  : 			ungetc(ch, SMDFile);

  0021a	a1 00 00 00 00	 mov	 eax, DWORD PTR _SMDFile
  0021f	0f be cb	 movsx	 ecx, bl
  00222	50		 push	 eax
  00223	51		 push	 ecx
$LN49@GetToken:
  00224	e8 00 00 00 00	 call	 _ungetc
  00229	83 c4 08	 add	 esp, 8
$LN7@GetToken:

; 140  : 			*p=0;

  0022c	c6 06 00	 mov	 BYTE PTR [esi], 0
  0022f	5e		 pop	 esi

; 141  : 			CurrentToken=NAME;

  00230	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR _CurrentToken, 0

; 142  : 			return CurrentToken;

  0023a	33 c0		 xor	 eax, eax
  0023c	5b		 pop	 ebx

; 147  : 		}
; 148  : 		break;
; 149  : 
; 150  : 	}
; 151  : 
; 152  : 	return NAME;
; 153  : }

  0023d	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00240	33 cd		 xor	 ecx, ebp
  00242	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00247	8b e5		 mov	 esp, ebp
  00249	5d		 pop	 ebp
  0024a	c3		 ret	 0
$LN5@GetToken:

; 143  : 		}
; 144  : 		else
; 145  : 		{
; 146  : 			return CurrentToken = SMD_ERROR; // '<'

  0024b	b8 3c 00 00 00	 mov	 eax, 60			; 0000003cH
$LN48@GetToken:

; 147  : 		}
; 148  : 		break;
; 149  : 
; 150  : 	}
; 151  : 
; 152  : 	return NAME;
; 153  : }

  00250	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00253	5e		 pop	 esi
  00254	33 cd		 xor	 ecx, ebp
  00256	a3 00 00 00 00	 mov	 DWORD PTR _CurrentToken, eax
  0025b	5b		 pop	 ebx
  0025c	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00261	8b e5		 mov	 esp, ebp
  00263	5d		 pop	 ebp
  00264	c3		 ret	 0
  00265	8d 49 00	 npad	 3
$LN50@GetToken:
  00268	00 00 00 00	 DD	 $LN10@GetToken
  0026c	00 00 00 00	 DD	 $LN19@GetToken
  00270	00 00 00 00	 DD	 $LN17@GetToken
  00274	00 00 00 00	 DD	 $LN14@GetToken
  00278	00 00 00 00	 DD	 $LN18@GetToken
  0027c	00 00 00 00	 DD	 $LN16@GetToken
  00280	00 00 00 00	 DD	 $LN15@GetToken
  00284	00 00 00 00	 DD	 $LN6@GetToken
$LN46@GetToken:
  00288	00		 DB	 0
  00289	01		 DB	 1
  0028a	07		 DB	 7
  0028b	07		 DB	 7
  0028c	07		 DB	 7
  0028d	07		 DB	 7
  0028e	07		 DB	 7
  0028f	07		 DB	 7
  00290	07		 DB	 7
  00291	07		 DB	 7
  00292	02		 DB	 2
  00293	03		 DB	 3
  00294	03		 DB	 3
  00295	07		 DB	 7
  00296	03		 DB	 3
  00297	03		 DB	 3
  00298	03		 DB	 3
  00299	03		 DB	 3
  0029a	03		 DB	 3
  0029b	03		 DB	 3
  0029c	03		 DB	 3
  0029d	03		 DB	 3
  0029e	03		 DB	 3
  0029f	03		 DB	 3
  002a0	07		 DB	 7
  002a1	04		 DB	 4
  002a2	07		 DB	 7
  002a3	07		 DB	 7
  002a4	07		 DB	 7
  002a5	07		 DB	 7
  002a6	07		 DB	 7
  002a7	07		 DB	 7
  002a8	07		 DB	 7
  002a9	07		 DB	 7
  002aa	07		 DB	 7
  002ab	07		 DB	 7
  002ac	07		 DB	 7
  002ad	07		 DB	 7
  002ae	07		 DB	 7
  002af	07		 DB	 7
  002b0	07		 DB	 7
  002b1	07		 DB	 7
  002b2	07		 DB	 7
  002b3	07		 DB	 7
  002b4	07		 DB	 7
  002b5	07		 DB	 7
  002b6	07		 DB	 7
  002b7	07		 DB	 7
  002b8	07		 DB	 7
  002b9	07		 DB	 7
  002ba	07		 DB	 7
  002bb	07		 DB	 7
  002bc	07		 DB	 7
  002bd	07		 DB	 7
  002be	07		 DB	 7
  002bf	07		 DB	 7
  002c0	07		 DB	 7
  002c1	07		 DB	 7
  002c2	07		 DB	 7
  002c3	07		 DB	 7
  002c4	07		 DB	 7
  002c5	07		 DB	 7
  002c6	07		 DB	 7
  002c7	07		 DB	 7
  002c8	07		 DB	 7
  002c9	07		 DB	 7
  002ca	07		 DB	 7
  002cb	07		 DB	 7
  002cc	07		 DB	 7
  002cd	07		 DB	 7
  002ce	07		 DB	 7
  002cf	07		 DB	 7
  002d0	07		 DB	 7
  002d1	07		 DB	 7
  002d2	07		 DB	 7
  002d3	07		 DB	 7
  002d4	07		 DB	 7
  002d5	07		 DB	 7
  002d6	07		 DB	 7
  002d7	07		 DB	 7
  002d8	07		 DB	 7
  002d9	07		 DB	 7
  002da	07		 DB	 7
  002db	07		 DB	 7
  002dc	07		 DB	 7
  002dd	07		 DB	 7
  002de	07		 DB	 7
  002df	07		 DB	 7
  002e0	07		 DB	 7
  002e1	05		 DB	 5
  002e2	07		 DB	 7
  002e3	06		 DB	 6
?GetToken@@YA?AW4SMDToken@@XZ ENDP			; GetToken
_TEXT	ENDS
PUBLIC	??_7CItemBagZt@@6B@				; CItemBagZt::`vftable'
PUBLIC	??1CItemBagZt@@UAE@XZ				; CItemBagZt::~CItemBagZt
PUBLIC	??_R4CItemBagZt@@6B@				; CItemBagZt::`RTTI Complete Object Locator'
PUBLIC	??_R0?AVCItemBagZt@@@8				; CItemBagZt `RTTI Type Descriptor'
PUBLIC	??_R3CItemBagZt@@8				; CItemBagZt::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2CItemBagZt@@8				; CItemBagZt::`RTTI Base Class Array'
PUBLIC	??_R1A@?0A@EA@CItemBagZt@@8			; CItemBagZt::`RTTI Base Class Descriptor at (0,-1,0,64)'
EXTRN	??_7type_info@@6B@:QWORD			; type_info::`vftable'
EXTRN	??_ECItemBagZt@@UAEPAXI@Z:PROC			; CItemBagZt::`vector deleting destructor'
;	COMDAT ??_R1A@?0A@EA@CItemBagZt@@8
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
rdata$r	SEGMENT
??_R1A@?0A@EA@CItemBagZt@@8 DD FLAT:??_R0?AVCItemBagZt@@@8 ; CItemBagZt::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	00H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3CItemBagZt@@8
rdata$r	ENDS
;	COMDAT ??_R2CItemBagZt@@8
rdata$r	SEGMENT
??_R2CItemBagZt@@8 DD FLAT:??_R1A@?0A@EA@CItemBagZt@@8	; CItemBagZt::`RTTI Base Class Array'
rdata$r	ENDS
;	COMDAT ??_R3CItemBagZt@@8
rdata$r	SEGMENT
??_R3CItemBagZt@@8 DD 00H				; CItemBagZt::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	01H
	DD	FLAT:??_R2CItemBagZt@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVCItemBagZt@@@8
_DATA	SEGMENT
??_R0?AVCItemBagZt@@@8 DD FLAT:??_7type_info@@6B@	; CItemBagZt `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVCItemBagZt@@', 00H
_DATA	ENDS
;	COMDAT ??_R4CItemBagZt@@6B@
rdata$r	SEGMENT
??_R4CItemBagZt@@6B@ DD 00H				; CItemBagZt::`RTTI Complete Object Locator'
	DD	00H
	DD	00H
	DD	FLAT:??_R0?AVCItemBagZt@@@8
	DD	FLAT:??_R3CItemBagZt@@8
rdata$r	ENDS
;	COMDAT ??_7CItemBagZt@@6B@
CONST	SEGMENT
??_7CItemBagZt@@6B@ DD FLAT:??_R4CItemBagZt@@6B@	; CItemBagZt::`vftable'
	DD	FLAT:??_ECItemBagZt@@UAEPAXI@Z
; Function compile flags: /Ogtp
CONST	ENDS
;	COMDAT ??1CItemBagZt@@UAE@XZ
_TEXT	SEGMENT
??1CItemBagZt@@UAE@XZ PROC				; CItemBagZt::~CItemBagZt, COMDAT
; _this$ = ecx

; 18   : {

  00000	c7 01 00 00 00
	00		 mov	 DWORD PTR [ecx], OFFSET ??_7CItemBagZt@@6B@

; 19   : 	return;
; 20   : }

  00006	c3		 ret	 0
??1CItemBagZt@@UAE@XZ ENDP				; CItemBagZt::~CItemBagZt
_TEXT	ENDS
PUBLIC	??_C@_0BO@PLHOAEKH@ZtEvent?5ItemBag?5LoadFail?5?$FL?$CFs?$FN?$AA@ ; `string'
PUBLIC	??_C@_0GL@LIMNLNHJ@?$FL?$CFs?$FN?5Eventitemnum?5?$DN?5?$CFd?0EventItem@ ; `string'
PUBLIC	??_C@_03JBJLGPFL@end?$AA@			; `string'
PUBLIC	_script_file$GSCopy$
PUBLIC	??_C@_01KDCPPGHE@r?$AA@				; `string'
PUBLIC	__$ArrayPad$
PUBLIC	?LoadItem@CItemBagZt@@QAEXPAD@Z			; CItemBagZt::LoadItem
EXTRN	?MsgBox@@YAXPADZZ:PROC				; MsgBox
EXTRN	_fclose:PROC
EXTRN	?LogAddTD@@3P6AXPADZZA:DWORD			; LogAddTD
EXTRN	__imp__wsprintfA:PROC
EXTRN	?LogAdd@@3P6AXPADZZA:DWORD			; LogAdd
EXTRN	?Get@CMsg@@QAEPADH@Z:PROC			; CMsg::Get
EXTRN	?lMsg@@3VCMsg@@A:BYTE				; lMsg
EXTRN	_fopen:PROC
EXTRN	__ftol2_sse:PROC
;	COMDAT ??_C@_0BO@PLHOAEKH@ZtEvent?5ItemBag?5LoadFail?5?$FL?$CFs?$FN?$AA@
CONST	SEGMENT
??_C@_0BO@PLHOAEKH@ZtEvent?5ItemBag?5LoadFail?5?$FL?$CFs?$FN?$AA@ DB 'ZtE'
	DB	'vent ItemBag LoadFail [%s]', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0GL@LIMNLNHJ@?$FL?$CFs?$FN?5Eventitemnum?5?$DN?5?$CFd?0EventItem@
CONST	SEGMENT
??_C@_0GL@LIMNLNHJ@?$FL?$CFs?$FN?5Eventitemnum?5?$DN?5?$CFd?0EventItem@ DB '['
	DB	'%s] Eventitemnum = %d,EventItemLevel = %d, EventItemDropRate '
	DB	'= %d, ItemDropRate = %d, ExItemDropRate = %d', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_03JBJLGPFL@end?$AA@
CONST	SEGMENT
??_C@_03JBJLGPFL@end?$AA@ DB 'end', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_01KDCPPGHE@r?$AA@
CONST	SEGMENT
??_C@_01KDCPPGHE@r?$AA@ DB 'r', 00H			; `string'
; Function compile flags: /Ogtp
CONST	ENDS
;	COMDAT ?LoadItem@CItemBagZt@@QAEXPAD@Z
_TEXT	SEGMENT
_script_file$GSCopy$ = -276				; size = 4
_n$ = -272						; size = 4
tv646 = -268						; size = 4
tv644 = -268						; size = 4
tv638 = -268						; size = 4
tv636 = -268						; size = 4
tv630 = -268						; size = 4
tv628 = -268						; size = 4
tv539 = -268						; size = 4
tv537 = -268						; size = 4
tv531 = -268						; size = 4
tv529 = -268						; size = 4
tv523 = -268						; size = 4
tv521 = -268						; size = 4
tv515 = -268						; size = 4
tv513 = -268						; size = 4
tv507 = -268						; size = 4
tv505 = -268						; size = 4
tv499 = -268						; size = 4
tv497 = -268						; size = 4
tv491 = -268						; size = 4
tv489 = -268						; size = 4
tv483 = -268						; size = 4
tv481 = -268						; size = 4
tv649 = -262						; size = 2
tv641 = -262						; size = 2
tv633 = -262						; size = 2
tv542 = -262						; size = 2
tv534 = -262						; size = 2
tv526 = -262						; size = 2
tv518 = -262						; size = 2
tv510 = -262						; size = 2
tv502 = -262						; size = 2
tv494 = -262						; size = 2
tv486 = -262						; size = 2
_szTemp$210021 = -260					; size = 256
__$ArrayPad$ = -4					; size = 4
_script_file$ = 8					; size = 4
?LoadItem@CItemBagZt@@QAEXPAD@Z PROC			; CItemBagZt::LoadItem, COMDAT
; _this$ = ecx

; 38   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 14 01 00
	00		 sub	 esp, 276		; 00000114H
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	53		 push	 ebx
  00014	56		 push	 esi
  00015	8b 75 08	 mov	 esi, DWORD PTR _script_file$[ebp]
  00018	57		 push	 edi
  00019	8b f9		 mov	 edi, ecx

; 39   : 	int Token;
; 40   : 
; 41   : 	this->m_bLoad = FALSE;
; 42   : 	SMDFile = fopen(script_file, "r");

  0001b	68 00 00 00 00	 push	 OFFSET ??_C@_01KDCPPGHE@r?$AA@
  00020	33 db		 xor	 ebx, ebx
  00022	56		 push	 esi

; 84   : 						return;
; 85   : 					}
; 86   : 
; 87   : 					Token = GetToken();

  00023	89 b5 ec fe ff
	ff		 mov	 DWORD PTR _script_file$GSCopy$[ebp], esi
  00029	89 5f 04	 mov	 DWORD PTR [edi+4], ebx
  0002c	e8 00 00 00 00	 call	 _fopen
  00031	83 c4 08	 add	 esp, 8
  00034	a3 00 00 00 00	 mov	 DWORD PTR _SMDFile, eax
  00039	3b c3		 cmp	 eax, ebx
  0003b	75 1c		 jne	 SHORT $LN24@LoadItem

; 43   : 
; 44   : 	if ( SMDFile == NULL )
; 45   : 	{
; 46   : 		LogAdd(lMsg.Get(MSGGET(1, 197)), script_file);

  0003d	56		 push	 esi
  0003e	68 c5 01 00 00	 push	 453			; 000001c5H
  00043	b9 00 00 00 00	 mov	 ecx, OFFSET ?lMsg@@3VCMsg@@A ; lMsg
  00048	e8 00 00 00 00	 call	 ?Get@CMsg@@QAEPADH@Z	; CMsg::Get
  0004d	50		 push	 eax
  0004e	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd

; 47   : 		return;

  00054	e9 75 05 00 00	 jmp	 $LN61@LoadItem
$LN24@LoadItem:

; 48   : 	}
; 49   : 
; 50   : 	int n=0;

  00059	89 9d f0 fe ff
	ff		 mov	 DWORD PTR _n$[ebp], ebx

; 51   : 
; 52   : 	while ( true )
; 53   : 	{
; 54   : 		Token = GetToken();

  0005f	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 55   : 
; 56   : 		if ( Token == 2 )

  00064	83 f8 02	 cmp	 eax, 2
  00067	0f 84 19 05 00
	00		 je	 $LN41@LoadItem
  0006d	8d 49 00	 npad	 3
$LL23@LoadItem:

; 57   : 		{
; 58   : 			break;
; 59   : 		}
; 60   : 
; 61   : 		if ( Token == 1 )

  00070	83 f8 01	 cmp	 eax, 1
  00073	0f 85 f9 04 00
	00		 jne	 $LN57@LoadItem

; 62   : 		{
; 63   : 			int st = (int)TokenNumber;	// script_type

  00079	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  0007f	e8 00 00 00 00	 call	 __ftol2_sse

; 64   : 
; 65   : 			if ( st == 0 )

  00084	85 c0		 test	 eax, eax
  00086	0f 85 3c 01 00
	00		 jne	 $LN19@LoadItem
  0008c	8d 64 24 00	 npad	 4
$LL18@LoadItem:

; 66   : 			{
; 67   : 				while ( true )
; 68   : 				{
; 69   : 					Token = GetToken();

  00090	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 70   : 
; 71   : 					if ( Token == 0 )

  00095	85 c0		 test	 eax, eax
  00097	75 37		 jne	 SHORT $LN15@LoadItem

; 72   : 					{
; 73   : 						if ( strcmp("end", TokenString) == 0 )

  00099	b9 00 00 00 00	 mov	 ecx, OFFSET _TokenString
  0009e	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_03JBJLGPFL@end?$AA@
$LL43@LoadItem:
  000a3	8a 10		 mov	 dl, BYTE PTR [eax]
  000a5	3a 11		 cmp	 dl, BYTE PTR [ecx]
  000a7	75 1a		 jne	 SHORT $LN44@LoadItem
  000a9	84 d2		 test	 dl, dl
  000ab	74 12		 je	 SHORT $LN45@LoadItem
  000ad	8a 50 01	 mov	 dl, BYTE PTR [eax+1]
  000b0	3a 51 01	 cmp	 dl, BYTE PTR [ecx+1]
  000b3	75 0e		 jne	 SHORT $LN44@LoadItem
  000b5	83 c0 02	 add	 eax, 2
  000b8	83 c1 02	 add	 ecx, 2
  000bb	84 d2		 test	 dl, dl
  000bd	75 e4		 jne	 SHORT $LL43@LoadItem
$LN45@LoadItem:
  000bf	33 c0		 xor	 eax, eax
  000c1	eb 05		 jmp	 SHORT $LN46@LoadItem
$LN44@LoadItem:
  000c3	1b c0		 sbb	 eax, eax
  000c5	83 d8 ff	 sbb	 eax, -1
$LN46@LoadItem:
  000c8	85 c0		 test	 eax, eax
  000ca	0f 84 e5 04 00
	00		 je	 $LN56@LoadItem
$LN15@LoadItem:

; 74   : 						{
; 75   : 							break;
; 76   : 						}
; 77   : 					}
; 78   : 
; 79   : 					int map = (int)TokenNumber;

  000d0	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  000d6	e8 00 00 00 00	 call	 __ftol2_sse
  000db	8b f0		 mov	 esi, eax

; 80   : 
; 81   : 					if ( MAX_MAP_RANGE(map) == FALSE )

  000dd	85 f6		 test	 esi, esi
  000df	0f 88 d8 04 00
	00		 js	 $LN37@LoadItem
  000e5	33 c0		 xor	 eax, eax
  000e7	83 fe 52	 cmp	 esi, 82			; 00000052H
  000ea	0f 9e c0	 setle	 al
  000ed	85 c0		 test	 eax, eax
  000ef	0f 84 c8 04 00
	00		 je	 $LN37@LoadItem

; 84   : 						return;
; 85   : 					}
; 86   : 
; 87   : 					Token = GetToken();

  000f5	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 88   : 					this->DropMapInfo[map].m_bIsDrop = (BYTE)TokenNumber;

  000fa	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  00100	8d 04 77	 lea	 eax, DWORD PTR [edi+esi*2]
  00103	d9 bd fa fe ff
	ff		 fnstcw	 WORD PTR tv649[ebp]
  00109	8d 1c 06	 lea	 ebx, DWORD PTR [esi+eax]
  0010c	0f b7 85 fa fe
	ff ff		 movzx	 eax, WORD PTR tv649[ebp]
  00113	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  00118	89 85 f4 fe ff
	ff		 mov	 DWORD PTR tv646[ebp], eax
  0011e	d9 ad f4 fe ff
	ff		 fldcw	 WORD PTR tv646[ebp]
  00124	db 9d f4 fe ff
	ff		 fistp	 DWORD PTR tv644[ebp]
  0012a	8a 8d f4 fe ff
	ff		 mov	 cl, BYTE PTR tv644[ebp]
  00130	88 8b 24 01 00
	00		 mov	 BYTE PTR [ebx+292], cl
  00136	d9 ad fa fe ff
	ff		 fldcw	 WORD PTR tv649[ebp]

; 89   : 
; 90   : 					Token = GetToken();

  0013c	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 91   : 					this->DropMapInfo[map].m_MinMonsterLevel = (BYTE)TokenNumber;

  00141	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  00147	d9 bd fa fe ff
	ff		 fnstcw	 WORD PTR tv641[ebp]
  0014d	0f b7 85 fa fe
	ff ff		 movzx	 eax, WORD PTR tv641[ebp]
  00154	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  00159	89 85 f4 fe ff
	ff		 mov	 DWORD PTR tv638[ebp], eax
  0015f	d9 ad f4 fe ff
	ff		 fldcw	 WORD PTR tv638[ebp]
  00165	db 9d f4 fe ff
	ff		 fistp	 DWORD PTR tv636[ebp]
  0016b	8a 95 f4 fe ff
	ff		 mov	 dl, BYTE PTR tv636[ebp]
  00171	88 93 25 01 00
	00		 mov	 BYTE PTR [ebx+293], dl
  00177	d9 ad fa fe ff
	ff		 fldcw	 WORD PTR tv641[ebp]

; 92   : 
; 93   : 					Token = GetToken();

  0017d	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 94   : 					this->DropMapInfo[map].m_MaxMonsterLevel = (BYTE)TokenNumber;

  00182	8d 8c 77 c4 00
	00 00		 lea	 ecx, DWORD PTR [edi+esi*2+196]
  00189	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  0018f	d9 bd fa fe ff
	ff		 fnstcw	 WORD PTR tv633[ebp]
  00195	0f b7 85 fa fe
	ff ff		 movzx	 eax, WORD PTR tv633[ebp]
  0019c	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  001a1	89 85 f4 fe ff
	ff		 mov	 DWORD PTR tv630[ebp], eax
  001a7	d9 ad f4 fe ff
	ff		 fldcw	 WORD PTR tv630[ebp]
  001ad	db 9d f4 fe ff
	ff		 fistp	 DWORD PTR tv628[ebp]
  001b3	8a 85 f4 fe ff
	ff		 mov	 al, BYTE PTR tv628[ebp]
  001b9	88 44 0e 62	 mov	 BYTE PTR [esi+ecx+98], al
  001bd	d9 ad fa fe ff
	ff		 fldcw	 WORD PTR tv633[ebp]

; 95   : 				}

  001c3	e9 c8 fe ff ff	 jmp	 $LL18@LoadItem
$LN19@LoadItem:

; 96   : 			
; 97   : 			}
; 98   : 			else if ( st == 1 )

  001c8	83 f8 01	 cmp	 eax, 1
  001cb	0f 85 39 01 00
	00		 jne	 $LN12@LoadItem
$LL11@LoadItem:

; 99   : 			{
; 100  : 				while ( true )
; 101  : 				{
; 102  : 					Token = GetToken();

  001d1	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 103  : 
; 104  : 					if ( Token == 0 )

  001d6	85 c0		 test	 eax, eax
  001d8	75 37		 jne	 SHORT $LN8@LoadItem

; 105  : 					{
; 106  : 						if ( strcmp("end", TokenString) == 0 )

  001da	b9 00 00 00 00	 mov	 ecx, OFFSET _TokenString
  001df	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_03JBJLGPFL@end?$AA@
$LL47@LoadItem:
  001e4	8a 10		 mov	 dl, BYTE PTR [eax]
  001e6	3a 11		 cmp	 dl, BYTE PTR [ecx]
  001e8	75 1a		 jne	 SHORT $LN48@LoadItem
  001ea	84 d2		 test	 dl, dl
  001ec	74 12		 je	 SHORT $LN49@LoadItem
  001ee	8a 50 01	 mov	 dl, BYTE PTR [eax+1]
  001f1	3a 51 01	 cmp	 dl, BYTE PTR [ecx+1]
  001f4	75 0e		 jne	 SHORT $LN48@LoadItem
  001f6	83 c0 02	 add	 eax, 2
  001f9	83 c1 02	 add	 ecx, 2
  001fc	84 d2		 test	 dl, dl
  001fe	75 e4		 jne	 SHORT $LL47@LoadItem
$LN49@LoadItem:
  00200	33 c0		 xor	 eax, eax
  00202	eb 05		 jmp	 SHORT $LN50@LoadItem
$LN48@LoadItem:
  00204	1b c0		 sbb	 eax, eax
  00206	83 d8 ff	 sbb	 eax, -1
$LN50@LoadItem:
  00209	85 c0		 test	 eax, eax
  0020b	0f 84 a4 03 00
	00		 je	 $LN56@LoadItem
$LN8@LoadItem:

; 107  : 						{
; 108  : 							break;
; 109  : 						}
; 110  : 					}
; 111  : 
; 112  : 					strcpy(this->m_sEventName, TokenString);

  00211	8d 5f 08	 lea	 ebx, DWORD PTR [edi+8]
  00214	b8 00 00 00 00	 mov	 eax, OFFSET _TokenString
  00219	8b d3		 mov	 edx, ebx
  0021b	2b d0		 sub	 edx, eax
  0021d	8d 49 00	 npad	 3
$LL29@LoadItem:
  00220	8a 08		 mov	 cl, BYTE PTR [eax]
  00222	88 0c 02	 mov	 BYTE PTR [edx+eax], cl
  00225	40		 inc	 eax
  00226	84 c9		 test	 cl, cl
  00228	75 f6		 jne	 SHORT $LL29@LoadItem

; 113  : 
; 114  : 					Token = GetToken();

  0022a	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 115  : 					this->m_iDropZen = (int)TokenNumber;

  0022f	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  00235	e8 00 00 00 00	 call	 __ftol2_sse
  0023a	89 87 10 01 00
	00		 mov	 DWORD PTR [edi+272], eax

; 116  : 
; 117  : 					Token = GetToken();

  00240	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 118  : 					int type = (int)TokenNumber;

  00245	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  0024b	e8 00 00 00 00	 call	 __ftol2_sse
  00250	8b f0		 mov	 esi, eax

; 119  : 
; 120  : 					Token = GetToken();

  00252	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 121  : 					int index = (int)TokenNumber;
; 122  : 
; 123  : 					this->m_iEventItemType = ITEMGET(type, index);

  00257	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  0025d	c1 e6 09	 shl	 esi, 9
  00260	e8 00 00 00 00	 call	 __ftol2_sse
  00265	03 f0		 add	 esi, eax
  00267	89 b7 08 01 00
	00		 mov	 DWORD PTR [edi+264], esi

; 124  : 
; 125  : 					Token = GetToken();

  0026d	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 126  : 					this->m_iEventItemLevel = (int)TokenNumber;

  00272	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  00278	e8 00 00 00 00	 call	 __ftol2_sse
  0027d	89 87 0c 01 00
	00		 mov	 DWORD PTR [edi+268], eax

; 127  : 
; 128  : 					Token = GetToken();

  00283	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 129  : 					this->m_iEventItemDropRate = (int)TokenNumber;

  00288	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  0028e	e8 00 00 00 00	 call	 __ftol2_sse
  00293	89 87 14 01 00
	00		 mov	 DWORD PTR [edi+276], eax

; 130  : 
; 131  : 					Token = GetToken();

  00299	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 132  : 					this->m_iItemDropRate = (int)TokenNumber;

  0029e	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  002a4	e8 00 00 00 00	 call	 __ftol2_sse
  002a9	89 87 18 01 00
	00		 mov	 DWORD PTR [edi+280], eax

; 133  : 
; 134  : 					Token = GetToken();

  002af	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 135  : 					this->m_iExItemDropRate = (int)TokenNumber;

  002b4	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  002ba	e8 00 00 00 00	 call	 __ftol2_sse

; 136  : 
; 137  : 					char szTemp[256];
; 138  : 
; 139  : 					wsprintf(szTemp, "[%s] Eventitemnum = %d,EventItemLevel = %d, EventItemDropRate = %d, ItemDropRate = %d, ExItemDropRate = %d",
; 140  : 						this->m_sEventName, this->m_iEventItemType, this->m_iEventItemLevel, this->m_iEventItemDropRate, this->m_iItemDropRate, this->m_iExItemDropRate);

  002bf	8b 97 18 01 00
	00		 mov	 edx, DWORD PTR [edi+280]
  002c5	8b 8f 0c 01 00
	00		 mov	 ecx, DWORD PTR [edi+268]
  002cb	50		 push	 eax
  002cc	52		 push	 edx
  002cd	8b 97 08 01 00
	00		 mov	 edx, DWORD PTR [edi+264]
  002d3	89 87 1c 01 00
	00		 mov	 DWORD PTR [edi+284], eax
  002d9	8b 87 14 01 00
	00		 mov	 eax, DWORD PTR [edi+276]
  002df	50		 push	 eax
  002e0	51		 push	 ecx
  002e1	52		 push	 edx
  002e2	53		 push	 ebx
  002e3	8d 85 fc fe ff
	ff		 lea	 eax, DWORD PTR _szTemp$210021[ebp]
  002e9	68 00 00 00 00	 push	 OFFSET ??_C@_0GL@LIMNLNHJ@?$FL?$CFs?$FN?5Eventitemnum?5?$DN?5?$CFd?0EventItem@
  002ee	50		 push	 eax
  002ef	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__wsprintfA

; 141  : 					LogAddTD(szTemp);

  002f5	8d 8d fc fe ff
	ff		 lea	 ecx, DWORD PTR _szTemp$210021[ebp]
  002fb	51		 push	 ecx
  002fc	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  00302	83 c4 24	 add	 esp, 36			; 00000024H

; 142  : 				}

  00305	e9 c7 fe ff ff	 jmp	 $LL11@LoadItem
$LN12@LoadItem:

; 143  : 			}
; 144  : 			else if ( st == 2 )

  0030a	83 f8 02	 cmp	 eax, 2
  0030d	0f 85 5f 02 00
	00		 jne	 $LN57@LoadItem
  00313	8d b4 df 1e 02
	00 00		 lea	 esi, DWORD PTR [edi+ebx*8+542]
  0031a	8d 9b 00 00 00
	00		 npad	 6
$LL5@LoadItem:

; 145  : 			{
; 146  : 				while ( true )
; 147  : 				{
; 148  : 					Token = GetToken();

  00320	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 149  : 
; 150  : 					if ( Token == 0 )

  00325	85 c0		 test	 eax, eax
  00327	75 37		 jne	 SHORT $LN2@LoadItem

; 151  : 					{
; 152  : 						if ( strcmp("end", TokenString) == 0 )

  00329	b9 00 00 00 00	 mov	 ecx, OFFSET _TokenString
  0032e	b8 00 00 00 00	 mov	 eax, OFFSET ??_C@_03JBJLGPFL@end?$AA@
$LL51@LoadItem:
  00333	8a 10		 mov	 dl, BYTE PTR [eax]
  00335	3a 11		 cmp	 dl, BYTE PTR [ecx]
  00337	75 1a		 jne	 SHORT $LN52@LoadItem
  00339	84 d2		 test	 dl, dl
  0033b	74 12		 je	 SHORT $LN53@LoadItem
  0033d	8a 50 01	 mov	 dl, BYTE PTR [eax+1]
  00340	3a 51 01	 cmp	 dl, BYTE PTR [ecx+1]
  00343	75 0e		 jne	 SHORT $LN52@LoadItem
  00345	83 c0 02	 add	 eax, 2
  00348	83 c1 02	 add	 ecx, 2
  0034b	84 d2		 test	 dl, dl
  0034d	75 e4		 jne	 SHORT $LL51@LoadItem
$LN53@LoadItem:
  0034f	33 c0		 xor	 eax, eax
  00351	eb 05		 jmp	 SHORT $LN54@LoadItem
$LN52@LoadItem:
  00353	1b c0		 sbb	 eax, eax
  00355	83 d8 ff	 sbb	 eax, -1
$LN54@LoadItem:
  00358	85 c0		 test	 eax, eax
  0035a	0f 84 0c 02 00
	00		 je	 $LN60@LoadItem
$LN2@LoadItem:

; 153  : 						{
; 154  : 							break;
; 155  : 						}
; 156  : 					}
; 157  : 
; 158  : 					this->BagObject[n].m_type = (BYTE)TokenNumber;

  00360	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  00366	d9 bd fa fe ff
	ff		 fnstcw	 WORD PTR tv542[ebp]
  0036c	0f b7 85 fa fe
	ff ff		 movzx	 eax, WORD PTR tv542[ebp]
  00373	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  00378	89 85 f4 fe ff
	ff		 mov	 DWORD PTR tv539[ebp], eax
  0037e	d9 ad f4 fe ff
	ff		 fldcw	 WORD PTR tv539[ebp]
  00384	db 9d f4 fe ff
	ff		 fistp	 DWORD PTR tv537[ebp]
  0038a	0f b6 95 f4 fe
	ff ff		 movzx	 edx, BYTE PTR tv537[ebp]
  00391	88 56 ff	 mov	 BYTE PTR [esi-1], dl
  00394	d9 ad fa fe ff
	ff		 fldcw	 WORD PTR tv542[ebp]

; 159  : 
; 160  : 					Token = GetToken();

  0039a	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 161  : 					this->BagObject[n].m_index = (BYTE)TokenNumber;

  0039f	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  003a5	d9 bd fa fe ff
	ff		 fnstcw	 WORD PTR tv534[ebp]
  003ab	0f b7 85 fa fe
	ff ff		 movzx	 eax, WORD PTR tv534[ebp]
  003b2	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  003b7	89 85 f4 fe ff
	ff		 mov	 DWORD PTR tv531[ebp], eax
  003bd	d9 ad f4 fe ff
	ff		 fldcw	 WORD PTR tv531[ebp]
  003c3	db 9d f4 fe ff
	ff		 fistp	 DWORD PTR tv529[ebp]
  003c9	0f b6 85 f4 fe
	ff ff		 movzx	 eax, BYTE PTR tv529[ebp]
  003d0	88 06		 mov	 BYTE PTR [esi], al
  003d2	d9 ad fa fe ff
	ff		 fldcw	 WORD PTR tv534[ebp]

; 162  : 
; 163  : 					Token = GetToken();

  003d8	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 164  : 					this->BagObject[n].m_minLevel = (BYTE)TokenNumber;

  003dd	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  003e3	d9 bd fa fe ff
	ff		 fnstcw	 WORD PTR tv526[ebp]
  003e9	0f b7 85 fa fe
	ff ff		 movzx	 eax, WORD PTR tv526[ebp]
  003f0	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  003f5	89 85 f4 fe ff
	ff		 mov	 DWORD PTR tv523[ebp], eax
  003fb	d9 ad f4 fe ff
	ff		 fldcw	 WORD PTR tv523[ebp]
  00401	db 9d f4 fe ff
	ff		 fistp	 DWORD PTR tv521[ebp]
  00407	0f b6 8d f4 fe
	ff ff		 movzx	 ecx, BYTE PTR tv521[ebp]
  0040e	88 4e 01	 mov	 BYTE PTR [esi+1], cl
  00411	d9 ad fa fe ff
	ff		 fldcw	 WORD PTR tv526[ebp]

; 165  : 
; 166  : 					Token = GetToken();

  00417	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 167  : 					this->BagObject[n].m_maxLevel = (BYTE)TokenNumber;

  0041c	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  00422	d9 bd fa fe ff
	ff		 fnstcw	 WORD PTR tv518[ebp]
  00428	0f b7 85 fa fe
	ff ff		 movzx	 eax, WORD PTR tv518[ebp]
  0042f	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  00434	89 85 f4 fe ff
	ff		 mov	 DWORD PTR tv515[ebp], eax
  0043a	d9 ad f4 fe ff
	ff		 fldcw	 WORD PTR tv515[ebp]
  00440	db 9d f4 fe ff
	ff		 fistp	 DWORD PTR tv513[ebp]
  00446	0f b6 95 f4 fe
	ff ff		 movzx	 edx, BYTE PTR tv513[ebp]
  0044d	88 56 02	 mov	 BYTE PTR [esi+2], dl
  00450	d9 ad fa fe ff
	ff		 fldcw	 WORD PTR tv518[ebp]

; 168  : 
; 169  : 					Token = GetToken();

  00456	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 170  : 					this->BagObject[n].m_isskill = (BYTE)TokenNumber;

  0045b	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  00461	d9 bd fa fe ff
	ff		 fnstcw	 WORD PTR tv510[ebp]
  00467	0f b7 85 fa fe
	ff ff		 movzx	 eax, WORD PTR tv510[ebp]
  0046e	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  00473	89 85 f4 fe ff
	ff		 mov	 DWORD PTR tv507[ebp], eax
  00479	d9 ad f4 fe ff
	ff		 fldcw	 WORD PTR tv507[ebp]
  0047f	db 9d f4 fe ff
	ff		 fistp	 DWORD PTR tv505[ebp]
  00485	0f b6 85 f4 fe
	ff ff		 movzx	 eax, BYTE PTR tv505[ebp]
  0048c	88 46 03	 mov	 BYTE PTR [esi+3], al
  0048f	d9 ad fa fe ff
	ff		 fldcw	 WORD PTR tv510[ebp]

; 171  : 
; 172  : 					Token = GetToken();

  00495	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 173  : 					this->BagObject[n].m_isluck = (BYTE)TokenNumber;

  0049a	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  004a0	d9 bd fa fe ff
	ff		 fnstcw	 WORD PTR tv502[ebp]
  004a6	0f b7 85 fa fe
	ff ff		 movzx	 eax, WORD PTR tv502[ebp]
  004ad	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  004b2	89 85 f4 fe ff
	ff		 mov	 DWORD PTR tv499[ebp], eax
  004b8	d9 ad f4 fe ff
	ff		 fldcw	 WORD PTR tv499[ebp]
  004be	db 9d f4 fe ff
	ff		 fistp	 DWORD PTR tv497[ebp]
  004c4	0f b6 8d f4 fe
	ff ff		 movzx	 ecx, BYTE PTR tv497[ebp]
  004cb	88 4e 04	 mov	 BYTE PTR [esi+4], cl
  004ce	d9 ad fa fe ff
	ff		 fldcw	 WORD PTR tv502[ebp]

; 174  : 
; 175  : 					Token = GetToken();

  004d4	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 176  : 					this->BagObject[n].m_isoption = (BYTE)TokenNumber;

  004d9	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  004df	d9 bd fa fe ff
	ff		 fnstcw	 WORD PTR tv494[ebp]
  004e5	0f b7 85 fa fe
	ff ff		 movzx	 eax, WORD PTR tv494[ebp]
  004ec	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  004f1	89 85 f4 fe ff
	ff		 mov	 DWORD PTR tv491[ebp], eax
  004f7	d9 ad f4 fe ff
	ff		 fldcw	 WORD PTR tv491[ebp]
  004fd	db 9d f4 fe ff
	ff		 fistp	 DWORD PTR tv489[ebp]
  00503	0f b6 95 f4 fe
	ff ff		 movzx	 edx, BYTE PTR tv489[ebp]
  0050a	88 56 05	 mov	 BYTE PTR [esi+5], dl
  0050d	d9 ad fa fe ff
	ff		 fldcw	 WORD PTR tv494[ebp]

; 177  : 
; 178  : 					Token = GetToken();

  00513	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 179  : 					this->BagObject[n].m_isexitem = (BYTE)TokenNumber;

  00518	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  0051e	d9 bd fa fe ff
	ff		 fnstcw	 WORD PTR tv486[ebp]
  00524	0f b7 85 fa fe
	ff ff		 movzx	 eax, WORD PTR tv486[ebp]
  0052b	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  00530	89 85 f4 fe ff
	ff		 mov	 DWORD PTR tv483[ebp], eax
  00536	d9 ad f4 fe ff
	ff		 fldcw	 WORD PTR tv483[ebp]

; 180  : 
; 181  : 					n++;

  0053c	43		 inc	 ebx
  0053d	83 c6 08	 add	 esi, 8
  00540	db 9d f4 fe ff
	ff		 fistp	 DWORD PTR tv481[ebp]
  00546	0f b6 85 f4 fe
	ff ff		 movzx	 eax, BYTE PTR tv481[ebp]
  0054d	88 46 fe	 mov	 BYTE PTR [esi-2], al

; 182  : 					this->m_iBagObjectCount++;

  00550	ff 87 20 01 00
	00		 inc	 DWORD PTR [edi+288]

; 183  : 
; 184  : 					if ( this->m_iBagObjectCount > MAX_ITEMBAG_ATTR-1 )

  00556	81 bf 20 01 00
	00 95 00 00 00	 cmp	 DWORD PTR [edi+288], 149 ; 00000095H
  00560	d9 ad fa fe ff
	ff		 fldcw	 WORD PTR tv486[ebp]
  00566	0f 8e b4 fd ff
	ff		 jle	 $LL5@LoadItem
$LN60@LoadItem:

; 180  : 
; 181  : 					n++;

  0056c	89 9d f0 fe ff
	ff		 mov	 DWORD PTR _n$[ebp], ebx
$LN57@LoadItem:

; 51   : 
; 52   : 	while ( true )
; 53   : 	{
; 54   : 		Token = GetToken();

  00572	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken

; 55   : 
; 56   : 		if ( Token == 2 )

  00577	83 f8 02	 cmp	 eax, 2
  0057a	0f 85 f0 fa ff
	ff		 jne	 $LL23@LoadItem
  00580	8b b5 ec fe ff
	ff		 mov	 esi, DWORD PTR _script_file$GSCopy$[ebp]
$LN41@LoadItem:

; 185  : 					{
; 186  : 						break;
; 187  : 					}
; 188  : 				}
; 189  : 			}
; 190  : 		}
; 191  : 	}
; 192  : 
; 193  : 	fclose(SMDFile);

  00586	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR _SMDFile
  0058c	51		 push	 ecx
  0058d	e8 00 00 00 00	 call	 _fclose
  00592	83 c4 04	 add	 esp, 4

; 194  : 	LogAdd(lMsg.Get(MSGGET(1, 198)), script_file);

  00595	56		 push	 esi
  00596	68 c6 01 00 00	 push	 454			; 000001c6H
  0059b	b9 00 00 00 00	 mov	 ecx, OFFSET ?lMsg@@3VCMsg@@A ; lMsg
  005a0	e8 00 00 00 00	 call	 ?Get@CMsg@@QAEPADH@Z	; CMsg::Get
  005a5	50		 push	 eax
  005a6	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd

; 195  : 	this->m_bLoad = TRUE;

  005ac	c7 47 04 01 00
	00 00		 mov	 DWORD PTR [edi+4], 1
  005b3	eb 19		 jmp	 SHORT $LN61@LoadItem
$LN56@LoadItem:

; 183  : 
; 184  : 					if ( this->m_iBagObjectCount > MAX_ITEMBAG_ATTR-1 )

  005b5	8b 9d f0 fe ff
	ff		 mov	 ebx, DWORD PTR _n$[ebp]
  005bb	eb b5		 jmp	 SHORT $LN57@LoadItem
$LN37@LoadItem:

; 82   : 					{
; 83   : 						MsgBox("ZtEvent ItemBag LoadFail [%s]", script_file);

  005bd	8b 95 ec fe ff
	ff		 mov	 edx, DWORD PTR _script_file$GSCopy$[ebp]
  005c3	52		 push	 edx
  005c4	68 00 00 00 00	 push	 OFFSET ??_C@_0BO@PLHOAEKH@ZtEvent?5ItemBag?5LoadFail?5?$FL?$CFs?$FN?$AA@
  005c9	e8 00 00 00 00	 call	 ?MsgBox@@YAXPADZZ	; MsgBox
$LN61@LoadItem:

; 196  : }

  005ce	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  005d1	83 c4 08	 add	 esp, 8
  005d4	5f		 pop	 edi
  005d5	5e		 pop	 esi
  005d6	33 cd		 xor	 ecx, ebp
  005d8	5b		 pop	 ebx
  005d9	e8 00 00 00 00	 call	 @__security_check_cookie@4
  005de	8b e5		 mov	 esp, ebp
  005e0	5d		 pop	 ebp
  005e1	c2 04 00	 ret	 4
?LoadItem@CItemBagZt@@QAEXPAD@Z ENDP			; CItemBagZt::LoadItem
_TEXT	ENDS
PUBLIC	?GetLevel@CItemBagZt@@AAEEH@Z			; CItemBagZt::GetLevel
EXTRN	_rand:PROC
; Function compile flags: /Ogtp
;	COMDAT ?GetLevel@CItemBagZt@@AAEEH@Z
_TEXT	SEGMENT
_n$ = 8							; size = 4
?GetLevel@CItemBagZt@@AAEEH@Z PROC			; CItemBagZt::GetLevel, COMDAT
; _this$ = ecx

; 200  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	53		 push	 ebx

; 201  : 	if ( n <0 || n > MAX_ITEMBAG_ATTR-1 )

  00004	8b 5d 08	 mov	 ebx, DWORD PTR _n$[ebp]
  00007	57		 push	 edi
  00008	8b f9		 mov	 edi, ecx
  0000a	81 fb 95 00 00
	00		 cmp	 ebx, 149		; 00000095H
  00010	77 34		 ja	 SHORT $LN3@GetLevel

; 204  : 	}
; 205  : 
; 206  : #if(FIX_CRASH==TRUE)
; 207  : 	if(this->BagObject[n].m_minLevel < 0 )
; 208  : 	{
; 209  : 		return 0;
; 210  : 	}
; 211  : 	if ( this->BagObject[n].m_minLevel >= this->BagObject[n].m_maxLevel )

  00012	8a 84 df 1f 02
	00 00		 mov	 al, BYTE PTR [edi+ebx*8+543]
  00019	8a 8c df 20 02
	00 00		 mov	 cl, BYTE PTR [edi+ebx*8+544]
  00020	3a c1		 cmp	 al, cl

; 212  : 	{
; 213  : 		return this->BagObject[n].m_minLevel;

  00022	73 24		 jae	 SHORT $LN5@GetLevel

; 214  : 	}
; 215  : #else
; 216  : 	if ( this->BagObject[n].m_minLevel == this->BagObject[n].m_maxLevel )
; 217  : 	{
; 218  : 		return this->BagObject[n].m_minLevel;
; 219  : 	}
; 220  : #endif
; 221  : 
; 222  : 	int sub = (this->BagObject[n].m_maxLevel - this->BagObject[n].m_minLevel) + 1;

  00024	56		 push	 esi
  00025	0f b6 f1	 movzx	 esi, cl
  00028	0f b6 c0	 movzx	 eax, al
  0002b	2b f0		 sub	 esi, eax
  0002d	46		 inc	 esi

; 223  : 	int level = this->BagObject[n].m_minLevel + (rand()%sub);

  0002e	e8 00 00 00 00	 call	 _rand
  00033	99		 cdq
  00034	f7 fe		 idiv	 esi
  00036	5e		 pop	 esi
  00037	8b c2		 mov	 eax, edx
  00039	02 84 df 1f 02
	00 00		 add	 al, BYTE PTR [edi+ebx*8+543]
  00040	5f		 pop	 edi
  00041	5b		 pop	 ebx

; 224  : 
; 225  : 	return level;
; 226  : }

  00042	5d		 pop	 ebp
  00043	c2 04 00	 ret	 4
$LN3@GetLevel:

; 202  : 	{
; 203  : 		return 0;

  00046	32 c0		 xor	 al, al
$LN5@GetLevel:
  00048	5f		 pop	 edi
  00049	5b		 pop	 ebx

; 224  : 
; 225  : 	return level;
; 226  : }

  0004a	5d		 pop	 ebp
  0004b	c2 04 00	 ret	 4
?GetLevel@CItemBagZt@@AAEEH@Z ENDP			; CItemBagZt::GetLevel
_TEXT	ENDS
PUBLIC	?IsEnableEventItemDrop@CItemBagZt@@AAEHH@Z	; CItemBagZt::IsEnableEventItemDrop
EXTRN	?gObj@@3PAUOBJECTSTRUCT@@A:DWORD		; gObj
; Function compile flags: /Ogtp
;	COMDAT ?IsEnableEventItemDrop@CItemBagZt@@AAEHH@Z
_TEXT	SEGMENT
_aIndex$ = 8						; size = 4
?IsEnableEventItemDrop@CItemBagZt@@AAEHH@Z PROC		; CItemBagZt::IsEnableEventItemDrop, COMDAT
; _this$ = ecx

; 229  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 230  : 	int iMapNumber = gObj[aIndex].MapNumber;

  00003	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  00006	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0000c	69 c0 50 2b 00
	00		 imul	 eax, 11088		; 00002b50H
  00012	03 d0		 add	 edx, eax
  00014	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  0001b	56		 push	 esi

; 231  : 
; 232  : 	if ( this->DropMapInfo[iMapNumber].m_bIsDrop == FALSE )

  0001c	8d 34 41	 lea	 esi, DWORD PTR [ecx+eax*2]
  0001f	80 bc 06 24 01
	00 00 00	 cmp	 BYTE PTR [esi+eax+292], 0

; 233  : 	{
; 234  : 		return FALSE;

  00027	74 2d		 je	 SHORT $LN1@IsEnableEv

; 235  : 	}
; 236  : 
; 237  : 	int iLevel = gObj[aIndex].Level;

  00029	0f bf 92 be 00
	00 00		 movsx	 edx, WORD PTR [edx+190]

; 238  : 
; 239  : 	if  ( iLevel < this->DropMapInfo[iMapNumber].m_MinMonsterLevel || iLevel > this->DropMapInfo[iMapNumber].m_MaxMonsterLevel)

  00030	0f b6 b4 06 25
	01 00 00	 movzx	 esi, BYTE PTR [esi+eax+293]
  00038	3b d6		 cmp	 edx, esi
  0003a	7c 1a		 jl	 SHORT $LN1@IsEnableEv
  0003c	8d 8c 41 c4 00
	00 00		 lea	 ecx, DWORD PTR [ecx+eax*2+196]
  00043	0f b6 44 08 62	 movzx	 eax, BYTE PTR [eax+ecx+98]
  00048	3b d0		 cmp	 edx, eax
  0004a	7f 0a		 jg	 SHORT $LN1@IsEnableEv

; 242  : 	}
; 243  : 
; 244  : 	return TRUE;

  0004c	b8 01 00 00 00	 mov	 eax, 1
  00051	5e		 pop	 esi

; 245  : }

  00052	5d		 pop	 ebp
  00053	c2 04 00	 ret	 4
$LN1@IsEnableEv:

; 240  : 	{
; 241  : 		return FALSE;

  00056	33 c0		 xor	 eax, eax
  00058	5e		 pop	 esi

; 245  : }

  00059	5d		 pop	 ebp
  0005a	c2 04 00	 ret	 4
?IsEnableEventItemDrop@CItemBagZt@@AAEHH@Z ENDP		; CItemBagZt::IsEnableEventItemDrop
_TEXT	ENDS
PUBLIC	??_C@_0CP@CFLKNDIJ@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$FL?$CFs?$FN?5MonsterEventItemDr@ ; `string'
PUBLIC	?DropEventItem@CItemBagZt@@QAEHH@Z		; CItemBagZt::DropEventItem
EXTRN	?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z:PROC	; ItemSerialCreateSend
EXTRN	?gObjMonsterTopHitDamageUser@@YAHPAUOBJECTSTRUCT@@@Z:PROC ; gObjMonsterTopHitDamageUser
;	COMDAT ??_C@_0CP@CFLKNDIJ@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$FL?$CFs?$FN?5MonsterEventItemDr@
CONST	SEGMENT
??_C@_0CP@CFLKNDIJ@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$FL?$CFs?$FN?5MonsterEventItemDr@ DB '['
	DB	'%s][%s] [%s] MonsterEventItemDrop (%d)(%d/%d)', 00H ; `string'
; Function compile flags: /Ogtp
CONST	ENDS
;	COMDAT ?DropEventItem@CItemBagZt@@QAEHH@Z
_TEXT	SEGMENT
_ei$210066 = -8						; size = 4
_eil$210067 = -4					; size = 4
_y$210069 = 8						; size = 4
_aIndex$ = 8						; size = 4
?DropEventItem@CItemBagZt@@QAEHH@Z PROC			; CItemBagZt::DropEventItem, COMDAT
; _this$ = ecx

; 249  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 08	 sub	 esp, 8
  00006	57		 push	 edi
  00007	8b f9		 mov	 edi, ecx

; 250  : 	if ( this->m_bLoad == FALSE )

  00009	83 7f 04 00	 cmp	 DWORD PTR [edi+4], 0
  0000d	75 09		 jne	 SHORT $LN3@DropEventI

; 251  : 	{
; 252  : 		return FALSE;

  0000f	33 c0		 xor	 eax, eax
  00011	5f		 pop	 edi

; 284  : }

  00012	8b e5		 mov	 esp, ebp
  00014	5d		 pop	 ebp
  00015	c2 04 00	 ret	 4
$LN3@DropEventI:
  00018	56		 push	 esi

; 253  : 	}
; 254  : 
; 255  : 	if ( this->IsEnableEventItemDrop(aIndex) == FALSE )

  00019	8b 75 08	 mov	 esi, DWORD PTR _aIndex$[ebp]
  0001c	56		 push	 esi
  0001d	e8 00 00 00 00	 call	 ?IsEnableEventItemDrop@CItemBagZt@@AAEHH@Z ; CItemBagZt::IsEnableEventItemDrop
  00022	85 c0		 test	 eax, eax

; 256  : 	{
; 257  : 		return FALSE;

  00024	0f 84 b1 00 00
	00		 je	 $LN1@DropEventI

; 258  : 	}
; 259  : 
; 260  : 	LPOBJ lpObj = &gObj[aIndex];

  0002a	69 f6 50 2b 00
	00		 imul	 esi, 11088		; 00002b50H
  00030	03 35 00 00 00
	00		 add	 esi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj

; 261  : 
; 262  : 	if ( (rand()%1000) < this->m_iEventItemDropRate )

  00036	e8 00 00 00 00	 call	 _rand
  0003b	99		 cdq
  0003c	b9 e8 03 00 00	 mov	 ecx, 1000		; 000003e8H
  00041	f7 f9		 idiv	 ecx
  00043	3b 97 14 01 00
	00		 cmp	 edx, DWORD PTR [edi+276]
  00049	0f 8d 8c 00 00
	00		 jge	 $LN1@DropEventI

; 263  : 	{
; 264  : 		int ei;
; 265  : 		int eil;
; 266  : 		int x;
; 267  : 		int y;
; 268  : 		float dur = 0;
; 269  : 		dur = 255.0;
; 270  : 
; 271  : 		x = lpObj->X;
; 272  : 		y = lpObj->Y;

  0004f	0f bf 96 46 01
	00 00		 movsx	 edx, WORD PTR [esi+326]

; 273  : 		eil = this->m_iEventItemLevel;

  00056	8b 87 0c 01 00
	00		 mov	 eax, DWORD PTR [edi+268]

; 274  : 		ei = this->m_iEventItemType;

  0005c	8b 8f 08 01 00
	00		 mov	 ecx, DWORD PTR [edi+264]
  00062	53		 push	 ebx
  00063	0f bf 9e 44 01
	00 00		 movsx	 ebx, WORD PTR [esi+324]

; 275  : 
; 276  : 		int thdu = gObjMonsterTopHitDamageUser(lpObj);

  0006a	56		 push	 esi
  0006b	89 55 08	 mov	 DWORD PTR _y$210069[ebp], edx
  0006e	89 45 fc	 mov	 DWORD PTR _eil$210067[ebp], eax
  00071	89 4d f8	 mov	 DWORD PTR _ei$210066[ebp], ecx
  00074	e8 00 00 00 00	 call	 ?gObjMonsterTopHitDamageUser@@YAHPAUOBJECTSTRUCT@@@Z ; gObjMonsterTopHitDamageUser

; 277  : 		ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x ,(BYTE)y, ei, (BYTE)eil, (BYTE)dur, 0, 0, 0, thdu, 0, 0);

  00079	8b 55 fc	 mov	 edx, DWORD PTR _eil$210067[ebp]
  0007c	8b 4d 08	 mov	 ecx, DWORD PTR _y$210069[ebp]
  0007f	6a 00		 push	 0
  00081	6a 00		 push	 0
  00083	50		 push	 eax
  00084	8b 45 f8	 mov	 eax, DWORD PTR _ei$210066[ebp]
  00087	6a 00		 push	 0
  00089	6a 00		 push	 0
  0008b	6a 00		 push	 0
  0008d	68 ff 00 00 00	 push	 255			; 000000ffH
  00092	52		 push	 edx
  00093	0f b6 96 49 01
	00 00		 movzx	 edx, BYTE PTR [esi+329]
  0009a	50		 push	 eax
  0009b	8b 06		 mov	 eax, DWORD PTR [esi]
  0009d	51		 push	 ecx
  0009e	53		 push	 ebx
  0009f	52		 push	 edx
  000a0	50		 push	 eax
  000a1	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 278  : 		LogAddTD("[%s][%s] [%s] MonsterEventItemDrop (%d)(%d/%d)", lpObj->AccountID, lpObj->Name, 
; 279  : 			this->m_sEventName, lpObj->MapNumber, x, y);

  000a6	8b 4d 08	 mov	 ecx, DWORD PTR _y$210069[ebp]
  000a9	0f b6 96 49 01
	00 00		 movzx	 edx, BYTE PTR [esi+329]
  000b0	51		 push	 ecx
  000b1	53		 push	 ebx
  000b2	52		 push	 edx
  000b3	83 c7 08	 add	 edi, 8
  000b6	57		 push	 edi
  000b7	8d 46 77	 lea	 eax, DWORD PTR [esi+119]
  000ba	50		 push	 eax
  000bb	83 c6 6c	 add	 esi, 108		; 0000006cH
  000be	56		 push	 esi
  000bf	68 00 00 00 00	 push	 OFFSET ??_C@_0CP@CFLKNDIJ@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$FL?$CFs?$FN?5MonsterEventItemDr@
  000c4	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  000ca	83 c4 54	 add	 esp, 84			; 00000054H
  000cd	5b		 pop	 ebx
  000ce	5e		 pop	 esi

; 280  : 		return TRUE;

  000cf	b8 01 00 00 00	 mov	 eax, 1
  000d4	5f		 pop	 edi

; 284  : }

  000d5	8b e5		 mov	 esp, ebp
  000d7	5d		 pop	 ebp
  000d8	c2 04 00	 ret	 4
$LN1@DropEventI:
  000db	5e		 pop	 esi

; 281  : 	}
; 282  : 
; 283  : 	return FALSE;

  000dc	33 c0		 xor	 eax, eax
  000de	5f		 pop	 edi

; 284  : }

  000df	8b e5		 mov	 esp, ebp
  000e1	5d		 pop	 ebp
  000e2	c2 04 00	 ret	 4
?DropEventItem@CItemBagZt@@QAEHH@Z ENDP			; CItemBagZt::DropEventItem
_TEXT	ENDS
PUBLIC	??_C@_0FF@LDONOBLP@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$FL?$CFs?$FN?5Event?5ItemDrop?5?3?5?$CI@ ; `string'
PUBLIC	?DropItem@CItemBagZt@@QAEHH@Z			; CItemBagZt::DropItem
EXTRN	?MoneyItemDrop@MapClass@@QAEHHHH@Z:PROC		; MapClass::MoneyItemDrop
EXTRN	?MapC@@3PAVMapClass@@A:BYTE			; MapC
EXTRN	?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A:BYTE	; ItemAttribute
EXTRN	?NewOptionRand@@YAEH@Z:PROC			; NewOptionRand
EXTRN	?ItemGetNumberMake@@YAHHH@Z:PROC		; ItemGetNumberMake
;	COMDAT ??_C@_0FF@LDONOBLP@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$FL?$CFs?$FN?5Event?5ItemDrop?5?3?5?$CI@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0FF@LDONOBLP@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$FL?$CFs?$FN?5Event?5ItemDrop?5?3?5?$CI@ DB '['
	DB	'%s][%s] [%s] Event ItemDrop : (%d)(%d/%d) Item:(%s)%d Level:%'
	DB	'd op1:%d op2:%d op3:%d', 00H		; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropItem@CItemBagZt@@QAEHH@Z
_TEXT	SEGMENT
_ExOption$ = -28					; size = 4
_x$ = -24						; size = 4
_y$ = -20						; size = 4
_level$ = -16						; size = 4
_Option2$ = -12						; size = 4
_Option1$ = -8						; size = 4
_Option3$ = -4						; size = 4
_DropItemNum$ = 8					; size = 4
_aIndex$ = 8						; size = 4
?DropItem@CItemBagZt@@QAEHH@Z PROC			; CItemBagZt::DropItem, COMDAT
; _this$ = ecx

; 288  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 1c	 sub	 esp, 28			; 0000001cH
  00006	53		 push	 ebx
  00007	8b d9		 mov	 ebx, ecx

; 289  : 	if ( this->m_bLoad == FALSE )

  00009	33 c0		 xor	 eax, eax
  0000b	39 43 04	 cmp	 DWORD PTR [ebx+4], eax
  0000e	75 07		 jne	 SHORT $LN14@DropItem
  00010	5b		 pop	 ebx

; 376  : }

  00011	8b e5		 mov	 esp, ebp
  00013	5d		 pop	 ebp
  00014	c2 04 00	 ret	 4
$LN14@DropItem:
  00017	56		 push	 esi

; 290  : 	{
; 291  : 		return FALSE;
; 292  : 	}
; 293  : 
; 294  : 	float dur;
; 295  : 	int type;
; 296  : 	int level;
; 297  : 	int x;
; 298  : 	int y;
; 299  : 	int Option1 = 0;
; 300  : 	int Option2 = 0;
; 301  : 	int Option3 = 0;
; 302  : 	int DropItemNum;
; 303  : 	int ExOption = 0;
; 304  : 	LPOBJ lpObj = &gObj[aIndex];

  00018	8b 75 08	 mov	 esi, DWORD PTR _aIndex$[ebp]
  0001b	69 f6 50 2b 00
	00		 imul	 esi, 11088		; 00002b50H
  00021	03 35 00 00 00
	00		 add	 esi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00027	89 45 f8	 mov	 DWORD PTR _Option1$[ebp], eax
  0002a	89 45 f4	 mov	 DWORD PTR _Option2$[ebp], eax
  0002d	89 45 fc	 mov	 DWORD PTR _Option3$[ebp], eax
  00030	89 45 e4	 mov	 DWORD PTR _ExOption$[ebp], eax

; 305  : 
; 306  : 	if ( this->GetBagCount() > 0 )

  00033	39 83 20 01 00
	00		 cmp	 DWORD PTR [ebx+288], eax
  00039	0f 8e 00 02 00
	00		 jle	 $LN12@DropItem

; 307  : 	{
; 308  : 		if ( (rand()%100) < this->m_iItemDropRate )

  0003f	e8 00 00 00 00	 call	 _rand
  00044	99		 cdq
  00045	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  0004a	f7 f9		 idiv	 ecx
  0004c	3b 93 18 01 00
	00		 cmp	 edx, DWORD PTR [ebx+280]
  00052	0f 8d e7 01 00
	00		 jge	 $LN12@DropItem

; 309  : 		{
; 310  : 			DropItemNum =  rand() % this->GetBagCount();

  00058	57		 push	 edi
  00059	8b bb 20 01 00
	00		 mov	 edi, DWORD PTR [ebx+288]
  0005f	e8 00 00 00 00	 call	 _rand
  00064	99		 cdq
  00065	f7 ff		 idiv	 edi

; 311  : 			dur = 0;
; 312  : 			x = lpObj->X;
; 313  : 			y = lpObj->Y;

  00067	0f bf 86 46 01
	00 00		 movsx	 eax, WORD PTR [esi+326]

; 314  : 			level = this->GetLevel(DropItemNum);

  0006e	8b cb		 mov	 ecx, ebx
  00070	89 45 ec	 mov	 DWORD PTR _y$[ebp], eax
  00073	8b fa		 mov	 edi, edx
  00075	0f bf 96 44 01
	00 00		 movsx	 edx, WORD PTR [esi+324]
  0007c	57		 push	 edi
  0007d	89 7d 08	 mov	 DWORD PTR _DropItemNum$[ebp], edi
  00080	89 55 e8	 mov	 DWORD PTR _x$[ebp], edx
  00083	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel

; 315  : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  00088	0f b6 94 fb 1e
	02 00 00	 movzx	 edx, BYTE PTR [ebx+edi*8+542]
  00090	0f b6 c8	 movzx	 ecx, al
  00093	0f b6 84 fb 1d
	02 00 00	 movzx	 eax, BYTE PTR [ebx+edi*8+541]
  0009b	52		 push	 edx
  0009c	50		 push	 eax
  0009d	89 4d f0	 mov	 DWORD PTR _level$[ebp], ecx
  000a0	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  000a5	8b f8		 mov	 edi, eax
  000a7	83 c4 08	 add	 esp, 8

; 316  : 
; 317  : 			if ( type == -1 )

  000aa	83 ff ff	 cmp	 edi, -1
  000ad	75 0b		 jne	 SHORT $LN11@DropItem

; 318  : 			{
; 319  : 				return FALSE;

  000af	5f		 pop	 edi
  000b0	5e		 pop	 esi
  000b1	33 c0		 xor	 eax, eax
  000b3	5b		 pop	 ebx

; 376  : }

  000b4	8b e5		 mov	 esp, ebp
  000b6	5d		 pop	 ebp
  000b7	c2 04 00	 ret	 4
$LN11@DropItem:

; 320  : 			}
; 321  : 
; 322  : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  000ba	8b 4d 08	 mov	 ecx, DWORD PTR _DropItemNum$[ebp]
  000bd	80 bc cb 21 02
	00 00 00	 cmp	 BYTE PTR [ebx+ecx*8+545], 0
  000c5	74 14		 je	 SHORT $LN21@DropItem

; 323  : 			{
; 324  : 				Option1 = rand()%2;

  000c7	e8 00 00 00 00	 call	 _rand
  000cc	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  000d1	79 05		 jns	 SHORT $LN28@DropItem
  000d3	48		 dec	 eax
  000d4	83 c8 fe	 or	 eax, -2			; fffffffeH
  000d7	40		 inc	 eax
$LN28@DropItem:
  000d8	89 45 f8	 mov	 DWORD PTR _Option1$[ebp], eax
$LN21@DropItem:

; 325  : 			}
; 326  : 
; 327  : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  000db	8b 55 08	 mov	 edx, DWORD PTR _DropItemNum$[ebp]
  000de	80 bc d3 22 02
	00 00 00	 cmp	 BYTE PTR [ebx+edx*8+546], 0
  000e6	74 14		 je	 SHORT $LN22@DropItem

; 328  : 			{
; 329  : 				Option2 = rand()%2;

  000e8	e8 00 00 00 00	 call	 _rand
  000ed	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  000f2	79 05		 jns	 SHORT $LN29@DropItem
  000f4	48		 dec	 eax
  000f5	83 c8 fe	 or	 eax, -2			; fffffffeH
  000f8	40		 inc	 eax
$LN29@DropItem:
  000f9	89 45 f4	 mov	 DWORD PTR _Option2$[ebp], eax
$LN22@DropItem:

; 330  : 			}
; 331  : 
; 332  : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  000fc	8b 45 08	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  000ff	80 bc c3 23 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+547], 0
  00107	74 2b		 je	 SHORT $LN23@DropItem

; 333  : 			{
; 334  : 				if ( rand()%5 < 1 )

  00109	e8 00 00 00 00	 call	 _rand
  0010e	99		 cdq
  0010f	b9 05 00 00 00	 mov	 ecx, 5
  00114	f7 f9		 idiv	 ecx
  00116	83 fa 01	 cmp	 edx, 1
  00119	7d 09		 jge	 SHORT $LN7@DropItem

; 335  : 				{
; 336  : 					Option3 = 3;

  0011b	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 337  : 				}
; 338  : 				else

  00122	eb 10		 jmp	 SHORT $LN23@DropItem
$LN7@DropItem:

; 339  : 				{
; 340  : 					Option3 = rand()%3;

  00124	e8 00 00 00 00	 call	 _rand
  00129	99		 cdq
  0012a	b9 03 00 00 00	 mov	 ecx, 3
  0012f	f7 f9		 idiv	 ecx
  00131	89 55 fc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN23@DropItem:

; 341  : 				}
; 342  : 			}
; 343  : 
; 344  : 			if ( this->BagObject[DropItemNum].m_isexitem != 0 )

  00134	8b 55 08	 mov	 edx, DWORD PTR _DropItemNum$[ebp]
  00137	80 bc d3 24 02
	00 00 00	 cmp	 BYTE PTR [ebx+edx*8+548], 0
  0013f	74 16		 je	 SHORT $LN24@DropItem

; 345  : 			{
; 346  : 				ExOption = NewOptionRand(0);

  00141	6a 00		 push	 0
  00143	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  00148	83 c4 04	 add	 esp, 4
  0014b	0f b6 d0	 movzx	 edx, al

; 347  : 				Option1 = 1;

  0014e	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
  00155	eb 03		 jmp	 SHORT $LN5@DropItem
$LN24@DropItem:
  00157	8b 55 e4	 mov	 edx, DWORD PTR _ExOption$[ebp]
$LN5@DropItem:

; 348  : 			}
; 349  : 
; 350  : 			if ( type == ITEMGET(12,15) || type == ITEMGET(14,13) || type == ITEMGET(14,14))	// Chaos, Bless, Soul

  0015a	81 ff 0f 18 00
	00		 cmp	 edi, 6159		; 0000180fH
  00160	74 10		 je	 SHORT $LN3@DropItem
  00162	81 ff 0d 1c 00
	00		 cmp	 edi, 7181		; 00001c0dH
  00168	74 08		 je	 SHORT $LN3@DropItem
  0016a	81 ff 0e 1c 00
	00		 cmp	 edi, 7182		; 00001c0eH
  00170	75 10		 jne	 SHORT $LN25@DropItem
$LN3@DropItem:

; 351  : 			{
; 352  : 				Option1 = 0;

  00172	33 c9		 xor	 ecx, ecx
  00174	89 4d f8	 mov	 DWORD PTR _Option1$[ebp], ecx

; 353  : 				Option2 = 0;

  00177	89 4d f4	 mov	 DWORD PTR _Option2$[ebp], ecx

; 354  : 				Option3 = 0;

  0017a	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx

; 355  : 				level = 0;

  0017d	89 4d f0	 mov	 DWORD PTR _level$[ebp], ecx
  00180	eb 02		 jmp	 SHORT $LN4@DropItem
$LN25@DropItem:
  00182	33 c9		 xor	 ecx, ecx
$LN4@DropItem:

; 356  : 			}
; 357  : 
; 358  : 			if ( type == ITEMGET(13,0) || type == ITEMGET(13,1) || type ==ITEMGET(13,2) ||
; 359  : 				 type == ITEMGET(13,8) || type == ITEMGET(13,9) || type == ITEMGET(13,12) ||
; 360  : 				 type ==ITEMGET(13,13) )	// Angel, imp, unirioa, dino, r and pendant of ice, poisonm

  00184	81 ff 00 1a 00
	00		 cmp	 edi, 6656		; 00001a00H
  0018a	74 30		 je	 SHORT $LN1@DropItem
  0018c	81 ff 01 1a 00
	00		 cmp	 edi, 6657		; 00001a01H
  00192	74 28		 je	 SHORT $LN1@DropItem
  00194	81 ff 02 1a 00
	00		 cmp	 edi, 6658		; 00001a02H
  0019a	74 20		 je	 SHORT $LN1@DropItem
  0019c	81 ff 08 1a 00
	00		 cmp	 edi, 6664		; 00001a08H
  001a2	74 18		 je	 SHORT $LN1@DropItem
  001a4	81 ff 09 1a 00
	00		 cmp	 edi, 6665		; 00001a09H
  001aa	74 10		 je	 SHORT $LN1@DropItem
  001ac	81 ff 0c 1a 00
	00		 cmp	 edi, 6668		; 00001a0cH
  001b2	74 08		 je	 SHORT $LN1@DropItem
  001b4	81 ff 0d 1a 00
	00		 cmp	 edi, 6669		; 00001a0dH
  001ba	75 03		 jne	 SHORT $LN2@DropItem
$LN1@DropItem:

; 361  : 			{
; 362  : 				level = 0;

  001bc	89 4d f0	 mov	 DWORD PTR _level$[ebp], ecx
$LN2@DropItem:

; 363  : 			}
; 364  : 
; 365  : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur, (BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  001bf	8b 06		 mov	 eax, DWORD PTR [esi]
  001c1	51		 push	 ecx
  001c2	52		 push	 edx
  001c3	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  001c6	50		 push	 eax
  001c7	52		 push	 edx
  001c8	8b 55 f4	 mov	 edx, DWORD PTR _Option2$[ebp]
  001cb	52		 push	 edx
  001cc	8b 55 f8	 mov	 edx, DWORD PTR _Option1$[ebp]
  001cf	52		 push	 edx
  001d0	8b 55 ec	 mov	 edx, DWORD PTR _y$[ebp]
  001d3	51		 push	 ecx
  001d4	8b 4d f0	 mov	 ecx, DWORD PTR _level$[ebp]
  001d7	51		 push	 ecx
  001d8	8b 4d e8	 mov	 ecx, DWORD PTR _x$[ebp]
  001db	57		 push	 edi
  001dc	52		 push	 edx
  001dd	0f b6 96 49 01
	00 00		 movzx	 edx, BYTE PTR [esi+329]
  001e4	51		 push	 ecx
  001e5	52		 push	 edx
  001e6	50		 push	 eax
  001e7	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 366  : 			LogAddTD("[%s][%s] [%s] Event ItemDrop : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d",
; 367  : 				lpObj->AccountID, lpObj->Name, this->m_sEventName, lpObj->MapNumber, x, y, ItemAttribute[type].Name, type, level, Option1, Option2, Option3);

  001ec	8b 45 fc	 mov	 eax, DWORD PTR _Option3$[ebp]
  001ef	8b 4d f4	 mov	 ecx, DWORD PTR _Option2$[ebp]
  001f2	8b 55 f8	 mov	 edx, DWORD PTR _Option1$[ebp]
  001f5	50		 push	 eax
  001f6	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  001f9	51		 push	 ecx
  001fa	8b 4d ec	 mov	 ecx, DWORD PTR _y$[ebp]
  001fd	52		 push	 edx
  001fe	8b 55 e8	 mov	 edx, DWORD PTR _x$[ebp]
  00201	50		 push	 eax
  00202	0f b6 86 49 01
	00 00		 movzx	 eax, BYTE PTR [esi+329]
  00209	57		 push	 edi
  0020a	6b ff 70	 imul	 edi, 112		; 00000070H
  0020d	81 c7 00 00 00
	00		 add	 edi, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  00213	57		 push	 edi
  00214	51		 push	 ecx
  00215	52		 push	 edx
  00216	50		 push	 eax
  00217	83 c3 08	 add	 ebx, 8
  0021a	53		 push	 ebx
  0021b	8d 4e 77	 lea	 ecx, DWORD PTR [esi+119]
  0021e	51		 push	 ecx
  0021f	83 c6 6c	 add	 esi, 108		; 0000006cH
  00222	56		 push	 esi
  00223	68 00 00 00 00	 push	 OFFSET ??_C@_0FF@LDONOBLP@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$FL?$CFs?$FN?5Event?5ItemDrop?5?3?5?$CI@
  00228	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  0022e	83 c4 68	 add	 esp, 104		; 00000068H
  00231	5f		 pop	 edi
  00232	5e		 pop	 esi

; 368  : 			return TRUE;

  00233	b8 01 00 00 00	 mov	 eax, 1
  00238	5b		 pop	 ebx

; 376  : }

  00239	8b e5		 mov	 esp, ebp
  0023b	5d		 pop	 ebp
  0023c	c2 04 00	 ret	 4
$LN12@DropItem:

; 369  : 		}
; 370  : 	}
; 371  : 
; 372  : 	x = lpObj->X;
; 373  : 	y = lpObj->Y;
; 374  : 	MapC[lpObj->MapNumber].MoneyItemDrop(this->m_iDropZen, x, y);

  0023f	0f bf 96 46 01
	00 00		 movsx	 edx, WORD PTR [esi+326]
  00246	0f bf 86 44 01
	00 00		 movsx	 eax, WORD PTR [esi+324]
  0024d	8b 8b 10 01 00
	00		 mov	 ecx, DWORD PTR [ebx+272]
  00253	52		 push	 edx
  00254	50		 push	 eax
  00255	51		 push	 ecx
  00256	0f b6 8e 49 01
	00 00		 movzx	 ecx, BYTE PTR [esi+329]
  0025d	69 c9 48 3d 05
	00		 imul	 ecx, 343368		; 00053d48H
  00263	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  00269	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop
  0026e	5e		 pop	 esi

; 375  : 	return TRUE;

  0026f	b8 01 00 00 00	 mov	 eax, 1
  00274	5b		 pop	 ebx

; 376  : }

  00275	8b e5		 mov	 esp, ebp
  00277	5d		 pop	 ebp
  00278	c2 04 00	 ret	 4
?DropItem@CItemBagZt@@QAEHH@Z ENDP			; CItemBagZt::DropItem
_TEXT	ENDS
PUBLIC	?GetMinLevel@CItemBagZt@@QAEEH@Z		; CItemBagZt::GetMinLevel
; Function compile flags: /Ogtp
;	COMDAT ?GetMinLevel@CItemBagZt@@QAEEH@Z
_TEXT	SEGMENT
_n$ = 8							; size = 4
?GetMinLevel@CItemBagZt@@QAEEH@Z PROC			; CItemBagZt::GetMinLevel, COMDAT
; _this$ = ecx

; 380  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 381  : 	if ( n<0 || n > MAX_ITEMBAG_ATTR-1 )

  00003	8b 45 08	 mov	 eax, DWORD PTR _n$[ebp]
  00006	3d 95 00 00 00	 cmp	 eax, 149		; 00000095H
  0000b	77 0b		 ja	 SHORT $LN1@GetMinLeve

; 383  : 
; 384  : 	return this->BagObject[n].m_minLevel;

  0000d	8a 84 c1 1f 02
	00 00		 mov	 al, BYTE PTR [ecx+eax*8+543]

; 385  : }

  00014	5d		 pop	 ebp
  00015	c2 04 00	 ret	 4
$LN1@GetMinLeve:

; 382  : 		return 0;

  00018	32 c0		 xor	 al, al

; 385  : }

  0001a	5d		 pop	 ebp
  0001b	c2 04 00	 ret	 4
?GetMinLevel@CItemBagZt@@QAEEH@Z ENDP			; CItemBagZt::GetMinLevel
_TEXT	ENDS
PUBLIC	?GetMaxLevel@CItemBagZt@@QAEEH@Z		; CItemBagZt::GetMaxLevel
; Function compile flags: /Ogtp
;	COMDAT ?GetMaxLevel@CItemBagZt@@QAEEH@Z
_TEXT	SEGMENT
_n$ = 8							; size = 4
?GetMaxLevel@CItemBagZt@@QAEEH@Z PROC			; CItemBagZt::GetMaxLevel, COMDAT
; _this$ = ecx

; 388  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 389  : 	if ( n<0 || n > MAX_ITEMBAG_ATTR-1 )

  00003	8b 45 08	 mov	 eax, DWORD PTR _n$[ebp]
  00006	3d 95 00 00 00	 cmp	 eax, 149		; 00000095H
  0000b	77 0b		 ja	 SHORT $LN1@GetMaxLeve

; 391  : 
; 392  : 	return this->BagObject[n].m_maxLevel;

  0000d	8a 84 c1 20 02
	00 00		 mov	 al, BYTE PTR [ecx+eax*8+544]

; 393  : }

  00014	5d		 pop	 ebp
  00015	c2 04 00	 ret	 4
$LN1@GetMaxLeve:

; 390  : 		return 0;

  00018	32 c0		 xor	 al, al

; 393  : }

  0001a	5d		 pop	 ebp
  0001b	c2 04 00	 ret	 4
?GetMaxLevel@CItemBagZt@@QAEEH@Z ENDP			; CItemBagZt::GetMaxLevel
_TEXT	ENDS
PUBLIC	__real@00000000
PUBLIC	?PickItem@CItemBagZt@@QAEHAAVCItem@@AAH@Z	; CItemBagZt::PickItem
;	COMDAT __real@00000000
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
__real@00000000 DD 000000000r			; 0
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?PickItem@CItemBagZt@@QAEHAAVCItem@@AAH@Z
_TEXT	SEGMENT
_objItem$ = 8						; size = 4
_nItemIndex$ = 12					; size = 4
?PickItem@CItemBagZt@@QAEHAAVCItem@@AAH@Z PROC		; CItemBagZt::PickItem, COMDAT
; _this$ = ecx

; 397  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	57		 push	 edi
  00004	8b f9		 mov	 edi, ecx

; 398  : 	if ( this->m_bLoad == FALSE )

  00006	83 7f 04 00	 cmp	 DWORD PTR [edi+4], 0
  0000a	75 07		 jne	 SHORT $LN11@PickItem

; 399  : 		return FALSE;

  0000c	33 c0		 xor	 eax, eax
  0000e	5f		 pop	 edi

; 456  : }

  0000f	5d		 pop	 ebp
  00010	c2 08 00	 ret	 8
$LN11@PickItem:
  00013	56		 push	 esi

; 400  : 
; 401  : 	int DropItemNum;
; 402  : 
; 403  : 	if ( this->GetBagCount() > 0 )

  00014	8b b7 20 01 00
	00		 mov	 esi, DWORD PTR [edi+288]
  0001a	85 f6		 test	 esi, esi
  0001c	0f 8e 2d 01 00
	00		 jle	 $LN10@PickItem

; 404  : 	{
; 405  : 		DropItemNum = rand() % this->GetBagCount();

  00022	53		 push	 ebx
  00023	e8 00 00 00 00	 call	 _rand
  00028	99		 cdq
  00029	f7 fe		 idiv	 esi

; 406  : 		nItemIndex = DropItemNum;

  0002b	8b 45 0c	 mov	 eax, DWORD PTR _nItemIndex$[ebp]

; 407  : 		objItem.m_Type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  0002e	8b 5d 08	 mov	 ebx, DWORD PTR _objItem$[ebp]
  00031	8b f2		 mov	 esi, edx
  00033	89 30		 mov	 DWORD PTR [eax], esi
  00035	0f b6 8c f7 1e
	02 00 00	 movzx	 ecx, BYTE PTR [edi+esi*8+542]
  0003d	0f b6 94 f7 1d
	02 00 00	 movzx	 edx, BYTE PTR [edi+esi*8+541]
  00045	51		 push	 ecx
  00046	52		 push	 edx
  00047	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  0004c	83 c4 08	 add	 esp, 8

; 408  : 		objItem.m_Level = this->GetLevel(DropItemNum);

  0004f	56		 push	 esi
  00050	8b cf		 mov	 ecx, edi
  00052	66 89 43 06	 mov	 WORD PTR [ebx+6], ax
  00056	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel

; 409  : 
; 410  : 		if ( objItem.m_Type == -1 )

  0005b	0f b7 4b 06	 movzx	 ecx, WORD PTR [ebx+6]
  0005f	0f b6 c0	 movzx	 eax, al
  00062	66 89 43 08	 mov	 WORD PTR [ebx+8], ax
  00066	66 83 f9 ff	 cmp	 cx, -1
  0006a	75 09		 jne	 SHORT $LN9@PickItem

; 411  : 			return FALSE;

  0006c	5b		 pop	 ebx
  0006d	5e		 pop	 esi
  0006e	33 c0		 xor	 eax, eax
  00070	5f		 pop	 edi

; 456  : }

  00071	5d		 pop	 ebp
  00072	c2 08 00	 ret	 8
$LN9@PickItem:

; 412  : 
; 413  : 		if ( this->BagObject[DropItemNum].m_isskill != 0 )

  00075	80 bc f7 21 02
	00 00 00	 cmp	 BYTE PTR [edi+esi*8+545], 0
  0007d	b8 01 00 00 00	 mov	 eax, 1
  00082	74 06		 je	 SHORT $LN8@PickItem

; 414  : 			objItem.m_Option1 = 1;

  00084	88 83 94 00 00
	00		 mov	 BYTE PTR [ebx+148], al
$LN8@PickItem:

; 415  : 
; 416  : 		if ( this->BagObject[DropItemNum].m_isluck != 0 )

  0008a	80 bc f7 22 02
	00 00 00	 cmp	 BYTE PTR [edi+esi*8+546], 0
  00092	74 06		 je	 SHORT $LN7@PickItem

; 417  : 			objItem.m_Option2 = 1;

  00094	88 83 95 00 00
	00		 mov	 BYTE PTR [ebx+149], al
$LN7@PickItem:

; 418  : 
; 419  : 		if ( this->BagObject[DropItemNum].m_isoption != 0 )

  0009a	80 bc f7 23 02
	00 00 00	 cmp	 BYTE PTR [edi+esi*8+547], 0
  000a2	74 06		 je	 SHORT $LN6@PickItem

; 420  : 			objItem.m_Option3 = 1;

  000a4	88 83 96 00 00
	00		 mov	 BYTE PTR [ebx+150], al
$LN6@PickItem:

; 421  : 
; 422  : 		if ( this->BagObject[DropItemNum].m_isexitem != 0 )

  000aa	80 bc f7 24 02
	00 00 00	 cmp	 BYTE PTR [edi+esi*8+548], 0
  000b2	74 0f		 je	 SHORT $LN5@PickItem

; 423  : 		{
; 424  : 			objItem.m_NewOption = 1;

  000b4	88 83 97 00 00
	00		 mov	 BYTE PTR [ebx+151], al

; 425  : 			objItem.m_Option1 = 0;

  000ba	66 c7 83 94 00
	00 00 00 00	 mov	 WORD PTR [ebx+148], 0
$LN5@PickItem:

; 426  : 			objItem.m_Option2 = 0;
; 427  : 		}
; 428  : 
; 429  : 		if ( objItem.m_Type == ITEMGET(12,15) ||
; 430  : 			 objItem.m_Type == ITEMGET(14,13) ||
; 431  : 			 objItem.m_Type == ITEMGET(14,14) )

  000c3	ba 0f 18 00 00	 mov	 edx, 6159		; 0000180fH
  000c8	66 3b ca	 cmp	 cx, dx
  000cb	74 14		 je	 SHORT $LN3@PickItem
  000cd	ba 0d 1c 00 00	 mov	 edx, 7181		; 00001c0dH
  000d2	66 3b ca	 cmp	 cx, dx
  000d5	74 0a		 je	 SHORT $LN3@PickItem
  000d7	ba 0e 1c 00 00	 mov	 edx, 7182		; 00001c0eH
  000dc	66 3b ca	 cmp	 cx, dx
  000df	75 16		 jne	 SHORT $LN4@PickItem
$LN3@PickItem:

; 432  : 		{
; 433  : 			objItem.m_Option1 = 0;
; 434  : 			objItem.m_Option2 = 0;
; 435  : 			objItem.m_Option3 = 0;
; 436  : 			objItem.m_Level = 0;

  000e1	33 d2		 xor	 edx, edx
  000e3	66 c7 83 94 00
	00 00 00 00	 mov	 WORD PTR [ebx+148], 0
  000ec	c6 83 96 00 00
	00 00		 mov	 BYTE PTR [ebx+150], 0
  000f3	66 89 53 08	 mov	 WORD PTR [ebx+8], dx
$LN4@PickItem:

; 437  : 		}
; 438  : 
; 439  : 		if ( objItem.m_Type == ITEMGET(13,0) ||
; 440  : 			 objItem.m_Type == ITEMGET(13,1) ||
; 441  : 			 objItem.m_Type == ITEMGET(13,2) ||
; 442  : 			 objItem.m_Type == ITEMGET(13,8) ||
; 443  : 			 objItem.m_Type == ITEMGET(13,9) ||
; 444  : 			 objItem.m_Type == ITEMGET(13,12) ||
; 445  : 			 objItem.m_Type == ITEMGET(13,13) )

  000f7	ba 00 1a 00 00	 mov	 edx, 6656		; 00001a00H
  000fc	66 3b ca	 cmp	 cx, dx
  000ff	74 3c		 je	 SHORT $LN1@PickItem
  00101	ba 01 1a 00 00	 mov	 edx, 6657		; 00001a01H
  00106	66 3b ca	 cmp	 cx, dx
  00109	74 32		 je	 SHORT $LN1@PickItem
  0010b	ba 02 1a 00 00	 mov	 edx, 6658		; 00001a02H
  00110	66 3b ca	 cmp	 cx, dx
  00113	74 28		 je	 SHORT $LN1@PickItem
  00115	ba 08 1a 00 00	 mov	 edx, 6664		; 00001a08H
  0011a	66 3b ca	 cmp	 cx, dx
  0011d	74 1e		 je	 SHORT $LN1@PickItem
  0011f	ba 09 1a 00 00	 mov	 edx, 6665		; 00001a09H
  00124	66 3b ca	 cmp	 cx, dx
  00127	74 14		 je	 SHORT $LN1@PickItem
  00129	ba 0c 1a 00 00	 mov	 edx, 6668		; 00001a0cH
  0012e	66 3b ca	 cmp	 cx, dx
  00131	74 0a		 je	 SHORT $LN1@PickItem
  00133	ba 0d 1a 00 00	 mov	 edx, 6669		; 00001a0dH
  00138	66 3b ca	 cmp	 cx, dx
  0013b	75 06		 jne	 SHORT $LN2@PickItem
$LN1@PickItem:

; 446  : 		{
; 447  : 			objItem.m_Level = 0;

  0013d	33 c9		 xor	 ecx, ecx
  0013f	66 89 4b 08	 mov	 WORD PTR [ebx+8], cx
$LN2@PickItem:

; 448  : 		}
; 449  : 
; 450  : 		objItem.m_Durability = 0;

  00143	d9 ee		 fldz
  00145	d9 5b 24	 fstp	 DWORD PTR [ebx+36]
  00148	5b		 pop	 ebx
  00149	5e		 pop	 esi
  0014a	5f		 pop	 edi

; 456  : }

  0014b	5d		 pop	 ebp
  0014c	c2 08 00	 ret	 8
$LN10@PickItem:
  0014f	5e		 pop	 esi

; 451  : 
; 452  : 		return TRUE;
; 453  : 	}
; 454  : 
; 455  : 	return FALSE;

  00150	33 c0		 xor	 eax, eax
  00152	5f		 pop	 edi

; 456  : }

  00153	5d		 pop	 ebp
  00154	c2 08 00	 ret	 8
?PickItem@CItemBagZt@@QAEHAAVCItem@@AAH@Z ENDP		; CItemBagZt::PickItem
_TEXT	ENDS
PUBLIC	??_C@_0JJ@BMBIJJKC@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5RED@ ; `string'
PUBLIC	??_C@_0EH@BHMHGNEI@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5RIBB@ ; `string'
PUBLIC	?DropRedRibbonBoxEventItem@CItemBagZt@@QAEHH@Z	; CItemBagZt::DropRedRibbonBoxEventItem
EXTRN	?DataSend@@YAHHPAEK@Z:PROC			; DataSend
EXTRN	?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z:PROC	; MsgSendV2
EXTRN	?PHeadSubSetB@@YAXPAEEEH@Z:PROC			; PHeadSubSetB
EXTRN	?g_iRedRibbonBoxDropZen@@3HA:DWORD		; g_iRedRibbonBoxDropZen
EXTRN	?g_iRedRibbonBoxDropZenRate@@3HA:DWORD		; g_iRedRibbonBoxDropZenRate
;	COMDAT ??_C@_0JJ@BMBIJJKC@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5RED@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0JJ@BMBIJJKC@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5RED@ DB '[EVENT'
	DB	' CHRISTMAS RIBBONBOX ] REDRIBBONBOX Event ItemDrop [%s][%s] ['
	DB	'%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d E'
	DB	'x:[%d,%d,%d,%d,%d,%d,%d]', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0EH@BHMHGNEI@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5RIBB@
CONST	SEGMENT
??_C@_0EH@BHMHGNEI@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5RIBB@ DB '[EVENT '
	DB	'CHRISTMAS RIBBONBOX] RIBBONBOX Event ItemDrop [%s][%s] [%d Ze'
	DB	'n]', 00H					; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropRedRibbonBoxEventItem@CItemBagZt@@QAEHH@Z
_TEXT	SEGMENT
_ServerCmd$210188 = -32					; size = 7
_x$ = -24						; size = 4
_y$ = -20						; size = 4
_DropItemNum$ = -16					; size = 4
_Option1$ = -12						; size = 4
_Option2$ = -8						; size = 4
_Option3$ = -4						; size = 4
_level$ = 8						; size = 4
_aIndex$ = 8						; size = 4
?DropRedRibbonBoxEventItem@CItemBagZt@@QAEHH@Z PROC	; CItemBagZt::DropRedRibbonBoxEventItem, COMDAT
; _this$ = ecx

; 459  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 20	 sub	 esp, 32			; 00000020H
  00006	53		 push	 ebx
  00007	8b d9		 mov	 ebx, ecx

; 460  : 	if ( this->m_bLoad == FALSE )

  00009	33 c0		 xor	 eax, eax
  0000b	39 43 04	 cmp	 DWORD PTR [ebx+4], eax
  0000e	75 07		 jne	 SHORT $LN15@DropRedRib
  00010	5b		 pop	 ebx

; 568  : }

  00011	8b e5		 mov	 esp, ebp
  00013	5d		 pop	 ebp
  00014	c2 04 00	 ret	 4
$LN15@DropRedRib:
  00017	56		 push	 esi

; 461  : 		return FALSE;
; 462  : 
; 463  : 	float dur;
; 464  : 	int type;
; 465  : 	int level;
; 466  : 	int x;
; 467  : 	int y;
; 468  : 	int Option1 = 0;
; 469  : 	int Option2 = 0;
; 470  : 	int Option3 = 0;
; 471  : 	int DropItemRate;
; 472  : 	int DropItemNum;
; 473  : 	int ExOption = 0;
; 474  : 	LPOBJ lpObj = &gObj[aIndex];

  00018	8b 75 08	 mov	 esi, DWORD PTR _aIndex$[ebp]
  0001b	69 f6 50 2b 00
	00		 imul	 esi, 11088		; 00002b50H
  00021	03 35 00 00 00
	00		 add	 esi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00027	57		 push	 edi
  00028	89 45 f4	 mov	 DWORD PTR _Option1$[ebp], eax
  0002b	89 45 f8	 mov	 DWORD PTR _Option2$[ebp], eax
  0002e	89 45 fc	 mov	 DWORD PTR _Option3$[ebp], eax

; 475  : 
; 476  : 	if ( this->GetBagCount() > 0 )

  00031	39 83 20 01 00
	00		 cmp	 DWORD PTR [ebx+288], eax
  00037	0f 8e 51 02 00
	00		 jle	 $LN14@DropRedRib

; 477  : 	{
; 478  : 		DropItemRate = rand() % 10000;

  0003d	e8 00 00 00 00	 call	 _rand
  00042	99		 cdq
  00043	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  00048	f7 f9		 idiv	 ecx

; 479  : 
; 480  : 		if ( DropItemRate < g_iRedRibbonBoxDropZenRate )

  0004a	3b 15 00 00 00
	00		 cmp	 edx, DWORD PTR ?g_iRedRibbonBoxDropZenRate@@3HA ; g_iRedRibbonBoxDropZenRate
  00050	7d 51		 jge	 SHORT $LN13@DropRedRib

; 481  : 		{
; 482  : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iRedRibbonBoxDropZen, 
; 483  : 				lpObj->X, lpObj->Y);

  00052	0f bf 96 46 01
	00 00		 movsx	 edx, WORD PTR [esi+326]
  00059	0f bf 86 44 01
	00 00		 movsx	 eax, WORD PTR [esi+324]
  00060	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iRedRibbonBoxDropZen@@3HA ; g_iRedRibbonBoxDropZen
  00066	52		 push	 edx
  00067	50		 push	 eax
  00068	51		 push	 ecx
  00069	0f b6 8e 49 01
	00 00		 movzx	 ecx, BYTE PTR [esi+329]
  00070	69 c9 48 3d 05
	00		 imul	 ecx, 343368		; 00053d48H
  00076	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  0007c	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 484  : 
; 485  : 			LogAddTD("[EVENT CHRISTMAS RIBBONBOX] RIBBONBOX Event ItemDrop [%s][%s] [%d Zen]",
; 486  : 				lpObj->AccountID, lpObj->Name,
; 487  : 				g_iRedRibbonBoxDropZen);

  00081	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?g_iRedRibbonBoxDropZen@@3HA ; g_iRedRibbonBoxDropZen
  00087	52		 push	 edx
  00088	8d 46 77	 lea	 eax, DWORD PTR [esi+119]
  0008b	50		 push	 eax
  0008c	8d 4e 6c	 lea	 ecx, DWORD PTR [esi+108]
  0008f	51		 push	 ecx
  00090	68 00 00 00 00	 push	 OFFSET ??_C@_0EH@BHMHGNEI@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5RIBB@
  00095	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  0009b	83 c4 10	 add	 esp, 16			; 00000010H

; 488  : 		}
; 489  : 		else

  0009e	e9 a6 01 00 00	 jmp	 $LN12@DropRedRib
$LN13@DropRedRib:

; 490  : 		{
; 491  : 			DropItemNum = rand() % this->GetBagCount();

  000a3	8b bb 20 01 00
	00		 mov	 edi, DWORD PTR [ebx+288]
  000a9	e8 00 00 00 00	 call	 _rand
  000ae	99		 cdq
  000af	f7 ff		 idiv	 edi

; 492  : 			dur = 0;
; 493  : 			x = lpObj->X;
; 494  : 			y = lpObj->Y;

  000b1	0f bf 86 46 01
	00 00		 movsx	 eax, WORD PTR [esi+326]

; 495  : 			level = this->GetLevel(DropItemNum);

  000b8	8b cb		 mov	 ecx, ebx
  000ba	89 45 ec	 mov	 DWORD PTR _y$[ebp], eax
  000bd	8b fa		 mov	 edi, edx
  000bf	0f bf 96 44 01
	00 00		 movsx	 edx, WORD PTR [esi+324]
  000c6	57		 push	 edi
  000c7	89 7d f0	 mov	 DWORD PTR _DropItemNum$[ebp], edi
  000ca	89 55 e8	 mov	 DWORD PTR _x$[ebp], edx
  000cd	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel

; 496  : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  000d2	0f b6 94 fb 1e
	02 00 00	 movzx	 edx, BYTE PTR [ebx+edi*8+542]
  000da	0f b6 c8	 movzx	 ecx, al
  000dd	0f b6 84 fb 1d
	02 00 00	 movzx	 eax, BYTE PTR [ebx+edi*8+541]
  000e5	52		 push	 edx
  000e6	50		 push	 eax
  000e7	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
  000ea	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  000ef	8b f8		 mov	 edi, eax
  000f1	83 c4 08	 add	 esp, 8

; 497  : 
; 498  : 			if ( type == -1 )

  000f4	83 ff ff	 cmp	 edi, -1
  000f7	75 0b		 jne	 SHORT $LN11@DropRedRib

; 499  : 				return FALSE;

  000f9	5f		 pop	 edi
  000fa	5e		 pop	 esi
  000fb	33 c0		 xor	 eax, eax
  000fd	5b		 pop	 ebx

; 568  : }

  000fe	8b e5		 mov	 esp, ebp
  00100	5d		 pop	 ebp
  00101	c2 04 00	 ret	 4
$LN11@DropRedRib:

; 500  : 
; 501  : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  00104	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00107	80 bc c3 21 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+545], 0
  0010f	74 07		 je	 SHORT $LN22@DropRedRib

; 502  : 				Option1 = 1;

  00111	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN22@DropRedRib:

; 503  : 
; 504  : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  00118	80 bc c3 22 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+546], 0
  00120	74 21		 je	 SHORT $LN23@DropRedRib

; 505  : 			{
; 506  : 				Option2 = 0;

  00122	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 507  : 
; 508  : 				if ( (rand()%2) == 0 )

  00129	e8 00 00 00 00	 call	 _rand
  0012e	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  00133	79 05		 jns	 SHORT $LN29@DropRedRib
  00135	48		 dec	 eax
  00136	83 c8 fe	 or	 eax, -2			; fffffffeH
  00139	40		 inc	 eax
$LN29@DropRedRib:
  0013a	75 07		 jne	 SHORT $LN23@DropRedRib

; 509  : 				{
; 510  : 					Option2 = 1;

  0013c	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN23@DropRedRib:

; 511  : 				}
; 512  : 			}
; 513  : 
; 514  : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  00143	8b 4d f0	 mov	 ecx, DWORD PTR _DropItemNum$[ebp]
  00146	80 bc cb 23 02
	00 00 00	 cmp	 BYTE PTR [ebx+ecx*8+547], 0
  0014e	74 2b		 je	 SHORT $LN25@DropRedRib

; 515  : 			{
; 516  : 				if ( (rand()%5) < 1 )

  00150	e8 00 00 00 00	 call	 _rand
  00155	99		 cdq
  00156	b9 05 00 00 00	 mov	 ecx, 5
  0015b	f7 f9		 idiv	 ecx
  0015d	83 fa 01	 cmp	 edx, 1
  00160	7d 09		 jge	 SHORT $LN6@DropRedRib

; 517  : 				{
; 518  : 					Option3 = 3;

  00162	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 519  : 				}
; 520  : 				else

  00169	eb 10		 jmp	 SHORT $LN25@DropRedRib
$LN6@DropRedRib:

; 521  : 				{
; 522  : 					Option3 = rand() % 3;

  0016b	e8 00 00 00 00	 call	 _rand
  00170	99		 cdq
  00171	b9 03 00 00 00	 mov	 ecx, 3
  00176	f7 f9		 idiv	 ecx
  00178	89 55 fc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN25@DropRedRib:

; 523  : 				}
; 524  : 			}
; 525  : 
; 526  : 			ExOption = 0;
; 527  : 
; 528  : 			if ( type == ITEMGET(12,15) ||
; 529  : 				 type == ITEMGET(14,13) ||
; 530  : 				 type == ITEMGET(14,14) )

  0017b	81 ff 0f 18 00
	00		 cmp	 edi, 6159		; 0000180fH
  00181	74 10		 je	 SHORT $LN3@DropRedRib
  00183	81 ff 0d 1c 00
	00		 cmp	 edi, 7181		; 00001c0dH
  00189	74 08		 je	 SHORT $LN3@DropRedRib
  0018b	81 ff 0e 1c 00
	00		 cmp	 edi, 7182		; 00001c0eH
  00191	75 10		 jne	 SHORT $LN26@DropRedRib
$LN3@DropRedRib:

; 531  : 			{
; 532  : 				Option1 = 0;

  00193	33 c9		 xor	 ecx, ecx
  00195	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx

; 533  : 				Option2 = 0;

  00198	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx

; 534  : 				Option3 = 0;

  0019b	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx

; 535  : 				level = 0;

  0019e	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
  001a1	eb 02		 jmp	 SHORT $LN4@DropRedRib
$LN26@DropRedRib:
  001a3	33 c9		 xor	 ecx, ecx
$LN4@DropRedRib:

; 536  : 			}
; 537  : 
; 538  : 			if ( type == ITEMGET(14,19) ||
; 539  : 				 type == ITEMGET(14,28) ||
; 540  : 				 type == ITEMGET(13,18) )

  001a5	81 ff 13 1c 00
	00		 cmp	 edi, 7187		; 00001c13H
  001ab	74 10		 je	 SHORT $LN1@DropRedRib
  001ad	81 ff 1c 1c 00
	00		 cmp	 edi, 7196		; 00001c1cH
  001b3	74 08		 je	 SHORT $LN1@DropRedRib
  001b5	81 ff 12 1a 00
	00		 cmp	 edi, 6674		; 00001a12H
  001bb	75 09		 jne	 SHORT $LN2@DropRedRib
$LN1@DropRedRib:

; 541  : 			{
; 542  : 				Option1 = 0;

  001bd	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx

; 543  : 				Option2 = 0;

  001c0	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx

; 544  : 				Option3 = 0;

  001c3	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx
$LN2@DropRedRib:

; 545  : 			}
; 546  : 			
; 547  : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 548  : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  001c6	8b 06		 mov	 eax, DWORD PTR [esi]
  001c8	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  001cb	51		 push	 ecx
  001cc	51		 push	 ecx
  001cd	50		 push	 eax
  001ce	52		 push	 edx
  001cf	8b 55 f8	 mov	 edx, DWORD PTR _Option2$[ebp]
  001d2	52		 push	 edx
  001d3	8b 55 f4	 mov	 edx, DWORD PTR _Option1$[ebp]
  001d6	52		 push	 edx
  001d7	8b 55 ec	 mov	 edx, DWORD PTR _y$[ebp]
  001da	51		 push	 ecx
  001db	8b 4d 08	 mov	 ecx, DWORD PTR _level$[ebp]
  001de	51		 push	 ecx
  001df	8b 4d e8	 mov	 ecx, DWORD PTR _x$[ebp]
  001e2	57		 push	 edi
  001e3	52		 push	 edx
  001e4	0f b6 96 49 01
	00 00		 movzx	 edx, BYTE PTR [esi+329]
  001eb	51		 push	 ecx
  001ec	52		 push	 edx
  001ed	50		 push	 eax
  001ee	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 549  : 
; 550  : 			LogAddTD("[EVENT CHRISTMAS RIBBONBOX ] REDRIBBONBOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 551  : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 552  : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 553  : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  001f3	8b 45 fc	 mov	 eax, DWORD PTR _Option3$[ebp]
  001f6	8b 4d f8	 mov	 ecx, DWORD PTR _Option2$[ebp]
  001f9	6a 00		 push	 0
  001fb	8b 55 f4	 mov	 edx, DWORD PTR _Option1$[ebp]
  001fe	6a 00		 push	 0
  00200	6a 00		 push	 0
  00202	6a 00		 push	 0
  00204	6a 00		 push	 0
  00206	6a 00		 push	 0
  00208	6a 00		 push	 0
  0020a	50		 push	 eax
  0020b	8b 45 08	 mov	 eax, DWORD PTR _level$[ebp]
  0020e	51		 push	 ecx
  0020f	8b 4d ec	 mov	 ecx, DWORD PTR _y$[ebp]
  00212	52		 push	 edx
  00213	8b 55 e8	 mov	 edx, DWORD PTR _x$[ebp]
  00216	50		 push	 eax
  00217	0f b6 86 49 01
	00 00		 movzx	 eax, BYTE PTR [esi+329]
  0021e	57		 push	 edi
  0021f	6b ff 70	 imul	 edi, 112		; 00000070H
  00222	81 c7 00 00 00
	00		 add	 edi, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  00228	57		 push	 edi
  00229	51		 push	 ecx
  0022a	52		 push	 edx
  0022b	50		 push	 eax
  0022c	83 c3 08	 add	 ebx, 8
  0022f	53		 push	 ebx
  00230	8d 4e 77	 lea	 ecx, DWORD PTR [esi+119]
  00233	51		 push	 ecx
  00234	8d 56 6c	 lea	 edx, DWORD PTR [esi+108]
  00237	52		 push	 edx
  00238	68 00 00 00 00	 push	 OFFSET ??_C@_0JJ@BMBIJJKC@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5RED@
  0023d	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  00243	81 c4 84 00 00
	00		 add	 esp, 132		; 00000084H
$LN12@DropRedRib:

; 554  : 		}
; 555  : 
; 556  : 		PMSG_SERVERCMD ServerCmd;
; 557  : 
; 558  : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  00249	6a 07		 push	 7
  0024b	6a 40		 push	 64			; 00000040H
  0024d	8d 45 e0	 lea	 eax, DWORD PTR _ServerCmd$210188[ebp]
  00250	68 f3 00 00 00	 push	 243			; 000000f3H
  00255	50		 push	 eax
  00256	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB

; 559  : 		ServerCmd.CmdType = 0;
; 560  : 		ServerCmd.X = lpObj->X;

  0025b	8a 8e 44 01 00
	00		 mov	 cl, BYTE PTR [esi+324]

; 561  : 		ServerCmd.Y = lpObj->Y;

  00261	8a 96 46 01 00
	00		 mov	 dl, BYTE PTR [esi+326]

; 562  : 
; 563  : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  00267	6a 07		 push	 7
  00269	8d 45 e0	 lea	 eax, DWORD PTR _ServerCmd$210188[ebp]
  0026c	50		 push	 eax
  0026d	56		 push	 esi
  0026e	c6 45 e4 00	 mov	 BYTE PTR _ServerCmd$210188[ebp+4], 0
  00272	88 4d e5	 mov	 BYTE PTR _ServerCmd$210188[ebp+5], cl
  00275	88 55 e6	 mov	 BYTE PTR _ServerCmd$210188[ebp+6], dl
  00278	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2

; 564  : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  0027d	8b 16		 mov	 edx, DWORD PTR [esi]
  0027f	6a 07		 push	 7
  00281	8d 4d e0	 lea	 ecx, DWORD PTR _ServerCmd$210188[ebp]
  00284	51		 push	 ecx
  00285	52		 push	 edx
  00286	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  0028b	83 c4 28	 add	 esp, 40			; 00000028H
$LN14@DropRedRib:

; 565  : 	}
; 566  : 
; 567  : 	return TRUE;

  0028e	5f		 pop	 edi
  0028f	5e		 pop	 esi
  00290	b8 01 00 00 00	 mov	 eax, 1
  00295	5b		 pop	 ebx

; 568  : }

  00296	8b e5		 mov	 esp, ebp
  00298	5d		 pop	 ebp
  00299	c2 04 00	 ret	 4
?DropRedRibbonBoxEventItem@CItemBagZt@@QAEHH@Z ENDP	; CItemBagZt::DropRedRibbonBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0JL@ICGIGFIG@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5GRE@ ; `string'
PUBLIC	??_C@_0EM@PFFONPLH@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5GREE@ ; `string'
PUBLIC	?DropGreenRibbonBoxEventItem@CItemBagZt@@QAEHH@Z ; CItemBagZt::DropGreenRibbonBoxEventItem
EXTRN	?g_iGreenRibbonBoxDropZen@@3HA:DWORD		; g_iGreenRibbonBoxDropZen
EXTRN	?g_iGreenRibbonBoxDropZenRate@@3HA:DWORD	; g_iGreenRibbonBoxDropZenRate
;	COMDAT ??_C@_0JL@ICGIGFIG@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5GRE@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0JL@ICGIGFIG@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5GRE@ DB '[EVENT'
	DB	' CHRISTMAS RIBBONBOX ] GREENRIBBONBOX Event ItemDrop [%s][%s]'
	DB	' [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d'
	DB	' Ex:[%d,%d,%d,%d,%d,%d,%d]', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0EM@PFFONPLH@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5GREE@
CONST	SEGMENT
??_C@_0EM@PFFONPLH@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5GREE@ DB '[EVENT '
	DB	'CHRISTMAS RIBBONBOX] GREENRIBBONBOX Event ItemDrop [%s][%s] ['
	DB	'%d Zen]', 00H				; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropGreenRibbonBoxEventItem@CItemBagZt@@QAEHH@Z
_TEXT	SEGMENT
_ServerCmd$210235 = -36					; size = 7
_x$ = -28						; size = 4
_y$ = -24						; size = 4
_this$ = -20						; size = 4
_DropItemNum$ = -16					; size = 4
_Option1$ = -12						; size = 4
_Option2$ = -8						; size = 4
_Option3$ = -4						; size = 4
$T211213 = 8						; size = 4
_level$ = 8						; size = 4
_aIndex$ = 8						; size = 4
?DropGreenRibbonBoxEventItem@CItemBagZt@@QAEHH@Z PROC	; CItemBagZt::DropGreenRibbonBoxEventItem, COMDAT
; _this$ = ecx

; 572  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 24	 sub	 esp, 36			; 00000024H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	8b d9		 mov	 ebx, ecx

; 573  : 	if ( this->m_bLoad == FALSE )

  0000a	33 f6		 xor	 esi, esi
  0000c	89 5d ec	 mov	 DWORD PTR _this$[ebp], ebx
  0000f	39 73 04	 cmp	 DWORD PTR [ebx+4], esi
  00012	75 0a		 jne	 SHORT $LN16@DropGreenR

; 574  : 		return FALSE;

  00014	5e		 pop	 esi
  00015	33 c0		 xor	 eax, eax
  00017	5b		 pop	 ebx

; 690  : }

  00018	8b e5		 mov	 esp, ebp
  0001a	5d		 pop	 ebp
  0001b	c2 04 00	 ret	 4
$LN16@DropGreenR:
  0001e	57		 push	 edi

; 575  : 
; 576  : 	float dur;
; 577  : 	int type;
; 578  : 	int level;
; 579  : 	int x;
; 580  : 	int y;
; 581  : 	int Option1 = 0;
; 582  : 	int Option2 = 0;
; 583  : 	int Option3 = 0;
; 584  : 	int DropItemRate;
; 585  : 	int DropItemNum;
; 586  : 	int ExOption = 0;
; 587  : 	LPOBJ lpObj = &gObj[aIndex];

  0001f	8b 7d 08	 mov	 edi, DWORD PTR _aIndex$[ebp]
  00022	69 ff 50 2b 00
	00		 imul	 edi, 11088		; 00002b50H
  00028	03 3d 00 00 00
	00		 add	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0002e	89 75 f4	 mov	 DWORD PTR _Option1$[ebp], esi
  00031	89 75 f8	 mov	 DWORD PTR _Option2$[ebp], esi
  00034	89 75 fc	 mov	 DWORD PTR _Option3$[ebp], esi

; 588  : 
; 589  : 	if ( this->GetBagCount() > 0 )

  00037	39 b3 20 01 00
	00		 cmp	 DWORD PTR [ebx+288], esi
  0003d	0f 8e b0 02 00
	00		 jle	 $LN15@DropGreenR

; 590  : 	{
; 591  : 		DropItemRate = rand() % 10000;

  00043	e8 00 00 00 00	 call	 _rand
  00048	99		 cdq
  00049	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  0004e	f7 f9		 idiv	 ecx

; 592  : 
; 593  : 		if ( DropItemRate < g_iGreenRibbonBoxDropZenRate )

  00050	3b 15 00 00 00
	00		 cmp	 edx, DWORD PTR ?g_iGreenRibbonBoxDropZenRate@@3HA ; g_iGreenRibbonBoxDropZenRate
  00056	7d 51		 jge	 SHORT $LN14@DropGreenR

; 594  : 		{
; 595  : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iGreenRibbonBoxDropZen, 
; 596  : 				lpObj->X, lpObj->Y);

  00058	0f bf 97 46 01
	00 00		 movsx	 edx, WORD PTR [edi+326]
  0005f	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]
  00066	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iGreenRibbonBoxDropZen@@3HA ; g_iGreenRibbonBoxDropZen
  0006c	52		 push	 edx
  0006d	50		 push	 eax
  0006e	51		 push	 ecx
  0006f	0f b6 8f 49 01
	00 00		 movzx	 ecx, BYTE PTR [edi+329]
  00076	69 c9 48 3d 05
	00		 imul	 ecx, 343368		; 00053d48H
  0007c	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  00082	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 597  : 
; 598  : 			LogAddTD("[EVENT CHRISTMAS RIBBONBOX] GREENRIBBONBOX Event ItemDrop [%s][%s] [%d Zen]",
; 599  : 				lpObj->AccountID, lpObj->Name,
; 600  : 				g_iGreenRibbonBoxDropZen);

  00087	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?g_iGreenRibbonBoxDropZen@@3HA ; g_iGreenRibbonBoxDropZen
  0008d	52		 push	 edx
  0008e	8d 47 77	 lea	 eax, DWORD PTR [edi+119]
  00091	50		 push	 eax
  00092	8d 4f 6c	 lea	 ecx, DWORD PTR [edi+108]
  00095	51		 push	 ecx
  00096	68 00 00 00 00	 push	 OFFSET ??_C@_0EM@PFFONPLH@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5GREE@
  0009b	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  000a1	83 c4 10	 add	 esp, 16			; 00000010H

; 601  : 		}
; 602  : 		else

  000a4	e9 05 02 00 00	 jmp	 $LN13@DropGreenR
$LN14@DropGreenR:

; 603  : 		{
; 604  : 			DropItemNum = rand() % this->GetBagCount();

  000a9	8b 93 20 01 00
	00		 mov	 edx, DWORD PTR [ebx+288]
  000af	89 55 08	 mov	 DWORD PTR $T211213[ebp], edx
  000b2	e8 00 00 00 00	 call	 _rand
  000b7	99		 cdq
  000b8	f7 7d 08	 idiv	 DWORD PTR $T211213[ebp]

; 605  : 			dur = 0;
; 606  : 			x = lpObj->X;
; 607  : 			y = lpObj->Y;

  000bb	0f bf 8f 46 01
	00 00		 movsx	 ecx, WORD PTR [edi+326]
  000c2	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]
  000c9	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 608  : 			level = this->GetLevel(DropItemNum);

  000cc	8b cb		 mov	 ecx, ebx
  000ce	89 45 e4	 mov	 DWORD PTR _x$[ebp], eax
  000d1	52		 push	 edx
  000d2	89 55 f0	 mov	 DWORD PTR _DropItemNum$[ebp], edx
  000d5	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel
  000da	0f b6 d0	 movzx	 edx, al

; 609  : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  000dd	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  000e0	0f b6 8c c3 1e
	02 00 00	 movzx	 ecx, BYTE PTR [ebx+eax*8+542]
  000e8	89 55 08	 mov	 DWORD PTR _level$[ebp], edx
  000eb	0f b6 94 c3 1d
	02 00 00	 movzx	 edx, BYTE PTR [ebx+eax*8+541]
  000f3	51		 push	 ecx
  000f4	52		 push	 edx
  000f5	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  000fa	8b d8		 mov	 ebx, eax
  000fc	83 c4 08	 add	 esp, 8

; 610  : 
; 611  : 			if ( type == -1 )

  000ff	83 fb ff	 cmp	 ebx, -1
  00102	75 0b		 jne	 SHORT $LN12@DropGreenR

; 612  : 				return FALSE;

  00104	5f		 pop	 edi
  00105	5e		 pop	 esi
  00106	33 c0		 xor	 eax, eax
  00108	5b		 pop	 ebx

; 690  : }

  00109	8b e5		 mov	 esp, ebp
  0010b	5d		 pop	 ebp
  0010c	c2 04 00	 ret	 4
$LN12@DropGreenR:

; 613  : 
; 614  : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  0010f	8b 4d ec	 mov	 ecx, DWORD PTR _this$[ebp]
  00112	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00115	80 bc c1 21 02
	00 00 00	 cmp	 BYTE PTR [ecx+eax*8+545], 0
  0011d	74 07		 je	 SHORT $LN23@DropGreenR

; 615  : 				Option1 = 1;

  0011f	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN23@DropGreenR:

; 616  : 
; 617  : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  00126	80 bc c1 22 02
	00 00 00	 cmp	 BYTE PTR [ecx+eax*8+546], 0
  0012e	74 1d		 je	 SHORT $LN24@DropGreenR

; 618  : 			{
; 619  : 				Option2 = 0;

  00130	89 75 f8	 mov	 DWORD PTR _Option2$[ebp], esi

; 620  : 
; 621  : 				if ( (rand()%2) == 0 )

  00133	e8 00 00 00 00	 call	 _rand
  00138	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  0013d	79 05		 jns	 SHORT $LN29@DropGreenR
  0013f	48		 dec	 eax
  00140	83 c8 fe	 or	 eax, -2			; fffffffeH
  00143	40		 inc	 eax
$LN29@DropGreenR:
  00144	75 07		 jne	 SHORT $LN24@DropGreenR

; 622  : 				{
; 623  : 					Option2 = 1;

  00146	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN24@DropGreenR:

; 624  : 				}
; 625  : 			}
; 626  : 
; 627  : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  0014d	8b 45 ec	 mov	 eax, DWORD PTR _this$[ebp]
  00150	8b 4d f0	 mov	 ecx, DWORD PTR _DropItemNum$[ebp]
  00153	80 bc c8 23 02
	00 00 00	 cmp	 BYTE PTR [eax+ecx*8+547], 0
  0015b	74 2b		 je	 SHORT $LN26@DropGreenR

; 628  : 			{
; 629  : 				if ( (rand()%5) < 1 )

  0015d	e8 00 00 00 00	 call	 _rand
  00162	99		 cdq
  00163	b9 05 00 00 00	 mov	 ecx, 5
  00168	f7 f9		 idiv	 ecx
  0016a	83 fa 01	 cmp	 edx, 1
  0016d	7d 09		 jge	 SHORT $LN7@DropGreenR

; 630  : 				{
; 631  : 					Option3 = 3;

  0016f	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 632  : 				}
; 633  : 				else

  00176	eb 10		 jmp	 SHORT $LN26@DropGreenR
$LN7@DropGreenR:

; 634  : 				{
; 635  : 					Option3 = rand() % 3;

  00178	e8 00 00 00 00	 call	 _rand
  0017d	99		 cdq
  0017e	b9 03 00 00 00	 mov	 ecx, 3
  00183	f7 f9		 idiv	 ecx
  00185	89 55 fc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN26@DropGreenR:

; 636  : 				}
; 637  : 			}
; 638  : 
; 639  : 			if ( this->BagObject[DropItemNum].m_isexitem )

  00188	8b 55 ec	 mov	 edx, DWORD PTR _this$[ebp]
  0018b	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  0018e	80 bc c2 24 02
	00 00 00	 cmp	 BYTE PTR [edx+eax*8+548], 0
  00196	74 1d		 je	 SHORT $LN27@DropGreenR

; 640  : 			{
; 641  : 				ExOption = NewOptionRand(level);

  00198	8b 4d 08	 mov	 ecx, DWORD PTR _level$[ebp]
  0019b	51		 push	 ecx
  0019c	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  001a1	83 c4 04	 add	 esp, 4

; 642  : #ifndef _FIX_
; 643  : 				Option2 = 0;
; 644  : #endif
; 645  : 				Option1 = 1;
; 646  : 				level = 0;

  001a4	33 c9		 xor	 ecx, ecx
  001a6	0f b6 f0	 movzx	 esi, al
  001a9	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
  001b0	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
  001b3	eb 02		 jmp	 SHORT $LN5@DropGreenR
$LN27@DropGreenR:
  001b5	33 c9		 xor	 ecx, ecx
$LN5@DropGreenR:

; 647  : 			}
; 648  : 
; 649  : 			if ( type == ITEMGET(12,15) ||
; 650  : 				 type == ITEMGET(14,13) ||
; 651  : 				 type == ITEMGET(14,14) ||
; 652  : 				 type == ITEMGET(14,16) )

  001b7	81 fb 0f 18 00
	00		 cmp	 ebx, 6159		; 0000180fH
  001bd	74 18		 je	 SHORT $LN3@DropGreenR
  001bf	81 fb 0d 1c 00
	00		 cmp	 ebx, 7181		; 00001c0dH
  001c5	74 10		 je	 SHORT $LN3@DropGreenR
  001c7	81 fb 0e 1c 00
	00		 cmp	 ebx, 7182		; 00001c0eH
  001cd	74 08		 je	 SHORT $LN3@DropGreenR
  001cf	81 fb 10 1c 00
	00		 cmp	 ebx, 7184		; 00001c10H
  001d5	75 0c		 jne	 SHORT $LN4@DropGreenR
$LN3@DropGreenR:

; 653  : 			{
; 654  : 				Option1 = 0;

  001d7	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx

; 655  : 				Option2 = 0;

  001da	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx

; 656  : 				Option3 = 0;

  001dd	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx

; 657  : 				level = 0;

  001e0	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
$LN4@DropGreenR:

; 658  : 			}
; 659  : 
; 660  : 			if ( type == ITEMGET(14,19) ||
; 661  : 				 type == ITEMGET(14,28) ||
; 662  : 				 type == ITEMGET(13,18) )

  001e3	81 fb 13 1c 00
	00		 cmp	 ebx, 7187		; 00001c13H
  001e9	74 10		 je	 SHORT $LN1@DropGreenR
  001eb	81 fb 1c 1c 00
	00		 cmp	 ebx, 7196		; 00001c1cH
  001f1	74 08		 je	 SHORT $LN1@DropGreenR
  001f3	81 fb 12 1a 00
	00		 cmp	 ebx, 6674		; 00001a12H
  001f9	75 09		 jne	 SHORT $LN2@DropGreenR
$LN1@DropGreenR:

; 663  : 			{
; 664  : 				Option1 = 0;

  001fb	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx

; 665  : 				Option2 = 0;

  001fe	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx

; 666  : 				Option3 = 0;

  00201	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx
$LN2@DropGreenR:

; 667  : 			}
; 668  : 			
; 669  : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 670  : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  00204	8b 07		 mov	 eax, DWORD PTR [edi]
  00206	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  00209	51		 push	 ecx
  0020a	56		 push	 esi
  0020b	50		 push	 eax
  0020c	52		 push	 edx
  0020d	8b 55 f8	 mov	 edx, DWORD PTR _Option2$[ebp]
  00210	52		 push	 edx
  00211	8b 55 f4	 mov	 edx, DWORD PTR _Option1$[ebp]
  00214	52		 push	 edx
  00215	8b 55 e8	 mov	 edx, DWORD PTR _y$[ebp]
  00218	51		 push	 ecx
  00219	8b 4d 08	 mov	 ecx, DWORD PTR _level$[ebp]
  0021c	51		 push	 ecx
  0021d	8b 4d e4	 mov	 ecx, DWORD PTR _x$[ebp]
  00220	53		 push	 ebx
  00221	52		 push	 edx
  00222	0f b6 97 49 01
	00 00		 movzx	 edx, BYTE PTR [edi+329]
  00229	51		 push	 ecx
  0022a	52		 push	 edx
  0022b	50		 push	 eax
  0022c	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 671  : 
; 672  : 			LogAddTD("[EVENT CHRISTMAS RIBBONBOX ] GREENRIBBONBOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 673  : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 674  : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 675  : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  00231	6a 00		 push	 0
  00233	8b c6		 mov	 eax, esi
  00235	83 e0 01	 and	 eax, 1
  00238	50		 push	 eax
  00239	8b ce		 mov	 ecx, esi
  0023b	d1 f9		 sar	 ecx, 1
  0023d	83 e1 01	 and	 ecx, 1
  00240	51		 push	 ecx
  00241	8b d6		 mov	 edx, esi
  00243	c1 fa 02	 sar	 edx, 2
  00246	83 e2 01	 and	 edx, 1
  00249	52		 push	 edx
  0024a	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  0024d	8b c6		 mov	 eax, esi
  0024f	c1 f8 03	 sar	 eax, 3
  00252	83 e0 01	 and	 eax, 1
  00255	50		 push	 eax
  00256	8b 45 f8	 mov	 eax, DWORD PTR _Option2$[ebp]
  00259	8b ce		 mov	 ecx, esi
  0025b	c1 f9 04	 sar	 ecx, 4
  0025e	83 e1 01	 and	 ecx, 1
  00261	51		 push	 ecx
  00262	8b 4d f4	 mov	 ecx, DWORD PTR _Option1$[ebp]
  00265	c1 fe 05	 sar	 esi, 5
  00268	83 e6 01	 and	 esi, 1
  0026b	56		 push	 esi
  0026c	52		 push	 edx
  0026d	8b 55 08	 mov	 edx, DWORD PTR _level$[ebp]
  00270	50		 push	 eax
  00271	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  00274	51		 push	 ecx
  00275	8b 4d e4	 mov	 ecx, DWORD PTR _x$[ebp]
  00278	52		 push	 edx
  00279	0f b6 97 49 01
	00 00		 movzx	 edx, BYTE PTR [edi+329]
  00280	53		 push	 ebx
  00281	6b db 70	 imul	 ebx, 112		; 00000070H
  00284	81 c3 00 00 00
	00		 add	 ebx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  0028a	53		 push	 ebx
  0028b	50		 push	 eax
  0028c	8b 45 ec	 mov	 eax, DWORD PTR _this$[ebp]
  0028f	51		 push	 ecx
  00290	52		 push	 edx
  00291	83 c0 08	 add	 eax, 8
  00294	50		 push	 eax
  00295	8d 4f 77	 lea	 ecx, DWORD PTR [edi+119]
  00298	51		 push	 ecx
  00299	8d 57 6c	 lea	 edx, DWORD PTR [edi+108]
  0029c	52		 push	 edx
  0029d	68 00 00 00 00	 push	 OFFSET ??_C@_0JL@ICGIGFIG@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5GRE@
  002a2	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  002a8	81 c4 84 00 00
	00		 add	 esp, 132		; 00000084H
$LN13@DropGreenR:

; 676  : 		}
; 677  : 
; 678  : 		PMSG_SERVERCMD ServerCmd;
; 679  : 
; 680  : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  002ae	6a 07		 push	 7
  002b0	6a 40		 push	 64			; 00000040H
  002b2	8d 45 dc	 lea	 eax, DWORD PTR _ServerCmd$210235[ebp]
  002b5	68 f3 00 00 00	 push	 243			; 000000f3H
  002ba	50		 push	 eax
  002bb	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB

; 681  : 		ServerCmd.CmdType = 0;
; 682  : 		ServerCmd.X = lpObj->X;

  002c0	8a 8f 44 01 00
	00		 mov	 cl, BYTE PTR [edi+324]

; 683  : 		ServerCmd.Y = lpObj->Y;

  002c6	8a 97 46 01 00
	00		 mov	 dl, BYTE PTR [edi+326]

; 684  : 
; 685  : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  002cc	6a 07		 push	 7
  002ce	8d 45 dc	 lea	 eax, DWORD PTR _ServerCmd$210235[ebp]
  002d1	50		 push	 eax
  002d2	57		 push	 edi
  002d3	c6 45 e0 00	 mov	 BYTE PTR _ServerCmd$210235[ebp+4], 0
  002d7	88 4d e1	 mov	 BYTE PTR _ServerCmd$210235[ebp+5], cl
  002da	88 55 e2	 mov	 BYTE PTR _ServerCmd$210235[ebp+6], dl
  002dd	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2

; 686  : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  002e2	8b 17		 mov	 edx, DWORD PTR [edi]
  002e4	6a 07		 push	 7
  002e6	8d 4d dc	 lea	 ecx, DWORD PTR _ServerCmd$210235[ebp]
  002e9	51		 push	 ecx
  002ea	52		 push	 edx
  002eb	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  002f0	83 c4 28	 add	 esp, 40			; 00000028H
$LN15@DropGreenR:

; 687  : 	}
; 688  : 
; 689  : 	return TRUE;

  002f3	5f		 pop	 edi
  002f4	5e		 pop	 esi
  002f5	b8 01 00 00 00	 mov	 eax, 1
  002fa	5b		 pop	 ebx

; 690  : }

  002fb	8b e5		 mov	 esp, ebp
  002fd	5d		 pop	 ebp
  002fe	c2 04 00	 ret	 4
?DropGreenRibbonBoxEventItem@CItemBagZt@@QAEHH@Z ENDP	; CItemBagZt::DropGreenRibbonBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0JK@JEKBBHDC@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5BLU@ ; `string'
PUBLIC	??_C@_0EL@MAIPOPGJ@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5BLUE@ ; `string'
PUBLIC	?DropBlueRibbonBoxEventItem@CItemBagZt@@QAEHH@Z	; CItemBagZt::DropBlueRibbonBoxEventItem
EXTRN	?g_iBlueRibbonBoxDropZen@@3HA:DWORD		; g_iBlueRibbonBoxDropZen
EXTRN	?g_iBlueRibbonBoxDropZenRate@@3HA:DWORD		; g_iBlueRibbonBoxDropZenRate
;	COMDAT ??_C@_0JK@JEKBBHDC@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5BLU@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0JK@JEKBBHDC@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5BLU@ DB '[EVENT'
	DB	' CHRISTMAS RIBBONBOX ] BLUERIBBONBOX Event ItemDrop [%s][%s] '
	DB	'[%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d '
	DB	'Ex:[%d,%d,%d,%d,%d,%d,%d]', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0EL@MAIPOPGJ@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5BLUE@
CONST	SEGMENT
??_C@_0EL@MAIPOPGJ@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5BLUE@ DB '[EVENT '
	DB	'CHRISTMAS RIBBONBOX] BLUERIBBONBOX Event ItemDrop [%s][%s] [%'
	DB	'd Zen]', 00H				; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropBlueRibbonBoxEventItem@CItemBagZt@@QAEHH@Z
_TEXT	SEGMENT
_ServerCmd$210282 = -36					; size = 7
_x$ = -28						; size = 4
_y$ = -24						; size = 4
_this$ = -20						; size = 4
_DropItemNum$ = -16					; size = 4
_Option1$ = -12						; size = 4
_Option2$ = -8						; size = 4
_Option3$ = -4						; size = 4
$T211230 = 8						; size = 4
_level$ = 8						; size = 4
_aIndex$ = 8						; size = 4
?DropBlueRibbonBoxEventItem@CItemBagZt@@QAEHH@Z PROC	; CItemBagZt::DropBlueRibbonBoxEventItem, COMDAT
; _this$ = ecx

; 696  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 24	 sub	 esp, 36			; 00000024H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	8b d9		 mov	 ebx, ecx

; 697  : 	if ( this->m_bLoad == FALSE )

  0000a	33 f6		 xor	 esi, esi
  0000c	89 5d ec	 mov	 DWORD PTR _this$[ebp], ebx
  0000f	39 73 04	 cmp	 DWORD PTR [ebx+4], esi
  00012	75 0a		 jne	 SHORT $LN16@DropBlueRi

; 698  : 		return FALSE;

  00014	5e		 pop	 esi
  00015	33 c0		 xor	 eax, eax
  00017	5b		 pop	 ebx

; 812  : }

  00018	8b e5		 mov	 esp, ebp
  0001a	5d		 pop	 ebp
  0001b	c2 04 00	 ret	 4
$LN16@DropBlueRi:
  0001e	57		 push	 edi

; 699  : 
; 700  : 	float dur;
; 701  : 	int type;
; 702  : 	int level;
; 703  : 	int x;
; 704  : 	int y;
; 705  : 	int Option1 = 0;
; 706  : 	int Option2 = 0;
; 707  : 	int Option3 = 0;
; 708  : 	int DropItemRate;
; 709  : 	int DropItemNum;
; 710  : 	int ExOption = 0;
; 711  : 	LPOBJ lpObj = &gObj[aIndex];

  0001f	8b 7d 08	 mov	 edi, DWORD PTR _aIndex$[ebp]
  00022	69 ff 50 2b 00
	00		 imul	 edi, 11088		; 00002b50H
  00028	03 3d 00 00 00
	00		 add	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0002e	89 75 f4	 mov	 DWORD PTR _Option1$[ebp], esi
  00031	89 75 f8	 mov	 DWORD PTR _Option2$[ebp], esi
  00034	89 75 fc	 mov	 DWORD PTR _Option3$[ebp], esi

; 712  : 
; 713  : 	if ( this->GetBagCount() > 0 )

  00037	39 b3 20 01 00
	00		 cmp	 DWORD PTR [ebx+288], esi
  0003d	0f 8e aa 02 00
	00		 jle	 $LN15@DropBlueRi

; 714  : 	{
; 715  : 		DropItemRate = rand() % 10000;

  00043	e8 00 00 00 00	 call	 _rand
  00048	99		 cdq
  00049	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  0004e	f7 f9		 idiv	 ecx

; 716  : 
; 717  : 		if ( DropItemRate < g_iBlueRibbonBoxDropZenRate )

  00050	3b 15 00 00 00
	00		 cmp	 edx, DWORD PTR ?g_iBlueRibbonBoxDropZenRate@@3HA ; g_iBlueRibbonBoxDropZenRate
  00056	7d 51		 jge	 SHORT $LN14@DropBlueRi

; 718  : 		{
; 719  : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iBlueRibbonBoxDropZen, 
; 720  : 				lpObj->X, lpObj->Y);

  00058	0f bf 97 46 01
	00 00		 movsx	 edx, WORD PTR [edi+326]
  0005f	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]
  00066	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iBlueRibbonBoxDropZen@@3HA ; g_iBlueRibbonBoxDropZen
  0006c	52		 push	 edx
  0006d	50		 push	 eax
  0006e	51		 push	 ecx
  0006f	0f b6 8f 49 01
	00 00		 movzx	 ecx, BYTE PTR [edi+329]
  00076	69 c9 48 3d 05
	00		 imul	 ecx, 343368		; 00053d48H
  0007c	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  00082	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 721  : 
; 722  : 			LogAddTD("[EVENT CHRISTMAS RIBBONBOX] BLUERIBBONBOX Event ItemDrop [%s][%s] [%d Zen]",
; 723  : 				lpObj->AccountID, lpObj->Name,
; 724  : 				g_iBlueRibbonBoxDropZen);

  00087	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?g_iBlueRibbonBoxDropZen@@3HA ; g_iBlueRibbonBoxDropZen
  0008d	52		 push	 edx
  0008e	8d 47 77	 lea	 eax, DWORD PTR [edi+119]
  00091	50		 push	 eax
  00092	8d 4f 6c	 lea	 ecx, DWORD PTR [edi+108]
  00095	51		 push	 ecx
  00096	68 00 00 00 00	 push	 OFFSET ??_C@_0EL@MAIPOPGJ@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5BLUE@
  0009b	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  000a1	83 c4 10	 add	 esp, 16			; 00000010H

; 725  : 		}
; 726  : 		else

  000a4	e9 ff 01 00 00	 jmp	 $LN13@DropBlueRi
$LN14@DropBlueRi:

; 727  : 		{
; 728  : 			DropItemNum = rand() % this->GetBagCount();

  000a9	8b 93 20 01 00
	00		 mov	 edx, DWORD PTR [ebx+288]
  000af	89 55 08	 mov	 DWORD PTR $T211230[ebp], edx
  000b2	e8 00 00 00 00	 call	 _rand
  000b7	99		 cdq
  000b8	f7 7d 08	 idiv	 DWORD PTR $T211230[ebp]

; 729  : 			dur = 0;
; 730  : 			x = lpObj->X;
; 731  : 			y = lpObj->Y;

  000bb	0f bf 8f 46 01
	00 00		 movsx	 ecx, WORD PTR [edi+326]
  000c2	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]
  000c9	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 732  : 			level = this->GetLevel(DropItemNum);

  000cc	8b cb		 mov	 ecx, ebx
  000ce	89 45 e4	 mov	 DWORD PTR _x$[ebp], eax
  000d1	52		 push	 edx
  000d2	89 55 f0	 mov	 DWORD PTR _DropItemNum$[ebp], edx
  000d5	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel
  000da	0f b6 d0	 movzx	 edx, al

; 733  : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  000dd	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  000e0	0f b6 8c c3 1e
	02 00 00	 movzx	 ecx, BYTE PTR [ebx+eax*8+542]
  000e8	89 55 08	 mov	 DWORD PTR _level$[ebp], edx
  000eb	0f b6 94 c3 1d
	02 00 00	 movzx	 edx, BYTE PTR [ebx+eax*8+541]
  000f3	51		 push	 ecx
  000f4	52		 push	 edx
  000f5	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  000fa	8b d8		 mov	 ebx, eax
  000fc	83 c4 08	 add	 esp, 8

; 734  : 
; 735  : 			if ( type == -1 )

  000ff	83 fb ff	 cmp	 ebx, -1
  00102	75 0b		 jne	 SHORT $LN12@DropBlueRi

; 736  : 				return FALSE;

  00104	5f		 pop	 edi
  00105	5e		 pop	 esi
  00106	33 c0		 xor	 eax, eax
  00108	5b		 pop	 ebx

; 812  : }

  00109	8b e5		 mov	 esp, ebp
  0010b	5d		 pop	 ebp
  0010c	c2 04 00	 ret	 4
$LN12@DropBlueRi:

; 737  : 
; 738  : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  0010f	8b 4d ec	 mov	 ecx, DWORD PTR _this$[ebp]
  00112	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00115	80 bc c1 21 02
	00 00 00	 cmp	 BYTE PTR [ecx+eax*8+545], 0
  0011d	74 07		 je	 SHORT $LN23@DropBlueRi

; 739  : 				Option1 = 1;

  0011f	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN23@DropBlueRi:

; 740  : 
; 741  : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  00126	80 bc c1 22 02
	00 00 00	 cmp	 BYTE PTR [ecx+eax*8+546], 0
  0012e	74 1d		 je	 SHORT $LN24@DropBlueRi

; 742  : 			{
; 743  : 				Option2 = 0;

  00130	89 75 f8	 mov	 DWORD PTR _Option2$[ebp], esi

; 744  : 
; 745  : 				if ( (rand()%2) == 0 )

  00133	e8 00 00 00 00	 call	 _rand
  00138	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  0013d	79 05		 jns	 SHORT $LN29@DropBlueRi
  0013f	48		 dec	 eax
  00140	83 c8 fe	 or	 eax, -2			; fffffffeH
  00143	40		 inc	 eax
$LN29@DropBlueRi:
  00144	75 07		 jne	 SHORT $LN24@DropBlueRi

; 746  : 				{
; 747  : 					Option2 = 1;

  00146	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN24@DropBlueRi:

; 748  : 				}
; 749  : 			}
; 750  : 
; 751  : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  0014d	8b 45 ec	 mov	 eax, DWORD PTR _this$[ebp]
  00150	8b 4d f0	 mov	 ecx, DWORD PTR _DropItemNum$[ebp]
  00153	80 bc c8 23 02
	00 00 00	 cmp	 BYTE PTR [eax+ecx*8+547], 0
  0015b	74 2b		 je	 SHORT $LN26@DropBlueRi

; 752  : 			{
; 753  : 				if ( (rand()%5) < 1 )

  0015d	e8 00 00 00 00	 call	 _rand
  00162	99		 cdq
  00163	b9 05 00 00 00	 mov	 ecx, 5
  00168	f7 f9		 idiv	 ecx
  0016a	83 fa 01	 cmp	 edx, 1
  0016d	7d 09		 jge	 SHORT $LN7@DropBlueRi

; 754  : 				{
; 755  : 					Option3 = 3;

  0016f	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 756  : 				}
; 757  : 				else

  00176	eb 10		 jmp	 SHORT $LN26@DropBlueRi
$LN7@DropBlueRi:

; 758  : 				{
; 759  : 					Option3 = rand() % 3;

  00178	e8 00 00 00 00	 call	 _rand
  0017d	99		 cdq
  0017e	b9 03 00 00 00	 mov	 ecx, 3
  00183	f7 f9		 idiv	 ecx
  00185	89 55 fc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN26@DropBlueRi:

; 760  : 				}
; 761  : 			}
; 762  : 
; 763  : 			if ( this->BagObject[DropItemNum].m_isexitem )

  00188	8b 55 ec	 mov	 edx, DWORD PTR _this$[ebp]
  0018b	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  0018e	80 bc c2 24 02
	00 00 00	 cmp	 BYTE PTR [edx+eax*8+548], 0
  00196	74 1d		 je	 SHORT $LN27@DropBlueRi

; 764  : 			{
; 765  : 				ExOption = NewOptionRand(level);

  00198	8b 4d 08	 mov	 ecx, DWORD PTR _level$[ebp]
  0019b	51		 push	 ecx
  0019c	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  001a1	83 c4 04	 add	 esp, 4

; 766  : #ifndef _FIX_
; 767  : 				Option2 = 0;
; 768  : #endif
; 769  : 				Option1 = 1;
; 770  : 				level = 0;

  001a4	33 c9		 xor	 ecx, ecx
  001a6	0f b6 f0	 movzx	 esi, al
  001a9	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
  001b0	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
  001b3	eb 02		 jmp	 SHORT $LN5@DropBlueRi
$LN27@DropBlueRi:
  001b5	33 c9		 xor	 ecx, ecx
$LN5@DropBlueRi:

; 771  : 			}
; 772  : 
; 773  : 			if ( type == ITEMGET(12,15) ||
; 774  : 				 type == ITEMGET(14,13) ||
; 775  : 				 type == ITEMGET(14,14)  )

  001b7	81 fb 0f 18 00
	00		 cmp	 ebx, 6159		; 0000180fH
  001bd	74 10		 je	 SHORT $LN3@DropBlueRi
  001bf	81 fb 0d 1c 00
	00		 cmp	 ebx, 7181		; 00001c0dH
  001c5	74 08		 je	 SHORT $LN3@DropBlueRi
  001c7	81 fb 0e 1c 00
	00		 cmp	 ebx, 7182		; 00001c0eH
  001cd	75 0c		 jne	 SHORT $LN4@DropBlueRi
$LN3@DropBlueRi:

; 776  : 			{
; 777  : 				Option1 = 0;

  001cf	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx

; 778  : 				Option2 = 0;

  001d2	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx

; 779  : 				Option3 = 0;

  001d5	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx

; 780  : 				level = 0;

  001d8	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
$LN4@DropBlueRi:

; 781  : 			}
; 782  : 
; 783  : 			if ( type == ITEMGET(13,8) ||
; 784  : 				 type == ITEMGET(13,9) ||
; 785  : 				 type == ITEMGET(13,12) ||
; 786  : 				 type == ITEMGET(13,21) )

  001db	81 fb 08 1a 00
	00		 cmp	 ebx, 6664		; 00001a08H
  001e1	74 18		 je	 SHORT $LN1@DropBlueRi
  001e3	81 fb 09 1a 00
	00		 cmp	 ebx, 6665		; 00001a09H
  001e9	74 10		 je	 SHORT $LN1@DropBlueRi
  001eb	81 fb 0c 1a 00
	00		 cmp	 ebx, 6668		; 00001a0cH
  001f1	74 08		 je	 SHORT $LN1@DropBlueRi
  001f3	81 fb 15 1a 00
	00		 cmp	 ebx, 6677		; 00001a15H
  001f9	75 03		 jne	 SHORT $LN2@DropBlueRi
$LN1@DropBlueRi:

; 787  : 			{
; 788  : 				level = 0;

  001fb	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
$LN2@DropBlueRi:

; 789  : 			}
; 790  : 			
; 791  : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 792  : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  001fe	8b 07		 mov	 eax, DWORD PTR [edi]
  00200	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  00203	51		 push	 ecx
  00204	56		 push	 esi
  00205	50		 push	 eax
  00206	52		 push	 edx
  00207	8b 55 f8	 mov	 edx, DWORD PTR _Option2$[ebp]
  0020a	52		 push	 edx
  0020b	8b 55 f4	 mov	 edx, DWORD PTR _Option1$[ebp]
  0020e	52		 push	 edx
  0020f	8b 55 e8	 mov	 edx, DWORD PTR _y$[ebp]
  00212	51		 push	 ecx
  00213	8b 4d 08	 mov	 ecx, DWORD PTR _level$[ebp]
  00216	51		 push	 ecx
  00217	8b 4d e4	 mov	 ecx, DWORD PTR _x$[ebp]
  0021a	53		 push	 ebx
  0021b	52		 push	 edx
  0021c	0f b6 97 49 01
	00 00		 movzx	 edx, BYTE PTR [edi+329]
  00223	51		 push	 ecx
  00224	52		 push	 edx
  00225	50		 push	 eax
  00226	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 793  : 
; 794  : 			LogAddTD("[EVENT CHRISTMAS RIBBONBOX ] BLUERIBBONBOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 795  : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 796  : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 797  : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  0022b	6a 00		 push	 0
  0022d	8b c6		 mov	 eax, esi
  0022f	83 e0 01	 and	 eax, 1
  00232	50		 push	 eax
  00233	8b ce		 mov	 ecx, esi
  00235	d1 f9		 sar	 ecx, 1
  00237	83 e1 01	 and	 ecx, 1
  0023a	51		 push	 ecx
  0023b	8b d6		 mov	 edx, esi
  0023d	c1 fa 02	 sar	 edx, 2
  00240	83 e2 01	 and	 edx, 1
  00243	52		 push	 edx
  00244	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  00247	8b c6		 mov	 eax, esi
  00249	c1 f8 03	 sar	 eax, 3
  0024c	83 e0 01	 and	 eax, 1
  0024f	50		 push	 eax
  00250	8b 45 f8	 mov	 eax, DWORD PTR _Option2$[ebp]
  00253	8b ce		 mov	 ecx, esi
  00255	c1 f9 04	 sar	 ecx, 4
  00258	83 e1 01	 and	 ecx, 1
  0025b	51		 push	 ecx
  0025c	8b 4d f4	 mov	 ecx, DWORD PTR _Option1$[ebp]
  0025f	c1 fe 05	 sar	 esi, 5
  00262	83 e6 01	 and	 esi, 1
  00265	56		 push	 esi
  00266	52		 push	 edx
  00267	8b 55 08	 mov	 edx, DWORD PTR _level$[ebp]
  0026a	50		 push	 eax
  0026b	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  0026e	51		 push	 ecx
  0026f	8b 4d e4	 mov	 ecx, DWORD PTR _x$[ebp]
  00272	52		 push	 edx
  00273	0f b6 97 49 01
	00 00		 movzx	 edx, BYTE PTR [edi+329]
  0027a	53		 push	 ebx
  0027b	6b db 70	 imul	 ebx, 112		; 00000070H
  0027e	81 c3 00 00 00
	00		 add	 ebx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  00284	53		 push	 ebx
  00285	50		 push	 eax
  00286	8b 45 ec	 mov	 eax, DWORD PTR _this$[ebp]
  00289	51		 push	 ecx
  0028a	52		 push	 edx
  0028b	83 c0 08	 add	 eax, 8
  0028e	50		 push	 eax
  0028f	8d 4f 77	 lea	 ecx, DWORD PTR [edi+119]
  00292	51		 push	 ecx
  00293	8d 57 6c	 lea	 edx, DWORD PTR [edi+108]
  00296	52		 push	 edx
  00297	68 00 00 00 00	 push	 OFFSET ??_C@_0JK@JEKBBHDC@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5BLU@
  0029c	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  002a2	81 c4 84 00 00
	00		 add	 esp, 132		; 00000084H
$LN13@DropBlueRi:

; 798  : 		}
; 799  : 
; 800  : 		PMSG_SERVERCMD ServerCmd;
; 801  : 
; 802  : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  002a8	6a 07		 push	 7
  002aa	6a 40		 push	 64			; 00000040H
  002ac	8d 45 dc	 lea	 eax, DWORD PTR _ServerCmd$210282[ebp]
  002af	68 f3 00 00 00	 push	 243			; 000000f3H
  002b4	50		 push	 eax
  002b5	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB

; 803  : 		ServerCmd.CmdType = 0;
; 804  : 		ServerCmd.X = lpObj->X;

  002ba	8a 8f 44 01 00
	00		 mov	 cl, BYTE PTR [edi+324]

; 805  : 		ServerCmd.Y = lpObj->Y;

  002c0	8a 97 46 01 00
	00		 mov	 dl, BYTE PTR [edi+326]

; 806  : 
; 807  : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  002c6	6a 07		 push	 7
  002c8	8d 45 dc	 lea	 eax, DWORD PTR _ServerCmd$210282[ebp]
  002cb	50		 push	 eax
  002cc	57		 push	 edi
  002cd	c6 45 e0 00	 mov	 BYTE PTR _ServerCmd$210282[ebp+4], 0
  002d1	88 4d e1	 mov	 BYTE PTR _ServerCmd$210282[ebp+5], cl
  002d4	88 55 e2	 mov	 BYTE PTR _ServerCmd$210282[ebp+6], dl
  002d7	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2

; 808  : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  002dc	8b 17		 mov	 edx, DWORD PTR [edi]
  002de	6a 07		 push	 7
  002e0	8d 4d dc	 lea	 ecx, DWORD PTR _ServerCmd$210282[ebp]
  002e3	51		 push	 ecx
  002e4	52		 push	 edx
  002e5	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  002ea	83 c4 28	 add	 esp, 40			; 00000028H
$LN15@DropBlueRi:

; 809  : 	}
; 810  : 
; 811  : 	return TRUE;

  002ed	5f		 pop	 edi
  002ee	5e		 pop	 esi
  002ef	b8 01 00 00 00	 mov	 eax, 1
  002f4	5b		 pop	 ebx

; 812  : }

  002f5	8b e5		 mov	 esp, ebp
  002f7	5d		 pop	 ebp
  002f8	c2 04 00	 ret	 4
?DropBlueRibbonBoxEventItem@CItemBagZt@@QAEHH@Z ENDP	; CItemBagZt::DropBlueRibbonBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0KG@HKBGNNEJ@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ ; `string'
PUBLIC	??_C@_0FI@DOIHGBLI@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ ; `string'
PUBLIC	?DropPinkChocolateBoxEventItem@CItemBagZt@@QAEHH@Z ; CItemBagZt::DropPinkChocolateBoxEventItem
EXTRN	?g_iPinkChocolateBoxDropZen@@3HA:DWORD		; g_iPinkChocolateBoxDropZen
EXTRN	?g_iPinkChocolateBoxDropZenRate@@3HA:DWORD	; g_iPinkChocolateBoxDropZenRate
;	COMDAT ??_C@_0KG@HKBGNNEJ@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0KG@HKBGNNEJ@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ DB '[EVENT VA'
	DB	'LENTINE''S DAY CHOCOLATEBOX ] PINKCHOCOLATEBOX Event ItemDrop'
	DB	' [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:'
	DB	'%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0FI@DOIHGBLI@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
CONST	SEGMENT
??_C@_0FI@DOIHGBLI@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ DB '[EVENT VA'
	DB	'LENTINE''S DAY CHOCOLATEBOX] PINKCHOCOLATE BOX Event ItemDrop'
	DB	' [%s][%s] [%d Zen]', 00H			; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropPinkChocolateBoxEventItem@CItemBagZt@@QAEHH@Z
_TEXT	SEGMENT
_ServerCmd$210328 = -32					; size = 7
_x$ = -24						; size = 4
_y$ = -20						; size = 4
_DropItemNum$ = -16					; size = 4
_Option1$ = -12						; size = 4
_Option2$ = -8						; size = 4
_Option3$ = -4						; size = 4
_level$ = 8						; size = 4
_aIndex$ = 8						; size = 4
?DropPinkChocolateBoxEventItem@CItemBagZt@@QAEHH@Z PROC	; CItemBagZt::DropPinkChocolateBoxEventItem, COMDAT
; _this$ = ecx

; 817  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 20	 sub	 esp, 32			; 00000020H
  00006	53		 push	 ebx
  00007	8b d9		 mov	 ebx, ecx

; 818  : 	if ( this->m_bLoad == FALSE )

  00009	33 c0		 xor	 eax, eax
  0000b	39 43 04	 cmp	 DWORD PTR [ebx+4], eax
  0000e	75 07		 jne	 SHORT $LN15@DropPinkCh
  00010	5b		 pop	 ebx

; 926  : }

  00011	8b e5		 mov	 esp, ebp
  00013	5d		 pop	 ebp
  00014	c2 04 00	 ret	 4
$LN15@DropPinkCh:
  00017	56		 push	 esi

; 819  : 		return FALSE;
; 820  : 
; 821  : 	float dur;
; 822  : 	int type;
; 823  : 	int level;
; 824  : 	int x;
; 825  : 	int y;
; 826  : 	int Option1 = 0;
; 827  : 	int Option2 = 0;
; 828  : 	int Option3 = 0;
; 829  : 	int DropItemRate;
; 830  : 	int DropItemNum;
; 831  : 	int ExOption = 0;
; 832  : 	LPOBJ lpObj = &gObj[aIndex];

  00018	8b 75 08	 mov	 esi, DWORD PTR _aIndex$[ebp]
  0001b	69 f6 50 2b 00
	00		 imul	 esi, 11088		; 00002b50H
  00021	03 35 00 00 00
	00		 add	 esi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00027	57		 push	 edi
  00028	89 45 f4	 mov	 DWORD PTR _Option1$[ebp], eax
  0002b	89 45 f8	 mov	 DWORD PTR _Option2$[ebp], eax
  0002e	89 45 fc	 mov	 DWORD PTR _Option3$[ebp], eax

; 833  : 
; 834  : 	if ( this->GetBagCount() > 0 )

  00031	39 83 20 01 00
	00		 cmp	 DWORD PTR [ebx+288], eax
  00037	0f 8e 51 02 00
	00		 jle	 $LN14@DropPinkCh

; 835  : 	{
; 836  : 		DropItemRate = rand() % 10000;

  0003d	e8 00 00 00 00	 call	 _rand
  00042	99		 cdq
  00043	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  00048	f7 f9		 idiv	 ecx

; 837  : 
; 838  : 		if ( DropItemRate < g_iPinkChocolateBoxDropZenRate )

  0004a	3b 15 00 00 00
	00		 cmp	 edx, DWORD PTR ?g_iPinkChocolateBoxDropZenRate@@3HA ; g_iPinkChocolateBoxDropZenRate
  00050	7d 51		 jge	 SHORT $LN13@DropPinkCh

; 839  : 		{
; 840  : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iPinkChocolateBoxDropZen, 
; 841  : 				lpObj->X, lpObj->Y);

  00052	0f bf 96 46 01
	00 00		 movsx	 edx, WORD PTR [esi+326]
  00059	0f bf 86 44 01
	00 00		 movsx	 eax, WORD PTR [esi+324]
  00060	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iPinkChocolateBoxDropZen@@3HA ; g_iPinkChocolateBoxDropZen
  00066	52		 push	 edx
  00067	50		 push	 eax
  00068	51		 push	 ecx
  00069	0f b6 8e 49 01
	00 00		 movzx	 ecx, BYTE PTR [esi+329]
  00070	69 c9 48 3d 05
	00		 imul	 ecx, 343368		; 00053d48H
  00076	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  0007c	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 842  : 
; 843  : 			LogAddTD("[EVENT VALENTINE'S DAY CHOCOLATEBOX] PINKCHOCOLATE BOX Event ItemDrop [%s][%s] [%d Zen]",
; 844  : 				lpObj->AccountID, lpObj->Name,
; 845  : 				g_iPinkChocolateBoxDropZen);

  00081	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?g_iPinkChocolateBoxDropZen@@3HA ; g_iPinkChocolateBoxDropZen
  00087	52		 push	 edx
  00088	8d 46 77	 lea	 eax, DWORD PTR [esi+119]
  0008b	50		 push	 eax
  0008c	8d 4e 6c	 lea	 ecx, DWORD PTR [esi+108]
  0008f	51		 push	 ecx
  00090	68 00 00 00 00	 push	 OFFSET ??_C@_0FI@DOIHGBLI@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
  00095	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  0009b	83 c4 10	 add	 esp, 16			; 00000010H

; 846  : 		}
; 847  : 		else

  0009e	e9 a6 01 00 00	 jmp	 $LN12@DropPinkCh
$LN13@DropPinkCh:

; 848  : 		{
; 849  : 			DropItemNum = rand() % this->GetBagCount();

  000a3	8b bb 20 01 00
	00		 mov	 edi, DWORD PTR [ebx+288]
  000a9	e8 00 00 00 00	 call	 _rand
  000ae	99		 cdq
  000af	f7 ff		 idiv	 edi

; 850  : 			dur = 0;
; 851  : 			x = lpObj->X;
; 852  : 			y = lpObj->Y;

  000b1	0f bf 86 46 01
	00 00		 movsx	 eax, WORD PTR [esi+326]

; 853  : 			level = this->GetLevel(DropItemNum);

  000b8	8b cb		 mov	 ecx, ebx
  000ba	89 45 ec	 mov	 DWORD PTR _y$[ebp], eax
  000bd	8b fa		 mov	 edi, edx
  000bf	0f bf 96 44 01
	00 00		 movsx	 edx, WORD PTR [esi+324]
  000c6	57		 push	 edi
  000c7	89 7d f0	 mov	 DWORD PTR _DropItemNum$[ebp], edi
  000ca	89 55 e8	 mov	 DWORD PTR _x$[ebp], edx
  000cd	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel

; 854  : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  000d2	0f b6 94 fb 1e
	02 00 00	 movzx	 edx, BYTE PTR [ebx+edi*8+542]
  000da	0f b6 c8	 movzx	 ecx, al
  000dd	0f b6 84 fb 1d
	02 00 00	 movzx	 eax, BYTE PTR [ebx+edi*8+541]
  000e5	52		 push	 edx
  000e6	50		 push	 eax
  000e7	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
  000ea	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  000ef	8b f8		 mov	 edi, eax
  000f1	83 c4 08	 add	 esp, 8

; 855  : 
; 856  : 			if ( type == -1 )

  000f4	83 ff ff	 cmp	 edi, -1
  000f7	75 0b		 jne	 SHORT $LN11@DropPinkCh

; 857  : 				return FALSE;

  000f9	5f		 pop	 edi
  000fa	5e		 pop	 esi
  000fb	33 c0		 xor	 eax, eax
  000fd	5b		 pop	 ebx

; 926  : }

  000fe	8b e5		 mov	 esp, ebp
  00100	5d		 pop	 ebp
  00101	c2 04 00	 ret	 4
$LN11@DropPinkCh:

; 858  : 
; 859  : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  00104	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00107	80 bc c3 21 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+545], 0
  0010f	74 07		 je	 SHORT $LN22@DropPinkCh

; 860  : 				Option1 = 1;

  00111	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN22@DropPinkCh:

; 861  : 
; 862  : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  00118	80 bc c3 22 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+546], 0
  00120	74 21		 je	 SHORT $LN23@DropPinkCh

; 863  : 			{
; 864  : 				Option2 = 0;

  00122	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 865  : 
; 866  : 				if ( (rand()%2) == 0 )

  00129	e8 00 00 00 00	 call	 _rand
  0012e	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  00133	79 05		 jns	 SHORT $LN29@DropPinkCh
  00135	48		 dec	 eax
  00136	83 c8 fe	 or	 eax, -2			; fffffffeH
  00139	40		 inc	 eax
$LN29@DropPinkCh:
  0013a	75 07		 jne	 SHORT $LN23@DropPinkCh

; 867  : 				{
; 868  : 					Option2 = 1;

  0013c	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN23@DropPinkCh:

; 869  : 				}
; 870  : 			}
; 871  : 
; 872  : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  00143	8b 4d f0	 mov	 ecx, DWORD PTR _DropItemNum$[ebp]
  00146	80 bc cb 23 02
	00 00 00	 cmp	 BYTE PTR [ebx+ecx*8+547], 0
  0014e	74 2b		 je	 SHORT $LN25@DropPinkCh

; 873  : 			{
; 874  : 				if ( (rand()%5) < 1 )

  00150	e8 00 00 00 00	 call	 _rand
  00155	99		 cdq
  00156	b9 05 00 00 00	 mov	 ecx, 5
  0015b	f7 f9		 idiv	 ecx
  0015d	83 fa 01	 cmp	 edx, 1
  00160	7d 09		 jge	 SHORT $LN6@DropPinkCh

; 875  : 				{
; 876  : 					Option3 = 3;

  00162	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 877  : 				}
; 878  : 				else

  00169	eb 10		 jmp	 SHORT $LN25@DropPinkCh
$LN6@DropPinkCh:

; 879  : 				{
; 880  : 					Option3 = rand() % 3;

  0016b	e8 00 00 00 00	 call	 _rand
  00170	99		 cdq
  00171	b9 03 00 00 00	 mov	 ecx, 3
  00176	f7 f9		 idiv	 ecx
  00178	89 55 fc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN25@DropPinkCh:

; 881  : 				}
; 882  : 			}
; 883  : 
; 884  : 			ExOption = 0;
; 885  : 
; 886  : 			if ( type == ITEMGET(12,15) ||
; 887  : 				 type == ITEMGET(14,13) ||
; 888  : 				 type == ITEMGET(14,14) )

  0017b	81 ff 0f 18 00
	00		 cmp	 edi, 6159		; 0000180fH
  00181	74 10		 je	 SHORT $LN3@DropPinkCh
  00183	81 ff 0d 1c 00
	00		 cmp	 edi, 7181		; 00001c0dH
  00189	74 08		 je	 SHORT $LN3@DropPinkCh
  0018b	81 ff 0e 1c 00
	00		 cmp	 edi, 7182		; 00001c0eH
  00191	75 10		 jne	 SHORT $LN26@DropPinkCh
$LN3@DropPinkCh:

; 889  : 			{
; 890  : 				Option1 = 0;

  00193	33 c9		 xor	 ecx, ecx
  00195	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx

; 891  : 				Option2 = 0;

  00198	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx

; 892  : 				Option3 = 0;

  0019b	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx

; 893  : 				level = 0;

  0019e	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
  001a1	eb 02		 jmp	 SHORT $LN4@DropPinkCh
$LN26@DropPinkCh:
  001a3	33 c9		 xor	 ecx, ecx
$LN4@DropPinkCh:

; 894  : 			}
; 895  : 
; 896  : 			if ( type == ITEMGET(14,19) ||
; 897  : 				 type == ITEMGET(14,28) ||
; 898  : 				 type == ITEMGET(13,18) )

  001a5	81 ff 13 1c 00
	00		 cmp	 edi, 7187		; 00001c13H
  001ab	74 10		 je	 SHORT $LN1@DropPinkCh
  001ad	81 ff 1c 1c 00
	00		 cmp	 edi, 7196		; 00001c1cH
  001b3	74 08		 je	 SHORT $LN1@DropPinkCh
  001b5	81 ff 12 1a 00
	00		 cmp	 edi, 6674		; 00001a12H
  001bb	75 09		 jne	 SHORT $LN2@DropPinkCh
$LN1@DropPinkCh:

; 899  : 			{
; 900  : 				Option1 = 0;

  001bd	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx

; 901  : 				Option2 = 0;

  001c0	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx

; 902  : 				Option3 = 0;

  001c3	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx
$LN2@DropPinkCh:

; 903  : 			}
; 904  : 			
; 905  : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 906  : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  001c6	8b 06		 mov	 eax, DWORD PTR [esi]
  001c8	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  001cb	51		 push	 ecx
  001cc	51		 push	 ecx
  001cd	50		 push	 eax
  001ce	52		 push	 edx
  001cf	8b 55 f8	 mov	 edx, DWORD PTR _Option2$[ebp]
  001d2	52		 push	 edx
  001d3	8b 55 f4	 mov	 edx, DWORD PTR _Option1$[ebp]
  001d6	52		 push	 edx
  001d7	8b 55 ec	 mov	 edx, DWORD PTR _y$[ebp]
  001da	51		 push	 ecx
  001db	8b 4d 08	 mov	 ecx, DWORD PTR _level$[ebp]
  001de	51		 push	 ecx
  001df	8b 4d e8	 mov	 ecx, DWORD PTR _x$[ebp]
  001e2	57		 push	 edi
  001e3	52		 push	 edx
  001e4	0f b6 96 49 01
	00 00		 movzx	 edx, BYTE PTR [esi+329]
  001eb	51		 push	 ecx
  001ec	52		 push	 edx
  001ed	50		 push	 eax
  001ee	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 907  : 
; 908  : 			LogAddTD("[EVENT VALENTINE'S DAY CHOCOLATEBOX ] PINKCHOCOLATEBOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 909  : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 910  : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 911  : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  001f3	8b 45 fc	 mov	 eax, DWORD PTR _Option3$[ebp]
  001f6	8b 4d f8	 mov	 ecx, DWORD PTR _Option2$[ebp]
  001f9	6a 00		 push	 0
  001fb	8b 55 f4	 mov	 edx, DWORD PTR _Option1$[ebp]
  001fe	6a 00		 push	 0
  00200	6a 00		 push	 0
  00202	6a 00		 push	 0
  00204	6a 00		 push	 0
  00206	6a 00		 push	 0
  00208	6a 00		 push	 0
  0020a	50		 push	 eax
  0020b	8b 45 08	 mov	 eax, DWORD PTR _level$[ebp]
  0020e	51		 push	 ecx
  0020f	8b 4d ec	 mov	 ecx, DWORD PTR _y$[ebp]
  00212	52		 push	 edx
  00213	8b 55 e8	 mov	 edx, DWORD PTR _x$[ebp]
  00216	50		 push	 eax
  00217	0f b6 86 49 01
	00 00		 movzx	 eax, BYTE PTR [esi+329]
  0021e	57		 push	 edi
  0021f	6b ff 70	 imul	 edi, 112		; 00000070H
  00222	81 c7 00 00 00
	00		 add	 edi, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  00228	57		 push	 edi
  00229	51		 push	 ecx
  0022a	52		 push	 edx
  0022b	50		 push	 eax
  0022c	83 c3 08	 add	 ebx, 8
  0022f	53		 push	 ebx
  00230	8d 4e 77	 lea	 ecx, DWORD PTR [esi+119]
  00233	51		 push	 ecx
  00234	8d 56 6c	 lea	 edx, DWORD PTR [esi+108]
  00237	52		 push	 edx
  00238	68 00 00 00 00	 push	 OFFSET ??_C@_0KG@HKBGNNEJ@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
  0023d	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  00243	81 c4 84 00 00
	00		 add	 esp, 132		; 00000084H
$LN12@DropPinkCh:

; 912  : 		}
; 913  : 
; 914  : 		PMSG_SERVERCMD ServerCmd;
; 915  : 
; 916  : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  00249	6a 07		 push	 7
  0024b	6a 40		 push	 64			; 00000040H
  0024d	8d 45 e0	 lea	 eax, DWORD PTR _ServerCmd$210328[ebp]
  00250	68 f3 00 00 00	 push	 243			; 000000f3H
  00255	50		 push	 eax
  00256	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB

; 917  : 		ServerCmd.CmdType = 0;
; 918  : 		ServerCmd.X = lpObj->X;

  0025b	8a 8e 44 01 00
	00		 mov	 cl, BYTE PTR [esi+324]

; 919  : 		ServerCmd.Y = lpObj->Y;

  00261	8a 96 46 01 00
	00		 mov	 dl, BYTE PTR [esi+326]

; 920  : 
; 921  : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  00267	6a 07		 push	 7
  00269	8d 45 e0	 lea	 eax, DWORD PTR _ServerCmd$210328[ebp]
  0026c	50		 push	 eax
  0026d	56		 push	 esi
  0026e	c6 45 e4 00	 mov	 BYTE PTR _ServerCmd$210328[ebp+4], 0
  00272	88 4d e5	 mov	 BYTE PTR _ServerCmd$210328[ebp+5], cl
  00275	88 55 e6	 mov	 BYTE PTR _ServerCmd$210328[ebp+6], dl
  00278	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2

; 922  : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  0027d	8b 16		 mov	 edx, DWORD PTR [esi]
  0027f	6a 07		 push	 7
  00281	8d 4d e0	 lea	 ecx, DWORD PTR _ServerCmd$210328[ebp]
  00284	51		 push	 ecx
  00285	52		 push	 edx
  00286	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  0028b	83 c4 28	 add	 esp, 40			; 00000028H
$LN14@DropPinkCh:

; 923  : 	}
; 924  : 
; 925  : 	return TRUE;

  0028e	5f		 pop	 edi
  0028f	5e		 pop	 esi
  00290	b8 01 00 00 00	 mov	 eax, 1
  00295	5b		 pop	 ebx

; 926  : }

  00296	8b e5		 mov	 esp, ebp
  00298	5d		 pop	 ebp
  00299	c2 04 00	 ret	 4
?DropPinkChocolateBoxEventItem@CItemBagZt@@QAEHH@Z ENDP	; CItemBagZt::DropPinkChocolateBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0KF@COCFMJHA@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ ; `string'
PUBLIC	??_C@_0FG@HNNCGKKM@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ ; `string'
PUBLIC	?DropRedChocolateBoxEventItem@CItemBagZt@@QAEHH@Z ; CItemBagZt::DropRedChocolateBoxEventItem
EXTRN	?g_iRedChocolateBoxDropZen@@3HA:DWORD		; g_iRedChocolateBoxDropZen
EXTRN	?g_iRedChocolateBoxDropZenRate@@3HA:DWORD	; g_iRedChocolateBoxDropZenRate
;	COMDAT ??_C@_0KF@COCFMJHA@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0KF@COCFMJHA@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ DB '[EVENT VA'
	DB	'LENTINE''S DAY CHOCOLATEBOX ] REDCHOCOLATEBOX Event ItemDrop '
	DB	'[%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%'
	DB	'd op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0FG@HNNCGKKM@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
CONST	SEGMENT
??_C@_0FG@HNNCGKKM@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ DB '[EVENT VA'
	DB	'LENTINE''S DAY CHOCOLATEBOX] REDCHOCOLATEBOX Event ItemDrop ['
	DB	'%s][%s] [%d Zen]', 00H			; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropRedChocolateBoxEventItem@CItemBagZt@@QAEHH@Z
_TEXT	SEGMENT
_ServerCmd$210375 = -36					; size = 7
_x$ = -28						; size = 4
_y$ = -24						; size = 4
_this$ = -20						; size = 4
_DropItemNum$ = -16					; size = 4
_Option1$ = -12						; size = 4
_Option2$ = -8						; size = 4
_Option3$ = -4						; size = 4
$T211265 = 8						; size = 4
_level$ = 8						; size = 4
_aIndex$ = 8						; size = 4
?DropRedChocolateBoxEventItem@CItemBagZt@@QAEHH@Z PROC	; CItemBagZt::DropRedChocolateBoxEventItem, COMDAT
; _this$ = ecx

; 930  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 24	 sub	 esp, 36			; 00000024H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	8b d9		 mov	 ebx, ecx

; 931  : 	if ( this->m_bLoad == FALSE )

  0000a	33 f6		 xor	 esi, esi
  0000c	89 5d ec	 mov	 DWORD PTR _this$[ebp], ebx
  0000f	39 73 04	 cmp	 DWORD PTR [ebx+4], esi
  00012	75 0a		 jne	 SHORT $LN16@DropRedCho

; 932  : 		return FALSE;

  00014	5e		 pop	 esi
  00015	33 c0		 xor	 eax, eax
  00017	5b		 pop	 ebx

; 1048 : }

  00018	8b e5		 mov	 esp, ebp
  0001a	5d		 pop	 ebp
  0001b	c2 04 00	 ret	 4
$LN16@DropRedCho:
  0001e	57		 push	 edi

; 933  : 
; 934  : 	float dur;
; 935  : 	int type;
; 936  : 	int level;
; 937  : 	int x;
; 938  : 	int y;
; 939  : 	int Option1 = 0;
; 940  : 	int Option2 = 0;
; 941  : 	int Option3 = 0;
; 942  : 	int DropItemRate;
; 943  : 	int DropItemNum;
; 944  : 	int ExOption = 0;
; 945  : 	LPOBJ lpObj = &gObj[aIndex];

  0001f	8b 7d 08	 mov	 edi, DWORD PTR _aIndex$[ebp]
  00022	69 ff 50 2b 00
	00		 imul	 edi, 11088		; 00002b50H
  00028	03 3d 00 00 00
	00		 add	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0002e	89 75 f4	 mov	 DWORD PTR _Option1$[ebp], esi
  00031	89 75 f8	 mov	 DWORD PTR _Option2$[ebp], esi
  00034	89 75 fc	 mov	 DWORD PTR _Option3$[ebp], esi

; 946  : 
; 947  : 	if ( this->GetBagCount() > 0 )

  00037	39 b3 20 01 00
	00		 cmp	 DWORD PTR [ebx+288], esi
  0003d	0f 8e b0 02 00
	00		 jle	 $LN15@DropRedCho

; 948  : 	{
; 949  : 		DropItemRate = rand() % 10000;

  00043	e8 00 00 00 00	 call	 _rand
  00048	99		 cdq
  00049	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  0004e	f7 f9		 idiv	 ecx

; 950  : 
; 951  : 		if ( DropItemRate < g_iRedChocolateBoxDropZenRate )

  00050	3b 15 00 00 00
	00		 cmp	 edx, DWORD PTR ?g_iRedChocolateBoxDropZenRate@@3HA ; g_iRedChocolateBoxDropZenRate
  00056	7d 51		 jge	 SHORT $LN14@DropRedCho

; 952  : 		{
; 953  : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iRedChocolateBoxDropZen, 
; 954  : 				lpObj->X, lpObj->Y);

  00058	0f bf 97 46 01
	00 00		 movsx	 edx, WORD PTR [edi+326]
  0005f	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]
  00066	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iRedChocolateBoxDropZen@@3HA ; g_iRedChocolateBoxDropZen
  0006c	52		 push	 edx
  0006d	50		 push	 eax
  0006e	51		 push	 ecx
  0006f	0f b6 8f 49 01
	00 00		 movzx	 ecx, BYTE PTR [edi+329]
  00076	69 c9 48 3d 05
	00		 imul	 ecx, 343368		; 00053d48H
  0007c	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  00082	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 955  : 
; 956  : 			LogAddTD("[EVENT VALENTINE'S DAY CHOCOLATEBOX] REDCHOCOLATEBOX Event ItemDrop [%s][%s] [%d Zen]",
; 957  : 				lpObj->AccountID, lpObj->Name,
; 958  : 				g_iRedChocolateBoxDropZen);

  00087	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?g_iRedChocolateBoxDropZen@@3HA ; g_iRedChocolateBoxDropZen
  0008d	52		 push	 edx
  0008e	8d 47 77	 lea	 eax, DWORD PTR [edi+119]
  00091	50		 push	 eax
  00092	8d 4f 6c	 lea	 ecx, DWORD PTR [edi+108]
  00095	51		 push	 ecx
  00096	68 00 00 00 00	 push	 OFFSET ??_C@_0FG@HNNCGKKM@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
  0009b	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  000a1	83 c4 10	 add	 esp, 16			; 00000010H

; 959  : 		}
; 960  : 		else

  000a4	e9 05 02 00 00	 jmp	 $LN13@DropRedCho
$LN14@DropRedCho:

; 961  : 		{
; 962  : 			DropItemNum = rand() % this->GetBagCount();

  000a9	8b 93 20 01 00
	00		 mov	 edx, DWORD PTR [ebx+288]
  000af	89 55 08	 mov	 DWORD PTR $T211265[ebp], edx
  000b2	e8 00 00 00 00	 call	 _rand
  000b7	99		 cdq
  000b8	f7 7d 08	 idiv	 DWORD PTR $T211265[ebp]

; 963  : 			dur = 0;
; 964  : 			x = lpObj->X;
; 965  : 			y = lpObj->Y;

  000bb	0f bf 8f 46 01
	00 00		 movsx	 ecx, WORD PTR [edi+326]
  000c2	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]
  000c9	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 966  : 			level = this->GetLevel(DropItemNum);

  000cc	8b cb		 mov	 ecx, ebx
  000ce	89 45 e4	 mov	 DWORD PTR _x$[ebp], eax
  000d1	52		 push	 edx
  000d2	89 55 f0	 mov	 DWORD PTR _DropItemNum$[ebp], edx
  000d5	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel
  000da	0f b6 d0	 movzx	 edx, al

; 967  : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  000dd	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  000e0	0f b6 8c c3 1e
	02 00 00	 movzx	 ecx, BYTE PTR [ebx+eax*8+542]
  000e8	89 55 08	 mov	 DWORD PTR _level$[ebp], edx
  000eb	0f b6 94 c3 1d
	02 00 00	 movzx	 edx, BYTE PTR [ebx+eax*8+541]
  000f3	51		 push	 ecx
  000f4	52		 push	 edx
  000f5	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  000fa	8b d8		 mov	 ebx, eax
  000fc	83 c4 08	 add	 esp, 8

; 968  : 
; 969  : 			if ( type == -1 )

  000ff	83 fb ff	 cmp	 ebx, -1
  00102	75 0b		 jne	 SHORT $LN12@DropRedCho

; 970  : 				return FALSE;

  00104	5f		 pop	 edi
  00105	5e		 pop	 esi
  00106	33 c0		 xor	 eax, eax
  00108	5b		 pop	 ebx

; 1048 : }

  00109	8b e5		 mov	 esp, ebp
  0010b	5d		 pop	 ebp
  0010c	c2 04 00	 ret	 4
$LN12@DropRedCho:

; 971  : 
; 972  : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  0010f	8b 4d ec	 mov	 ecx, DWORD PTR _this$[ebp]
  00112	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00115	80 bc c1 21 02
	00 00 00	 cmp	 BYTE PTR [ecx+eax*8+545], 0
  0011d	74 07		 je	 SHORT $LN23@DropRedCho

; 973  : 				Option1 = 1;

  0011f	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN23@DropRedCho:

; 974  : 
; 975  : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  00126	80 bc c1 22 02
	00 00 00	 cmp	 BYTE PTR [ecx+eax*8+546], 0
  0012e	74 1d		 je	 SHORT $LN24@DropRedCho

; 976  : 			{
; 977  : 				Option2 = 0;

  00130	89 75 f8	 mov	 DWORD PTR _Option2$[ebp], esi

; 978  : 
; 979  : 				if ( (rand()%2) == 0 )

  00133	e8 00 00 00 00	 call	 _rand
  00138	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  0013d	79 05		 jns	 SHORT $LN29@DropRedCho
  0013f	48		 dec	 eax
  00140	83 c8 fe	 or	 eax, -2			; fffffffeH
  00143	40		 inc	 eax
$LN29@DropRedCho:
  00144	75 07		 jne	 SHORT $LN24@DropRedCho

; 980  : 				{
; 981  : 					Option2 = 1;

  00146	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN24@DropRedCho:

; 982  : 				}
; 983  : 			}
; 984  : 
; 985  : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  0014d	8b 45 ec	 mov	 eax, DWORD PTR _this$[ebp]
  00150	8b 4d f0	 mov	 ecx, DWORD PTR _DropItemNum$[ebp]
  00153	80 bc c8 23 02
	00 00 00	 cmp	 BYTE PTR [eax+ecx*8+547], 0
  0015b	74 2b		 je	 SHORT $LN26@DropRedCho

; 986  : 			{
; 987  : 				if ( (rand()%5) < 1 )

  0015d	e8 00 00 00 00	 call	 _rand
  00162	99		 cdq
  00163	b9 05 00 00 00	 mov	 ecx, 5
  00168	f7 f9		 idiv	 ecx
  0016a	83 fa 01	 cmp	 edx, 1
  0016d	7d 09		 jge	 SHORT $LN7@DropRedCho

; 988  : 				{
; 989  : 					Option3 = 3;

  0016f	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 990  : 				}
; 991  : 				else

  00176	eb 10		 jmp	 SHORT $LN26@DropRedCho
$LN7@DropRedCho:

; 992  : 				{
; 993  : 					Option3 = rand() % 3;

  00178	e8 00 00 00 00	 call	 _rand
  0017d	99		 cdq
  0017e	b9 03 00 00 00	 mov	 ecx, 3
  00183	f7 f9		 idiv	 ecx
  00185	89 55 fc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN26@DropRedCho:

; 994  : 				}
; 995  : 			}
; 996  : 
; 997  : 			if ( this->BagObject[DropItemNum].m_isexitem )

  00188	8b 55 ec	 mov	 edx, DWORD PTR _this$[ebp]
  0018b	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  0018e	80 bc c2 24 02
	00 00 00	 cmp	 BYTE PTR [edx+eax*8+548], 0
  00196	74 1d		 je	 SHORT $LN27@DropRedCho

; 998  : 			{
; 999  : 				ExOption = NewOptionRand(level);

  00198	8b 4d 08	 mov	 ecx, DWORD PTR _level$[ebp]
  0019b	51		 push	 ecx
  0019c	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  001a1	83 c4 04	 add	 esp, 4

; 1000 : #ifndef _FIX_
; 1001 : 				Option2 = 0;
; 1002 : #endif
; 1003 : 				Option1 = 1;
; 1004 : 				level = 0;

  001a4	33 c9		 xor	 ecx, ecx
  001a6	0f b6 f0	 movzx	 esi, al
  001a9	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
  001b0	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
  001b3	eb 02		 jmp	 SHORT $LN5@DropRedCho
$LN27@DropRedCho:
  001b5	33 c9		 xor	 ecx, ecx
$LN5@DropRedCho:

; 1005 : 			}
; 1006 : 
; 1007 : 			if ( type == ITEMGET(12,15) ||
; 1008 : 				 type == ITEMGET(14,13) ||
; 1009 : 				 type == ITEMGET(14,14) ||
; 1010 : 				 type == ITEMGET(14,16) )

  001b7	81 fb 0f 18 00
	00		 cmp	 ebx, 6159		; 0000180fH
  001bd	74 18		 je	 SHORT $LN3@DropRedCho
  001bf	81 fb 0d 1c 00
	00		 cmp	 ebx, 7181		; 00001c0dH
  001c5	74 10		 je	 SHORT $LN3@DropRedCho
  001c7	81 fb 0e 1c 00
	00		 cmp	 ebx, 7182		; 00001c0eH
  001cd	74 08		 je	 SHORT $LN3@DropRedCho
  001cf	81 fb 10 1c 00
	00		 cmp	 ebx, 7184		; 00001c10H
  001d5	75 0c		 jne	 SHORT $LN4@DropRedCho
$LN3@DropRedCho:

; 1011 : 			{
; 1012 : 				Option1 = 0;

  001d7	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx

; 1013 : 				Option2 = 0;

  001da	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx

; 1014 : 				Option3 = 0;

  001dd	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx

; 1015 : 				level = 0;

  001e0	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
$LN4@DropRedCho:

; 1016 : 			}
; 1017 : 
; 1018 : 			if ( type == ITEMGET(14,19) ||
; 1019 : 				 type == ITEMGET(14,28) ||
; 1020 : 				 type == ITEMGET(13,18) )

  001e3	81 fb 13 1c 00
	00		 cmp	 ebx, 7187		; 00001c13H
  001e9	74 10		 je	 SHORT $LN1@DropRedCho
  001eb	81 fb 1c 1c 00
	00		 cmp	 ebx, 7196		; 00001c1cH
  001f1	74 08		 je	 SHORT $LN1@DropRedCho
  001f3	81 fb 12 1a 00
	00		 cmp	 ebx, 6674		; 00001a12H
  001f9	75 09		 jne	 SHORT $LN2@DropRedCho
$LN1@DropRedCho:

; 1021 : 			{
; 1022 : 				Option1 = 0;

  001fb	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx

; 1023 : 				Option2 = 0;

  001fe	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx

; 1024 : 				Option3 = 0;

  00201	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx
$LN2@DropRedCho:

; 1025 : 			}
; 1026 : 			
; 1027 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 1028 : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  00204	8b 07		 mov	 eax, DWORD PTR [edi]
  00206	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  00209	51		 push	 ecx
  0020a	56		 push	 esi
  0020b	50		 push	 eax
  0020c	52		 push	 edx
  0020d	8b 55 f8	 mov	 edx, DWORD PTR _Option2$[ebp]
  00210	52		 push	 edx
  00211	8b 55 f4	 mov	 edx, DWORD PTR _Option1$[ebp]
  00214	52		 push	 edx
  00215	8b 55 e8	 mov	 edx, DWORD PTR _y$[ebp]
  00218	51		 push	 ecx
  00219	8b 4d 08	 mov	 ecx, DWORD PTR _level$[ebp]
  0021c	51		 push	 ecx
  0021d	8b 4d e4	 mov	 ecx, DWORD PTR _x$[ebp]
  00220	53		 push	 ebx
  00221	52		 push	 edx
  00222	0f b6 97 49 01
	00 00		 movzx	 edx, BYTE PTR [edi+329]
  00229	51		 push	 ecx
  0022a	52		 push	 edx
  0022b	50		 push	 eax
  0022c	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 1029 : 
; 1030 : 			LogAddTD("[EVENT VALENTINE'S DAY CHOCOLATEBOX ] REDCHOCOLATEBOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 1031 : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 1032 : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 1033 : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  00231	6a 00		 push	 0
  00233	8b c6		 mov	 eax, esi
  00235	83 e0 01	 and	 eax, 1
  00238	50		 push	 eax
  00239	8b ce		 mov	 ecx, esi
  0023b	d1 f9		 sar	 ecx, 1
  0023d	83 e1 01	 and	 ecx, 1
  00240	51		 push	 ecx
  00241	8b d6		 mov	 edx, esi
  00243	c1 fa 02	 sar	 edx, 2
  00246	83 e2 01	 and	 edx, 1
  00249	52		 push	 edx
  0024a	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  0024d	8b c6		 mov	 eax, esi
  0024f	c1 f8 03	 sar	 eax, 3
  00252	83 e0 01	 and	 eax, 1
  00255	50		 push	 eax
  00256	8b 45 f8	 mov	 eax, DWORD PTR _Option2$[ebp]
  00259	8b ce		 mov	 ecx, esi
  0025b	c1 f9 04	 sar	 ecx, 4
  0025e	83 e1 01	 and	 ecx, 1
  00261	51		 push	 ecx
  00262	8b 4d f4	 mov	 ecx, DWORD PTR _Option1$[ebp]
  00265	c1 fe 05	 sar	 esi, 5
  00268	83 e6 01	 and	 esi, 1
  0026b	56		 push	 esi
  0026c	52		 push	 edx
  0026d	8b 55 08	 mov	 edx, DWORD PTR _level$[ebp]
  00270	50		 push	 eax
  00271	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  00274	51		 push	 ecx
  00275	8b 4d e4	 mov	 ecx, DWORD PTR _x$[ebp]
  00278	52		 push	 edx
  00279	0f b6 97 49 01
	00 00		 movzx	 edx, BYTE PTR [edi+329]
  00280	53		 push	 ebx
  00281	6b db 70	 imul	 ebx, 112		; 00000070H
  00284	81 c3 00 00 00
	00		 add	 ebx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  0028a	53		 push	 ebx
  0028b	50		 push	 eax
  0028c	8b 45 ec	 mov	 eax, DWORD PTR _this$[ebp]
  0028f	51		 push	 ecx
  00290	52		 push	 edx
  00291	83 c0 08	 add	 eax, 8
  00294	50		 push	 eax
  00295	8d 4f 77	 lea	 ecx, DWORD PTR [edi+119]
  00298	51		 push	 ecx
  00299	8d 57 6c	 lea	 edx, DWORD PTR [edi+108]
  0029c	52		 push	 edx
  0029d	68 00 00 00 00	 push	 OFFSET ??_C@_0KF@COCFMJHA@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
  002a2	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  002a8	81 c4 84 00 00
	00		 add	 esp, 132		; 00000084H
$LN13@DropRedCho:

; 1034 : 		}
; 1035 : 
; 1036 : 		PMSG_SERVERCMD ServerCmd;
; 1037 : 
; 1038 : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  002ae	6a 07		 push	 7
  002b0	6a 40		 push	 64			; 00000040H
  002b2	8d 45 dc	 lea	 eax, DWORD PTR _ServerCmd$210375[ebp]
  002b5	68 f3 00 00 00	 push	 243			; 000000f3H
  002ba	50		 push	 eax
  002bb	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB

; 1039 : 		ServerCmd.CmdType = 0;
; 1040 : 		ServerCmd.X = lpObj->X;

  002c0	8a 8f 44 01 00
	00		 mov	 cl, BYTE PTR [edi+324]

; 1041 : 		ServerCmd.Y = lpObj->Y;

  002c6	8a 97 46 01 00
	00		 mov	 dl, BYTE PTR [edi+326]

; 1042 : 
; 1043 : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  002cc	6a 07		 push	 7
  002ce	8d 45 dc	 lea	 eax, DWORD PTR _ServerCmd$210375[ebp]
  002d1	50		 push	 eax
  002d2	57		 push	 edi
  002d3	c6 45 e0 00	 mov	 BYTE PTR _ServerCmd$210375[ebp+4], 0
  002d7	88 4d e1	 mov	 BYTE PTR _ServerCmd$210375[ebp+5], cl
  002da	88 55 e2	 mov	 BYTE PTR _ServerCmd$210375[ebp+6], dl
  002dd	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2

; 1044 : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  002e2	8b 17		 mov	 edx, DWORD PTR [edi]
  002e4	6a 07		 push	 7
  002e6	8d 4d dc	 lea	 ecx, DWORD PTR _ServerCmd$210375[ebp]
  002e9	51		 push	 ecx
  002ea	52		 push	 edx
  002eb	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  002f0	83 c4 28	 add	 esp, 40			; 00000028H
$LN15@DropRedCho:

; 1045 : 	}
; 1046 : 
; 1047 : 	return TRUE;

  002f3	5f		 pop	 edi
  002f4	5e		 pop	 esi
  002f5	b8 01 00 00 00	 mov	 eax, 1
  002fa	5b		 pop	 ebx

; 1048 : }

  002fb	8b e5		 mov	 esp, ebp
  002fd	5d		 pop	 ebp
  002fe	c2 04 00	 ret	 4
?DropRedChocolateBoxEventItem@CItemBagZt@@QAEHH@Z ENDP	; CItemBagZt::DropRedChocolateBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0KH@KCPHJKBG@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ ; `string'
PUBLIC	??_C@_0FH@CKADFAKC@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ ; `string'
PUBLIC	?DropBlueChocolateBoxEventItem@CItemBagZt@@QAEHH@Z ; CItemBagZt::DropBlueChocolateBoxEventItem
EXTRN	?g_iBlueChocolateBoxDropZen@@3HA:DWORD		; g_iBlueChocolateBoxDropZen
EXTRN	?g_iBlueChocolateBoxDropZenRate@@3HA:DWORD	; g_iBlueChocolateBoxDropZenRate
;	COMDAT ??_C@_0KH@KCPHJKBG@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0KH@KCPHJKBG@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ DB '[EVENT VA'
	DB	'LENTINE''S DAY CHOCOLATEBOX ] BLUECHOCOLATEBOX Event ItemDrop'
	DB	' [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:'
	DB	'%d op3:%d  Ex:[%d,%d,%d,%d,%d,%d,%d]', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0FH@CKADFAKC@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
CONST	SEGMENT
??_C@_0FH@CKADFAKC@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ DB '[EVENT VA'
	DB	'LENTINE''S DAY CHOCOLATEBOX] BLUECHOCOLATEBOX Event ItemDrop '
	DB	'[%s][%s] [%d Zen]', 00H			; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropBlueChocolateBoxEventItem@CItemBagZt@@QAEHH@Z
_TEXT	SEGMENT
_ServerCmd$210422 = -36					; size = 7
_x$ = -28						; size = 4
_y$ = -24						; size = 4
_this$ = -20						; size = 4
_DropItemNum$ = -16					; size = 4
_Option1$ = -12						; size = 4
_Option2$ = -8						; size = 4
_Option3$ = -4						; size = 4
$T211282 = 8						; size = 4
_level$ = 8						; size = 4
_aIndex$ = 8						; size = 4
?DropBlueChocolateBoxEventItem@CItemBagZt@@QAEHH@Z PROC	; CItemBagZt::DropBlueChocolateBoxEventItem, COMDAT
; _this$ = ecx

; 1054 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 24	 sub	 esp, 36			; 00000024H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	8b d9		 mov	 ebx, ecx

; 1055 : 	if ( this->m_bLoad == FALSE )

  0000a	33 f6		 xor	 esi, esi
  0000c	89 5d ec	 mov	 DWORD PTR _this$[ebp], ebx
  0000f	39 73 04	 cmp	 DWORD PTR [ebx+4], esi
  00012	75 0a		 jne	 SHORT $LN16@DropBlueCh

; 1056 : 		return FALSE;

  00014	5e		 pop	 esi
  00015	33 c0		 xor	 eax, eax
  00017	5b		 pop	 ebx

; 1170 : }

  00018	8b e5		 mov	 esp, ebp
  0001a	5d		 pop	 ebp
  0001b	c2 04 00	 ret	 4
$LN16@DropBlueCh:
  0001e	57		 push	 edi

; 1057 : 
; 1058 : 	float dur;
; 1059 : 	int type;
; 1060 : 	int level;
; 1061 : 	int x;
; 1062 : 	int y;
; 1063 : 	int Option1 = 0;
; 1064 : 	int Option2 = 0;
; 1065 : 	int Option3 = 0;
; 1066 : 	int DropItemRate;
; 1067 : 	int DropItemNum;
; 1068 : 	int ExOption = 0;
; 1069 : 	LPOBJ lpObj = &gObj[aIndex];

  0001f	8b 7d 08	 mov	 edi, DWORD PTR _aIndex$[ebp]
  00022	69 ff 50 2b 00
	00		 imul	 edi, 11088		; 00002b50H
  00028	03 3d 00 00 00
	00		 add	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0002e	89 75 f4	 mov	 DWORD PTR _Option1$[ebp], esi
  00031	89 75 f8	 mov	 DWORD PTR _Option2$[ebp], esi
  00034	89 75 fc	 mov	 DWORD PTR _Option3$[ebp], esi

; 1070 : 
; 1071 : 	if ( this->GetBagCount() > 0 )

  00037	39 b3 20 01 00
	00		 cmp	 DWORD PTR [ebx+288], esi
  0003d	0f 8e aa 02 00
	00		 jle	 $LN15@DropBlueCh

; 1072 : 	{
; 1073 : 		DropItemRate = rand() % 10000;

  00043	e8 00 00 00 00	 call	 _rand
  00048	99		 cdq
  00049	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  0004e	f7 f9		 idiv	 ecx

; 1074 : 
; 1075 : 		if ( DropItemRate < g_iBlueChocolateBoxDropZenRate )

  00050	3b 15 00 00 00
	00		 cmp	 edx, DWORD PTR ?g_iBlueChocolateBoxDropZenRate@@3HA ; g_iBlueChocolateBoxDropZenRate
  00056	7d 51		 jge	 SHORT $LN14@DropBlueCh

; 1076 : 		{
; 1077 : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iBlueChocolateBoxDropZen, 
; 1078 : 				lpObj->X, lpObj->Y);

  00058	0f bf 97 46 01
	00 00		 movsx	 edx, WORD PTR [edi+326]
  0005f	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]
  00066	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iBlueChocolateBoxDropZen@@3HA ; g_iBlueChocolateBoxDropZen
  0006c	52		 push	 edx
  0006d	50		 push	 eax
  0006e	51		 push	 ecx
  0006f	0f b6 8f 49 01
	00 00		 movzx	 ecx, BYTE PTR [edi+329]
  00076	69 c9 48 3d 05
	00		 imul	 ecx, 343368		; 00053d48H
  0007c	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  00082	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 1079 : 
; 1080 : 			LogAddTD("[EVENT VALENTINE'S DAY CHOCOLATEBOX] BLUECHOCOLATEBOX Event ItemDrop [%s][%s] [%d Zen]",
; 1081 : 				lpObj->AccountID, lpObj->Name,
; 1082 : 				g_iBlueChocolateBoxDropZen);

  00087	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?g_iBlueChocolateBoxDropZen@@3HA ; g_iBlueChocolateBoxDropZen
  0008d	52		 push	 edx
  0008e	8d 47 77	 lea	 eax, DWORD PTR [edi+119]
  00091	50		 push	 eax
  00092	8d 4f 6c	 lea	 ecx, DWORD PTR [edi+108]
  00095	51		 push	 ecx
  00096	68 00 00 00 00	 push	 OFFSET ??_C@_0FH@CKADFAKC@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
  0009b	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  000a1	83 c4 10	 add	 esp, 16			; 00000010H

; 1083 : 		}
; 1084 : 		else

  000a4	e9 ff 01 00 00	 jmp	 $LN13@DropBlueCh
$LN14@DropBlueCh:

; 1085 : 		{
; 1086 : 			DropItemNum = rand() % this->GetBagCount();

  000a9	8b 93 20 01 00
	00		 mov	 edx, DWORD PTR [ebx+288]
  000af	89 55 08	 mov	 DWORD PTR $T211282[ebp], edx
  000b2	e8 00 00 00 00	 call	 _rand
  000b7	99		 cdq
  000b8	f7 7d 08	 idiv	 DWORD PTR $T211282[ebp]

; 1087 : 			dur = 0;
; 1088 : 			x = lpObj->X;
; 1089 : 			y = lpObj->Y;

  000bb	0f bf 8f 46 01
	00 00		 movsx	 ecx, WORD PTR [edi+326]
  000c2	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]
  000c9	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 1090 : 			level = this->GetLevel(DropItemNum);

  000cc	8b cb		 mov	 ecx, ebx
  000ce	89 45 e4	 mov	 DWORD PTR _x$[ebp], eax
  000d1	52		 push	 edx
  000d2	89 55 f0	 mov	 DWORD PTR _DropItemNum$[ebp], edx
  000d5	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel
  000da	0f b6 d0	 movzx	 edx, al

; 1091 : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  000dd	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  000e0	0f b6 8c c3 1e
	02 00 00	 movzx	 ecx, BYTE PTR [ebx+eax*8+542]
  000e8	89 55 08	 mov	 DWORD PTR _level$[ebp], edx
  000eb	0f b6 94 c3 1d
	02 00 00	 movzx	 edx, BYTE PTR [ebx+eax*8+541]
  000f3	51		 push	 ecx
  000f4	52		 push	 edx
  000f5	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  000fa	8b d8		 mov	 ebx, eax
  000fc	83 c4 08	 add	 esp, 8

; 1092 : 
; 1093 : 			if ( type == -1 )

  000ff	83 fb ff	 cmp	 ebx, -1
  00102	75 0b		 jne	 SHORT $LN12@DropBlueCh

; 1094 : 				return FALSE;

  00104	5f		 pop	 edi
  00105	5e		 pop	 esi
  00106	33 c0		 xor	 eax, eax
  00108	5b		 pop	 ebx

; 1170 : }

  00109	8b e5		 mov	 esp, ebp
  0010b	5d		 pop	 ebp
  0010c	c2 04 00	 ret	 4
$LN12@DropBlueCh:

; 1095 : 
; 1096 : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  0010f	8b 4d ec	 mov	 ecx, DWORD PTR _this$[ebp]
  00112	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00115	80 bc c1 21 02
	00 00 00	 cmp	 BYTE PTR [ecx+eax*8+545], 0
  0011d	74 07		 je	 SHORT $LN23@DropBlueCh

; 1097 : 				Option1 = 1;

  0011f	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN23@DropBlueCh:

; 1098 : 
; 1099 : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  00126	80 bc c1 22 02
	00 00 00	 cmp	 BYTE PTR [ecx+eax*8+546], 0
  0012e	74 1d		 je	 SHORT $LN24@DropBlueCh

; 1100 : 			{
; 1101 : 				Option2 = 0;

  00130	89 75 f8	 mov	 DWORD PTR _Option2$[ebp], esi

; 1102 : 
; 1103 : 				if ( (rand()%2) == 0 )

  00133	e8 00 00 00 00	 call	 _rand
  00138	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  0013d	79 05		 jns	 SHORT $LN29@DropBlueCh
  0013f	48		 dec	 eax
  00140	83 c8 fe	 or	 eax, -2			; fffffffeH
  00143	40		 inc	 eax
$LN29@DropBlueCh:
  00144	75 07		 jne	 SHORT $LN24@DropBlueCh

; 1104 : 				{
; 1105 : 					Option2 = 1;

  00146	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN24@DropBlueCh:

; 1106 : 				}
; 1107 : 			}
; 1108 : 
; 1109 : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  0014d	8b 45 ec	 mov	 eax, DWORD PTR _this$[ebp]
  00150	8b 4d f0	 mov	 ecx, DWORD PTR _DropItemNum$[ebp]
  00153	80 bc c8 23 02
	00 00 00	 cmp	 BYTE PTR [eax+ecx*8+547], 0
  0015b	74 2b		 je	 SHORT $LN26@DropBlueCh

; 1110 : 			{
; 1111 : 				if ( (rand()%5) < 1 )

  0015d	e8 00 00 00 00	 call	 _rand
  00162	99		 cdq
  00163	b9 05 00 00 00	 mov	 ecx, 5
  00168	f7 f9		 idiv	 ecx
  0016a	83 fa 01	 cmp	 edx, 1
  0016d	7d 09		 jge	 SHORT $LN7@DropBlueCh

; 1112 : 				{
; 1113 : 					Option3 = 3;

  0016f	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 1114 : 				}
; 1115 : 				else

  00176	eb 10		 jmp	 SHORT $LN26@DropBlueCh
$LN7@DropBlueCh:

; 1116 : 				{
; 1117 : 					Option3 = rand() % 3;

  00178	e8 00 00 00 00	 call	 _rand
  0017d	99		 cdq
  0017e	b9 03 00 00 00	 mov	 ecx, 3
  00183	f7 f9		 idiv	 ecx
  00185	89 55 fc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN26@DropBlueCh:

; 1118 : 				}
; 1119 : 			}
; 1120 : 
; 1121 : 			if ( this->BagObject[DropItemNum].m_isexitem )

  00188	8b 55 ec	 mov	 edx, DWORD PTR _this$[ebp]
  0018b	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  0018e	80 bc c2 24 02
	00 00 00	 cmp	 BYTE PTR [edx+eax*8+548], 0
  00196	74 1d		 je	 SHORT $LN27@DropBlueCh

; 1122 : 			{
; 1123 : 				ExOption = NewOptionRand(level);

  00198	8b 4d 08	 mov	 ecx, DWORD PTR _level$[ebp]
  0019b	51		 push	 ecx
  0019c	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  001a1	83 c4 04	 add	 esp, 4

; 1124 : #ifndef _FIX_
; 1125 : 				Option2 = 0;
; 1126 : #endif
; 1127 : 				Option1 = 1;
; 1128 : 				level = 0;

  001a4	33 c9		 xor	 ecx, ecx
  001a6	0f b6 f0	 movzx	 esi, al
  001a9	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
  001b0	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
  001b3	eb 02		 jmp	 SHORT $LN5@DropBlueCh
$LN27@DropBlueCh:
  001b5	33 c9		 xor	 ecx, ecx
$LN5@DropBlueCh:

; 1129 : 			}
; 1130 : 
; 1131 : 			if ( type == ITEMGET(12,15) ||
; 1132 : 				 type == ITEMGET(14,13) ||
; 1133 : 				 type == ITEMGET(14,14)  )

  001b7	81 fb 0f 18 00
	00		 cmp	 ebx, 6159		; 0000180fH
  001bd	74 10		 je	 SHORT $LN3@DropBlueCh
  001bf	81 fb 0d 1c 00
	00		 cmp	 ebx, 7181		; 00001c0dH
  001c5	74 08		 je	 SHORT $LN3@DropBlueCh
  001c7	81 fb 0e 1c 00
	00		 cmp	 ebx, 7182		; 00001c0eH
  001cd	75 0c		 jne	 SHORT $LN4@DropBlueCh
$LN3@DropBlueCh:

; 1134 : 			{
; 1135 : 				Option1 = 0;

  001cf	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx

; 1136 : 				Option2 = 0;

  001d2	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx

; 1137 : 				Option3 = 0;

  001d5	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx

; 1138 : 				level = 0;

  001d8	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
$LN4@DropBlueCh:

; 1139 : 			}
; 1140 : 
; 1141 : 			if ( type == ITEMGET(13,8) ||
; 1142 : 				 type == ITEMGET(13,9) ||
; 1143 : 				 type == ITEMGET(13,12) ||
; 1144 : 				 type == ITEMGET(13,21) )

  001db	81 fb 08 1a 00
	00		 cmp	 ebx, 6664		; 00001a08H
  001e1	74 18		 je	 SHORT $LN1@DropBlueCh
  001e3	81 fb 09 1a 00
	00		 cmp	 ebx, 6665		; 00001a09H
  001e9	74 10		 je	 SHORT $LN1@DropBlueCh
  001eb	81 fb 0c 1a 00
	00		 cmp	 ebx, 6668		; 00001a0cH
  001f1	74 08		 je	 SHORT $LN1@DropBlueCh
  001f3	81 fb 15 1a 00
	00		 cmp	 ebx, 6677		; 00001a15H
  001f9	75 03		 jne	 SHORT $LN2@DropBlueCh
$LN1@DropBlueCh:

; 1145 : 			{
; 1146 : 				level = 0;

  001fb	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
$LN2@DropBlueCh:

; 1147 : 			}
; 1148 : 			
; 1149 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 1150 : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  001fe	8b 07		 mov	 eax, DWORD PTR [edi]
  00200	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  00203	51		 push	 ecx
  00204	56		 push	 esi
  00205	50		 push	 eax
  00206	52		 push	 edx
  00207	8b 55 f8	 mov	 edx, DWORD PTR _Option2$[ebp]
  0020a	52		 push	 edx
  0020b	8b 55 f4	 mov	 edx, DWORD PTR _Option1$[ebp]
  0020e	52		 push	 edx
  0020f	8b 55 e8	 mov	 edx, DWORD PTR _y$[ebp]
  00212	51		 push	 ecx
  00213	8b 4d 08	 mov	 ecx, DWORD PTR _level$[ebp]
  00216	51		 push	 ecx
  00217	8b 4d e4	 mov	 ecx, DWORD PTR _x$[ebp]
  0021a	53		 push	 ebx
  0021b	52		 push	 edx
  0021c	0f b6 97 49 01
	00 00		 movzx	 edx, BYTE PTR [edi+329]
  00223	51		 push	 ecx
  00224	52		 push	 edx
  00225	50		 push	 eax
  00226	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 1151 : 
; 1152 : 			LogAddTD("[EVENT VALENTINE'S DAY CHOCOLATEBOX ] BLUECHOCOLATEBOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d  Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 1153 : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 1154 : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 1155 : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  0022b	6a 00		 push	 0
  0022d	8b c6		 mov	 eax, esi
  0022f	83 e0 01	 and	 eax, 1
  00232	50		 push	 eax
  00233	8b ce		 mov	 ecx, esi
  00235	d1 f9		 sar	 ecx, 1
  00237	83 e1 01	 and	 ecx, 1
  0023a	51		 push	 ecx
  0023b	8b d6		 mov	 edx, esi
  0023d	c1 fa 02	 sar	 edx, 2
  00240	83 e2 01	 and	 edx, 1
  00243	52		 push	 edx
  00244	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  00247	8b c6		 mov	 eax, esi
  00249	c1 f8 03	 sar	 eax, 3
  0024c	83 e0 01	 and	 eax, 1
  0024f	50		 push	 eax
  00250	8b 45 f8	 mov	 eax, DWORD PTR _Option2$[ebp]
  00253	8b ce		 mov	 ecx, esi
  00255	c1 f9 04	 sar	 ecx, 4
  00258	83 e1 01	 and	 ecx, 1
  0025b	51		 push	 ecx
  0025c	8b 4d f4	 mov	 ecx, DWORD PTR _Option1$[ebp]
  0025f	c1 fe 05	 sar	 esi, 5
  00262	83 e6 01	 and	 esi, 1
  00265	56		 push	 esi
  00266	52		 push	 edx
  00267	8b 55 08	 mov	 edx, DWORD PTR _level$[ebp]
  0026a	50		 push	 eax
  0026b	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  0026e	51		 push	 ecx
  0026f	8b 4d e4	 mov	 ecx, DWORD PTR _x$[ebp]
  00272	52		 push	 edx
  00273	0f b6 97 49 01
	00 00		 movzx	 edx, BYTE PTR [edi+329]
  0027a	53		 push	 ebx
  0027b	6b db 70	 imul	 ebx, 112		; 00000070H
  0027e	81 c3 00 00 00
	00		 add	 ebx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  00284	53		 push	 ebx
  00285	50		 push	 eax
  00286	8b 45 ec	 mov	 eax, DWORD PTR _this$[ebp]
  00289	51		 push	 ecx
  0028a	52		 push	 edx
  0028b	83 c0 08	 add	 eax, 8
  0028e	50		 push	 eax
  0028f	8d 4f 77	 lea	 ecx, DWORD PTR [edi+119]
  00292	51		 push	 ecx
  00293	8d 57 6c	 lea	 edx, DWORD PTR [edi+108]
  00296	52		 push	 edx
  00297	68 00 00 00 00	 push	 OFFSET ??_C@_0KH@KCPHJKBG@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
  0029c	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  002a2	81 c4 84 00 00
	00		 add	 esp, 132		; 00000084H
$LN13@DropBlueCh:

; 1156 : 		}
; 1157 : 
; 1158 : 		PMSG_SERVERCMD ServerCmd;
; 1159 : 
; 1160 : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  002a8	6a 07		 push	 7
  002aa	6a 40		 push	 64			; 00000040H
  002ac	8d 45 dc	 lea	 eax, DWORD PTR _ServerCmd$210422[ebp]
  002af	68 f3 00 00 00	 push	 243			; 000000f3H
  002b4	50		 push	 eax
  002b5	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB

; 1161 : 		ServerCmd.CmdType = 0;
; 1162 : 		ServerCmd.X = lpObj->X;

  002ba	8a 8f 44 01 00
	00		 mov	 cl, BYTE PTR [edi+324]

; 1163 : 		ServerCmd.Y = lpObj->Y;

  002c0	8a 97 46 01 00
	00		 mov	 dl, BYTE PTR [edi+326]

; 1164 : 
; 1165 : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  002c6	6a 07		 push	 7
  002c8	8d 45 dc	 lea	 eax, DWORD PTR _ServerCmd$210422[ebp]
  002cb	50		 push	 eax
  002cc	57		 push	 edi
  002cd	c6 45 e0 00	 mov	 BYTE PTR _ServerCmd$210422[ebp+4], 0
  002d1	88 4d e1	 mov	 BYTE PTR _ServerCmd$210422[ebp+5], cl
  002d4	88 55 e2	 mov	 BYTE PTR _ServerCmd$210422[ebp+6], dl
  002d7	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2

; 1166 : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  002dc	8b 17		 mov	 edx, DWORD PTR [edi]
  002de	6a 07		 push	 7
  002e0	8d 4d dc	 lea	 ecx, DWORD PTR _ServerCmd$210422[ebp]
  002e3	51		 push	 ecx
  002e4	52		 push	 edx
  002e5	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  002ea	83 c4 28	 add	 esp, 40			; 00000028H
$LN15@DropBlueCh:

; 1167 : 	}
; 1168 : 
; 1169 : 	return TRUE;

  002ed	5f		 pop	 edi
  002ee	5e		 pop	 esi
  002ef	b8 01 00 00 00	 mov	 eax, 1
  002f4	5b		 pop	 ebx

; 1170 : }

  002f5	8b e5		 mov	 esp, ebp
  002f7	5d		 pop	 ebp
  002f8	c2 04 00	 ret	 4
?DropBlueChocolateBoxEventItem@CItemBagZt@@QAEHH@Z ENDP	; CItemBagZt::DropBlueChocolateBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0JM@KKDJBICI@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5LIGH@ ; `string'
PUBLIC	??_C@_0EO@BALFJEBE@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5LIGH@ ; `string'
PUBLIC	?DropLightPurpleCandyBoxEventItem@CItemBagZt@@QAEHH@Z ; CItemBagZt::DropLightPurpleCandyBoxEventItem
EXTRN	?g_iLightPurpleCandyBoxDropZen@@3HA:DWORD	; g_iLightPurpleCandyBoxDropZen
EXTRN	?g_iLightPurpleCandyBoxDropZenRate@@3HA:DWORD	; g_iLightPurpleCandyBoxDropZenRate
;	COMDAT ??_C@_0JM@KKDJBICI@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5LIGH@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0JM@KKDJBICI@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5LIGH@ DB '[EVEN'
	DB	'T WHITE DAY CANDY BOX] LIGHT PURPLE BOX Event ItemDrop [%s][%'
	DB	's] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:'
	DB	'%d Ex:[%d,%d,%d,%d,%d,%d,%d]', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0EO@BALFJEBE@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5LIGH@
CONST	SEGMENT
??_C@_0EO@BALFJEBE@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5LIGH@ DB '[EVEN'
	DB	'T WHITE DAY CANDY BOX] LIGHT PURPLE BOX Event ItemDrop [%s][%'
	DB	's] [%d Zen]', 00H				; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropLightPurpleCandyBoxEventItem@CItemBagZt@@QAEHH@Z
_TEXT	SEGMENT
_ServerCmd$210468 = -32					; size = 7
_x$ = -24						; size = 4
_y$ = -20						; size = 4
_DropItemNum$ = -16					; size = 4
_Option1$ = -12						; size = 4
_Option2$ = -8						; size = 4
_Option3$ = -4						; size = 4
_level$ = 8						; size = 4
_aIndex$ = 8						; size = 4
?DropLightPurpleCandyBoxEventItem@CItemBagZt@@QAEHH@Z PROC ; CItemBagZt::DropLightPurpleCandyBoxEventItem, COMDAT
; _this$ = ecx

; 1175 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 20	 sub	 esp, 32			; 00000020H
  00006	53		 push	 ebx
  00007	8b d9		 mov	 ebx, ecx

; 1176 : 	if ( this->m_bLoad == FALSE )

  00009	33 c0		 xor	 eax, eax
  0000b	39 43 04	 cmp	 DWORD PTR [ebx+4], eax
  0000e	75 07		 jne	 SHORT $LN15@DropLightP
  00010	5b		 pop	 ebx

; 1284 : }

  00011	8b e5		 mov	 esp, ebp
  00013	5d		 pop	 ebp
  00014	c2 04 00	 ret	 4
$LN15@DropLightP:
  00017	56		 push	 esi

; 1177 : 		return FALSE;
; 1178 : 
; 1179 : 	float dur;
; 1180 : 	int type;
; 1181 : 	int level;
; 1182 : 	int x;
; 1183 : 	int y;
; 1184 : 	int Option1 = 0;
; 1185 : 	int Option2 = 0;
; 1186 : 	int Option3 = 0;
; 1187 : 	int DropItemRate;
; 1188 : 	int DropItemNum;
; 1189 : 	int ExOption = 0;
; 1190 : 	LPOBJ lpObj = &gObj[aIndex];

  00018	8b 75 08	 mov	 esi, DWORD PTR _aIndex$[ebp]
  0001b	69 f6 50 2b 00
	00		 imul	 esi, 11088		; 00002b50H
  00021	03 35 00 00 00
	00		 add	 esi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00027	57		 push	 edi
  00028	89 45 f4	 mov	 DWORD PTR _Option1$[ebp], eax
  0002b	89 45 f8	 mov	 DWORD PTR _Option2$[ebp], eax
  0002e	89 45 fc	 mov	 DWORD PTR _Option3$[ebp], eax

; 1191 : 
; 1192 : 	if ( this->GetBagCount() > 0 )

  00031	39 83 20 01 00
	00		 cmp	 DWORD PTR [ebx+288], eax
  00037	0f 8e 51 02 00
	00		 jle	 $LN14@DropLightP

; 1193 : 	{
; 1194 : 		DropItemRate = rand() % 10000;

  0003d	e8 00 00 00 00	 call	 _rand
  00042	99		 cdq
  00043	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  00048	f7 f9		 idiv	 ecx

; 1195 : 
; 1196 : 		if ( DropItemRate < g_iLightPurpleCandyBoxDropZenRate )

  0004a	3b 15 00 00 00
	00		 cmp	 edx, DWORD PTR ?g_iLightPurpleCandyBoxDropZenRate@@3HA ; g_iLightPurpleCandyBoxDropZenRate
  00050	7d 51		 jge	 SHORT $LN13@DropLightP

; 1197 : 		{
; 1198 : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iLightPurpleCandyBoxDropZen, 
; 1199 : 				lpObj->X, lpObj->Y);

  00052	0f bf 96 46 01
	00 00		 movsx	 edx, WORD PTR [esi+326]
  00059	0f bf 86 44 01
	00 00		 movsx	 eax, WORD PTR [esi+324]
  00060	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iLightPurpleCandyBoxDropZen@@3HA ; g_iLightPurpleCandyBoxDropZen
  00066	52		 push	 edx
  00067	50		 push	 eax
  00068	51		 push	 ecx
  00069	0f b6 8e 49 01
	00 00		 movzx	 ecx, BYTE PTR [esi+329]
  00070	69 c9 48 3d 05
	00		 imul	 ecx, 343368		; 00053d48H
  00076	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  0007c	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 1200 : 
; 1201 : 			LogAddTD("[EVENT WHITE DAY CANDY BOX] LIGHT PURPLE BOX Event ItemDrop [%s][%s] [%d Zen]",
; 1202 : 				lpObj->AccountID, lpObj->Name,
; 1203 : 				g_iLightPurpleCandyBoxDropZen);

  00081	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?g_iLightPurpleCandyBoxDropZen@@3HA ; g_iLightPurpleCandyBoxDropZen
  00087	52		 push	 edx
  00088	8d 46 77	 lea	 eax, DWORD PTR [esi+119]
  0008b	50		 push	 eax
  0008c	8d 4e 6c	 lea	 ecx, DWORD PTR [esi+108]
  0008f	51		 push	 ecx
  00090	68 00 00 00 00	 push	 OFFSET ??_C@_0EO@BALFJEBE@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5LIGH@
  00095	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  0009b	83 c4 10	 add	 esp, 16			; 00000010H

; 1204 : 		}
; 1205 : 		else

  0009e	e9 a6 01 00 00	 jmp	 $LN12@DropLightP
$LN13@DropLightP:

; 1206 : 		{
; 1207 : 			DropItemNum = rand() % this->GetBagCount();

  000a3	8b bb 20 01 00
	00		 mov	 edi, DWORD PTR [ebx+288]
  000a9	e8 00 00 00 00	 call	 _rand
  000ae	99		 cdq
  000af	f7 ff		 idiv	 edi

; 1208 : 			dur = 0;
; 1209 : 			x = lpObj->X;
; 1210 : 			y = lpObj->Y;

  000b1	0f bf 86 46 01
	00 00		 movsx	 eax, WORD PTR [esi+326]

; 1211 : 			level = this->GetLevel(DropItemNum);

  000b8	8b cb		 mov	 ecx, ebx
  000ba	89 45 ec	 mov	 DWORD PTR _y$[ebp], eax
  000bd	8b fa		 mov	 edi, edx
  000bf	0f bf 96 44 01
	00 00		 movsx	 edx, WORD PTR [esi+324]
  000c6	57		 push	 edi
  000c7	89 7d f0	 mov	 DWORD PTR _DropItemNum$[ebp], edi
  000ca	89 55 e8	 mov	 DWORD PTR _x$[ebp], edx
  000cd	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel

; 1212 : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  000d2	0f b6 94 fb 1e
	02 00 00	 movzx	 edx, BYTE PTR [ebx+edi*8+542]
  000da	0f b6 c8	 movzx	 ecx, al
  000dd	0f b6 84 fb 1d
	02 00 00	 movzx	 eax, BYTE PTR [ebx+edi*8+541]
  000e5	52		 push	 edx
  000e6	50		 push	 eax
  000e7	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
  000ea	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  000ef	8b f8		 mov	 edi, eax
  000f1	83 c4 08	 add	 esp, 8

; 1213 : 
; 1214 : 			if ( type == -1 )

  000f4	83 ff ff	 cmp	 edi, -1
  000f7	75 0b		 jne	 SHORT $LN11@DropLightP

; 1215 : 				return FALSE;

  000f9	5f		 pop	 edi
  000fa	5e		 pop	 esi
  000fb	33 c0		 xor	 eax, eax
  000fd	5b		 pop	 ebx

; 1284 : }

  000fe	8b e5		 mov	 esp, ebp
  00100	5d		 pop	 ebp
  00101	c2 04 00	 ret	 4
$LN11@DropLightP:

; 1216 : 
; 1217 : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  00104	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00107	80 bc c3 21 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+545], 0
  0010f	74 07		 je	 SHORT $LN22@DropLightP

; 1218 : 				Option1 = 1;

  00111	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN22@DropLightP:

; 1219 : 
; 1220 : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  00118	80 bc c3 22 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+546], 0
  00120	74 21		 je	 SHORT $LN23@DropLightP

; 1221 : 			{
; 1222 : 				Option2 = 0;

  00122	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1223 : 
; 1224 : 				if ( (rand()%2) == 0 )

  00129	e8 00 00 00 00	 call	 _rand
  0012e	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  00133	79 05		 jns	 SHORT $LN29@DropLightP
  00135	48		 dec	 eax
  00136	83 c8 fe	 or	 eax, -2			; fffffffeH
  00139	40		 inc	 eax
$LN29@DropLightP:
  0013a	75 07		 jne	 SHORT $LN23@DropLightP

; 1225 : 				{
; 1226 : 					Option2 = 1;

  0013c	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN23@DropLightP:

; 1227 : 				}
; 1228 : 			}
; 1229 : 
; 1230 : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  00143	8b 4d f0	 mov	 ecx, DWORD PTR _DropItemNum$[ebp]
  00146	80 bc cb 23 02
	00 00 00	 cmp	 BYTE PTR [ebx+ecx*8+547], 0
  0014e	74 2b		 je	 SHORT $LN25@DropLightP

; 1231 : 			{
; 1232 : 				if ( (rand()%5) < 1 )

  00150	e8 00 00 00 00	 call	 _rand
  00155	99		 cdq
  00156	b9 05 00 00 00	 mov	 ecx, 5
  0015b	f7 f9		 idiv	 ecx
  0015d	83 fa 01	 cmp	 edx, 1
  00160	7d 09		 jge	 SHORT $LN6@DropLightP

; 1233 : 				{
; 1234 : 					Option3 = 3;

  00162	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 1235 : 				}
; 1236 : 				else

  00169	eb 10		 jmp	 SHORT $LN25@DropLightP
$LN6@DropLightP:

; 1237 : 				{
; 1238 : 					Option3 = rand() % 3;

  0016b	e8 00 00 00 00	 call	 _rand
  00170	99		 cdq
  00171	b9 03 00 00 00	 mov	 ecx, 3
  00176	f7 f9		 idiv	 ecx
  00178	89 55 fc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN25@DropLightP:

; 1239 : 				}
; 1240 : 			}
; 1241 : 
; 1242 : 			ExOption = 0;
; 1243 : 
; 1244 : 			if ( type == ITEMGET(12,15) ||
; 1245 : 				 type == ITEMGET(14,13) ||
; 1246 : 				 type == ITEMGET(14,14) )

  0017b	81 ff 0f 18 00
	00		 cmp	 edi, 6159		; 0000180fH
  00181	74 10		 je	 SHORT $LN3@DropLightP
  00183	81 ff 0d 1c 00
	00		 cmp	 edi, 7181		; 00001c0dH
  00189	74 08		 je	 SHORT $LN3@DropLightP
  0018b	81 ff 0e 1c 00
	00		 cmp	 edi, 7182		; 00001c0eH
  00191	75 10		 jne	 SHORT $LN26@DropLightP
$LN3@DropLightP:

; 1247 : 			{
; 1248 : 				Option1 = 0;

  00193	33 c9		 xor	 ecx, ecx
  00195	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx

; 1249 : 				Option2 = 0;

  00198	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx

; 1250 : 				Option3 = 0;

  0019b	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx

; 1251 : 				level = 0;

  0019e	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
  001a1	eb 02		 jmp	 SHORT $LN4@DropLightP
$LN26@DropLightP:
  001a3	33 c9		 xor	 ecx, ecx
$LN4@DropLightP:

; 1252 : 			}
; 1253 : 
; 1254 : 			if ( type == ITEMGET(14,19) ||
; 1255 : 				 type == ITEMGET(14,28) ||
; 1256 : 				 type == ITEMGET(13,18) )

  001a5	81 ff 13 1c 00
	00		 cmp	 edi, 7187		; 00001c13H
  001ab	74 10		 je	 SHORT $LN1@DropLightP
  001ad	81 ff 1c 1c 00
	00		 cmp	 edi, 7196		; 00001c1cH
  001b3	74 08		 je	 SHORT $LN1@DropLightP
  001b5	81 ff 12 1a 00
	00		 cmp	 edi, 6674		; 00001a12H
  001bb	75 09		 jne	 SHORT $LN2@DropLightP
$LN1@DropLightP:

; 1257 : 			{
; 1258 : 				Option1 = 0;

  001bd	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx

; 1259 : 				Option2 = 0;

  001c0	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx

; 1260 : 				Option3 = 0;

  001c3	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx
$LN2@DropLightP:

; 1261 : 			}
; 1262 : 			
; 1263 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 1264 : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  001c6	8b 06		 mov	 eax, DWORD PTR [esi]
  001c8	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  001cb	51		 push	 ecx
  001cc	51		 push	 ecx
  001cd	50		 push	 eax
  001ce	52		 push	 edx
  001cf	8b 55 f8	 mov	 edx, DWORD PTR _Option2$[ebp]
  001d2	52		 push	 edx
  001d3	8b 55 f4	 mov	 edx, DWORD PTR _Option1$[ebp]
  001d6	52		 push	 edx
  001d7	8b 55 ec	 mov	 edx, DWORD PTR _y$[ebp]
  001da	51		 push	 ecx
  001db	8b 4d 08	 mov	 ecx, DWORD PTR _level$[ebp]
  001de	51		 push	 ecx
  001df	8b 4d e8	 mov	 ecx, DWORD PTR _x$[ebp]
  001e2	57		 push	 edi
  001e3	52		 push	 edx
  001e4	0f b6 96 49 01
	00 00		 movzx	 edx, BYTE PTR [esi+329]
  001eb	51		 push	 ecx
  001ec	52		 push	 edx
  001ed	50		 push	 eax
  001ee	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 1265 : 
; 1266 : 			LogAddTD("[EVENT WHITE DAY CANDY BOX] LIGHT PURPLE BOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 1267 : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 1268 : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 1269 : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  001f3	8b 45 fc	 mov	 eax, DWORD PTR _Option3$[ebp]
  001f6	8b 4d f8	 mov	 ecx, DWORD PTR _Option2$[ebp]
  001f9	6a 00		 push	 0
  001fb	8b 55 f4	 mov	 edx, DWORD PTR _Option1$[ebp]
  001fe	6a 00		 push	 0
  00200	6a 00		 push	 0
  00202	6a 00		 push	 0
  00204	6a 00		 push	 0
  00206	6a 00		 push	 0
  00208	6a 00		 push	 0
  0020a	50		 push	 eax
  0020b	8b 45 08	 mov	 eax, DWORD PTR _level$[ebp]
  0020e	51		 push	 ecx
  0020f	8b 4d ec	 mov	 ecx, DWORD PTR _y$[ebp]
  00212	52		 push	 edx
  00213	8b 55 e8	 mov	 edx, DWORD PTR _x$[ebp]
  00216	50		 push	 eax
  00217	0f b6 86 49 01
	00 00		 movzx	 eax, BYTE PTR [esi+329]
  0021e	57		 push	 edi
  0021f	6b ff 70	 imul	 edi, 112		; 00000070H
  00222	81 c7 00 00 00
	00		 add	 edi, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  00228	57		 push	 edi
  00229	51		 push	 ecx
  0022a	52		 push	 edx
  0022b	50		 push	 eax
  0022c	83 c3 08	 add	 ebx, 8
  0022f	53		 push	 ebx
  00230	8d 4e 77	 lea	 ecx, DWORD PTR [esi+119]
  00233	51		 push	 ecx
  00234	8d 56 6c	 lea	 edx, DWORD PTR [esi+108]
  00237	52		 push	 edx
  00238	68 00 00 00 00	 push	 OFFSET ??_C@_0JM@KKDJBICI@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5LIGH@
  0023d	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  00243	81 c4 84 00 00
	00		 add	 esp, 132		; 00000084H
$LN12@DropLightP:

; 1270 : 		}
; 1271 : 
; 1272 : 		PMSG_SERVERCMD ServerCmd;
; 1273 : 
; 1274 : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  00249	6a 07		 push	 7
  0024b	6a 40		 push	 64			; 00000040H
  0024d	8d 45 e0	 lea	 eax, DWORD PTR _ServerCmd$210468[ebp]
  00250	68 f3 00 00 00	 push	 243			; 000000f3H
  00255	50		 push	 eax
  00256	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB

; 1275 : 		ServerCmd.CmdType = 0;
; 1276 : 		ServerCmd.X = lpObj->X;

  0025b	8a 8e 44 01 00
	00		 mov	 cl, BYTE PTR [esi+324]

; 1277 : 		ServerCmd.Y = lpObj->Y;

  00261	8a 96 46 01 00
	00		 mov	 dl, BYTE PTR [esi+326]

; 1278 : 
; 1279 : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  00267	6a 07		 push	 7
  00269	8d 45 e0	 lea	 eax, DWORD PTR _ServerCmd$210468[ebp]
  0026c	50		 push	 eax
  0026d	56		 push	 esi
  0026e	c6 45 e4 00	 mov	 BYTE PTR _ServerCmd$210468[ebp+4], 0
  00272	88 4d e5	 mov	 BYTE PTR _ServerCmd$210468[ebp+5], cl
  00275	88 55 e6	 mov	 BYTE PTR _ServerCmd$210468[ebp+6], dl
  00278	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2

; 1280 : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  0027d	8b 16		 mov	 edx, DWORD PTR [esi]
  0027f	6a 07		 push	 7
  00281	8d 4d e0	 lea	 ecx, DWORD PTR _ServerCmd$210468[ebp]
  00284	51		 push	 ecx
  00285	52		 push	 edx
  00286	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  0028b	83 c4 28	 add	 esp, 40			; 00000028H
$LN14@DropLightP:

; 1281 : 	}
; 1282 : 
; 1283 : 	return TRUE;

  0028e	5f		 pop	 edi
  0028f	5e		 pop	 esi
  00290	b8 01 00 00 00	 mov	 eax, 1
  00295	5b		 pop	 ebx

; 1284 : }

  00296	8b e5		 mov	 esp, ebp
  00298	5d		 pop	 ebp
  00299	c2 04 00	 ret	 4
?DropLightPurpleCandyBoxEventItem@CItemBagZt@@QAEHH@Z ENDP ; CItemBagZt::DropLightPurpleCandyBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0JJ@NBIHGBN@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5VERM@ ; `string'
PUBLIC	??_C@_0EL@PEMOOOOC@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5VERM@ ; `string'
PUBLIC	?DropVermilionCandyBoxEventItem@CItemBagZt@@QAEHH@Z ; CItemBagZt::DropVermilionCandyBoxEventItem
EXTRN	?g_iVermilionCandyBoxDropZen@@3HA:DWORD		; g_iVermilionCandyBoxDropZen
EXTRN	?g_iVermilionCandyBoxDropZenRate@@3HA:DWORD	; g_iVermilionCandyBoxDropZenRate
;	COMDAT ??_C@_0JJ@NBIHGBN@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5VERM@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0JJ@NBIHGBN@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5VERM@ DB '[EVENT'
	DB	' WHITE DAY CANDY BOX] VERMILION BOX Event ItemDrop [%s][%s] ['
	DB	'%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d E'
	DB	'x:[%d,%d,%d,%d,%d,%d,%d]', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0EL@PEMOOOOC@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5VERM@
CONST	SEGMENT
??_C@_0EL@PEMOOOOC@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5VERM@ DB '[EVEN'
	DB	'T WHITE DAY CANDY BOX] VERMILION BOX Event ItemDrop [%s][%s] '
	DB	'[%d Zen]', 00H				; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropVermilionCandyBoxEventItem@CItemBagZt@@QAEHH@Z
_TEXT	SEGMENT
_ServerCmd$210515 = -36					; size = 7
_x$ = -28						; size = 4
_y$ = -24						; size = 4
_this$ = -20						; size = 4
_DropItemNum$ = -16					; size = 4
_Option1$ = -12						; size = 4
_Option2$ = -8						; size = 4
_Option3$ = -4						; size = 4
$T211317 = 8						; size = 4
_level$ = 8						; size = 4
_aIndex$ = 8						; size = 4
?DropVermilionCandyBoxEventItem@CItemBagZt@@QAEHH@Z PROC ; CItemBagZt::DropVermilionCandyBoxEventItem, COMDAT
; _this$ = ecx

; 1288 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 24	 sub	 esp, 36			; 00000024H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	8b d9		 mov	 ebx, ecx

; 1289 : 	if ( this->m_bLoad == FALSE )

  0000a	33 f6		 xor	 esi, esi
  0000c	89 5d ec	 mov	 DWORD PTR _this$[ebp], ebx
  0000f	39 73 04	 cmp	 DWORD PTR [ebx+4], esi
  00012	75 0a		 jne	 SHORT $LN16@DropVermil

; 1290 : 		return FALSE;

  00014	5e		 pop	 esi
  00015	33 c0		 xor	 eax, eax
  00017	5b		 pop	 ebx

; 1406 : }

  00018	8b e5		 mov	 esp, ebp
  0001a	5d		 pop	 ebp
  0001b	c2 04 00	 ret	 4
$LN16@DropVermil:
  0001e	57		 push	 edi

; 1291 : 
; 1292 : 	float dur;
; 1293 : 	int type;
; 1294 : 	int level;
; 1295 : 	int x;
; 1296 : 	int y;
; 1297 : 	int Option1 = 0;
; 1298 : 	int Option2 = 0;
; 1299 : 	int Option3 = 0;
; 1300 : 	int DropItemRate;
; 1301 : 	int DropItemNum;
; 1302 : 	int ExOption = 0;
; 1303 : 	LPOBJ lpObj = &gObj[aIndex];

  0001f	8b 7d 08	 mov	 edi, DWORD PTR _aIndex$[ebp]
  00022	69 ff 50 2b 00
	00		 imul	 edi, 11088		; 00002b50H
  00028	03 3d 00 00 00
	00		 add	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0002e	89 75 f4	 mov	 DWORD PTR _Option1$[ebp], esi
  00031	89 75 f8	 mov	 DWORD PTR _Option2$[ebp], esi
  00034	89 75 fc	 mov	 DWORD PTR _Option3$[ebp], esi

; 1304 : 
; 1305 : 	if ( this->GetBagCount() > 0 )

  00037	39 b3 20 01 00
	00		 cmp	 DWORD PTR [ebx+288], esi
  0003d	0f 8e b0 02 00
	00		 jle	 $LN15@DropVermil

; 1306 : 	{
; 1307 : 		DropItemRate = rand() % 10000;

  00043	e8 00 00 00 00	 call	 _rand
  00048	99		 cdq
  00049	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  0004e	f7 f9		 idiv	 ecx

; 1308 : 
; 1309 : 		if ( DropItemRate < g_iVermilionCandyBoxDropZenRate )

  00050	3b 15 00 00 00
	00		 cmp	 edx, DWORD PTR ?g_iVermilionCandyBoxDropZenRate@@3HA ; g_iVermilionCandyBoxDropZenRate
  00056	7d 51		 jge	 SHORT $LN14@DropVermil

; 1310 : 		{
; 1311 : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iVermilionCandyBoxDropZen, 
; 1312 : 				lpObj->X, lpObj->Y);

  00058	0f bf 97 46 01
	00 00		 movsx	 edx, WORD PTR [edi+326]
  0005f	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]
  00066	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iVermilionCandyBoxDropZen@@3HA ; g_iVermilionCandyBoxDropZen
  0006c	52		 push	 edx
  0006d	50		 push	 eax
  0006e	51		 push	 ecx
  0006f	0f b6 8f 49 01
	00 00		 movzx	 ecx, BYTE PTR [edi+329]
  00076	69 c9 48 3d 05
	00		 imul	 ecx, 343368		; 00053d48H
  0007c	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  00082	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 1313 : 
; 1314 : 			LogAddTD("[EVENT WHITE DAY CANDY BOX] VERMILION BOX Event ItemDrop [%s][%s] [%d Zen]",
; 1315 : 				lpObj->AccountID, lpObj->Name,
; 1316 : 				g_iVermilionCandyBoxDropZen);

  00087	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?g_iVermilionCandyBoxDropZen@@3HA ; g_iVermilionCandyBoxDropZen
  0008d	52		 push	 edx
  0008e	8d 47 77	 lea	 eax, DWORD PTR [edi+119]
  00091	50		 push	 eax
  00092	8d 4f 6c	 lea	 ecx, DWORD PTR [edi+108]
  00095	51		 push	 ecx
  00096	68 00 00 00 00	 push	 OFFSET ??_C@_0EL@PEMOOOOC@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5VERM@
  0009b	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  000a1	83 c4 10	 add	 esp, 16			; 00000010H

; 1317 : 		}
; 1318 : 		else

  000a4	e9 05 02 00 00	 jmp	 $LN13@DropVermil
$LN14@DropVermil:

; 1319 : 		{
; 1320 : 			DropItemNum = rand() % this->GetBagCount();

  000a9	8b 93 20 01 00
	00		 mov	 edx, DWORD PTR [ebx+288]
  000af	89 55 08	 mov	 DWORD PTR $T211317[ebp], edx
  000b2	e8 00 00 00 00	 call	 _rand
  000b7	99		 cdq
  000b8	f7 7d 08	 idiv	 DWORD PTR $T211317[ebp]

; 1321 : 			dur = 0;
; 1322 : 			x = lpObj->X;
; 1323 : 			y = lpObj->Y;

  000bb	0f bf 8f 46 01
	00 00		 movsx	 ecx, WORD PTR [edi+326]
  000c2	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]
  000c9	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 1324 : 			level = this->GetLevel(DropItemNum);

  000cc	8b cb		 mov	 ecx, ebx
  000ce	89 45 e4	 mov	 DWORD PTR _x$[ebp], eax
  000d1	52		 push	 edx
  000d2	89 55 f0	 mov	 DWORD PTR _DropItemNum$[ebp], edx
  000d5	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel
  000da	0f b6 d0	 movzx	 edx, al

; 1325 : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  000dd	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  000e0	0f b6 8c c3 1e
	02 00 00	 movzx	 ecx, BYTE PTR [ebx+eax*8+542]
  000e8	89 55 08	 mov	 DWORD PTR _level$[ebp], edx
  000eb	0f b6 94 c3 1d
	02 00 00	 movzx	 edx, BYTE PTR [ebx+eax*8+541]
  000f3	51		 push	 ecx
  000f4	52		 push	 edx
  000f5	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  000fa	8b d8		 mov	 ebx, eax
  000fc	83 c4 08	 add	 esp, 8

; 1326 : 
; 1327 : 			if ( type == -1 )

  000ff	83 fb ff	 cmp	 ebx, -1
  00102	75 0b		 jne	 SHORT $LN12@DropVermil

; 1328 : 				return FALSE;

  00104	5f		 pop	 edi
  00105	5e		 pop	 esi
  00106	33 c0		 xor	 eax, eax
  00108	5b		 pop	 ebx

; 1406 : }

  00109	8b e5		 mov	 esp, ebp
  0010b	5d		 pop	 ebp
  0010c	c2 04 00	 ret	 4
$LN12@DropVermil:

; 1329 : 
; 1330 : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  0010f	8b 4d ec	 mov	 ecx, DWORD PTR _this$[ebp]
  00112	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00115	80 bc c1 21 02
	00 00 00	 cmp	 BYTE PTR [ecx+eax*8+545], 0
  0011d	74 07		 je	 SHORT $LN23@DropVermil

; 1331 : 				Option1 = 1;

  0011f	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN23@DropVermil:

; 1332 : 
; 1333 : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  00126	80 bc c1 22 02
	00 00 00	 cmp	 BYTE PTR [ecx+eax*8+546], 0
  0012e	74 1d		 je	 SHORT $LN24@DropVermil

; 1334 : 			{
; 1335 : 				Option2 = 0;

  00130	89 75 f8	 mov	 DWORD PTR _Option2$[ebp], esi

; 1336 : 
; 1337 : 				if ( (rand()%2) == 0 )

  00133	e8 00 00 00 00	 call	 _rand
  00138	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  0013d	79 05		 jns	 SHORT $LN29@DropVermil
  0013f	48		 dec	 eax
  00140	83 c8 fe	 or	 eax, -2			; fffffffeH
  00143	40		 inc	 eax
$LN29@DropVermil:
  00144	75 07		 jne	 SHORT $LN24@DropVermil

; 1338 : 				{
; 1339 : 					Option2 = 1;

  00146	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN24@DropVermil:

; 1340 : 				}
; 1341 : 			}
; 1342 : 
; 1343 : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  0014d	8b 45 ec	 mov	 eax, DWORD PTR _this$[ebp]
  00150	8b 4d f0	 mov	 ecx, DWORD PTR _DropItemNum$[ebp]
  00153	80 bc c8 23 02
	00 00 00	 cmp	 BYTE PTR [eax+ecx*8+547], 0
  0015b	74 2b		 je	 SHORT $LN26@DropVermil

; 1344 : 			{
; 1345 : 				if ( (rand()%5) < 1 )

  0015d	e8 00 00 00 00	 call	 _rand
  00162	99		 cdq
  00163	b9 05 00 00 00	 mov	 ecx, 5
  00168	f7 f9		 idiv	 ecx
  0016a	83 fa 01	 cmp	 edx, 1
  0016d	7d 09		 jge	 SHORT $LN7@DropVermil

; 1346 : 				{
; 1347 : 					Option3 = 3;

  0016f	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 1348 : 				}
; 1349 : 				else

  00176	eb 10		 jmp	 SHORT $LN26@DropVermil
$LN7@DropVermil:

; 1350 : 				{
; 1351 : 					Option3 = rand() % 3;

  00178	e8 00 00 00 00	 call	 _rand
  0017d	99		 cdq
  0017e	b9 03 00 00 00	 mov	 ecx, 3
  00183	f7 f9		 idiv	 ecx
  00185	89 55 fc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN26@DropVermil:

; 1352 : 				}
; 1353 : 			}
; 1354 : 
; 1355 : 			if ( this->BagObject[DropItemNum].m_isexitem )

  00188	8b 55 ec	 mov	 edx, DWORD PTR _this$[ebp]
  0018b	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  0018e	80 bc c2 24 02
	00 00 00	 cmp	 BYTE PTR [edx+eax*8+548], 0
  00196	74 1d		 je	 SHORT $LN27@DropVermil

; 1356 : 			{
; 1357 : 				ExOption = NewOptionRand(level);

  00198	8b 4d 08	 mov	 ecx, DWORD PTR _level$[ebp]
  0019b	51		 push	 ecx
  0019c	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  001a1	83 c4 04	 add	 esp, 4

; 1358 : #ifndef _FIX_
; 1359 : 				Option2 = 0;
; 1360 : #endif
; 1361 : 				Option1 = 1;
; 1362 : 				level = 0;

  001a4	33 c9		 xor	 ecx, ecx
  001a6	0f b6 f0	 movzx	 esi, al
  001a9	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
  001b0	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
  001b3	eb 02		 jmp	 SHORT $LN5@DropVermil
$LN27@DropVermil:
  001b5	33 c9		 xor	 ecx, ecx
$LN5@DropVermil:

; 1363 : 			}
; 1364 : 
; 1365 : 			if ( type == ITEMGET(12,15) ||
; 1366 : 				 type == ITEMGET(14,13) ||
; 1367 : 				 type == ITEMGET(14,14) ||
; 1368 : 				 type == ITEMGET(14,16) )

  001b7	81 fb 0f 18 00
	00		 cmp	 ebx, 6159		; 0000180fH
  001bd	74 18		 je	 SHORT $LN3@DropVermil
  001bf	81 fb 0d 1c 00
	00		 cmp	 ebx, 7181		; 00001c0dH
  001c5	74 10		 je	 SHORT $LN3@DropVermil
  001c7	81 fb 0e 1c 00
	00		 cmp	 ebx, 7182		; 00001c0eH
  001cd	74 08		 je	 SHORT $LN3@DropVermil
  001cf	81 fb 10 1c 00
	00		 cmp	 ebx, 7184		; 00001c10H
  001d5	75 0c		 jne	 SHORT $LN4@DropVermil
$LN3@DropVermil:

; 1369 : 			{
; 1370 : 				Option1 = 0;

  001d7	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx

; 1371 : 				Option2 = 0;

  001da	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx

; 1372 : 				Option3 = 0;

  001dd	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx

; 1373 : 				level = 0;

  001e0	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
$LN4@DropVermil:

; 1374 : 			}
; 1375 : 
; 1376 : 			if ( type == ITEMGET(14,19) ||
; 1377 : 				 type == ITEMGET(14,28) ||
; 1378 : 				 type == ITEMGET(13,18) )

  001e3	81 fb 13 1c 00
	00		 cmp	 ebx, 7187		; 00001c13H
  001e9	74 10		 je	 SHORT $LN1@DropVermil
  001eb	81 fb 1c 1c 00
	00		 cmp	 ebx, 7196		; 00001c1cH
  001f1	74 08		 je	 SHORT $LN1@DropVermil
  001f3	81 fb 12 1a 00
	00		 cmp	 ebx, 6674		; 00001a12H
  001f9	75 09		 jne	 SHORT $LN2@DropVermil
$LN1@DropVermil:

; 1379 : 			{
; 1380 : 				Option1 = 0;

  001fb	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx

; 1381 : 				Option2 = 0;

  001fe	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx

; 1382 : 				Option3 = 0;

  00201	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx
$LN2@DropVermil:

; 1383 : 			}
; 1384 : 			
; 1385 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 1386 : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  00204	8b 07		 mov	 eax, DWORD PTR [edi]
  00206	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  00209	51		 push	 ecx
  0020a	56		 push	 esi
  0020b	50		 push	 eax
  0020c	52		 push	 edx
  0020d	8b 55 f8	 mov	 edx, DWORD PTR _Option2$[ebp]
  00210	52		 push	 edx
  00211	8b 55 f4	 mov	 edx, DWORD PTR _Option1$[ebp]
  00214	52		 push	 edx
  00215	8b 55 e8	 mov	 edx, DWORD PTR _y$[ebp]
  00218	51		 push	 ecx
  00219	8b 4d 08	 mov	 ecx, DWORD PTR _level$[ebp]
  0021c	51		 push	 ecx
  0021d	8b 4d e4	 mov	 ecx, DWORD PTR _x$[ebp]
  00220	53		 push	 ebx
  00221	52		 push	 edx
  00222	0f b6 97 49 01
	00 00		 movzx	 edx, BYTE PTR [edi+329]
  00229	51		 push	 ecx
  0022a	52		 push	 edx
  0022b	50		 push	 eax
  0022c	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 1387 : 
; 1388 : 			LogAddTD("[EVENT WHITE DAY CANDY BOX] VERMILION BOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 1389 : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 1390 : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 1391 : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  00231	6a 00		 push	 0
  00233	8b c6		 mov	 eax, esi
  00235	83 e0 01	 and	 eax, 1
  00238	50		 push	 eax
  00239	8b ce		 mov	 ecx, esi
  0023b	d1 f9		 sar	 ecx, 1
  0023d	83 e1 01	 and	 ecx, 1
  00240	51		 push	 ecx
  00241	8b d6		 mov	 edx, esi
  00243	c1 fa 02	 sar	 edx, 2
  00246	83 e2 01	 and	 edx, 1
  00249	52		 push	 edx
  0024a	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  0024d	8b c6		 mov	 eax, esi
  0024f	c1 f8 03	 sar	 eax, 3
  00252	83 e0 01	 and	 eax, 1
  00255	50		 push	 eax
  00256	8b 45 f8	 mov	 eax, DWORD PTR _Option2$[ebp]
  00259	8b ce		 mov	 ecx, esi
  0025b	c1 f9 04	 sar	 ecx, 4
  0025e	83 e1 01	 and	 ecx, 1
  00261	51		 push	 ecx
  00262	8b 4d f4	 mov	 ecx, DWORD PTR _Option1$[ebp]
  00265	c1 fe 05	 sar	 esi, 5
  00268	83 e6 01	 and	 esi, 1
  0026b	56		 push	 esi
  0026c	52		 push	 edx
  0026d	8b 55 08	 mov	 edx, DWORD PTR _level$[ebp]
  00270	50		 push	 eax
  00271	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  00274	51		 push	 ecx
  00275	8b 4d e4	 mov	 ecx, DWORD PTR _x$[ebp]
  00278	52		 push	 edx
  00279	0f b6 97 49 01
	00 00		 movzx	 edx, BYTE PTR [edi+329]
  00280	53		 push	 ebx
  00281	6b db 70	 imul	 ebx, 112		; 00000070H
  00284	81 c3 00 00 00
	00		 add	 ebx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  0028a	53		 push	 ebx
  0028b	50		 push	 eax
  0028c	8b 45 ec	 mov	 eax, DWORD PTR _this$[ebp]
  0028f	51		 push	 ecx
  00290	52		 push	 edx
  00291	83 c0 08	 add	 eax, 8
  00294	50		 push	 eax
  00295	8d 4f 77	 lea	 ecx, DWORD PTR [edi+119]
  00298	51		 push	 ecx
  00299	8d 57 6c	 lea	 edx, DWORD PTR [edi+108]
  0029c	52		 push	 edx
  0029d	68 00 00 00 00	 push	 OFFSET ??_C@_0JJ@NBIHGBN@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5VERM@
  002a2	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  002a8	81 c4 84 00 00
	00		 add	 esp, 132		; 00000084H
$LN13@DropVermil:

; 1392 : 		}
; 1393 : 
; 1394 : 		PMSG_SERVERCMD ServerCmd;
; 1395 : 
; 1396 : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  002ae	6a 07		 push	 7
  002b0	6a 40		 push	 64			; 00000040H
  002b2	8d 45 dc	 lea	 eax, DWORD PTR _ServerCmd$210515[ebp]
  002b5	68 f3 00 00 00	 push	 243			; 000000f3H
  002ba	50		 push	 eax
  002bb	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB

; 1397 : 		ServerCmd.CmdType = 0;
; 1398 : 		ServerCmd.X = lpObj->X;

  002c0	8a 8f 44 01 00
	00		 mov	 cl, BYTE PTR [edi+324]

; 1399 : 		ServerCmd.Y = lpObj->Y;

  002c6	8a 97 46 01 00
	00		 mov	 dl, BYTE PTR [edi+326]

; 1400 : 
; 1401 : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  002cc	6a 07		 push	 7
  002ce	8d 45 dc	 lea	 eax, DWORD PTR _ServerCmd$210515[ebp]
  002d1	50		 push	 eax
  002d2	57		 push	 edi
  002d3	c6 45 e0 00	 mov	 BYTE PTR _ServerCmd$210515[ebp+4], 0
  002d7	88 4d e1	 mov	 BYTE PTR _ServerCmd$210515[ebp+5], cl
  002da	88 55 e2	 mov	 BYTE PTR _ServerCmd$210515[ebp+6], dl
  002dd	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2

; 1402 : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  002e2	8b 17		 mov	 edx, DWORD PTR [edi]
  002e4	6a 07		 push	 7
  002e6	8d 4d dc	 lea	 ecx, DWORD PTR _ServerCmd$210515[ebp]
  002e9	51		 push	 ecx
  002ea	52		 push	 edx
  002eb	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  002f0	83 c4 28	 add	 esp, 40			; 00000028H
$LN15@DropVermil:

; 1403 : 	}
; 1404 : 
; 1405 : 	return TRUE;

  002f3	5f		 pop	 edi
  002f4	5e		 pop	 esi
  002f5	b8 01 00 00 00	 mov	 eax, 1
  002fa	5b		 pop	 ebx

; 1406 : }

  002fb	8b e5		 mov	 esp, ebp
  002fd	5d		 pop	 ebp
  002fe	c2 04 00	 ret	 4
?DropVermilionCandyBoxEventItem@CItemBagZt@@QAEHH@Z ENDP ; CItemBagZt::DropVermilionCandyBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0JJ@HJCJJLKC@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5DEEP@ ; `string'
PUBLIC	??_C@_0EL@DLLMPLND@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5DEEP@ ; `string'
PUBLIC	?DropDeepBlueCandyBoxEventItem@CItemBagZt@@QAEHH@Z ; CItemBagZt::DropDeepBlueCandyBoxEventItem
EXTRN	?g_iDeepBlueCandyBoxDropZen@@3HA:DWORD		; g_iDeepBlueCandyBoxDropZen
EXTRN	?g_iDeepBlueCandyBoxDropZenRate@@3HA:DWORD	; g_iDeepBlueCandyBoxDropZenRate
;	COMDAT ??_C@_0JJ@HJCJJLKC@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5DEEP@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0JJ@HJCJJLKC@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5DEEP@ DB '[EVEN'
	DB	'T WHITE DAY CANDY BOX] DEEP BLUE BOX Event ItemDrop [%s][%s] '
	DB	'[%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d '
	DB	'Ex:[%d,%d,%d,%d,%d,%d,%d]', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0EL@DLLMPLND@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5DEEP@
CONST	SEGMENT
??_C@_0EL@DLLMPLND@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5DEEP@ DB '[EVEN'
	DB	'T WHITE DAY CANDY BOX] DEEP BLUE BOX Event ItemDrop [%s][%s] '
	DB	'[%d Zen]', 00H				; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropDeepBlueCandyBoxEventItem@CItemBagZt@@QAEHH@Z
_TEXT	SEGMENT
_ServerCmd$210562 = -36					; size = 7
_x$ = -28						; size = 4
_y$ = -24						; size = 4
_this$ = -20						; size = 4
_DropItemNum$ = -16					; size = 4
_Option1$ = -12						; size = 4
_Option2$ = -8						; size = 4
_Option3$ = -4						; size = 4
$T211334 = 8						; size = 4
_level$ = 8						; size = 4
_aIndex$ = 8						; size = 4
?DropDeepBlueCandyBoxEventItem@CItemBagZt@@QAEHH@Z PROC	; CItemBagZt::DropDeepBlueCandyBoxEventItem, COMDAT
; _this$ = ecx

; 1412 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 24	 sub	 esp, 36			; 00000024H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	8b d9		 mov	 ebx, ecx

; 1413 : 	if ( this->m_bLoad == FALSE )

  0000a	33 f6		 xor	 esi, esi
  0000c	89 5d ec	 mov	 DWORD PTR _this$[ebp], ebx
  0000f	39 73 04	 cmp	 DWORD PTR [ebx+4], esi
  00012	75 0a		 jne	 SHORT $LN16@DropDeepBl

; 1414 : 		return FALSE;

  00014	5e		 pop	 esi
  00015	33 c0		 xor	 eax, eax
  00017	5b		 pop	 ebx

; 1528 : }

  00018	8b e5		 mov	 esp, ebp
  0001a	5d		 pop	 ebp
  0001b	c2 04 00	 ret	 4
$LN16@DropDeepBl:
  0001e	57		 push	 edi

; 1415 : 
; 1416 : 	float dur;
; 1417 : 	int type;
; 1418 : 	int level;
; 1419 : 	int x;
; 1420 : 	int y;
; 1421 : 	int Option1 = 0;
; 1422 : 	int Option2 = 0;
; 1423 : 	int Option3 = 0;
; 1424 : 	int DropItemRate;
; 1425 : 	int DropItemNum;
; 1426 : 	int ExOption = 0;
; 1427 : 	LPOBJ lpObj = &gObj[aIndex];

  0001f	8b 7d 08	 mov	 edi, DWORD PTR _aIndex$[ebp]
  00022	69 ff 50 2b 00
	00		 imul	 edi, 11088		; 00002b50H
  00028	03 3d 00 00 00
	00		 add	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0002e	89 75 f4	 mov	 DWORD PTR _Option1$[ebp], esi
  00031	89 75 f8	 mov	 DWORD PTR _Option2$[ebp], esi
  00034	89 75 fc	 mov	 DWORD PTR _Option3$[ebp], esi

; 1428 : 
; 1429 : 	if ( this->GetBagCount() > 0 )

  00037	39 b3 20 01 00
	00		 cmp	 DWORD PTR [ebx+288], esi
  0003d	0f 8e aa 02 00
	00		 jle	 $LN15@DropDeepBl

; 1430 : 	{
; 1431 : 		DropItemRate = rand() % 10000;

  00043	e8 00 00 00 00	 call	 _rand
  00048	99		 cdq
  00049	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  0004e	f7 f9		 idiv	 ecx

; 1432 : 
; 1433 : 		if ( DropItemRate < g_iDeepBlueCandyBoxDropZenRate )

  00050	3b 15 00 00 00
	00		 cmp	 edx, DWORD PTR ?g_iDeepBlueCandyBoxDropZenRate@@3HA ; g_iDeepBlueCandyBoxDropZenRate
  00056	7d 51		 jge	 SHORT $LN14@DropDeepBl

; 1434 : 		{
; 1435 : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iDeepBlueCandyBoxDropZen, 
; 1436 : 				lpObj->X, lpObj->Y);

  00058	0f bf 97 46 01
	00 00		 movsx	 edx, WORD PTR [edi+326]
  0005f	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]
  00066	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iDeepBlueCandyBoxDropZen@@3HA ; g_iDeepBlueCandyBoxDropZen
  0006c	52		 push	 edx
  0006d	50		 push	 eax
  0006e	51		 push	 ecx
  0006f	0f b6 8f 49 01
	00 00		 movzx	 ecx, BYTE PTR [edi+329]
  00076	69 c9 48 3d 05
	00		 imul	 ecx, 343368		; 00053d48H
  0007c	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  00082	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 1437 : 
; 1438 : 			LogAddTD("[EVENT WHITE DAY CANDY BOX] DEEP BLUE BOX Event ItemDrop [%s][%s] [%d Zen]",
; 1439 : 				lpObj->AccountID, lpObj->Name,
; 1440 : 				g_iDeepBlueCandyBoxDropZen);

  00087	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?g_iDeepBlueCandyBoxDropZen@@3HA ; g_iDeepBlueCandyBoxDropZen
  0008d	52		 push	 edx
  0008e	8d 47 77	 lea	 eax, DWORD PTR [edi+119]
  00091	50		 push	 eax
  00092	8d 4f 6c	 lea	 ecx, DWORD PTR [edi+108]
  00095	51		 push	 ecx
  00096	68 00 00 00 00	 push	 OFFSET ??_C@_0EL@DLLMPLND@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5DEEP@
  0009b	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  000a1	83 c4 10	 add	 esp, 16			; 00000010H

; 1441 : 		}
; 1442 : 		else

  000a4	e9 ff 01 00 00	 jmp	 $LN13@DropDeepBl
$LN14@DropDeepBl:

; 1443 : 		{
; 1444 : 			DropItemNum = rand() % this->GetBagCount();

  000a9	8b 93 20 01 00
	00		 mov	 edx, DWORD PTR [ebx+288]
  000af	89 55 08	 mov	 DWORD PTR $T211334[ebp], edx
  000b2	e8 00 00 00 00	 call	 _rand
  000b7	99		 cdq
  000b8	f7 7d 08	 idiv	 DWORD PTR $T211334[ebp]

; 1445 : 			dur = 0;
; 1446 : 			x = lpObj->X;
; 1447 : 			y = lpObj->Y;

  000bb	0f bf 8f 46 01
	00 00		 movsx	 ecx, WORD PTR [edi+326]
  000c2	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]
  000c9	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 1448 : 			level = this->GetLevel(DropItemNum);

  000cc	8b cb		 mov	 ecx, ebx
  000ce	89 45 e4	 mov	 DWORD PTR _x$[ebp], eax
  000d1	52		 push	 edx
  000d2	89 55 f0	 mov	 DWORD PTR _DropItemNum$[ebp], edx
  000d5	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel
  000da	0f b6 d0	 movzx	 edx, al

; 1449 : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  000dd	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  000e0	0f b6 8c c3 1e
	02 00 00	 movzx	 ecx, BYTE PTR [ebx+eax*8+542]
  000e8	89 55 08	 mov	 DWORD PTR _level$[ebp], edx
  000eb	0f b6 94 c3 1d
	02 00 00	 movzx	 edx, BYTE PTR [ebx+eax*8+541]
  000f3	51		 push	 ecx
  000f4	52		 push	 edx
  000f5	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  000fa	8b d8		 mov	 ebx, eax
  000fc	83 c4 08	 add	 esp, 8

; 1450 : 
; 1451 : 			if ( type == -1 )

  000ff	83 fb ff	 cmp	 ebx, -1
  00102	75 0b		 jne	 SHORT $LN12@DropDeepBl

; 1452 : 				return FALSE;

  00104	5f		 pop	 edi
  00105	5e		 pop	 esi
  00106	33 c0		 xor	 eax, eax
  00108	5b		 pop	 ebx

; 1528 : }

  00109	8b e5		 mov	 esp, ebp
  0010b	5d		 pop	 ebp
  0010c	c2 04 00	 ret	 4
$LN12@DropDeepBl:

; 1453 : 
; 1454 : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  0010f	8b 4d ec	 mov	 ecx, DWORD PTR _this$[ebp]
  00112	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00115	80 bc c1 21 02
	00 00 00	 cmp	 BYTE PTR [ecx+eax*8+545], 0
  0011d	74 07		 je	 SHORT $LN23@DropDeepBl

; 1455 : 				Option1 = 1;

  0011f	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN23@DropDeepBl:

; 1456 : 
; 1457 : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  00126	80 bc c1 22 02
	00 00 00	 cmp	 BYTE PTR [ecx+eax*8+546], 0
  0012e	74 1d		 je	 SHORT $LN24@DropDeepBl

; 1458 : 			{
; 1459 : 				Option2 = 0;

  00130	89 75 f8	 mov	 DWORD PTR _Option2$[ebp], esi

; 1460 : 
; 1461 : 				if ( (rand()%2) == 0 )

  00133	e8 00 00 00 00	 call	 _rand
  00138	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  0013d	79 05		 jns	 SHORT $LN29@DropDeepBl
  0013f	48		 dec	 eax
  00140	83 c8 fe	 or	 eax, -2			; fffffffeH
  00143	40		 inc	 eax
$LN29@DropDeepBl:
  00144	75 07		 jne	 SHORT $LN24@DropDeepBl

; 1462 : 				{
; 1463 : 					Option2 = 1;

  00146	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN24@DropDeepBl:

; 1464 : 				}
; 1465 : 			}
; 1466 : 
; 1467 : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  0014d	8b 45 ec	 mov	 eax, DWORD PTR _this$[ebp]
  00150	8b 4d f0	 mov	 ecx, DWORD PTR _DropItemNum$[ebp]
  00153	80 bc c8 23 02
	00 00 00	 cmp	 BYTE PTR [eax+ecx*8+547], 0
  0015b	74 2b		 je	 SHORT $LN26@DropDeepBl

; 1468 : 			{
; 1469 : 				if ( (rand()%5) < 1 )

  0015d	e8 00 00 00 00	 call	 _rand
  00162	99		 cdq
  00163	b9 05 00 00 00	 mov	 ecx, 5
  00168	f7 f9		 idiv	 ecx
  0016a	83 fa 01	 cmp	 edx, 1
  0016d	7d 09		 jge	 SHORT $LN7@DropDeepBl

; 1470 : 				{
; 1471 : 					Option3 = 3;

  0016f	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 1472 : 				}
; 1473 : 				else

  00176	eb 10		 jmp	 SHORT $LN26@DropDeepBl
$LN7@DropDeepBl:

; 1474 : 				{
; 1475 : 					Option3 = rand() % 3;

  00178	e8 00 00 00 00	 call	 _rand
  0017d	99		 cdq
  0017e	b9 03 00 00 00	 mov	 ecx, 3
  00183	f7 f9		 idiv	 ecx
  00185	89 55 fc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN26@DropDeepBl:

; 1476 : 				}
; 1477 : 			}
; 1478 : 
; 1479 : 			if ( this->BagObject[DropItemNum].m_isexitem )

  00188	8b 55 ec	 mov	 edx, DWORD PTR _this$[ebp]
  0018b	8b 45 f0	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  0018e	80 bc c2 24 02
	00 00 00	 cmp	 BYTE PTR [edx+eax*8+548], 0
  00196	74 1d		 je	 SHORT $LN27@DropDeepBl

; 1480 : 			{
; 1481 : 				ExOption = NewOptionRand(level);

  00198	8b 4d 08	 mov	 ecx, DWORD PTR _level$[ebp]
  0019b	51		 push	 ecx
  0019c	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  001a1	83 c4 04	 add	 esp, 4

; 1482 : #ifndef _FIX_
; 1483 : 				Option2 = 0;
; 1484 : #endif
; 1485 : 				Option1 = 1;
; 1486 : 				level = 0;

  001a4	33 c9		 xor	 ecx, ecx
  001a6	0f b6 f0	 movzx	 esi, al
  001a9	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
  001b0	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
  001b3	eb 02		 jmp	 SHORT $LN5@DropDeepBl
$LN27@DropDeepBl:
  001b5	33 c9		 xor	 ecx, ecx
$LN5@DropDeepBl:

; 1487 : 			}
; 1488 : 
; 1489 : 			if ( type == ITEMGET(12,15) ||
; 1490 : 				 type == ITEMGET(14,13) ||
; 1491 : 				 type == ITEMGET(14,14)  )

  001b7	81 fb 0f 18 00
	00		 cmp	 ebx, 6159		; 0000180fH
  001bd	74 10		 je	 SHORT $LN3@DropDeepBl
  001bf	81 fb 0d 1c 00
	00		 cmp	 ebx, 7181		; 00001c0dH
  001c5	74 08		 je	 SHORT $LN3@DropDeepBl
  001c7	81 fb 0e 1c 00
	00		 cmp	 ebx, 7182		; 00001c0eH
  001cd	75 0c		 jne	 SHORT $LN4@DropDeepBl
$LN3@DropDeepBl:

; 1492 : 			{
; 1493 : 				Option1 = 0;

  001cf	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx

; 1494 : 				Option2 = 0;

  001d2	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx

; 1495 : 				Option3 = 0;

  001d5	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx

; 1496 : 				level = 0;

  001d8	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
$LN4@DropDeepBl:

; 1497 : 			}
; 1498 : 
; 1499 : 			if ( type == ITEMGET(13,8) ||
; 1500 : 				 type == ITEMGET(13,9) ||
; 1501 : 				 type == ITEMGET(13,12) ||
; 1502 : 				 type == ITEMGET(13,21) )

  001db	81 fb 08 1a 00
	00		 cmp	 ebx, 6664		; 00001a08H
  001e1	74 18		 je	 SHORT $LN1@DropDeepBl
  001e3	81 fb 09 1a 00
	00		 cmp	 ebx, 6665		; 00001a09H
  001e9	74 10		 je	 SHORT $LN1@DropDeepBl
  001eb	81 fb 0c 1a 00
	00		 cmp	 ebx, 6668		; 00001a0cH
  001f1	74 08		 je	 SHORT $LN1@DropDeepBl
  001f3	81 fb 15 1a 00
	00		 cmp	 ebx, 6677		; 00001a15H
  001f9	75 03		 jne	 SHORT $LN2@DropDeepBl
$LN1@DropDeepBl:

; 1503 : 			{
; 1504 : 				level = 0;

  001fb	89 4d 08	 mov	 DWORD PTR _level$[ebp], ecx
$LN2@DropDeepBl:

; 1505 : 			}
; 1506 : 			
; 1507 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 1508 : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  001fe	8b 07		 mov	 eax, DWORD PTR [edi]
  00200	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  00203	51		 push	 ecx
  00204	56		 push	 esi
  00205	50		 push	 eax
  00206	52		 push	 edx
  00207	8b 55 f8	 mov	 edx, DWORD PTR _Option2$[ebp]
  0020a	52		 push	 edx
  0020b	8b 55 f4	 mov	 edx, DWORD PTR _Option1$[ebp]
  0020e	52		 push	 edx
  0020f	8b 55 e8	 mov	 edx, DWORD PTR _y$[ebp]
  00212	51		 push	 ecx
  00213	8b 4d 08	 mov	 ecx, DWORD PTR _level$[ebp]
  00216	51		 push	 ecx
  00217	8b 4d e4	 mov	 ecx, DWORD PTR _x$[ebp]
  0021a	53		 push	 ebx
  0021b	52		 push	 edx
  0021c	0f b6 97 49 01
	00 00		 movzx	 edx, BYTE PTR [edi+329]
  00223	51		 push	 ecx
  00224	52		 push	 edx
  00225	50		 push	 eax
  00226	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 1509 : 
; 1510 : 			LogAddTD("[EVENT WHITE DAY CANDY BOX] DEEP BLUE BOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 1511 : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 1512 : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 1513 : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  0022b	6a 00		 push	 0
  0022d	8b c6		 mov	 eax, esi
  0022f	83 e0 01	 and	 eax, 1
  00232	50		 push	 eax
  00233	8b ce		 mov	 ecx, esi
  00235	d1 f9		 sar	 ecx, 1
  00237	83 e1 01	 and	 ecx, 1
  0023a	51		 push	 ecx
  0023b	8b d6		 mov	 edx, esi
  0023d	c1 fa 02	 sar	 edx, 2
  00240	83 e2 01	 and	 edx, 1
  00243	52		 push	 edx
  00244	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  00247	8b c6		 mov	 eax, esi
  00249	c1 f8 03	 sar	 eax, 3
  0024c	83 e0 01	 and	 eax, 1
  0024f	50		 push	 eax
  00250	8b 45 f8	 mov	 eax, DWORD PTR _Option2$[ebp]
  00253	8b ce		 mov	 ecx, esi
  00255	c1 f9 04	 sar	 ecx, 4
  00258	83 e1 01	 and	 ecx, 1
  0025b	51		 push	 ecx
  0025c	8b 4d f4	 mov	 ecx, DWORD PTR _Option1$[ebp]
  0025f	c1 fe 05	 sar	 esi, 5
  00262	83 e6 01	 and	 esi, 1
  00265	56		 push	 esi
  00266	52		 push	 edx
  00267	8b 55 08	 mov	 edx, DWORD PTR _level$[ebp]
  0026a	50		 push	 eax
  0026b	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  0026e	51		 push	 ecx
  0026f	8b 4d e4	 mov	 ecx, DWORD PTR _x$[ebp]
  00272	52		 push	 edx
  00273	0f b6 97 49 01
	00 00		 movzx	 edx, BYTE PTR [edi+329]
  0027a	53		 push	 ebx
  0027b	6b db 70	 imul	 ebx, 112		; 00000070H
  0027e	81 c3 00 00 00
	00		 add	 ebx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  00284	53		 push	 ebx
  00285	50		 push	 eax
  00286	8b 45 ec	 mov	 eax, DWORD PTR _this$[ebp]
  00289	51		 push	 ecx
  0028a	52		 push	 edx
  0028b	83 c0 08	 add	 eax, 8
  0028e	50		 push	 eax
  0028f	8d 4f 77	 lea	 ecx, DWORD PTR [edi+119]
  00292	51		 push	 ecx
  00293	8d 57 6c	 lea	 edx, DWORD PTR [edi+108]
  00296	52		 push	 edx
  00297	68 00 00 00 00	 push	 OFFSET ??_C@_0JJ@HJCJJLKC@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5DEEP@
  0029c	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  002a2	81 c4 84 00 00
	00		 add	 esp, 132		; 00000084H
$LN13@DropDeepBl:

; 1514 : 		}
; 1515 : 
; 1516 : 		PMSG_SERVERCMD ServerCmd;
; 1517 : 
; 1518 : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  002a8	6a 07		 push	 7
  002aa	6a 40		 push	 64			; 00000040H
  002ac	8d 45 dc	 lea	 eax, DWORD PTR _ServerCmd$210562[ebp]
  002af	68 f3 00 00 00	 push	 243			; 000000f3H
  002b4	50		 push	 eax
  002b5	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB

; 1519 : 		ServerCmd.CmdType = 0;
; 1520 : 		ServerCmd.X = lpObj->X;

  002ba	8a 8f 44 01 00
	00		 mov	 cl, BYTE PTR [edi+324]

; 1521 : 		ServerCmd.Y = lpObj->Y;

  002c0	8a 97 46 01 00
	00		 mov	 dl, BYTE PTR [edi+326]

; 1522 : 
; 1523 : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  002c6	6a 07		 push	 7
  002c8	8d 45 dc	 lea	 eax, DWORD PTR _ServerCmd$210562[ebp]
  002cb	50		 push	 eax
  002cc	57		 push	 edi
  002cd	c6 45 e0 00	 mov	 BYTE PTR _ServerCmd$210562[ebp+4], 0
  002d1	88 4d e1	 mov	 BYTE PTR _ServerCmd$210562[ebp+5], cl
  002d4	88 55 e2	 mov	 BYTE PTR _ServerCmd$210562[ebp+6], dl
  002d7	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2

; 1524 : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  002dc	8b 17		 mov	 edx, DWORD PTR [edi]
  002de	6a 07		 push	 7
  002e0	8d 4d dc	 lea	 ecx, DWORD PTR _ServerCmd$210562[ebp]
  002e3	51		 push	 ecx
  002e4	52		 push	 edx
  002e5	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  002ea	83 c4 28	 add	 esp, 40			; 00000028H
$LN15@DropDeepBl:

; 1525 : 	}
; 1526 : 
; 1527 : 	return TRUE;

  002ed	5f		 pop	 edi
  002ee	5e		 pop	 esi
  002ef	b8 01 00 00 00	 mov	 eax, 1
  002f4	5b		 pop	 ebx

; 1528 : }

  002f5	8b e5		 mov	 esp, ebp
  002f7	5d		 pop	 ebp
  002f8	c2 04 00	 ret	 4
?DropDeepBlueCandyBoxEventItem@CItemBagZt@@QAEHH@Z ENDP	; CItemBagZt::DropDeepBlueCandyBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0HI@MKOHGFOD@?$FLHallowinDay?5Event?$FN?$FLPumpkin?5of?5L@ ; `string'
PUBLIC	?DropHallowinEventItem@CItemBagZt@@QAEHPAUOBJECTSTRUCT@@@Z ; CItemBagZt::DropHallowinEventItem
EXTRN	?g_iHallowinDayEventJOLBlessDropRate@@3HA:DWORD	; g_iHallowinDayEventJOLBlessDropRate
EXTRN	?g_iHallowinDayEventJOLAngerDropRaTe@@3HA:DWORD	; g_iHallowinDayEventJOLAngerDropRaTe
EXTRN	?g_iHallowinDayEventJOLScreamDropRate@@3HA:DWORD ; g_iHallowinDayEventJOLScreamDropRate
EXTRN	?g_iHallowinDayEventJOLFoodDropRate@@3HA:DWORD	; g_iHallowinDayEventJOLFoodDropRate
EXTRN	?g_iHallowinDayEventJOLDrinkDropRate@@3HA:DWORD	; g_iHallowinDayEventJOLDrinkDropRate
EXTRN	?g_iHallowinDayEventJOLPolymorphRingDropRate@@3HA:DWORD ; g_iHallowinDayEventJOLPolymorphRingDropRate
;	COMDAT ??_C@_0HI@MKOHGFOD@?$FLHallowinDay?5Event?$FN?$FLPumpkin?5of?5L@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0HI@MKOHGFOD@?$FLHallowinDay?5Event?$FN?$FLPumpkin?5of?5L@ DB '[Hal'
	DB	'lowinDay Event][Pumpkin of Luck] Event Item Drop [%s][%s] : ('
	DB	'%d)(%d/%d) Item Attribute : %s(%d) Level : %d Dur : %d', 00H ; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropHallowinEventItem@CItemBagZt@@QAEHPAUOBJECTSTRUCT@@@Z
_TEXT	SEGMENT
_X$ = -12						; size = 4
_iDropItemNum$ = -12					; size = 4
_this$ = -8						; size = 4
_iDuration$ = -4					; size = 4
_Y$ = 8							; size = 4
_lpObj$ = 8						; size = 4
?DropHallowinEventItem@CItemBagZt@@QAEHPAUOBJECTSTRUCT@@@Z PROC ; CItemBagZt::DropHallowinEventItem, COMDAT
; _this$ = ecx

; 1531 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 0c	 sub	 esp, 12			; 0000000cH
  00006	57		 push	 edi

; 1532 : 	if ( this->m_bLoad == FALSE )

  00007	33 ff		 xor	 edi, edi
  00009	89 4d f8	 mov	 DWORD PTR _this$[ebp], ecx
  0000c	39 79 04	 cmp	 DWORD PTR [ecx+4], edi
  0000f	75 09		 jne	 SHORT $LN15@DropHallow

; 1533 : 		return FALSE;

  00011	33 c0		 xor	 eax, eax
  00013	5f		 pop	 edi

; 1591 : }

  00014	8b e5		 mov	 esp, ebp
  00016	5d		 pop	 ebp
  00017	c2 04 00	 ret	 4
$LN15@DropHallow:
  0001a	53		 push	 ebx
  0001b	56		 push	 esi

; 1534 : 
; 1535 : 	int iType;
; 1536 : 	int iLevel;
; 1537 : 	int X;
; 1538 : 	int Y;
; 1539 : 	int iDropItemNum = 0;

  0001c	89 7d f4	 mov	 DWORD PTR _iDropItemNum$[ebp], edi

; 1540 : 	int iDropItemRate;
; 1541 : 	int iDuration = 0;

  0001f	89 7d fc	 mov	 DWORD PTR _iDuration$[ebp], edi

; 1542 : 	int iTotalDropRate = 0;
; 1543 : 	int iItemBagCount = this->GetBagCount();
; 1544 : 
; 1545 : 	if ( iItemBagCount > 0 )

  00022	39 b9 20 01 00
	00		 cmp	 DWORD PTR [ecx+288], edi
  00028	0f 8e 96 01 00
	00		 jle	 $LN14@DropHallow

; 1546 : 	{
; 1547 : 		iTotalDropRate = g_iHallowinDayEventJOLBlessDropRate +
; 1548 : 			             g_iHallowinDayEventJOLAngerDropRaTe +
; 1549 : 						 g_iHallowinDayEventJOLScreamDropRate +
; 1550 : 						 g_iHallowinDayEventJOLFoodDropRate +
; 1551 : 						 g_iHallowinDayEventJOLDrinkDropRate +
; 1552 : 						 g_iHallowinDayEventJOLPolymorphRingDropRate;

  0002e	8b 35 00 00 00
	00		 mov	 esi, DWORD PTR ?g_iHallowinDayEventJOLPolymorphRingDropRate@@3HA ; g_iHallowinDayEventJOLPolymorphRingDropRate
  00034	03 35 00 00 00
	00		 add	 esi, DWORD PTR ?g_iHallowinDayEventJOLDrinkDropRate@@3HA ; g_iHallowinDayEventJOLDrinkDropRate
  0003a	03 35 00 00 00
	00		 add	 esi, DWORD PTR ?g_iHallowinDayEventJOLFoodDropRate@@3HA ; g_iHallowinDayEventJOLFoodDropRate
  00040	03 35 00 00 00
	00		 add	 esi, DWORD PTR ?g_iHallowinDayEventJOLScreamDropRate@@3HA ; g_iHallowinDayEventJOLScreamDropRate
  00046	03 35 00 00 00
	00		 add	 esi, DWORD PTR ?g_iHallowinDayEventJOLAngerDropRaTe@@3HA ; g_iHallowinDayEventJOLAngerDropRaTe
  0004c	03 35 00 00 00
	00		 add	 esi, DWORD PTR ?g_iHallowinDayEventJOLBlessDropRate@@3HA ; g_iHallowinDayEventJOLBlessDropRate

; 1553 : 
; 1554 : 		iDropItemRate = rand() % iTotalDropRate;

  00052	e8 00 00 00 00	 call	 _rand
  00057	99		 cdq
  00058	f7 fe		 idiv	 esi

; 1555 : 
; 1556 : 		if ( iDropItemRate >= (iTotalDropRate - g_iHallowinDayEventJOLBlessDropRate)  )

  0005a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iHallowinDayEventJOLBlessDropRate@@3HA ; g_iHallowinDayEventJOLBlessDropRate
  0005f	8b ce		 mov	 ecx, esi
  00061	2b c8		 sub	 ecx, eax
  00063	3b d1		 cmp	 edx, ecx
  00065	7c 07		 jl	 SHORT $LN13@DropHallow

; 1557 : 			iDropItemNum = 0;

  00067	33 f6		 xor	 esi, esi
  00069	e9 94 00 00 00	 jmp	 $LN3@DropHallow
$LN13@DropHallow:

; 1558 : 		else if ( iDropItemRate >= (iTotalDropRate - g_iHallowinDayEventJOLBlessDropRate - g_iHallowinDayEventJOLAngerDropRaTe) )

  0006e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iHallowinDayEventJOLAngerDropRaTe@@3HA ; g_iHallowinDayEventJOLAngerDropRaTe
  00074	8b fe		 mov	 edi, esi
  00076	2b f9		 sub	 edi, ecx
  00078	2b f8		 sub	 edi, eax
  0007a	3b d7		 cmp	 edx, edi
  0007c	7c 07		 jl	 SHORT $LN11@DropHallow

; 1559 : 			iDropItemNum = 1;

  0007e	be 01 00 00 00	 mov	 esi, 1
  00083	eb 7d		 jmp	 SHORT $LN3@DropHallow
$LN11@DropHallow:

; 1560 : 		else if ( iDropItemRate >= (iTotalDropRate - g_iHallowinDayEventJOLBlessDropRate - g_iHallowinDayEventJOLAngerDropRaTe - g_iHallowinDayEventJOLScreamDropRate) )

  00085	8b fe		 mov	 edi, esi
  00087	2b 3d 00 00 00
	00		 sub	 edi, DWORD PTR ?g_iHallowinDayEventJOLScreamDropRate@@3HA ; g_iHallowinDayEventJOLScreamDropRate
  0008d	2b f9		 sub	 edi, ecx
  0008f	2b f8		 sub	 edi, eax
  00091	3b d7		 cmp	 edx, edi
  00093	7c 07		 jl	 SHORT $LN9@DropHallow

; 1561 : 			iDropItemNum = 2;

  00095	be 02 00 00 00	 mov	 esi, 2
  0009a	eb 66		 jmp	 SHORT $LN3@DropHallow
$LN9@DropHallow:

; 1562 : 		else if ( iDropItemRate >= (iTotalDropRate - g_iHallowinDayEventJOLBlessDropRate - g_iHallowinDayEventJOLAngerDropRaTe - g_iHallowinDayEventJOLScreamDropRate - g_iHallowinDayEventJOLFoodDropRate) )

  0009c	8b fe		 mov	 edi, esi
  0009e	2b 3d 00 00 00
	00		 sub	 edi, DWORD PTR ?g_iHallowinDayEventJOLFoodDropRate@@3HA ; g_iHallowinDayEventJOLFoodDropRate
  000a4	2b 3d 00 00 00
	00		 sub	 edi, DWORD PTR ?g_iHallowinDayEventJOLScreamDropRate@@3HA ; g_iHallowinDayEventJOLScreamDropRate
  000aa	2b f9		 sub	 edi, ecx
  000ac	2b f8		 sub	 edi, eax
  000ae	3b d7		 cmp	 edx, edi
  000b0	7c 07		 jl	 SHORT $LN7@DropHallow

; 1563 : 			iDropItemNum = 3;

  000b2	be 03 00 00 00	 mov	 esi, 3
  000b7	eb 49		 jmp	 SHORT $LN3@DropHallow
$LN7@DropHallow:

; 1564 : 		else if ( iDropItemRate >= (iTotalDropRate - g_iHallowinDayEventJOLBlessDropRate - g_iHallowinDayEventJOLAngerDropRaTe - g_iHallowinDayEventJOLScreamDropRate - g_iHallowinDayEventJOLFoodDropRate - g_iHallowinDayEventJOLDrinkDropRate) )

  000b9	8b 3d 00 00 00
	00		 mov	 edi, DWORD PTR ?g_iHallowinDayEventJOLScreamDropRate@@3HA ; g_iHallowinDayEventJOLScreamDropRate
  000bf	8b de		 mov	 ebx, esi
  000c1	2b 1d 00 00 00
	00		 sub	 ebx, DWORD PTR ?g_iHallowinDayEventJOLDrinkDropRate@@3HA ; g_iHallowinDayEventJOLDrinkDropRate
  000c7	2b 1d 00 00 00
	00		 sub	 ebx, DWORD PTR ?g_iHallowinDayEventJOLFoodDropRate@@3HA ; g_iHallowinDayEventJOLFoodDropRate
  000cd	2b df		 sub	 ebx, edi
  000cf	2b d9		 sub	 ebx, ecx
  000d1	2b d8		 sub	 ebx, eax
  000d3	3b d3		 cmp	 edx, ebx
  000d5	7c 07		 jl	 SHORT $LN5@DropHallow

; 1565 : 			iDropItemNum = 4;

  000d7	be 04 00 00 00	 mov	 esi, 4
  000dc	eb 24		 jmp	 SHORT $LN3@DropHallow
$LN5@DropHallow:

; 1566 : 		else if ( iDropItemRate >= (iTotalDropRate - g_iHallowinDayEventJOLBlessDropRate - g_iHallowinDayEventJOLAngerDropRaTe - g_iHallowinDayEventJOLScreamDropRate - g_iHallowinDayEventJOLFoodDropRate - g_iHallowinDayEventJOLDrinkDropRate - g_iHallowinDayEventJOLPolymorphRingDropRate) )

  000de	2b 35 00 00 00
	00		 sub	 esi, DWORD PTR ?g_iHallowinDayEventJOLPolymorphRingDropRate@@3HA ; g_iHallowinDayEventJOLPolymorphRingDropRate
  000e4	2b 35 00 00 00
	00		 sub	 esi, DWORD PTR ?g_iHallowinDayEventJOLDrinkDropRate@@3HA ; g_iHallowinDayEventJOLDrinkDropRate
  000ea	2b 35 00 00 00
	00		 sub	 esi, DWORD PTR ?g_iHallowinDayEventJOLFoodDropRate@@3HA ; g_iHallowinDayEventJOLFoodDropRate
  000f0	2b f7		 sub	 esi, edi
  000f2	2b f1		 sub	 esi, ecx
  000f4	2b f0		 sub	 esi, eax
  000f6	3b d6		 cmp	 edx, esi

; 1567 : 			iDropItemNum = 5;

  000f8	be 05 00 00 00	 mov	 esi, 5
  000fd	7d 03		 jge	 SHORT $LN3@DropHallow
  000ff	8b 75 f4	 mov	 esi, DWORD PTR _iDropItemNum$[ebp]
$LN3@DropHallow:

; 1568 : 
; 1569 : 		X = lpObj->X;

  00102	8b 7d 08	 mov	 edi, DWORD PTR _lpObj$[ebp]
  00105	0f bf 97 44 01
	00 00		 movsx	 edx, WORD PTR [edi+324]

; 1570 : 		Y = lpObj->Y;

  0010c	0f bf 87 46 01
	00 00		 movsx	 eax, WORD PTR [edi+326]

; 1571 : 		iLevel = this->GetLevel(iDropItemNum);

  00113	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  00116	56		 push	 esi
  00117	89 55 f4	 mov	 DWORD PTR _X$[ebp], edx
  0011a	89 45 08	 mov	 DWORD PTR _Y$[ebp], eax
  0011d	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel
  00122	0f b6 d8	 movzx	 ebx, al

; 1572 : 		iType = ItemGetNumberMake(this->BagObject[iDropItemNum].m_type, this->BagObject[iDropItemNum].m_index);

  00125	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00128	0f b6 8c f0 1e
	02 00 00	 movzx	 ecx, BYTE PTR [eax+esi*8+542]
  00130	0f b6 94 f0 1d
	02 00 00	 movzx	 edx, BYTE PTR [eax+esi*8+541]
  00138	51		 push	 ecx
  00139	52		 push	 edx
  0013a	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  0013f	8b f0		 mov	 esi, eax
  00141	83 c4 08	 add	 esp, 8

; 1573 : 
; 1574 : 		if ( iType == -1 )

  00144	83 fe ff	 cmp	 esi, -1
  00147	75 0b		 jne	 SHORT $LN2@DropHallow

; 1575 : 			return FALSE;

  00149	5e		 pop	 esi
  0014a	5b		 pop	 ebx
  0014b	33 c0		 xor	 eax, eax
  0014d	5f		 pop	 edi

; 1591 : }

  0014e	8b e5		 mov	 esp, ebp
  00150	5d		 pop	 ebp
  00151	c2 04 00	 ret	 4
$LN2@DropHallow:

; 1576 : 
; 1577 : 		if ( iType == ITEMGET(13,40) )

  00154	81 fe 28 1a 00
	00		 cmp	 esi, 6696		; 00001a28H
  0015a	75 09		 jne	 SHORT $LN21@DropHallow

; 1578 : 		{
; 1579 : 			iLevel = 0;

  0015c	33 db		 xor	 ebx, ebx

; 1580 : 			iDuration = 100;

  0015e	c7 45 fc 64 00
	00 00		 mov	 DWORD PTR _iDuration$[ebp], 100 ; 00000064H
$LN21@DropHallow:

; 1581 : 		}
; 1582 : 
; 1583 : 		ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)X, (BYTE)Y,
; 1584 : 			iType, (BYTE)iLevel, (BYTE)iDuration, 0, 0, 0, lpObj->m_Index, 0, 0);

  00165	8b 07		 mov	 eax, DWORD PTR [edi]
  00167	8b 4d fc	 mov	 ecx, DWORD PTR _iDuration$[ebp]
  0016a	8b 55 08	 mov	 edx, DWORD PTR _Y$[ebp]
  0016d	6a 00		 push	 0
  0016f	6a 00		 push	 0
  00171	50		 push	 eax
  00172	6a 00		 push	 0
  00174	6a 00		 push	 0
  00176	6a 00		 push	 0
  00178	51		 push	 ecx
  00179	8b 4d f4	 mov	 ecx, DWORD PTR _X$[ebp]
  0017c	53		 push	 ebx
  0017d	56		 push	 esi
  0017e	52		 push	 edx
  0017f	0f b6 97 49 01
	00 00		 movzx	 edx, BYTE PTR [edi+329]
  00186	51		 push	 ecx
  00187	52		 push	 edx
  00188	50		 push	 eax
  00189	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 1585 : 
; 1586 : 		LogAddTD("[HallowinDay Event][Pumpkin of Luck] Event Item Drop [%s][%s] : (%d)(%d/%d) Item Attribute : %s(%d) Level : %d Dur : %d",
; 1587 : 			lpObj->AccountID, lpObj->Name, lpObj->MapNumber, X, Y, ItemAttribute[iType].Name, iType, iLevel, iDuration);

  0018e	8b 45 fc	 mov	 eax, DWORD PTR _iDuration$[ebp]
  00191	8b 4d 08	 mov	 ecx, DWORD PTR _Y$[ebp]
  00194	8b 55 f4	 mov	 edx, DWORD PTR _X$[ebp]
  00197	50		 push	 eax
  00198	0f b6 87 49 01
	00 00		 movzx	 eax, BYTE PTR [edi+329]
  0019f	53		 push	 ebx
  001a0	56		 push	 esi
  001a1	6b f6 70	 imul	 esi, 112		; 00000070H
  001a4	81 c6 00 00 00
	00		 add	 esi, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  001aa	56		 push	 esi
  001ab	51		 push	 ecx
  001ac	52		 push	 edx
  001ad	50		 push	 eax
  001ae	8d 4f 77	 lea	 ecx, DWORD PTR [edi+119]
  001b1	51		 push	 ecx
  001b2	83 c7 6c	 add	 edi, 108		; 0000006cH
  001b5	57		 push	 edi
  001b6	68 00 00 00 00	 push	 OFFSET ??_C@_0HI@MKOHGFOD@?$FLHallowinDay?5Event?$FN?$FLPumpkin?5of?5L@
  001bb	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  001c1	83 c4 5c	 add	 esp, 92			; 0000005cH
$LN14@DropHallow:

; 1588 : 	}
; 1589 : 
; 1590 : 	return TRUE;

  001c4	5e		 pop	 esi
  001c5	5b		 pop	 ebx
  001c6	b8 01 00 00 00	 mov	 eax, 1
  001cb	5f		 pop	 edi

; 1591 : }

  001cc	8b e5		 mov	 esp, ebp
  001ce	5d		 pop	 ebp
  001cf	c2 04 00	 ret	 4
?DropHallowinEventItem@CItemBagZt@@QAEHPAUOBJECTSTRUCT@@@Z ENDP ; CItemBagZt::DropHallowinEventItem
_TEXT	ENDS
PUBLIC	??_C@_0GP@IHPHEILG@?$FL?$KB?$NLKundun?5EVENT?$FN?5?$KB?ZKUNDUN?5Event?5@ ; `string'
PUBLIC	??_C@_0FM@IBDEHDFI@?$FL?$KB?$NLKUNDUN?5EVENT?$FN?$FLKUNDUN?5ITEM?5BAG@ ; `string'
PUBLIC	?DropKundunEventItem@CItemBagZt@@QAEHHEEE@Z	; CItemBagZt::DropKundunEventItem
;	COMDAT ??_C@_0GP@IHPHEILG@?$FL?$KB?$NLKundun?5EVENT?$FN?5?$KB?ZKUNDUN?5Event?5@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0GP@IHPHEILG@?$FL?$KB?$NLKundun?5EVENT?$FN?5?$KB?ZKUNDUN?5Event?5@ DB '['
	DB	0a1H, 0dbH, 'Kundun EVENT] ', 0a1H, 0daH, 'KUNDUN Event ItemDr'
	DB	'op [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op'
	DB	'2:%d op3:%d', 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0FM@IBDEHDFI@?$FL?$KB?$NLKUNDUN?5EVENT?$FN?$FLKUNDUN?5ITEM?5BAG@
CONST	SEGMENT
??_C@_0FM@IBDEHDFI@?$FL?$KB?$NLKUNDUN?5EVENT?$FN?$FLKUNDUN?5ITEM?5BAG@ DB '['
	DB	0a1H, 0dbH, 'KUNDUN EVENT][KUNDUN ITEM BAG LIST] Item:(%s)%d L'
	DB	'evel:%d-%d op1:%d op2:%d op3:%d expo:%d', 00H ; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropKundunEventItem@CItemBagZt@@QAEHHEEE@Z
_TEXT	SEGMENT
_this$ = -24						; size = 4
_ExOption$ = -20					; size = 4
_x$ = -16						; size = 4
_Option1$ = -12						; size = 4
_Option2$ = -8						; size = 4
_Option3$ = -4						; size = 4
tv733 = 8						; size = 4
_DropItemNum$ = 8					; size = 4
_aIndex$ = 8						; size = 4
_btMapNumber$ = 12					; size = 1
_level$ = 16						; size = 4
_cX$ = 16						; size = 1
_y$ = 20						; size = 4
_cY$ = 20						; size = 1
?DropKundunEventItem@CItemBagZt@@QAEHHEEE@Z PROC	; CItemBagZt::DropKundunEventItem, COMDAT
; _this$ = ecx

; 1594 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 18	 sub	 esp, 24			; 00000018H
  00006	53		 push	 ebx
  00007	8b d9		 mov	 ebx, ecx

; 1595 : 	if ( this->m_bLoad == FALSE )

  00009	33 c9		 xor	 ecx, ecx
  0000b	89 5d e8	 mov	 DWORD PTR _this$[ebp], ebx
  0000e	39 4b 04	 cmp	 DWORD PTR [ebx+4], ecx
  00011	75 09		 jne	 SHORT $LN20@DropKundun

; 1596 : 	{
; 1597 : 		return FALSE;

  00013	33 c0		 xor	 eax, eax
  00015	5b		 pop	 ebx

; 1712 : }

  00016	8b e5		 mov	 esp, ebp
  00018	5d		 pop	 ebp
  00019	c2 10 00	 ret	 16			; 00000010H
$LN20@DropKundun:

; 1606 : 	int Option2 = 0;
; 1607 : 	int Option3 = 0;
; 1608 : 	int DropItemNum;
; 1609 : 	int ExOption = 0;
; 1610 : 	LPOBJ lpObj = &gObj[aIndex];
; 1611 : 	int iItemBagCount = this->GetBagCount();

  0001c	8b 83 20 01 00
	00		 mov	 eax, DWORD PTR [ebx+288]
  00022	56		 push	 esi
  00023	57		 push	 edi
  00024	8b 7d 08	 mov	 edi, DWORD PTR _aIndex$[ebp]
  00027	69 ff 50 2b 00
	00		 imul	 edi, 11088		; 00002b50H
  0002d	03 3d 00 00 00
	00		 add	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00033	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx
  00036	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx
  00039	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx
  0003c	89 4d ec	 mov	 DWORD PTR _ExOption$[ebp], ecx

; 1612 : 
; 1613 : 	for(int i=0;i<iItemBagCount;i++)

  0003f	3b c1		 cmp	 eax, ecx
  00041	7e 5b		 jle	 SHORT $LN17@DropKundun

; 1598 : 	}
; 1599 : 
; 1600 : 	float dur;
; 1601 : 	int type;
; 1602 : 	int level;
; 1603 : 	int x;
; 1604 : 	int y;
; 1605 : 	int Option1 = 0;

  00043	8d b3 1d 02 00
	00		 lea	 esi, DWORD PTR [ebx+541]
  00049	89 45 08	 mov	 DWORD PTR tv733[ebp], eax
  0004c	8d 64 24 00	 npad	 4
$LL19@DropKundun:

; 1614 : 	{
; 1615 : 		type = ItemGetNumberMake(this->BagObject[i].m_type, this->BagObject[i].m_index);

  00050	0f b6 46 01	 movzx	 eax, BYTE PTR [esi+1]
  00054	0f b6 0e	 movzx	 ecx, BYTE PTR [esi]
  00057	50		 push	 eax
  00058	51		 push	 ecx
  00059	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake

; 1616 : 
; 1617 : 		LogAdd("[KUNDUN EVENT][KUNDUN ITEM BAG LIST] Item:(%s)%d Level:%d-%d op1:%d op2:%d op3:%d expo:%d",
; 1618 : 			ItemAttribute[type].Name, type, this->BagObject[i].m_minLevel, BagObject[i].m_maxLevel,
; 1619 : 			BagObject[i].m_isskill, BagObject[i].m_isluck, BagObject[i].m_isoption, BagObject[i].m_isexitem);

  0005e	0f b6 56 07	 movzx	 edx, BYTE PTR [esi+7]
  00062	0f b6 4e 06	 movzx	 ecx, BYTE PTR [esi+6]
  00066	52		 push	 edx
  00067	0f b6 56 05	 movzx	 edx, BYTE PTR [esi+5]
  0006b	51		 push	 ecx
  0006c	0f b6 4e 04	 movzx	 ecx, BYTE PTR [esi+4]
  00070	52		 push	 edx
  00071	0f b6 56 03	 movzx	 edx, BYTE PTR [esi+3]
  00075	51		 push	 ecx
  00076	0f b6 4e 02	 movzx	 ecx, BYTE PTR [esi+2]
  0007a	52		 push	 edx
  0007b	51		 push	 ecx
  0007c	50		 push	 eax
  0007d	6b c0 70	 imul	 eax, 112		; 00000070H
  00080	05 00 00 00 00	 add	 eax, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  00085	50		 push	 eax
  00086	68 00 00 00 00	 push	 OFFSET ??_C@_0FM@IBDEHDFI@?$FL?$KB?$NLKUNDUN?5EVENT?$FN?$FLKUNDUN?5ITEM?5BAG@
  0008b	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  00091	83 c4 2c	 add	 esp, 44			; 0000002cH
  00094	83 c6 08	 add	 esi, 8
  00097	ff 4d 08	 dec	 DWORD PTR tv733[ebp]
  0009a	75 b4		 jne	 SHORT $LL19@DropKundun

; 1612 : 
; 1613 : 	for(int i=0;i<iItemBagCount;i++)

  0009c	33 c9		 xor	 ecx, ecx
$LN17@DropKundun:

; 1620 : 	}
; 1621 : 
; 1622 : 	if ( this->GetBagCount() > 0 )

  0009e	8b b3 20 01 00
	00		 mov	 esi, DWORD PTR [ebx+288]
  000a4	3b f1		 cmp	 esi, ecx
  000a6	0f 8e e5 01 00
	00		 jle	 $LN15@DropKundun

; 1623 : 	{
; 1624 : 		if ( true )
; 1625 : 		{
; 1626 : 			DropItemNum =  rand() % this->GetBagCount();

  000ac	e8 00 00 00 00	 call	 _rand
  000b1	99		 cdq
  000b2	f7 fe		 idiv	 esi

; 1627 : 			dur = 0;
; 1628 : 			
; 1629 : 			if ( cX == 0 && cY == 0 )

  000b4	8a 45 10	 mov	 al, BYTE PTR _cX$[ebp]
  000b7	8a 4d 14	 mov	 cl, BYTE PTR _cY$[ebp]
  000ba	8b f2		 mov	 esi, edx
  000bc	89 75 08	 mov	 DWORD PTR _DropItemNum$[ebp], esi
  000bf	84 c0		 test	 al, al
  000c1	75 14		 jne	 SHORT $LN14@DropKundun
  000c3	84 c9		 test	 cl, cl
  000c5	75 10		 jne	 SHORT $LN14@DropKundun

; 1630 : 			{
; 1631 : 				x = lpObj->X;

  000c7	0f bf 97 44 01
	00 00		 movsx	 edx, WORD PTR [edi+324]

; 1632 : 				y = lpObj->Y;

  000ce	0f bf 87 46 01
	00 00		 movsx	 eax, WORD PTR [edi+326]

; 1633 : 			}
; 1634 : 			else

  000d5	eb 06		 jmp	 SHORT $LN37@DropKundun
$LN14@DropKundun:

; 1635 : 			{
; 1636 : 				x = cX;

  000d7	0f b6 d0	 movzx	 edx, al

; 1637 : 				y = cY;

  000da	0f b6 c1	 movzx	 eax, cl
$LN37@DropKundun:

; 1638 : 			}
; 1639 : 
; 1640 : 			level = this->GetLevel(DropItemNum);

  000dd	56		 push	 esi
  000de	8b cb		 mov	 ecx, ebx
  000e0	89 45 14	 mov	 DWORD PTR _y$[ebp], eax
  000e3	89 55 f0	 mov	 DWORD PTR _x$[ebp], edx
  000e6	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel

; 1641 : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  000eb	0f b6 94 f3 1e
	02 00 00	 movzx	 edx, BYTE PTR [ebx+esi*8+542]
  000f3	0f b6 c8	 movzx	 ecx, al
  000f6	0f b6 84 f3 1d
	02 00 00	 movzx	 eax, BYTE PTR [ebx+esi*8+541]
  000fe	52		 push	 edx
  000ff	50		 push	 eax
  00100	89 4d 10	 mov	 DWORD PTR _level$[ebp], ecx
  00103	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  00108	8b f0		 mov	 esi, eax
  0010a	83 c4 08	 add	 esp, 8

; 1642 : 
; 1643 : 			if ( type == -1 )

  0010d	83 fe ff	 cmp	 esi, -1
  00110	75 0b		 jne	 SHORT $LN12@DropKundun

; 1644 : 			{
; 1645 : 				return FALSE;

  00112	5f		 pop	 edi
  00113	5e		 pop	 esi
  00114	33 c0		 xor	 eax, eax
  00116	5b		 pop	 ebx

; 1712 : }

  00117	8b e5		 mov	 esp, ebp
  00119	5d		 pop	 ebp
  0011a	c2 10 00	 ret	 16			; 00000010H
$LN12@DropKundun:

; 1646 : 			}
; 1647 : 
; 1648 : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  0011d	8b 45 08	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00120	80 bc c3 21 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+545], 0
  00128	74 07		 je	 SHORT $LN31@DropKundun

; 1649 : 			{
; 1650 : 				Option1 =1;

  0012a	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN31@DropKundun:

; 1651 : 			}
; 1652 : 
; 1653 : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  00131	80 bc c3 22 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+546], 0
  00139	74 21		 je	 SHORT $LN32@DropKundun

; 1654 : 			{
; 1655 : 				Option2 = 0;

  0013b	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1656 : 
; 1657 : 				if ( (rand()%2) == 0 )

  00142	e8 00 00 00 00	 call	 _rand
  00147	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  0014c	79 05		 jns	 SHORT $LN36@DropKundun
  0014e	48		 dec	 eax
  0014f	83 c8 fe	 or	 eax, -2			; fffffffeH
  00152	40		 inc	 eax
$LN36@DropKundun:
  00153	75 07		 jne	 SHORT $LN32@DropKundun

; 1658 : 				{
; 1659 : 					Option2 = 1;

  00155	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN32@DropKundun:

; 1660 : 				}
; 1661 : 			}
; 1662 : 
; 1663 : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  0015c	8b 4d 08	 mov	 ecx, DWORD PTR _DropItemNum$[ebp]
  0015f	80 bc cb 23 02
	00 00 00	 cmp	 BYTE PTR [ebx+ecx*8+547], 0
  00167	74 2b		 je	 SHORT $LN6@DropKundun

; 1664 : 			{
; 1665 : 				if ( rand()%5 < 1 )

  00169	e8 00 00 00 00	 call	 _rand
  0016e	99		 cdq
  0016f	b9 05 00 00 00	 mov	 ecx, 5
  00174	f7 f9		 idiv	 ecx
  00176	83 fa 01	 cmp	 edx, 1
  00179	7d 09		 jge	 SHORT $LN7@DropKundun

; 1666 : 				{
; 1667 : 					Option3 = 3;

  0017b	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 1668 : 				}
; 1669 : 				else

  00182	eb 10		 jmp	 SHORT $LN6@DropKundun
$LN7@DropKundun:

; 1670 : 				{
; 1671 : 					Option3 = rand()%3;

  00184	e8 00 00 00 00	 call	 _rand
  00189	99		 cdq
  0018a	b9 03 00 00 00	 mov	 ecx, 3
  0018f	f7 f9		 idiv	 ecx
  00191	89 55 fc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN6@DropKundun:

; 1672 : 				}
; 1673 : 			}
; 1674 : 
; 1675 : 			if ( this->BagObject[DropItemNum].m_isexitem != 0 )

  00194	8b 55 08	 mov	 edx, DWORD PTR _DropItemNum$[ebp]
  00197	80 bc d3 24 02
	00 00 00	 cmp	 BYTE PTR [ebx+edx*8+548], 0
  0019f	74 17		 je	 SHORT $LN33@DropKundun

; 1676 : 			{
; 1677 : 				ExOption = NewOptionRand(0);

  001a1	33 db		 xor	 ebx, ebx
  001a3	53		 push	 ebx
  001a4	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  001a9	83 c4 04	 add	 esp, 4
  001ac	0f b6 c8	 movzx	 ecx, al

; 1678 : #ifndef _FIX_
; 1679 : 				Option2 = 0;
; 1680 : #endif
; 1681 : 				Option1 = 1;

  001af	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
  001b6	eb 05		 jmp	 SHORT $LN5@DropKundun
$LN33@DropKundun:
  001b8	8b 4d ec	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  001bb	33 db		 xor	 ebx, ebx
$LN5@DropKundun:

; 1682 : 			}
; 1683 : 
; 1684 : 			if ( type == ITEMGET(12,15) || type == ITEMGET(14,13) || type == ITEMGET(14,14) || type == ITEMGET(14,16))	// Chaos, Bless, Soul

  001bd	81 fe 0f 18 00
	00		 cmp	 esi, 6159		; 0000180fH
  001c3	74 18		 je	 SHORT $LN3@DropKundun
  001c5	81 fe 0d 1c 00
	00		 cmp	 esi, 7181		; 00001c0dH
  001cb	74 10		 je	 SHORT $LN3@DropKundun
  001cd	81 fe 0e 1c 00
	00		 cmp	 esi, 7182		; 00001c0eH
  001d3	74 08		 je	 SHORT $LN3@DropKundun
  001d5	81 fe 10 1c 00
	00		 cmp	 esi, 7184		; 00001c10H
  001db	75 0c		 jne	 SHORT $LN4@DropKundun
$LN3@DropKundun:

; 1685 : 			{
; 1686 : 				Option1 = 0;

  001dd	89 5d f4	 mov	 DWORD PTR _Option1$[ebp], ebx

; 1687 : 				Option2 = 0;

  001e0	89 5d f8	 mov	 DWORD PTR _Option2$[ebp], ebx

; 1688 : 				Option3 = 0;

  001e3	89 5d fc	 mov	 DWORD PTR _Option3$[ebp], ebx

; 1689 : 				level = 0;

  001e6	89 5d 10	 mov	 DWORD PTR _level$[ebp], ebx
$LN4@DropKundun:

; 1690 : 			}
; 1691 : 
; 1692 : 			if ( type == ITEMGET(13,0) ||
; 1693 : 				 type == ITEMGET(13,1) ||
; 1694 : 				 type == ITEMGET(13,2) ||
; 1695 : 				 type == ITEMGET(13,8) ||
; 1696 : 				 type == ITEMGET(13,9) ||
; 1697 : 				 type == ITEMGET(13,12) ||
; 1698 : 				 type ==ITEMGET(13,13) )	// Angel, imp, unirioa, dino, r and pendant of ice, poisonm

  001e9	81 fe 00 1a 00
	00		 cmp	 esi, 6656		; 00001a00H
  001ef	74 30		 je	 SHORT $LN1@DropKundun
  001f1	81 fe 01 1a 00
	00		 cmp	 esi, 6657		; 00001a01H
  001f7	74 28		 je	 SHORT $LN1@DropKundun
  001f9	81 fe 02 1a 00
	00		 cmp	 esi, 6658		; 00001a02H
  001ff	74 20		 je	 SHORT $LN1@DropKundun
  00201	81 fe 08 1a 00
	00		 cmp	 esi, 6664		; 00001a08H
  00207	74 18		 je	 SHORT $LN1@DropKundun
  00209	81 fe 09 1a 00
	00		 cmp	 esi, 6665		; 00001a09H
  0020f	74 10		 je	 SHORT $LN1@DropKundun
  00211	81 fe 0c 1a 00
	00		 cmp	 esi, 6668		; 00001a0cH
  00217	74 08		 je	 SHORT $LN1@DropKundun
  00219	81 fe 0d 1a 00
	00		 cmp	 esi, 6669		; 00001a0dH
  0021f	75 03		 jne	 SHORT $LN2@DropKundun
$LN1@DropKundun:

; 1699 : 			{
; 1700 : 				level = 0;

  00221	89 5d 10	 mov	 DWORD PTR _level$[ebp], ebx
$LN2@DropKundun:

; 1701 : 			}
; 1702 : 
; 1703 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)btMapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur, (BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  00224	8b 07		 mov	 eax, DWORD PTR [edi]
  00226	8b 55 f8	 mov	 edx, DWORD PTR _Option2$[ebp]
  00229	53		 push	 ebx
  0022a	51		 push	 ecx
  0022b	8b 4d fc	 mov	 ecx, DWORD PTR _Option3$[ebp]
  0022e	50		 push	 eax
  0022f	51		 push	 ecx
  00230	8b 4d f4	 mov	 ecx, DWORD PTR _Option1$[ebp]
  00233	52		 push	 edx
  00234	8b 55 10	 mov	 edx, DWORD PTR _level$[ebp]
  00237	51		 push	 ecx
  00238	8b 4d 14	 mov	 ecx, DWORD PTR _y$[ebp]
  0023b	53		 push	 ebx
  0023c	8b 5d 0c	 mov	 ebx, DWORD PTR _btMapNumber$[ebp]
  0023f	52		 push	 edx
  00240	8b 55 f0	 mov	 edx, DWORD PTR _x$[ebp]
  00243	56		 push	 esi
  00244	51		 push	 ecx
  00245	52		 push	 edx
  00246	53		 push	 ebx
  00247	50		 push	 eax
  00248	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 1704 : 
; 1705 : 			LogAddTD("[Kundun EVENT] KUNDUN Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d",
; 1706 : 				lpObj->AccountID, lpObj->Name, this->m_sEventName, btMapNumber, x, y, ItemAttribute[type].Name, type, level, Option1, Option2, Option3);

  0024d	8b 45 fc	 mov	 eax, DWORD PTR _Option3$[ebp]
  00250	8b 4d f8	 mov	 ecx, DWORD PTR _Option2$[ebp]
  00253	8b 55 f4	 mov	 edx, DWORD PTR _Option1$[ebp]
  00256	50		 push	 eax
  00257	8b 45 10	 mov	 eax, DWORD PTR _level$[ebp]
  0025a	51		 push	 ecx
  0025b	8b 4d 14	 mov	 ecx, DWORD PTR _y$[ebp]
  0025e	52		 push	 edx
  0025f	8b 55 f0	 mov	 edx, DWORD PTR _x$[ebp]
  00262	50		 push	 eax
  00263	56		 push	 esi
  00264	6b f6 70	 imul	 esi, 112		; 00000070H
  00267	81 c6 00 00 00
	00		 add	 esi, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  0026d	56		 push	 esi
  0026e	51		 push	 ecx
  0026f	8b 4d e8	 mov	 ecx, DWORD PTR _this$[ebp]
  00272	52		 push	 edx
  00273	0f b6 c3	 movzx	 eax, bl
  00276	50		 push	 eax
  00277	83 c1 08	 add	 ecx, 8
  0027a	51		 push	 ecx
  0027b	8d 57 77	 lea	 edx, DWORD PTR [edi+119]
  0027e	52		 push	 edx
  0027f	83 c7 6c	 add	 edi, 108		; 0000006cH
  00282	57		 push	 edi
  00283	68 00 00 00 00	 push	 OFFSET ??_C@_0GP@IHPHEILG@?$FL?$KB?$NLKundun?5EVENT?$FN?5?$KB?ZKUNDUN?5Event?5@
  00288	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  0028e	83 c4 68	 add	 esp, 104		; 00000068H
$LN15@DropKundun:

; 1707 : 			return TRUE;
; 1708 : 		}
; 1709 : 	}
; 1710 : 
; 1711 : 	return TRUE;

  00291	5f		 pop	 edi
  00292	5e		 pop	 esi
  00293	b8 01 00 00 00	 mov	 eax, 1
  00298	5b		 pop	 ebx

; 1712 : }

  00299	8b e5		 mov	 esp, ebp
  0029b	5d		 pop	 ebp
  0029c	c2 10 00	 ret	 16			; 00000010H
?DropKundunEventItem@CItemBagZt@@QAEHHEEE@Z ENDP	; CItemBagZt::DropKundunEventItem
_TEXT	ENDS
PUBLIC	??_C@_0HI@EDAEPOLG@?$FLCastle?5HuntZone?$FN?5?$KB?ZCastle?5HuntZ@ ; `string'
PUBLIC	?DropCastleHuntZoneBossReward@CItemBagZt@@QAEHHEEE@Z ; CItemBagZt::DropCastleHuntZoneBossReward
;	COMDAT ??_C@_0HI@EDAEPOLG@?$FLCastle?5HuntZone?$FN?5?$KB?ZCastle?5HuntZ@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0HI@EDAEPOLG@?$FLCastle?5HuntZone?$FN?5?$KB?ZCastle?5HuntZ@ DB '[Ca'
	DB	'stle HuntZone] ', 0a1H, 0daH, 'Castle HuntZone Boss ItemDrop '
	DB	'[%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%'
	DB	'd op3:%d', 00H				; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropCastleHuntZoneBossReward@CItemBagZt@@QAEHHEEE@Z
_TEXT	SEGMENT
_ExOption$ = -20					; size = 4
_x$ = -16						; size = 4
_Option1$ = -12						; size = 4
_Option2$ = -8						; size = 4
_Option3$ = -4						; size = 4
_DropItemNum$ = 8					; size = 4
_aIndex$ = 8						; size = 4
_btMapNumber$ = 12					; size = 1
_level$ = 16						; size = 4
_cX$ = 16						; size = 1
_y$ = 20						; size = 4
_cY$ = 20						; size = 1
?DropCastleHuntZoneBossReward@CItemBagZt@@QAEHHEEE@Z PROC ; CItemBagZt::DropCastleHuntZoneBossReward, COMDAT
; _this$ = ecx

; 1716 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 14	 sub	 esp, 20			; 00000014H
  00006	53		 push	 ebx
  00007	8b d9		 mov	 ebx, ecx

; 1717 : 	if ( this->m_bLoad == FALSE )

  00009	33 c0		 xor	 eax, eax
  0000b	39 43 04	 cmp	 DWORD PTR [ebx+4], eax
  0000e	75 07		 jne	 SHORT $LN17@DropCastle
  00010	5b		 pop	 ebx

; 1822 : }

  00011	8b e5		 mov	 esp, ebp
  00013	5d		 pop	 ebp
  00014	c2 10 00	 ret	 16			; 00000010H
$LN17@DropCastle:
  00017	56		 push	 esi

; 1718 : 		return FALSE;
; 1719 : 
; 1720 : 	float dur;
; 1721 : 	int type;
; 1722 : 	int level;
; 1723 : 	int x;
; 1724 : 	int y;
; 1725 : 	int Option1 = 0;
; 1726 : 	int Option2 = 0;
; 1727 : 	int Option3 = 0;
; 1728 : 	int DropItemNum;
; 1729 : 	int ExOption = 0;
; 1730 : 	LPOBJ lpObj = &gObj[aIndex];
; 1731 : 
; 1732 : 	if ( this->GetBagCount() > 0 )

  00018	8b b3 20 01 00
	00		 mov	 esi, DWORD PTR [ebx+288]
  0001e	57		 push	 edi
  0001f	8b 7d 08	 mov	 edi, DWORD PTR _aIndex$[ebp]
  00022	69 ff 50 2b 00
	00		 imul	 edi, 11088		; 00002b50H
  00028	03 3d 00 00 00
	00		 add	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0002e	89 45 f4	 mov	 DWORD PTR _Option1$[ebp], eax
  00031	89 45 f8	 mov	 DWORD PTR _Option2$[ebp], eax
  00034	89 45 fc	 mov	 DWORD PTR _Option3$[ebp], eax
  00037	89 45 ec	 mov	 DWORD PTR _ExOption$[ebp], eax
  0003a	3b f0		 cmp	 esi, eax
  0003c	0f 8e e4 01 00
	00		 jle	 $LN16@DropCastle

; 1733 : 	{
; 1734 : 		if ( true )
; 1735 : 		{
; 1736 : 			DropItemNum =  rand() % this->GetBagCount();

  00042	e8 00 00 00 00	 call	 _rand
  00047	99		 cdq
  00048	f7 fe		 idiv	 esi

; 1737 : 			dur = 0;
; 1738 : 
; 1739 : 			if ( cX == 0 && cY == 0 )

  0004a	8a 45 10	 mov	 al, BYTE PTR _cX$[ebp]
  0004d	8a 4d 14	 mov	 cl, BYTE PTR _cY$[ebp]
  00050	8b f2		 mov	 esi, edx
  00052	89 75 08	 mov	 DWORD PTR _DropItemNum$[ebp], esi
  00055	84 c0		 test	 al, al
  00057	75 1a		 jne	 SHORT $LN14@DropCastle
  00059	84 c9		 test	 cl, cl
  0005b	75 16		 jne	 SHORT $LN14@DropCastle

; 1740 : 			{
; 1741 : 				x = lpObj->X;

  0005d	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]

; 1742 : 				y = lpObj->Y;

  00064	0f bf 8f 46 01
	00 00		 movsx	 ecx, WORD PTR [edi+326]
  0006b	89 45 f0	 mov	 DWORD PTR _x$[ebp], eax
  0006e	89 4d 14	 mov	 DWORD PTR _y$[ebp], ecx

; 1743 : 			}
; 1744 : 			else

  00071	eb 0c		 jmp	 SHORT $LN13@DropCastle
$LN14@DropCastle:

; 1745 : 			{
; 1746 : 				x = cX;

  00073	0f b6 d0	 movzx	 edx, al

; 1747 : 				y = cY;

  00076	0f b6 c1	 movzx	 eax, cl
  00079	89 55 f0	 mov	 DWORD PTR _x$[ebp], edx
  0007c	89 45 14	 mov	 DWORD PTR _y$[ebp], eax
$LN13@DropCastle:

; 1748 : 			}
; 1749 : 
; 1750 : 			level = this->GetLevel(DropItemNum);

  0007f	56		 push	 esi
  00080	8b cb		 mov	 ecx, ebx
  00082	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel

; 1751 : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  00087	0f b6 94 f3 1e
	02 00 00	 movzx	 edx, BYTE PTR [ebx+esi*8+542]
  0008f	0f b6 c8	 movzx	 ecx, al
  00092	0f b6 84 f3 1d
	02 00 00	 movzx	 eax, BYTE PTR [ebx+esi*8+541]
  0009a	52		 push	 edx
  0009b	50		 push	 eax
  0009c	89 4d 10	 mov	 DWORD PTR _level$[ebp], ecx
  0009f	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  000a4	8b f0		 mov	 esi, eax
  000a6	83 c4 08	 add	 esp, 8

; 1752 : 
; 1753 : 			if ( type == -1 )

  000a9	83 fe ff	 cmp	 esi, -1
  000ac	75 0b		 jne	 SHORT $LN12@DropCastle

; 1754 : 			{
; 1755 : 				return FALSE;

  000ae	5f		 pop	 edi
  000af	5e		 pop	 esi
  000b0	33 c0		 xor	 eax, eax
  000b2	5b		 pop	 ebx

; 1822 : }

  000b3	8b e5		 mov	 esp, ebp
  000b5	5d		 pop	 ebp
  000b6	c2 10 00	 ret	 16			; 00000010H
$LN12@DropCastle:

; 1756 : 			}
; 1757 : 
; 1758 : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  000b9	8b 45 08	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  000bc	80 bc c3 21 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+545], 0
  000c4	74 07		 je	 SHORT $LN24@DropCastle

; 1759 : 			{
; 1760 : 				Option1 =1;

  000c6	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN24@DropCastle:

; 1761 : 			}
; 1762 : 
; 1763 : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  000cd	80 bc c3 22 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+546], 0
  000d5	74 21		 je	 SHORT $LN25@DropCastle

; 1764 : 			{
; 1765 : 				Option2 = 0;

  000d7	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1766 : 
; 1767 : 				if ( (rand()%2) == 0 )

  000de	e8 00 00 00 00	 call	 _rand
  000e3	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  000e8	79 05		 jns	 SHORT $LN32@DropCastle
  000ea	48		 dec	 eax
  000eb	83 c8 fe	 or	 eax, -2			; fffffffeH
  000ee	40		 inc	 eax
$LN32@DropCastle:
  000ef	75 07		 jne	 SHORT $LN25@DropCastle

; 1768 : 				{
; 1769 : 					Option2 = 1;

  000f1	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN25@DropCastle:

; 1770 : 				}
; 1771 : 			}
; 1772 : 
; 1773 : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  000f8	8b 4d 08	 mov	 ecx, DWORD PTR _DropItemNum$[ebp]
  000fb	80 bc cb 23 02
	00 00 00	 cmp	 BYTE PTR [ebx+ecx*8+547], 0
  00103	74 2b		 je	 SHORT $LN27@DropCastle

; 1774 : 			{
; 1775 : 				if ( rand()%5 < 1 )

  00105	e8 00 00 00 00	 call	 _rand
  0010a	99		 cdq
  0010b	b9 05 00 00 00	 mov	 ecx, 5
  00110	f7 f9		 idiv	 ecx
  00112	83 fa 01	 cmp	 edx, 1
  00115	7d 09		 jge	 SHORT $LN7@DropCastle

; 1776 : 				{
; 1777 : 					Option3 = 3;

  00117	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 1778 : 				}
; 1779 : 				else

  0011e	eb 10		 jmp	 SHORT $LN27@DropCastle
$LN7@DropCastle:

; 1780 : 				{
; 1781 : 					Option3 = rand()%3;

  00120	e8 00 00 00 00	 call	 _rand
  00125	99		 cdq
  00126	b9 03 00 00 00	 mov	 ecx, 3
  0012b	f7 f9		 idiv	 ecx
  0012d	89 55 fc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN27@DropCastle:

; 1782 : 				}
; 1783 : 			}
; 1784 : 
; 1785 : 			if ( this->BagObject[DropItemNum].m_isexitem != 0 )

  00130	8b 55 08	 mov	 edx, DWORD PTR _DropItemNum$[ebp]
  00133	80 bc d3 24 02
	00 00 00	 cmp	 BYTE PTR [ebx+edx*8+548], 0
  0013b	74 16		 je	 SHORT $LN28@DropCastle

; 1786 : 			{
; 1787 : 				ExOption = NewOptionRand(0);

  0013d	6a 00		 push	 0
  0013f	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  00144	83 c4 04	 add	 esp, 4
  00147	0f b6 d0	 movzx	 edx, al

; 1788 : #ifndef _FIX_
; 1789 : 				Option2 = 0;
; 1790 : #endif
; 1791 : 				Option1 = 1;

  0014a	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
  00151	eb 03		 jmp	 SHORT $LN5@DropCastle
$LN28@DropCastle:
  00153	8b 55 ec	 mov	 edx, DWORD PTR _ExOption$[ebp]
$LN5@DropCastle:

; 1792 : 			}
; 1793 : 
; 1794 : 			if ( type == ITEMGET(12,15) || type == ITEMGET(14,13) || type == ITEMGET(14,14))	// Chaos, Bless, Soul

  00156	81 fe 0f 18 00
	00		 cmp	 esi, 6159		; 0000180fH
  0015c	74 10		 je	 SHORT $LN3@DropCastle
  0015e	81 fe 0d 1c 00
	00		 cmp	 esi, 7181		; 00001c0dH
  00164	74 08		 je	 SHORT $LN3@DropCastle
  00166	81 fe 0e 1c 00
	00		 cmp	 esi, 7182		; 00001c0eH
  0016c	75 10		 jne	 SHORT $LN29@DropCastle
$LN3@DropCastle:

; 1795 : 			{
; 1796 : 				Option1 = 0;

  0016e	33 c9		 xor	 ecx, ecx
  00170	89 4d f4	 mov	 DWORD PTR _Option1$[ebp], ecx

; 1797 : 				Option2 = 0;

  00173	89 4d f8	 mov	 DWORD PTR _Option2$[ebp], ecx

; 1798 : 				Option3 = 0;

  00176	89 4d fc	 mov	 DWORD PTR _Option3$[ebp], ecx

; 1799 : 				level = 0;

  00179	89 4d 10	 mov	 DWORD PTR _level$[ebp], ecx
  0017c	eb 02		 jmp	 SHORT $LN4@DropCastle
$LN29@DropCastle:
  0017e	33 c9		 xor	 ecx, ecx
$LN4@DropCastle:

; 1800 : 			}
; 1801 : 
; 1802 : 			if ( type == ITEMGET(13,0) ||
; 1803 : 				 type == ITEMGET(13,1) ||
; 1804 : 				 type == ITEMGET(13,2) ||
; 1805 : 				 type == ITEMGET(13,8) ||
; 1806 : 				 type == ITEMGET(13,9) ||
; 1807 : 				 type == ITEMGET(13,12) ||
; 1808 : 				 type ==ITEMGET(13,13) )	// Angel, imp, unirioa, dino, r and pendant of ice, poisonm

  00180	81 fe 00 1a 00
	00		 cmp	 esi, 6656		; 00001a00H
  00186	74 30		 je	 SHORT $LN1@DropCastle
  00188	81 fe 01 1a 00
	00		 cmp	 esi, 6657		; 00001a01H
  0018e	74 28		 je	 SHORT $LN1@DropCastle
  00190	81 fe 02 1a 00
	00		 cmp	 esi, 6658		; 00001a02H
  00196	74 20		 je	 SHORT $LN1@DropCastle
  00198	81 fe 08 1a 00
	00		 cmp	 esi, 6664		; 00001a08H
  0019e	74 18		 je	 SHORT $LN1@DropCastle
  001a0	81 fe 09 1a 00
	00		 cmp	 esi, 6665		; 00001a09H
  001a6	74 10		 je	 SHORT $LN1@DropCastle
  001a8	81 fe 0c 1a 00
	00		 cmp	 esi, 6668		; 00001a0cH
  001ae	74 08		 je	 SHORT $LN1@DropCastle
  001b0	81 fe 0d 1a 00
	00		 cmp	 esi, 6669		; 00001a0dH
  001b6	75 03		 jne	 SHORT $LN2@DropCastle
$LN1@DropCastle:

; 1809 : 			{
; 1810 : 				level = 0;

  001b8	89 4d 10	 mov	 DWORD PTR _level$[ebp], ecx
$LN2@DropCastle:

; 1811 : 			}
; 1812 : 
; 1813 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)btMapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur, (BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  001bb	8b 07		 mov	 eax, DWORD PTR [edi]
  001bd	51		 push	 ecx
  001be	52		 push	 edx
  001bf	8b 55 fc	 mov	 edx, DWORD PTR _Option3$[ebp]
  001c2	50		 push	 eax
  001c3	52		 push	 edx
  001c4	8b 55 f8	 mov	 edx, DWORD PTR _Option2$[ebp]
  001c7	52		 push	 edx
  001c8	8b 55 f4	 mov	 edx, DWORD PTR _Option1$[ebp]
  001cb	52		 push	 edx
  001cc	8b 55 14	 mov	 edx, DWORD PTR _y$[ebp]
  001cf	51		 push	 ecx
  001d0	8b 4d 10	 mov	 ecx, DWORD PTR _level$[ebp]
  001d3	51		 push	 ecx
  001d4	8b 4d f0	 mov	 ecx, DWORD PTR _x$[ebp]
  001d7	56		 push	 esi
  001d8	52		 push	 edx
  001d9	8b 55 0c	 mov	 edx, DWORD PTR _btMapNumber$[ebp]
  001dc	51		 push	 ecx
  001dd	52		 push	 edx
  001de	50		 push	 eax
  001df	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 1814 : 
; 1815 : 			LogAddTD("[Castle HuntZone] Castle HuntZone Boss ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d",
; 1816 : 				lpObj->AccountID, lpObj->Name, this->m_sEventName, btMapNumber, x, y, ItemAttribute[type].Name, type, level, Option1, Option2, Option3);

  001e4	8b 45 fc	 mov	 eax, DWORD PTR _Option3$[ebp]
  001e7	8b 4d f8	 mov	 ecx, DWORD PTR _Option2$[ebp]
  001ea	8b 55 f4	 mov	 edx, DWORD PTR _Option1$[ebp]
  001ed	50		 push	 eax
  001ee	8b 45 10	 mov	 eax, DWORD PTR _level$[ebp]
  001f1	51		 push	 ecx
  001f2	8b 4d 14	 mov	 ecx, DWORD PTR _y$[ebp]
  001f5	52		 push	 edx
  001f6	8b 55 f0	 mov	 edx, DWORD PTR _x$[ebp]
  001f9	50		 push	 eax
  001fa	0f b6 45 0c	 movzx	 eax, BYTE PTR _btMapNumber$[ebp]
  001fe	56		 push	 esi
  001ff	6b f6 70	 imul	 esi, 112		; 00000070H
  00202	81 c6 00 00 00
	00		 add	 esi, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  00208	56		 push	 esi
  00209	51		 push	 ecx
  0020a	52		 push	 edx
  0020b	50		 push	 eax
  0020c	83 c3 08	 add	 ebx, 8
  0020f	53		 push	 ebx
  00210	8d 4f 77	 lea	 ecx, DWORD PTR [edi+119]
  00213	51		 push	 ecx
  00214	83 c7 6c	 add	 edi, 108		; 0000006cH
  00217	57		 push	 edi
  00218	68 00 00 00 00	 push	 OFFSET ??_C@_0HI@EDAEPOLG@?$FLCastle?5HuntZone?$FN?5?$KB?ZCastle?5HuntZ@
  0021d	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  00223	83 c4 68	 add	 esp, 104		; 00000068H
$LN16@DropCastle:

; 1817 : 
; 1818 : 		}
; 1819 : 		return TRUE;
; 1820 : 	}
; 1821 : 	return TRUE;

  00226	5f		 pop	 edi
  00227	5e		 pop	 esi
  00228	b8 01 00 00 00	 mov	 eax, 1
  0022d	5b		 pop	 ebx

; 1822 : }

  0022e	8b e5		 mov	 esp, ebp
  00230	5d		 pop	 ebp
  00231	c2 10 00	 ret	 16			; 00000010H
?DropCastleHuntZoneBossReward@CItemBagZt@@QAEHHEEE@Z ENDP ; CItemBagZt::DropCastleHuntZoneBossReward
_TEXT	ENDS
PUBLIC	??_C@_0HA@EIEHAAMC@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Dark?5Elf?5Ite@ ; `string'
PUBLIC	??_C@_0DJ@HFCGAAID@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Dark?5Elf?5Ite@ ; `string'
PUBLIC	?DropCrywolfDarkElfItem@CItemBagZt@@QAEHHEEE@Z	; CItemBagZt::DropCrywolfDarkElfItem
EXTRN	?g_iCrywolfMonsterDarkElfDropZen@@3HA:DWORD	; g_iCrywolfMonsterDarkElfDropZen
EXTRN	?g_iCrywolfMonsterDarkElfDropZenRate@@3HA:DWORD	; g_iCrywolfMonsterDarkElfDropZenRate
;	COMDAT ??_C@_0HA@EIEHAAMC@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Dark?5Elf?5Ite@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0HA@EIEHAAMC@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Dark?5Elf?5Ite@ DB '['
	DB	' Crywolf ][Reward] Dark Elf Item Drop [%s][%s] : (%d)(%d/%d) '
	DB	'Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0DJ@HFCGAAID@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Dark?5Elf?5Ite@
CONST	SEGMENT
??_C@_0DJ@HFCGAAID@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Dark?5Elf?5Ite@ DB '['
	DB	' Crywolf ][Reward] Dark Elf Item Drop [%s][%s] [%d Zen]', 00H ; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropCrywolfDarkElfItem@CItemBagZt@@QAEHHEEE@Z
_TEXT	SEGMENT
_iExOption$ = -20					; size = 4
_X$ = -16						; size = 4
_iOption1$ = -12					; size = 4
_iOption2$ = -8						; size = 4
_iOption3$ = -4						; size = 4
_iDropItemNum$ = 8					; size = 4
_aIndex$ = 8						; size = 4
_btMapNumber$ = 12					; size = 1
_iLevel$ = 16						; size = 4
_cX$ = 16						; size = 1
_Y$ = 20						; size = 4
_cY$ = 20						; size = 1
?DropCrywolfDarkElfItem@CItemBagZt@@QAEHHEEE@Z PROC	; CItemBagZt::DropCrywolfDarkElfItem, COMDAT
; _this$ = ecx

; 1826 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 14	 sub	 esp, 20			; 00000014H
  00006	53		 push	 ebx
  00007	8b d9		 mov	 ebx, ecx

; 1827 : 	if ( this->m_bLoad == FALSE )

  00009	33 c0		 xor	 eax, eax
  0000b	39 43 04	 cmp	 DWORD PTR [ebx+4], eax
  0000e	75 07		 jne	 SHORT $LN14@DropCrywol
  00010	5b		 pop	 ebx

; 1923 : 
; 1924 : 
; 1925 : }

  00011	8b e5		 mov	 esp, ebp
  00013	5d		 pop	 ebp
  00014	c2 10 00	 ret	 16			; 00000010H
$LN14@DropCrywol:
  00017	57		 push	 edi

; 1828 : 		return FALSE;
; 1829 : 
; 1830 : 	float fDur = 0;
; 1831 : 	int iType = 0;
; 1832 : 	int iLevel = 0;
; 1833 : 	int X = 0;
; 1834 : 	int Y = 0;
; 1835 : 	int iOption1 = 0;
; 1836 : 	int iOption2 = 0;
; 1837 : 	int iOption3 = 0;
; 1838 : 	int iDropItemNum = 0;
; 1839 : 	int iDropItemRate = 0;
; 1840 : 	int iExOption = 0;
; 1841 : 	LPOBJ lpObj = &gObj[aIndex];

  00018	8b 7d 08	 mov	 edi, DWORD PTR _aIndex$[ebp]
  0001b	69 ff 50 2b 00
	00		 imul	 edi, 11088		; 00002b50H
  00021	03 3d 00 00 00
	00		 add	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00027	89 45 f4	 mov	 DWORD PTR _iOption1$[ebp], eax
  0002a	89 45 f8	 mov	 DWORD PTR _iOption2$[ebp], eax
  0002d	89 45 fc	 mov	 DWORD PTR _iOption3$[ebp], eax
  00030	89 45 ec	 mov	 DWORD PTR _iExOption$[ebp], eax

; 1842 : 
; 1843 : 	if ( this->GetBagCount() > 0 )

  00033	39 83 20 01 00
	00		 cmp	 DWORD PTR [ebx+288], eax
  00039	7e 5b		 jle	 SHORT $LN11@DropCrywol

; 1844 : 	{
; 1845 : 		iDropItemRate = rand() % 10000;

  0003b	e8 00 00 00 00	 call	 _rand
  00040	99		 cdq
  00041	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  00046	f7 f9		 idiv	 ecx

; 1846 : 
; 1847 : 		if ( iDropItemRate < g_iCrywolfMonsterDarkElfDropZenRate ) 

  00048	3b 15 00 00 00
	00		 cmp	 edx, DWORD PTR ?g_iCrywolfMonsterDarkElfDropZenRate@@3HA ; g_iCrywolfMonsterDarkElfDropZenRate
  0004e	7d 53		 jge	 SHORT $LN12@DropCrywol

; 1848 : 		{
; 1849 : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iCrywolfMonsterDarkElfDropZen, cX, cY);

  00050	0f b6 55 14	 movzx	 edx, BYTE PTR _cY$[ebp]
  00054	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  00058	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iCrywolfMonsterDarkElfDropZen@@3HA ; g_iCrywolfMonsterDarkElfDropZen
  0005e	52		 push	 edx
  0005f	50		 push	 eax
  00060	51		 push	 ecx
  00061	0f b6 8f 49 01
	00 00		 movzx	 ecx, BYTE PTR [edi+329]
  00068	69 c9 48 3d 05
	00		 imul	 ecx, 343368		; 00053d48H
  0006e	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  00074	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 1850 : 
; 1851 : 			LogAddTD("[ Crywolf ][Reward] Dark Elf Item Drop [%s][%s] [%d Zen]",
; 1852 : 				lpObj->AccountID, lpObj->Name, g_iCrywolfMonsterDarkElfDropZen);

  00079	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?g_iCrywolfMonsterDarkElfDropZen@@3HA ; g_iCrywolfMonsterDarkElfDropZen
  0007f	52		 push	 edx
  00080	8d 47 77	 lea	 eax, DWORD PTR [edi+119]
  00083	50		 push	 eax
  00084	83 c7 6c	 add	 edi, 108		; 0000006cH
  00087	57		 push	 edi
  00088	68 00 00 00 00	 push	 OFFSET ??_C@_0DJ@HFCGAAID@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Dark?5Elf?5Ite@
  0008d	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  00093	83 c4 10	 add	 esp, 16			; 00000010H
$LN11@DropCrywol:

; 1919 : 		}
; 1920 : 	}
; 1921 : 
; 1922 : 	return TRUE;

  00096	5f		 pop	 edi
  00097	b8 01 00 00 00	 mov	 eax, 1
  0009c	5b		 pop	 ebx

; 1923 : 
; 1924 : 
; 1925 : }

  0009d	8b e5		 mov	 esp, ebp
  0009f	5d		 pop	 ebp
  000a0	c2 10 00	 ret	 16			; 00000010H
$LN12@DropCrywol:
  000a3	56		 push	 esi

; 1853 : 		}
; 1854 : 		else
; 1855 : 		{
; 1856 : 			iDropItemNum = rand()% this->GetBagCount();

  000a4	8b b3 20 01 00
	00		 mov	 esi, DWORD PTR [ebx+288]
  000aa	e8 00 00 00 00	 call	 _rand
  000af	99		 cdq
  000b0	f7 fe		 idiv	 esi

; 1857 : 			fDur = 0;
; 1858 : 
; 1859 : 			if ( cX == 0 && cY == 0 )

  000b2	8a 45 10	 mov	 al, BYTE PTR _cX$[ebp]
  000b5	8a 4d 14	 mov	 cl, BYTE PTR _cY$[ebp]
  000b8	8b f2		 mov	 esi, edx
  000ba	89 75 08	 mov	 DWORD PTR _iDropItemNum$[ebp], esi
  000bd	84 c0		 test	 al, al
  000bf	75 1a		 jne	 SHORT $LN10@DropCrywol
  000c1	84 c9		 test	 cl, cl
  000c3	75 16		 jne	 SHORT $LN10@DropCrywol

; 1860 : 			{
; 1861 : 				X = lpObj->X;

  000c5	0f bf 8f 44 01
	00 00		 movsx	 ecx, WORD PTR [edi+324]

; 1862 : 				Y = lpObj->Y;

  000cc	0f bf 97 46 01
	00 00		 movsx	 edx, WORD PTR [edi+326]
  000d3	89 4d f0	 mov	 DWORD PTR _X$[ebp], ecx
  000d6	89 55 14	 mov	 DWORD PTR _Y$[ebp], edx

; 1863 : 			}
; 1864 : 			else

  000d9	eb 0c		 jmp	 SHORT $LN9@DropCrywol
$LN10@DropCrywol:

; 1865 : 			{
; 1866 : 				X = cX;

  000db	0f b6 c0	 movzx	 eax, al

; 1867 : 				Y = cY;

  000de	0f b6 c9	 movzx	 ecx, cl
  000e1	89 45 f0	 mov	 DWORD PTR _X$[ebp], eax
  000e4	89 4d 14	 mov	 DWORD PTR _Y$[ebp], ecx
$LN9@DropCrywol:

; 1868 : 			}
; 1869 : 
; 1870 : 			iLevel = this->GetLevel(iDropItemNum);

  000e7	56		 push	 esi
  000e8	8b cb		 mov	 ecx, ebx
  000ea	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel

; 1871 : 			iType = ItemGetNumberMake(this->BagObject[iDropItemNum].m_type, this->BagObject[iDropItemNum].m_index);

  000ef	0f b6 8c f3 1d
	02 00 00	 movzx	 ecx, BYTE PTR [ebx+esi*8+541]
  000f7	0f b6 d0	 movzx	 edx, al
  000fa	0f b6 84 f3 1e
	02 00 00	 movzx	 eax, BYTE PTR [ebx+esi*8+542]
  00102	50		 push	 eax
  00103	51		 push	 ecx
  00104	89 55 10	 mov	 DWORD PTR _iLevel$[ebp], edx
  00107	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  0010c	8b f0		 mov	 esi, eax
  0010e	83 c4 08	 add	 esp, 8

; 1872 : 
; 1873 : 			if ( iType == -1 )

  00111	83 fe ff	 cmp	 esi, -1
  00114	75 0b		 jne	 SHORT $LN8@DropCrywol

; 1874 : 				return FALSE;

  00116	5e		 pop	 esi
  00117	5f		 pop	 edi
  00118	33 c0		 xor	 eax, eax
  0011a	5b		 pop	 ebx

; 1923 : 
; 1924 : 
; 1925 : }

  0011b	8b e5		 mov	 esp, ebp
  0011d	5d		 pop	 ebp
  0011e	c2 10 00	 ret	 16			; 00000010H
$LN8@DropCrywol:

; 1875 : 
; 1876 : 			if ( this->BagObject[iDropItemNum].m_isskill )

  00121	8b 45 08	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  00124	80 bc c3 21 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+545], 0
  0012c	74 07		 je	 SHORT $LN21@DropCrywol

; 1877 : 				iOption1 = 1;

  0012e	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1
$LN21@DropCrywol:

; 1878 : 
; 1879 : 			if ( this->BagObject[iDropItemNum].m_isluck )

  00135	80 bc c3 22 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+546], 0
  0013d	74 21		 je	 SHORT $LN22@DropCrywol

; 1880 : 			{
; 1881 : 				iOption2 = 0;

  0013f	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 1882 : 
; 1883 : 				if ( (rand()%2) == 0 )

  00146	e8 00 00 00 00	 call	 _rand
  0014b	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  00150	79 05		 jns	 SHORT $LN28@DropCrywol
  00152	48		 dec	 eax
  00153	83 c8 fe	 or	 eax, -2			; fffffffeH
  00156	40		 inc	 eax
$LN28@DropCrywol:
  00157	75 07		 jne	 SHORT $LN22@DropCrywol

; 1884 : 				{
; 1885 : 					iOption2 = 1;

  00159	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 1
$LN22@DropCrywol:

; 1886 : 				}
; 1887 : 			}
; 1888 : 
; 1889 : 			if ( this->BagObject[iDropItemNum].m_isoption != 0 )

  00160	8b 55 08	 mov	 edx, DWORD PTR _iDropItemNum$[ebp]
  00163	80 bc d3 23 02
	00 00 00	 cmp	 BYTE PTR [ebx+edx*8+547], 0
  0016b	74 2b		 je	 SHORT $LN24@DropCrywol

; 1890 : 			{
; 1891 : 				if ( rand()%5 < 1 )

  0016d	e8 00 00 00 00	 call	 _rand
  00172	99		 cdq
  00173	b9 05 00 00 00	 mov	 ecx, 5
  00178	f7 f9		 idiv	 ecx
  0017a	83 fa 01	 cmp	 edx, 1
  0017d	7d 09		 jge	 SHORT $LN3@DropCrywol

; 1892 : 				{
; 1893 : 					iOption3 = 3;

  0017f	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 3

; 1894 : 				}
; 1895 : 				else

  00186	eb 10		 jmp	 SHORT $LN24@DropCrywol
$LN3@DropCrywol:

; 1896 : 				{
; 1897 : 					iOption3 = rand()%3;

  00188	e8 00 00 00 00	 call	 _rand
  0018d	99		 cdq
  0018e	b9 03 00 00 00	 mov	 ecx, 3
  00193	f7 f9		 idiv	 ecx
  00195	89 55 fc	 mov	 DWORD PTR _iOption3$[ebp], edx
$LN24@DropCrywol:

; 1898 : 				}
; 1899 : 			}
; 1900 : 
; 1901 : 			if ( this->BagObject[iDropItemNum].m_isexitem != 0 )

  00198	8b 55 08	 mov	 edx, DWORD PTR _iDropItemNum$[ebp]
  0019b	80 bc d3 24 02
	00 00 00	 cmp	 BYTE PTR [ebx+edx*8+548], 0
  001a3	74 1d		 je	 SHORT $LN25@DropCrywol

; 1902 : 			{
; 1903 : 				iExOption = NewOptionRand(0);

  001a5	6a 00		 push	 0
  001a7	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  001ac	83 c4 04	 add	 esp, 4
  001af	0f b6 d8	 movzx	 ebx, al

; 1904 : #ifndef _FIX_
; 1905 : 				iOption2 = 0;
; 1906 : #endif
; 1907 : 				iOption1 = 1;

  001b2	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1

; 1908 : 				iLevel = 0;

  001b9	c7 45 10 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0
  001c0	eb 03		 jmp	 SHORT $LN1@DropCrywol
$LN25@DropCrywol:
  001c2	8b 5d ec	 mov	 ebx, DWORD PTR _iExOption$[ebp]
$LN1@DropCrywol:

; 1909 : 			}
; 1910 : 
; 1911 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)btMapNumber, (BYTE)X, (BYTE)Y, iType, (BYTE)iLevel, (BYTE)fDur,
; 1912 : 				(BYTE)iOption1, (BYTE)iOption2, (BYTE)iOption3, lpObj->m_Index, (BYTE)iExOption, 0);

  001c5	8b 07		 mov	 eax, DWORD PTR [edi]
  001c7	8b 4d fc	 mov	 ecx, DWORD PTR _iOption3$[ebp]
  001ca	8b 55 f8	 mov	 edx, DWORD PTR _iOption2$[ebp]
  001cd	6a 00		 push	 0
  001cf	53		 push	 ebx
  001d0	50		 push	 eax
  001d1	51		 push	 ecx
  001d2	8b 4d f4	 mov	 ecx, DWORD PTR _iOption1$[ebp]
  001d5	52		 push	 edx
  001d6	8b 55 10	 mov	 edx, DWORD PTR _iLevel$[ebp]
  001d9	51		 push	 ecx
  001da	8b 4d 14	 mov	 ecx, DWORD PTR _Y$[ebp]
  001dd	6a 00		 push	 0
  001df	52		 push	 edx
  001e0	8b 55 f0	 mov	 edx, DWORD PTR _X$[ebp]
  001e3	56		 push	 esi
  001e4	51		 push	 ecx
  001e5	8b 4d 0c	 mov	 ecx, DWORD PTR _btMapNumber$[ebp]
  001e8	52		 push	 edx
  001e9	51		 push	 ecx
  001ea	50		 push	 eax
  001eb	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 1913 : 
; 1914 : 			LogAddTD("[ Crywolf ][Reward] Dark Elf Item Drop [%s][%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d",
; 1915 : 				lpObj->AccountID, lpObj->Name, btMapNumber, X, Y, ItemAttribute[iType].Name,
; 1916 : 				iType, iLevel, iOption1, iOption2, iOption3, iExOption);

  001f0	8b 55 fc	 mov	 edx, DWORD PTR _iOption3$[ebp]
  001f3	8b 45 f8	 mov	 eax, DWORD PTR _iOption2$[ebp]
  001f6	8b 4d f4	 mov	 ecx, DWORD PTR _iOption1$[ebp]
  001f9	53		 push	 ebx
  001fa	52		 push	 edx
  001fb	8b 55 10	 mov	 edx, DWORD PTR _iLevel$[ebp]
  001fe	50		 push	 eax
  001ff	8b 45 14	 mov	 eax, DWORD PTR _Y$[ebp]
  00202	51		 push	 ecx
  00203	8b 4d f0	 mov	 ecx, DWORD PTR _X$[ebp]
  00206	52		 push	 edx
  00207	0f b6 55 0c	 movzx	 edx, BYTE PTR _btMapNumber$[ebp]
  0020b	56		 push	 esi
  0020c	6b f6 70	 imul	 esi, 112		; 00000070H
  0020f	81 c6 00 00 00
	00		 add	 esi, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  00215	56		 push	 esi
  00216	50		 push	 eax
  00217	51		 push	 ecx
  00218	52		 push	 edx
  00219	8d 47 77	 lea	 eax, DWORD PTR [edi+119]
  0021c	50		 push	 eax
  0021d	83 c7 6c	 add	 edi, 108		; 0000006cH
  00220	57		 push	 edi
  00221	68 00 00 00 00	 push	 OFFSET ??_C@_0HA@EIEHAAMC@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Dark?5Elf?5Ite@
  00226	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  0022c	83 c4 68	 add	 esp, 104		; 00000068H
  0022f	5e		 pop	 esi
  00230	5f		 pop	 edi

; 1917 : 
; 1918 : 			return TRUE;

  00231	b8 01 00 00 00	 mov	 eax, 1
  00236	5b		 pop	 ebx

; 1923 : 
; 1924 : 
; 1925 : }

  00237	8b e5		 mov	 esp, ebp
  00239	5d		 pop	 ebp
  0023a	c2 10 00	 ret	 16			; 00000010H
?DropCrywolfDarkElfItem@CItemBagZt@@QAEHHEEE@Z ENDP	; CItemBagZt::DropCrywolfDarkElfItem
_TEXT	ENDS
PUBLIC	??_C@_0HE@LHMNDJDE@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Boss?5Monster@ ; `string'
PUBLIC	??_C@_0DN@DJADCOFL@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Boss?5Monster@ ; `string'
PUBLIC	?DropCrywolfBossMonsterItem@CItemBagZt@@QAEHHEEE@Z ; CItemBagZt::DropCrywolfBossMonsterItem
EXTRN	?g_iCrywolfBossMonsterDropZen@@3HA:DWORD	; g_iCrywolfBossMonsterDropZen
EXTRN	?g_iCrywolfBossMonsterDropZenRate@@3HA:DWORD	; g_iCrywolfBossMonsterDropZenRate
;	COMDAT ??_C@_0HE@LHMNDJDE@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Boss?5Monster@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0HE@LHMNDJDE@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Boss?5Monster@ DB '['
	DB	' Crywolf ][Reward] Boss Monster Item Drop [%s][%s] : (%d)(%d/'
	DB	'%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0DN@DJADCOFL@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Boss?5Monster@
CONST	SEGMENT
??_C@_0DN@DJADCOFL@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Boss?5Monster@ DB '['
	DB	' Crywolf ][Reward] Boss Monster Item Drop [%s][%s] [%d Zen]', 00H ; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropCrywolfBossMonsterItem@CItemBagZt@@QAEHHEEE@Z
_TEXT	SEGMENT
_iExOption$ = -20					; size = 4
_X$ = -16						; size = 4
_iOption1$ = -12					; size = 4
_iOption2$ = -8						; size = 4
_iOption3$ = -4						; size = 4
_iDropItemNum$ = 8					; size = 4
_aIndex$ = 8						; size = 4
_btMapNumber$ = 12					; size = 1
_iLevel$ = 16						; size = 4
_cX$ = 16						; size = 1
_Y$ = 20						; size = 4
_cY$ = 20						; size = 1
?DropCrywolfBossMonsterItem@CItemBagZt@@QAEHHEEE@Z PROC	; CItemBagZt::DropCrywolfBossMonsterItem, COMDAT
; _this$ = ecx

; 1931 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 14	 sub	 esp, 20			; 00000014H
  00006	53		 push	 ebx
  00007	8b d9		 mov	 ebx, ecx

; 1932 : 	if ( this->m_bLoad == FALSE )

  00009	33 c0		 xor	 eax, eax
  0000b	39 43 04	 cmp	 DWORD PTR [ebx+4], eax
  0000e	75 07		 jne	 SHORT $LN14@DropCrywol@2
  00010	5b		 pop	 ebx

; 2028 : }

  00011	8b e5		 mov	 esp, ebp
  00013	5d		 pop	 ebp
  00014	c2 10 00	 ret	 16			; 00000010H
$LN14@DropCrywol@2:
  00017	57		 push	 edi

; 1933 : 		return FALSE;
; 1934 : 
; 1935 : 	float fDur = 0;
; 1936 : 	int iType = 0;
; 1937 : 	int iLevel = 0;
; 1938 : 	int X = 0;
; 1939 : 	int Y = 0;
; 1940 : 	int iOption1 = 0;
; 1941 : 	int iOption2 = 0;
; 1942 : 	int iOption3 = 0;
; 1943 : 	int iDropItemNum = 0;
; 1944 : 	int iDropItemRate = 0;
; 1945 : 	int iExOption = 0;
; 1946 : 	LPOBJ lpObj = &gObj[aIndex];

  00018	8b 7d 08	 mov	 edi, DWORD PTR _aIndex$[ebp]
  0001b	69 ff 50 2b 00
	00		 imul	 edi, 11088		; 00002b50H
  00021	03 3d 00 00 00
	00		 add	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00027	89 45 f4	 mov	 DWORD PTR _iOption1$[ebp], eax
  0002a	89 45 f8	 mov	 DWORD PTR _iOption2$[ebp], eax
  0002d	89 45 fc	 mov	 DWORD PTR _iOption3$[ebp], eax
  00030	89 45 ec	 mov	 DWORD PTR _iExOption$[ebp], eax

; 1947 : 
; 1948 : 	if ( this->GetBagCount() > 0 )

  00033	39 83 20 01 00
	00		 cmp	 DWORD PTR [ebx+288], eax
  00039	7e 5b		 jle	 SHORT $LN11@DropCrywol@2

; 1949 : 	{
; 1950 : 		iDropItemRate = rand() % 10000;

  0003b	e8 00 00 00 00	 call	 _rand
  00040	99		 cdq
  00041	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  00046	f7 f9		 idiv	 ecx

; 1951 : 
; 1952 : 		if ( iDropItemRate < g_iCrywolfBossMonsterDropZenRate ) 

  00048	3b 15 00 00 00
	00		 cmp	 edx, DWORD PTR ?g_iCrywolfBossMonsterDropZenRate@@3HA ; g_iCrywolfBossMonsterDropZenRate
  0004e	7d 53		 jge	 SHORT $LN12@DropCrywol@2

; 1953 : 		{
; 1954 : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iCrywolfBossMonsterDropZen, cX, cY);

  00050	0f b6 55 14	 movzx	 edx, BYTE PTR _cY$[ebp]
  00054	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  00058	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iCrywolfBossMonsterDropZen@@3HA ; g_iCrywolfBossMonsterDropZen
  0005e	52		 push	 edx
  0005f	50		 push	 eax
  00060	51		 push	 ecx
  00061	0f b6 8f 49 01
	00 00		 movzx	 ecx, BYTE PTR [edi+329]
  00068	69 c9 48 3d 05
	00		 imul	 ecx, 343368		; 00053d48H
  0006e	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  00074	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 1955 : 
; 1956 : 			LogAddTD("[ Crywolf ][Reward] Boss Monster Item Drop [%s][%s] [%d Zen]",
; 1957 : 				lpObj->AccountID, lpObj->Name, g_iCrywolfBossMonsterDropZen);

  00079	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?g_iCrywolfBossMonsterDropZen@@3HA ; g_iCrywolfBossMonsterDropZen
  0007f	52		 push	 edx
  00080	8d 47 77	 lea	 eax, DWORD PTR [edi+119]
  00083	50		 push	 eax
  00084	83 c7 6c	 add	 edi, 108		; 0000006cH
  00087	57		 push	 edi
  00088	68 00 00 00 00	 push	 OFFSET ??_C@_0DN@DJADCOFL@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Boss?5Monster@
  0008d	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  00093	83 c4 10	 add	 esp, 16			; 00000010H
$LN11@DropCrywol@2:

; 2024 : 		}
; 2025 : 	}
; 2026 : 
; 2027 : 	return TRUE;

  00096	5f		 pop	 edi
  00097	b8 01 00 00 00	 mov	 eax, 1
  0009c	5b		 pop	 ebx

; 2028 : }

  0009d	8b e5		 mov	 esp, ebp
  0009f	5d		 pop	 ebp
  000a0	c2 10 00	 ret	 16			; 00000010H
$LN12@DropCrywol@2:
  000a3	56		 push	 esi

; 1958 : 		}
; 1959 : 		else
; 1960 : 		{
; 1961 : 			iDropItemNum = rand()% this->GetBagCount();

  000a4	8b b3 20 01 00
	00		 mov	 esi, DWORD PTR [ebx+288]
  000aa	e8 00 00 00 00	 call	 _rand
  000af	99		 cdq
  000b0	f7 fe		 idiv	 esi

; 1962 : 			fDur = 0;
; 1963 : 
; 1964 : 			if ( cX == 0 && cY == 0 )

  000b2	8a 45 10	 mov	 al, BYTE PTR _cX$[ebp]
  000b5	8a 4d 14	 mov	 cl, BYTE PTR _cY$[ebp]
  000b8	8b f2		 mov	 esi, edx
  000ba	89 75 08	 mov	 DWORD PTR _iDropItemNum$[ebp], esi
  000bd	84 c0		 test	 al, al
  000bf	75 1a		 jne	 SHORT $LN10@DropCrywol@2
  000c1	84 c9		 test	 cl, cl
  000c3	75 16		 jne	 SHORT $LN10@DropCrywol@2

; 1965 : 			{
; 1966 : 				X = lpObj->X;

  000c5	0f bf 8f 44 01
	00 00		 movsx	 ecx, WORD PTR [edi+324]

; 1967 : 				Y = lpObj->Y;

  000cc	0f bf 97 46 01
	00 00		 movsx	 edx, WORD PTR [edi+326]
  000d3	89 4d f0	 mov	 DWORD PTR _X$[ebp], ecx
  000d6	89 55 14	 mov	 DWORD PTR _Y$[ebp], edx

; 1968 : 			}
; 1969 : 			else

  000d9	eb 0c		 jmp	 SHORT $LN9@DropCrywol@2
$LN10@DropCrywol@2:

; 1970 : 			{
; 1971 : 				X = cX;

  000db	0f b6 c0	 movzx	 eax, al

; 1972 : 				Y = cY;

  000de	0f b6 c9	 movzx	 ecx, cl
  000e1	89 45 f0	 mov	 DWORD PTR _X$[ebp], eax
  000e4	89 4d 14	 mov	 DWORD PTR _Y$[ebp], ecx
$LN9@DropCrywol@2:

; 1973 : 			}
; 1974 : 
; 1975 : 			iLevel = this->GetLevel(iDropItemNum);

  000e7	56		 push	 esi
  000e8	8b cb		 mov	 ecx, ebx
  000ea	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel

; 1976 : 			iType = ItemGetNumberMake(this->BagObject[iDropItemNum].m_type, this->BagObject[iDropItemNum].m_index);

  000ef	0f b6 8c f3 1d
	02 00 00	 movzx	 ecx, BYTE PTR [ebx+esi*8+541]
  000f7	0f b6 d0	 movzx	 edx, al
  000fa	0f b6 84 f3 1e
	02 00 00	 movzx	 eax, BYTE PTR [ebx+esi*8+542]
  00102	50		 push	 eax
  00103	51		 push	 ecx
  00104	89 55 10	 mov	 DWORD PTR _iLevel$[ebp], edx
  00107	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  0010c	8b f0		 mov	 esi, eax
  0010e	83 c4 08	 add	 esp, 8

; 1977 : 
; 1978 : 			if ( iType == -1 )

  00111	83 fe ff	 cmp	 esi, -1
  00114	75 0b		 jne	 SHORT $LN8@DropCrywol@2

; 1979 : 				return FALSE;

  00116	5e		 pop	 esi
  00117	5f		 pop	 edi
  00118	33 c0		 xor	 eax, eax
  0011a	5b		 pop	 ebx

; 2028 : }

  0011b	8b e5		 mov	 esp, ebp
  0011d	5d		 pop	 ebp
  0011e	c2 10 00	 ret	 16			; 00000010H
$LN8@DropCrywol@2:

; 1980 : 
; 1981 : 			if ( this->BagObject[iDropItemNum].m_isskill )

  00121	8b 45 08	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  00124	80 bc c3 21 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+545], 0
  0012c	74 07		 je	 SHORT $LN21@DropCrywol@2

; 1982 : 				iOption1 = 1;

  0012e	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1
$LN21@DropCrywol@2:

; 1983 : 
; 1984 : 			if ( this->BagObject[iDropItemNum].m_isluck )

  00135	80 bc c3 22 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+546], 0
  0013d	74 21		 je	 SHORT $LN22@DropCrywol@2

; 1985 : 			{
; 1986 : 				iOption2 = 0;

  0013f	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 1987 : 
; 1988 : 				if ( (rand()%2) == 0 )

  00146	e8 00 00 00 00	 call	 _rand
  0014b	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  00150	79 05		 jns	 SHORT $LN28@DropCrywol@2
  00152	48		 dec	 eax
  00153	83 c8 fe	 or	 eax, -2			; fffffffeH
  00156	40		 inc	 eax
$LN28@DropCrywol@2:
  00157	75 07		 jne	 SHORT $LN22@DropCrywol@2

; 1989 : 				{
; 1990 : 					iOption2 = 1;

  00159	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 1
$LN22@DropCrywol@2:

; 1991 : 				}
; 1992 : 			}
; 1993 : 
; 1994 : 			if ( this->BagObject[iDropItemNum].m_isoption != 0 )

  00160	8b 55 08	 mov	 edx, DWORD PTR _iDropItemNum$[ebp]
  00163	80 bc d3 23 02
	00 00 00	 cmp	 BYTE PTR [ebx+edx*8+547], 0
  0016b	74 2b		 je	 SHORT $LN24@DropCrywol@2

; 1995 : 			{
; 1996 : 				if ( rand()%5 < 1 )

  0016d	e8 00 00 00 00	 call	 _rand
  00172	99		 cdq
  00173	b9 05 00 00 00	 mov	 ecx, 5
  00178	f7 f9		 idiv	 ecx
  0017a	83 fa 01	 cmp	 edx, 1
  0017d	7d 09		 jge	 SHORT $LN3@DropCrywol@2

; 1997 : 				{
; 1998 : 					iOption3 = 3;

  0017f	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 3

; 1999 : 				}
; 2000 : 				else

  00186	eb 10		 jmp	 SHORT $LN24@DropCrywol@2
$LN3@DropCrywol@2:

; 2001 : 				{
; 2002 : 					iOption3 = rand()%3;

  00188	e8 00 00 00 00	 call	 _rand
  0018d	99		 cdq
  0018e	b9 03 00 00 00	 mov	 ecx, 3
  00193	f7 f9		 idiv	 ecx
  00195	89 55 fc	 mov	 DWORD PTR _iOption3$[ebp], edx
$LN24@DropCrywol@2:

; 2003 : 				}
; 2004 : 			}
; 2005 : 
; 2006 : 			if ( this->BagObject[iDropItemNum].m_isexitem != 0 )

  00198	8b 55 08	 mov	 edx, DWORD PTR _iDropItemNum$[ebp]
  0019b	80 bc d3 24 02
	00 00 00	 cmp	 BYTE PTR [ebx+edx*8+548], 0
  001a3	74 1d		 je	 SHORT $LN25@DropCrywol@2

; 2007 : 			{
; 2008 : 				iExOption = NewOptionRand(0);

  001a5	6a 00		 push	 0
  001a7	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  001ac	83 c4 04	 add	 esp, 4
  001af	0f b6 d8	 movzx	 ebx, al

; 2009 : #ifndef _FIX_
; 2010 : 				iOption2 = 0;
; 2011 : #endif
; 2012 : 				iOption1 = 1;

  001b2	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1

; 2013 : 				iLevel = 0;

  001b9	c7 45 10 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0
  001c0	eb 03		 jmp	 SHORT $LN1@DropCrywol@2
$LN25@DropCrywol@2:
  001c2	8b 5d ec	 mov	 ebx, DWORD PTR _iExOption$[ebp]
$LN1@DropCrywol@2:

; 2014 : 			}
; 2015 : 
; 2016 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)btMapNumber, (BYTE)X, (BYTE)Y, iType, (BYTE)iLevel, (BYTE)fDur,
; 2017 : 				(BYTE)iOption1, (BYTE)iOption2, (BYTE)iOption3, lpObj->m_Index, (BYTE)iExOption, 0);

  001c5	8b 07		 mov	 eax, DWORD PTR [edi]
  001c7	8b 4d fc	 mov	 ecx, DWORD PTR _iOption3$[ebp]
  001ca	8b 55 f8	 mov	 edx, DWORD PTR _iOption2$[ebp]
  001cd	6a 00		 push	 0
  001cf	53		 push	 ebx
  001d0	50		 push	 eax
  001d1	51		 push	 ecx
  001d2	8b 4d f4	 mov	 ecx, DWORD PTR _iOption1$[ebp]
  001d5	52		 push	 edx
  001d6	8b 55 10	 mov	 edx, DWORD PTR _iLevel$[ebp]
  001d9	51		 push	 ecx
  001da	8b 4d 14	 mov	 ecx, DWORD PTR _Y$[ebp]
  001dd	6a 00		 push	 0
  001df	52		 push	 edx
  001e0	8b 55 f0	 mov	 edx, DWORD PTR _X$[ebp]
  001e3	56		 push	 esi
  001e4	51		 push	 ecx
  001e5	8b 4d 0c	 mov	 ecx, DWORD PTR _btMapNumber$[ebp]
  001e8	52		 push	 edx
  001e9	51		 push	 ecx
  001ea	50		 push	 eax
  001eb	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 2018 : 
; 2019 : 			LogAddTD("[ Crywolf ][Reward] Boss Monster Item Drop [%s][%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d",
; 2020 : 				lpObj->AccountID, lpObj->Name, btMapNumber, X, Y, ItemAttribute[iType].Name,
; 2021 : 				iType, iLevel, iOption1, iOption2, iOption3, iExOption);

  001f0	8b 55 fc	 mov	 edx, DWORD PTR _iOption3$[ebp]
  001f3	8b 45 f8	 mov	 eax, DWORD PTR _iOption2$[ebp]
  001f6	8b 4d f4	 mov	 ecx, DWORD PTR _iOption1$[ebp]
  001f9	53		 push	 ebx
  001fa	52		 push	 edx
  001fb	8b 55 10	 mov	 edx, DWORD PTR _iLevel$[ebp]
  001fe	50		 push	 eax
  001ff	8b 45 14	 mov	 eax, DWORD PTR _Y$[ebp]
  00202	51		 push	 ecx
  00203	8b 4d f0	 mov	 ecx, DWORD PTR _X$[ebp]
  00206	52		 push	 edx
  00207	0f b6 55 0c	 movzx	 edx, BYTE PTR _btMapNumber$[ebp]
  0020b	56		 push	 esi
  0020c	6b f6 70	 imul	 esi, 112		; 00000070H
  0020f	81 c6 00 00 00
	00		 add	 esi, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  00215	56		 push	 esi
  00216	50		 push	 eax
  00217	51		 push	 ecx
  00218	52		 push	 edx
  00219	8d 47 77	 lea	 eax, DWORD PTR [edi+119]
  0021c	50		 push	 eax
  0021d	83 c7 6c	 add	 edi, 108		; 0000006cH
  00220	57		 push	 edi
  00221	68 00 00 00 00	 push	 OFFSET ??_C@_0HE@LHMNDJDE@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Boss?5Monster@
  00226	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  0022c	83 c4 68	 add	 esp, 104		; 00000068H
  0022f	5e		 pop	 esi
  00230	5f		 pop	 edi

; 2022 : 
; 2023 : 			return TRUE;

  00231	b8 01 00 00 00	 mov	 eax, 1
  00236	5b		 pop	 ebx

; 2028 : }

  00237	8b e5		 mov	 esp, ebp
  00239	5d		 pop	 ebp
  0023a	c2 10 00	 ret	 16			; 00000010H
?DropCrywolfBossMonsterItem@CItemBagZt@@QAEHHEEE@Z ENDP	; CItemBagZt::DropCrywolfBossMonsterItem
_TEXT	ENDS
PUBLIC	??_C@_0HC@MEHIGOLO@?$FL?5KANTURU?5?$FN?$FL?5Reward?5?$FN?5MayaHand?5I@ ; `string'
PUBLIC	?DropKanturuMayaHandItem@CItemBagZt@@QAEHHEEE@Z	; CItemBagZt::DropKanturuMayaHandItem
;	COMDAT ??_C@_0HC@MEHIGOLO@?$FL?5KANTURU?5?$FN?$FL?5Reward?5?$FN?5MayaHand?5I@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0HC@MEHIGOLO@?$FL?5KANTURU?5?$FN?$FL?5Reward?5?$FN?5MayaHand?5I@ DB '['
	DB	' KANTURU ][ Reward ] MayaHand Item Drop [%s][%s] : (%d)(%d/%d'
	DB	') Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d', 00H ; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropKanturuMayaHandItem@CItemBagZt@@QAEHHEEE@Z
_TEXT	SEGMENT
_X$ = -20						; size = 4
_iExOption$ = -16					; size = 4
_iOption1$ = -12					; size = 4
_iOption2$ = -8						; size = 4
_iOption3$ = -4						; size = 4
_iDropItemNum$ = 8					; size = 4
_aIndex$ = 8						; size = 4
_btMapNumber$ = 12					; size = 1
_iLevel$ = 16						; size = 4
_cX$ = 16						; size = 1
_Y$ = 20						; size = 4
_cY$ = 20						; size = 1
?DropKanturuMayaHandItem@CItemBagZt@@QAEHHEEE@Z PROC	; CItemBagZt::DropKanturuMayaHandItem, COMDAT
; _this$ = ecx

; 2033 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 14	 sub	 esp, 20			; 00000014H
  00006	53		 push	 ebx
  00007	8b d9		 mov	 ebx, ecx

; 2034 : 	if ( this->m_bLoad == FALSE )

  00009	33 c0		 xor	 eax, eax
  0000b	39 43 04	 cmp	 DWORD PTR [ebx+4], eax
  0000e	75 07		 jne	 SHORT $LN12@DropKantur
  00010	5b		 pop	 ebx

; 2118 : }

  00011	8b e5		 mov	 esp, ebp
  00013	5d		 pop	 ebp
  00014	c2 10 00	 ret	 16			; 00000010H
$LN12@DropKantur:
  00017	56		 push	 esi

; 2035 : 		return FALSE;
; 2036 : 
; 2037 : 	float fDur = 0;
; 2038 : 	int iType = 0;
; 2039 : 	int iLevel = 0;
; 2040 : 	int X = 0;
; 2041 : 	int Y = 0;
; 2042 : 	int iOption1 = 0;
; 2043 : 	int iOption2 = 0;
; 2044 : 	int iOption3 = 0;
; 2045 : 	int iDropItemNum = 0;
; 2046 : 	int iDropItemRate = 0;
; 2047 : 	int iExOption = 0;
; 2048 : 	LPOBJ lpObj = &gObj[aIndex];
; 2049 : 
; 2050 : 	if ( this->GetBagCount() > 0 )

  00018	8b b3 20 01 00
	00		 mov	 esi, DWORD PTR [ebx+288]
  0001e	57		 push	 edi
  0001f	8b 7d 08	 mov	 edi, DWORD PTR _aIndex$[ebp]
  00022	69 ff 50 2b 00
	00		 imul	 edi, 11088		; 00002b50H
  00028	03 3d 00 00 00
	00		 add	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0002e	89 45 f4	 mov	 DWORD PTR _iOption1$[ebp], eax
  00031	89 45 f8	 mov	 DWORD PTR _iOption2$[ebp], eax
  00034	89 45 fc	 mov	 DWORD PTR _iOption3$[ebp], eax
  00037	89 45 f0	 mov	 DWORD PTR _iExOption$[ebp], eax
  0003a	3b f0		 cmp	 esi, eax
  0003c	0f 8e 88 01 00
	00		 jle	 $LN11@DropKantur

; 2051 : 	{
; 2052 : 		iDropItemNum = rand()% this->GetBagCount();

  00042	e8 00 00 00 00	 call	 _rand
  00047	99		 cdq
  00048	f7 fe		 idiv	 esi

; 2053 : 		fDur = 0;
; 2054 : 
; 2055 : 		if ( cX == 0 && cY == 0 )

  0004a	8a 45 10	 mov	 al, BYTE PTR _cX$[ebp]
  0004d	8a 4d 14	 mov	 cl, BYTE PTR _cY$[ebp]
  00050	8b f2		 mov	 esi, edx
  00052	89 75 08	 mov	 DWORD PTR _iDropItemNum$[ebp], esi
  00055	84 c0		 test	 al, al
  00057	75 1a		 jne	 SHORT $LN10@DropKantur
  00059	84 c9		 test	 cl, cl
  0005b	75 16		 jne	 SHORT $LN10@DropKantur

; 2056 : 		{
; 2057 : 			X = lpObj->X;

  0005d	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]

; 2058 : 			Y = lpObj->Y;

  00064	0f bf 8f 46 01
	00 00		 movsx	 ecx, WORD PTR [edi+326]
  0006b	89 45 ec	 mov	 DWORD PTR _X$[ebp], eax
  0006e	89 4d 14	 mov	 DWORD PTR _Y$[ebp], ecx

; 2059 : 		}
; 2060 : 		else

  00071	eb 0c		 jmp	 SHORT $LN9@DropKantur
$LN10@DropKantur:

; 2061 : 		{
; 2062 : 			X = cX;

  00073	0f b6 d0	 movzx	 edx, al

; 2063 : 			Y = cY;

  00076	0f b6 c1	 movzx	 eax, cl
  00079	89 55 ec	 mov	 DWORD PTR _X$[ebp], edx
  0007c	89 45 14	 mov	 DWORD PTR _Y$[ebp], eax
$LN9@DropKantur:

; 2064 : 		}
; 2065 : 
; 2066 : 		iLevel = this->GetLevel(iDropItemNum);

  0007f	56		 push	 esi
  00080	8b cb		 mov	 ecx, ebx
  00082	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel

; 2067 : 		iType = ItemGetNumberMake(this->BagObject[iDropItemNum].m_type, this->BagObject[iDropItemNum].m_index);

  00087	0f b6 94 f3 1e
	02 00 00	 movzx	 edx, BYTE PTR [ebx+esi*8+542]
  0008f	0f b6 c8	 movzx	 ecx, al
  00092	0f b6 84 f3 1d
	02 00 00	 movzx	 eax, BYTE PTR [ebx+esi*8+541]
  0009a	52		 push	 edx
  0009b	50		 push	 eax
  0009c	89 4d 10	 mov	 DWORD PTR _iLevel$[ebp], ecx
  0009f	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  000a4	8b f0		 mov	 esi, eax
  000a6	83 c4 08	 add	 esp, 8

; 2068 : 
; 2069 : 		if ( iType == -1 )

  000a9	83 fe ff	 cmp	 esi, -1
  000ac	75 0b		 jne	 SHORT $LN8@DropKantur

; 2070 : 			return FALSE;

  000ae	5f		 pop	 edi
  000af	5e		 pop	 esi
  000b0	33 c0		 xor	 eax, eax
  000b2	5b		 pop	 ebx

; 2118 : }

  000b3	8b e5		 mov	 esp, ebp
  000b5	5d		 pop	 ebp
  000b6	c2 10 00	 ret	 16			; 00000010H
$LN8@DropKantur:

; 2071 : 
; 2072 : 		if ( this->BagObject[iDropItemNum].m_isskill )

  000b9	8b 45 08	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  000bc	80 bc c3 21 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+545], 0
  000c4	74 07		 je	 SHORT $LN19@DropKantur

; 2073 : 			iOption1 = 1;

  000c6	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1
$LN19@DropKantur:

; 2074 : 
; 2075 : 		if ( this->BagObject[iDropItemNum].m_isluck )

  000cd	80 bc c3 22 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+546], 0
  000d5	74 21		 je	 SHORT $LN20@DropKantur

; 2076 : 		{
; 2077 : 			iOption2 = 0;

  000d7	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 2078 : 
; 2079 : 			if ( (rand()%2) == 0 )

  000de	e8 00 00 00 00	 call	 _rand
  000e3	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  000e8	79 05		 jns	 SHORT $LN24@DropKantur
  000ea	48		 dec	 eax
  000eb	83 c8 fe	 or	 eax, -2			; fffffffeH
  000ee	40		 inc	 eax
$LN24@DropKantur:
  000ef	75 07		 jne	 SHORT $LN20@DropKantur

; 2080 : 			{
; 2081 : 				iOption2 = 1;

  000f1	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 1
$LN20@DropKantur:

; 2082 : 			}
; 2083 : 		}
; 2084 : 
; 2085 : 		if ( this->BagObject[iDropItemNum].m_isoption != 0 )

  000f8	8b 4d 08	 mov	 ecx, DWORD PTR _iDropItemNum$[ebp]
  000fb	80 bc cb 23 02
	00 00 00	 cmp	 BYTE PTR [ebx+ecx*8+547], 0
  00103	74 2b		 je	 SHORT $LN2@DropKantur

; 2086 : 		{
; 2087 : 			if ( rand()%5 < 1 )

  00105	e8 00 00 00 00	 call	 _rand
  0010a	99		 cdq
  0010b	b9 05 00 00 00	 mov	 ecx, 5
  00110	f7 f9		 idiv	 ecx
  00112	83 fa 01	 cmp	 edx, 1
  00115	7d 09		 jge	 SHORT $LN3@DropKantur

; 2088 : 			{
; 2089 : 				iOption3 = 3;

  00117	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 3

; 2090 : 			}
; 2091 : 			else

  0011e	eb 10		 jmp	 SHORT $LN2@DropKantur
$LN3@DropKantur:

; 2092 : 			{
; 2093 : 				iOption3 = rand()%3;

  00120	e8 00 00 00 00	 call	 _rand
  00125	99		 cdq
  00126	b9 03 00 00 00	 mov	 ecx, 3
  0012b	f7 f9		 idiv	 ecx
  0012d	89 55 fc	 mov	 DWORD PTR _iOption3$[ebp], edx
$LN2@DropKantur:

; 2094 : 			}
; 2095 : 		}
; 2096 : 
; 2097 : 		if ( this->BagObject[iDropItemNum].m_isexitem != 0 )

  00130	8b 55 08	 mov	 edx, DWORD PTR _iDropItemNum$[ebp]
  00133	80 bc d3 24 02
	00 00 00	 cmp	 BYTE PTR [ebx+edx*8+548], 0
  0013b	74 1e		 je	 SHORT $LN21@DropKantur

; 2098 : 		{
; 2099 : 			iExOption = NewOptionRand(0);

  0013d	6a 00		 push	 0
  0013f	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  00144	0f b6 c0	 movzx	 eax, al
  00147	83 c4 04	 add	 esp, 4
  0014a	89 45 f0	 mov	 DWORD PTR _iExOption$[ebp], eax

; 2100 : #ifndef _FIX_
; 2101 : 			iOption2 = 0;
; 2102 : #endif
; 2103 : 			iOption1 = 1;

  0014d	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1

; 2104 : 			iLevel = 0;

  00154	c7 45 10 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0
$LN21@DropKantur:

; 2105 : 		}
; 2106 : 
; 2107 : 		ItemSerialCreateSend(lpObj->m_Index, (BYTE)btMapNumber, (BYTE)X, (BYTE)Y, iType, (BYTE)iLevel, (BYTE)fDur,
; 2108 : 			(BYTE)iOption1, (BYTE)iOption2, (BYTE)iOption3, lpObj->m_Index, (BYTE)iExOption, 0);

  0015b	8b 4d f0	 mov	 ecx, DWORD PTR _iExOption$[ebp]
  0015e	8b 07		 mov	 eax, DWORD PTR [edi]
  00160	8b 55 fc	 mov	 edx, DWORD PTR _iOption3$[ebp]
  00163	8b 5d 0c	 mov	 ebx, DWORD PTR _btMapNumber$[ebp]
  00166	6a 00		 push	 0
  00168	51		 push	 ecx
  00169	8b 4d f8	 mov	 ecx, DWORD PTR _iOption2$[ebp]
  0016c	50		 push	 eax
  0016d	52		 push	 edx
  0016e	8b 55 f4	 mov	 edx, DWORD PTR _iOption1$[ebp]
  00171	51		 push	 ecx
  00172	8b 4d 10	 mov	 ecx, DWORD PTR _iLevel$[ebp]
  00175	52		 push	 edx
  00176	8b 55 14	 mov	 edx, DWORD PTR _Y$[ebp]
  00179	6a 00		 push	 0
  0017b	51		 push	 ecx
  0017c	8b 4d ec	 mov	 ecx, DWORD PTR _X$[ebp]
  0017f	56		 push	 esi
  00180	52		 push	 edx
  00181	51		 push	 ecx
  00182	53		 push	 ebx
  00183	50		 push	 eax
  00184	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 2109 : 
; 2110 : 		LogAddTD("[ KANTURU ][ Reward ] MayaHand Item Drop [%s][%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d",
; 2111 : 			lpObj->AccountID, lpObj->Name, btMapNumber, X, Y, ItemAttribute[iType].Name,
; 2112 : 			iType, iLevel, iOption1, iOption2, iOption3, iExOption);

  00189	8b 55 f0	 mov	 edx, DWORD PTR _iExOption$[ebp]
  0018c	8b 45 fc	 mov	 eax, DWORD PTR _iOption3$[ebp]
  0018f	8b 4d f8	 mov	 ecx, DWORD PTR _iOption2$[ebp]
  00192	52		 push	 edx
  00193	8b 55 f4	 mov	 edx, DWORD PTR _iOption1$[ebp]
  00196	50		 push	 eax
  00197	8b 45 10	 mov	 eax, DWORD PTR _iLevel$[ebp]
  0019a	51		 push	 ecx
  0019b	8b 4d 14	 mov	 ecx, DWORD PTR _Y$[ebp]
  0019e	52		 push	 edx
  0019f	8b 55 ec	 mov	 edx, DWORD PTR _X$[ebp]
  001a2	50		 push	 eax
  001a3	56		 push	 esi
  001a4	6b f6 70	 imul	 esi, 112		; 00000070H
  001a7	81 c6 00 00 00
	00		 add	 esi, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  001ad	56		 push	 esi
  001ae	51		 push	 ecx
  001af	52		 push	 edx
  001b0	0f b6 c3	 movzx	 eax, bl
  001b3	50		 push	 eax
  001b4	8d 4f 77	 lea	 ecx, DWORD PTR [edi+119]
  001b7	51		 push	 ecx
  001b8	83 c7 6c	 add	 edi, 108		; 0000006cH
  001bb	57		 push	 edi
  001bc	68 00 00 00 00	 push	 OFFSET ??_C@_0HC@MEHIGOLO@?$FL?5KANTURU?5?$FN?$FL?5Reward?5?$FN?5MayaHand?5I@
  001c1	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  001c7	83 c4 68	 add	 esp, 104		; 00000068H
$LN11@DropKantur:

; 2113 : 
; 2114 : 		return TRUE;
; 2115 : 	}
; 2116 : 
; 2117 : 	return TRUE;

  001ca	5f		 pop	 edi
  001cb	5e		 pop	 esi
  001cc	b8 01 00 00 00	 mov	 eax, 1
  001d1	5b		 pop	 ebx

; 2118 : }

  001d2	8b e5		 mov	 esp, ebp
  001d4	5d		 pop	 ebp
  001d5	c2 10 00	 ret	 16			; 00000010H
?DropKanturuMayaHandItem@CItemBagZt@@QAEHHEEE@Z ENDP	; CItemBagZt::DropKanturuMayaHandItem
_TEXT	ENDS
PUBLIC	??_C@_0HD@MEBEJHHD@?$FL?5KANTURU?5?$FN?$FL?5Reward?5?$FN?5Nightmare?5@ ; `string'
PUBLIC	?DropKanturuNightmareItem@CItemBagZt@@QAEHHEEE@Z ; CItemBagZt::DropKanturuNightmareItem
;	COMDAT ??_C@_0HD@MEBEJHHD@?$FL?5KANTURU?5?$FN?$FL?5Reward?5?$FN?5Nightmare?5@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0HD@MEBEJHHD@?$FL?5KANTURU?5?$FN?$FL?5Reward?5?$FN?5Nightmare?5@ DB '['
	DB	' KANTURU ][ Reward ] Nightmare Item Drop [%s][%s] : (%d)(%d/%'
	DB	'd) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d', 00H ; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropKanturuNightmareItem@CItemBagZt@@QAEHHEEE@Z
_TEXT	SEGMENT
_X$ = -20						; size = 4
_iExOption$ = -16					; size = 4
_iOption1$ = -12					; size = 4
_iOption2$ = -8						; size = 4
_iOption3$ = -4						; size = 4
_iDropItemNum$ = 8					; size = 4
_aIndex$ = 8						; size = 4
_btMapNumber$ = 12					; size = 1
_iLevel$ = 16						; size = 4
_cX$ = 16						; size = 1
_Y$ = 20						; size = 4
_cY$ = 20						; size = 1
?DropKanturuNightmareItem@CItemBagZt@@QAEHHEEE@Z PROC	; CItemBagZt::DropKanturuNightmareItem, COMDAT
; _this$ = ecx

; 2122 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 14	 sub	 esp, 20			; 00000014H
  00006	53		 push	 ebx
  00007	8b d9		 mov	 ebx, ecx

; 2123 : 	if ( this->m_bLoad == FALSE )

  00009	33 c0		 xor	 eax, eax
  0000b	39 43 04	 cmp	 DWORD PTR [ebx+4], eax
  0000e	75 07		 jne	 SHORT $LN12@DropKantur@2
  00010	5b		 pop	 ebx

; 2207 : }

  00011	8b e5		 mov	 esp, ebp
  00013	5d		 pop	 ebp
  00014	c2 10 00	 ret	 16			; 00000010H
$LN12@DropKantur@2:
  00017	56		 push	 esi

; 2124 : 		return FALSE;
; 2125 : 
; 2126 : 	float fDur = 0;
; 2127 : 	int iType = 0;
; 2128 : 	int iLevel = 0;
; 2129 : 	int X = 0;
; 2130 : 	int Y = 0;
; 2131 : 	int iOption1 = 0;
; 2132 : 	int iOption2 = 0;
; 2133 : 	int iOption3 = 0;
; 2134 : 	int iDropItemNum = 0;
; 2135 : 	int iDropItemRate = 0;
; 2136 : 	int iExOption = 0;
; 2137 : 	LPOBJ lpObj = &gObj[aIndex];
; 2138 : 
; 2139 : 	if ( this->GetBagCount() > 0 )

  00018	8b b3 20 01 00
	00		 mov	 esi, DWORD PTR [ebx+288]
  0001e	57		 push	 edi
  0001f	8b 7d 08	 mov	 edi, DWORD PTR _aIndex$[ebp]
  00022	69 ff 50 2b 00
	00		 imul	 edi, 11088		; 00002b50H
  00028	03 3d 00 00 00
	00		 add	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0002e	89 45 f4	 mov	 DWORD PTR _iOption1$[ebp], eax
  00031	89 45 f8	 mov	 DWORD PTR _iOption2$[ebp], eax
  00034	89 45 fc	 mov	 DWORD PTR _iOption3$[ebp], eax
  00037	89 45 f0	 mov	 DWORD PTR _iExOption$[ebp], eax
  0003a	3b f0		 cmp	 esi, eax
  0003c	0f 8e 88 01 00
	00		 jle	 $LN11@DropKantur@2

; 2140 : 	{
; 2141 : 		iDropItemNum = rand()% this->GetBagCount();

  00042	e8 00 00 00 00	 call	 _rand
  00047	99		 cdq
  00048	f7 fe		 idiv	 esi

; 2142 : 		fDur = 0;
; 2143 : 
; 2144 : 		if ( cX == 0 && cY == 0 )

  0004a	8a 45 10	 mov	 al, BYTE PTR _cX$[ebp]
  0004d	8a 4d 14	 mov	 cl, BYTE PTR _cY$[ebp]
  00050	8b f2		 mov	 esi, edx
  00052	89 75 08	 mov	 DWORD PTR _iDropItemNum$[ebp], esi
  00055	84 c0		 test	 al, al
  00057	75 1a		 jne	 SHORT $LN10@DropKantur@2
  00059	84 c9		 test	 cl, cl
  0005b	75 16		 jne	 SHORT $LN10@DropKantur@2

; 2145 : 		{
; 2146 : 			X = lpObj->X;

  0005d	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]

; 2147 : 			Y = lpObj->Y;

  00064	0f bf 8f 46 01
	00 00		 movsx	 ecx, WORD PTR [edi+326]
  0006b	89 45 ec	 mov	 DWORD PTR _X$[ebp], eax
  0006e	89 4d 14	 mov	 DWORD PTR _Y$[ebp], ecx

; 2148 : 		}
; 2149 : 		else

  00071	eb 0c		 jmp	 SHORT $LN9@DropKantur@2
$LN10@DropKantur@2:

; 2150 : 		{
; 2151 : 			X = cX;

  00073	0f b6 d0	 movzx	 edx, al

; 2152 : 			Y = cY;

  00076	0f b6 c1	 movzx	 eax, cl
  00079	89 55 ec	 mov	 DWORD PTR _X$[ebp], edx
  0007c	89 45 14	 mov	 DWORD PTR _Y$[ebp], eax
$LN9@DropKantur@2:

; 2153 : 		}
; 2154 : 
; 2155 : 		iLevel = this->GetLevel(iDropItemNum);

  0007f	56		 push	 esi
  00080	8b cb		 mov	 ecx, ebx
  00082	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel

; 2156 : 		iType = ItemGetNumberMake(this->BagObject[iDropItemNum].m_type, this->BagObject[iDropItemNum].m_index);

  00087	0f b6 94 f3 1e
	02 00 00	 movzx	 edx, BYTE PTR [ebx+esi*8+542]
  0008f	0f b6 c8	 movzx	 ecx, al
  00092	0f b6 84 f3 1d
	02 00 00	 movzx	 eax, BYTE PTR [ebx+esi*8+541]
  0009a	52		 push	 edx
  0009b	50		 push	 eax
  0009c	89 4d 10	 mov	 DWORD PTR _iLevel$[ebp], ecx
  0009f	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  000a4	8b f0		 mov	 esi, eax
  000a6	83 c4 08	 add	 esp, 8

; 2157 : 
; 2158 : 		if ( iType == -1 )

  000a9	83 fe ff	 cmp	 esi, -1
  000ac	75 0b		 jne	 SHORT $LN8@DropKantur@2

; 2159 : 			return FALSE;

  000ae	5f		 pop	 edi
  000af	5e		 pop	 esi
  000b0	33 c0		 xor	 eax, eax
  000b2	5b		 pop	 ebx

; 2207 : }

  000b3	8b e5		 mov	 esp, ebp
  000b5	5d		 pop	 ebp
  000b6	c2 10 00	 ret	 16			; 00000010H
$LN8@DropKantur@2:

; 2160 : 
; 2161 : 		if ( this->BagObject[iDropItemNum].m_isskill )

  000b9	8b 45 08	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  000bc	80 bc c3 21 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+545], 0
  000c4	74 07		 je	 SHORT $LN19@DropKantur@2

; 2162 : 			iOption1 = 1;

  000c6	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1
$LN19@DropKantur@2:

; 2163 : 
; 2164 : 		if ( this->BagObject[iDropItemNum].m_isluck )

  000cd	80 bc c3 22 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+546], 0
  000d5	74 21		 je	 SHORT $LN20@DropKantur@2

; 2165 : 		{
; 2166 : 			iOption2 = 0;

  000d7	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 2167 : 
; 2168 : 			if ( (rand()%2) == 0 )

  000de	e8 00 00 00 00	 call	 _rand
  000e3	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  000e8	79 05		 jns	 SHORT $LN24@DropKantur@2
  000ea	48		 dec	 eax
  000eb	83 c8 fe	 or	 eax, -2			; fffffffeH
  000ee	40		 inc	 eax
$LN24@DropKantur@2:
  000ef	75 07		 jne	 SHORT $LN20@DropKantur@2

; 2169 : 			{
; 2170 : 				iOption2 = 1;

  000f1	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 1
$LN20@DropKantur@2:

; 2171 : 			}
; 2172 : 		}
; 2173 : 
; 2174 : 		if ( this->BagObject[iDropItemNum].m_isoption != 0 )

  000f8	8b 4d 08	 mov	 ecx, DWORD PTR _iDropItemNum$[ebp]
  000fb	80 bc cb 23 02
	00 00 00	 cmp	 BYTE PTR [ebx+ecx*8+547], 0
  00103	74 2b		 je	 SHORT $LN2@DropKantur@2

; 2175 : 		{
; 2176 : 			if ( rand()%5 < 1 )

  00105	e8 00 00 00 00	 call	 _rand
  0010a	99		 cdq
  0010b	b9 05 00 00 00	 mov	 ecx, 5
  00110	f7 f9		 idiv	 ecx
  00112	83 fa 01	 cmp	 edx, 1
  00115	7d 09		 jge	 SHORT $LN3@DropKantur@2

; 2177 : 			{
; 2178 : 				iOption3 = 3;

  00117	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 3

; 2179 : 			}
; 2180 : 			else

  0011e	eb 10		 jmp	 SHORT $LN2@DropKantur@2
$LN3@DropKantur@2:

; 2181 : 			{
; 2182 : 				iOption3 = rand()%3;

  00120	e8 00 00 00 00	 call	 _rand
  00125	99		 cdq
  00126	b9 03 00 00 00	 mov	 ecx, 3
  0012b	f7 f9		 idiv	 ecx
  0012d	89 55 fc	 mov	 DWORD PTR _iOption3$[ebp], edx
$LN2@DropKantur@2:

; 2183 : 			}
; 2184 : 		}
; 2185 : 
; 2186 : 		if ( this->BagObject[iDropItemNum].m_isexitem != 0 )

  00130	8b 55 08	 mov	 edx, DWORD PTR _iDropItemNum$[ebp]
  00133	80 bc d3 24 02
	00 00 00	 cmp	 BYTE PTR [ebx+edx*8+548], 0
  0013b	74 1e		 je	 SHORT $LN21@DropKantur@2

; 2187 : 		{
; 2188 : 			iExOption = NewOptionRand(0);

  0013d	6a 00		 push	 0
  0013f	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  00144	0f b6 c0	 movzx	 eax, al
  00147	83 c4 04	 add	 esp, 4
  0014a	89 45 f0	 mov	 DWORD PTR _iExOption$[ebp], eax

; 2189 : #ifndef _FIX_
; 2190 : 			iOption2 = 0;
; 2191 : #endif
; 2192 : 			iOption1 = 1;

  0014d	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1

; 2193 : 			iLevel = 0;

  00154	c7 45 10 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0
$LN21@DropKantur@2:

; 2194 : 		}
; 2195 : 
; 2196 : 		ItemSerialCreateSend(lpObj->m_Index, (BYTE)btMapNumber, (BYTE)X, (BYTE)Y, iType, (BYTE)iLevel, (BYTE)fDur,
; 2197 : 			(BYTE)iOption1, (BYTE)iOption2, (BYTE)iOption3, lpObj->m_Index, (BYTE)iExOption, 0);

  0015b	8b 4d f0	 mov	 ecx, DWORD PTR _iExOption$[ebp]
  0015e	8b 07		 mov	 eax, DWORD PTR [edi]
  00160	8b 55 fc	 mov	 edx, DWORD PTR _iOption3$[ebp]
  00163	8b 5d 0c	 mov	 ebx, DWORD PTR _btMapNumber$[ebp]
  00166	6a 00		 push	 0
  00168	51		 push	 ecx
  00169	8b 4d f8	 mov	 ecx, DWORD PTR _iOption2$[ebp]
  0016c	50		 push	 eax
  0016d	52		 push	 edx
  0016e	8b 55 f4	 mov	 edx, DWORD PTR _iOption1$[ebp]
  00171	51		 push	 ecx
  00172	8b 4d 10	 mov	 ecx, DWORD PTR _iLevel$[ebp]
  00175	52		 push	 edx
  00176	8b 55 14	 mov	 edx, DWORD PTR _Y$[ebp]
  00179	6a 00		 push	 0
  0017b	51		 push	 ecx
  0017c	8b 4d ec	 mov	 ecx, DWORD PTR _X$[ebp]
  0017f	56		 push	 esi
  00180	52		 push	 edx
  00181	51		 push	 ecx
  00182	53		 push	 ebx
  00183	50		 push	 eax
  00184	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 2198 : 
; 2199 : 		LogAddTD("[ KANTURU ][ Reward ] Nightmare Item Drop [%s][%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d",
; 2200 : 			lpObj->AccountID, lpObj->Name, btMapNumber, X, Y, ItemAttribute[iType].Name,
; 2201 : 			iType, iLevel, iOption1, iOption2, iOption3, iExOption);

  00189	8b 55 f0	 mov	 edx, DWORD PTR _iExOption$[ebp]
  0018c	8b 45 fc	 mov	 eax, DWORD PTR _iOption3$[ebp]
  0018f	8b 4d f8	 mov	 ecx, DWORD PTR _iOption2$[ebp]
  00192	52		 push	 edx
  00193	8b 55 f4	 mov	 edx, DWORD PTR _iOption1$[ebp]
  00196	50		 push	 eax
  00197	8b 45 10	 mov	 eax, DWORD PTR _iLevel$[ebp]
  0019a	51		 push	 ecx
  0019b	8b 4d 14	 mov	 ecx, DWORD PTR _Y$[ebp]
  0019e	52		 push	 edx
  0019f	8b 55 ec	 mov	 edx, DWORD PTR _X$[ebp]
  001a2	50		 push	 eax
  001a3	56		 push	 esi
  001a4	6b f6 70	 imul	 esi, 112		; 00000070H
  001a7	81 c6 00 00 00
	00		 add	 esi, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  001ad	56		 push	 esi
  001ae	51		 push	 ecx
  001af	52		 push	 edx
  001b0	0f b6 c3	 movzx	 eax, bl
  001b3	50		 push	 eax
  001b4	8d 4f 77	 lea	 ecx, DWORD PTR [edi+119]
  001b7	51		 push	 ecx
  001b8	83 c7 6c	 add	 edi, 108		; 0000006cH
  001bb	57		 push	 edi
  001bc	68 00 00 00 00	 push	 OFFSET ??_C@_0HD@MEBEJHHD@?$FL?5KANTURU?5?$FN?$FL?5Reward?5?$FN?5Nightmare?5@
  001c1	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  001c7	83 c4 68	 add	 esp, 104		; 00000068H
$LN11@DropKantur@2:

; 2202 : 
; 2203 : 		return TRUE;
; 2204 : 	}
; 2205 : 
; 2206 : 	return TRUE;

  001ca	5f		 pop	 edi
  001cb	5e		 pop	 esi
  001cc	b8 01 00 00 00	 mov	 eax, 1
  001d1	5b		 pop	 ebx

; 2207 : }

  001d2	8b e5		 mov	 esp, ebp
  001d4	5d		 pop	 ebp
  001d5	c2 10 00	 ret	 16			; 00000010H
?DropKanturuNightmareItem@CItemBagZt@@QAEHHEEE@Z ENDP	; CItemBagZt::DropKanturuNightmareItem
_TEXT	ENDS
PUBLIC	??_C@_0HE@PLDIECFP@?$FL?5DOUBLEGOER?5?$FN?$FL?5Reward?5?$FN?5Silver?5@ ; `string'
PUBLIC	?DropSilverChestItem@CItemBagZt@@QAEHHEEE@Z	; CItemBagZt::DropSilverChestItem
;	COMDAT ??_C@_0HE@PLDIECFP@?$FL?5DOUBLEGOER?5?$FN?$FL?5Reward?5?$FN?5Silver?5@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0HE@PLDIECFP@?$FL?5DOUBLEGOER?5?$FN?$FL?5Reward?5?$FN?5Silver?5@ DB '['
	DB	' DOUBLEGOER ][ Reward ] Silver Chest Drop [%s][%s] : (%d)(%d/'
	DB	'%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d', 00H ; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropSilverChestItem@CItemBagZt@@QAEHHEEE@Z
_TEXT	SEGMENT
_X$ = -20						; size = 4
_iExOption$ = -16					; size = 4
_iOption1$ = -12					; size = 4
_iOption2$ = -8						; size = 4
_iOption3$ = -4						; size = 4
_iDropItemNum$ = 8					; size = 4
_aIndex$ = 8						; size = 4
_btMapNumber$ = 12					; size = 1
_iLevel$ = 16						; size = 4
_cX$ = 16						; size = 1
_Y$ = 20						; size = 4
_cY$ = 20						; size = 1
?DropSilverChestItem@CItemBagZt@@QAEHHEEE@Z PROC	; CItemBagZt::DropSilverChestItem, COMDAT
; _this$ = ecx

; 2211 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 14	 sub	 esp, 20			; 00000014H
  00006	53		 push	 ebx
  00007	8b d9		 mov	 ebx, ecx

; 2212 : 	if ( this->m_bLoad == FALSE )

  00009	33 c0		 xor	 eax, eax
  0000b	39 43 04	 cmp	 DWORD PTR [ebx+4], eax
  0000e	75 07		 jne	 SHORT $LN12@DropSilver
  00010	5b		 pop	 ebx

; 2296 : }

  00011	8b e5		 mov	 esp, ebp
  00013	5d		 pop	 ebp
  00014	c2 10 00	 ret	 16			; 00000010H
$LN12@DropSilver:
  00017	56		 push	 esi

; 2213 : 		return FALSE;
; 2214 : 
; 2215 : 	float fDur = 0;
; 2216 : 	int iType = 0;
; 2217 : 	int iLevel = 0;
; 2218 : 	int X = 0;
; 2219 : 	int Y = 0;
; 2220 : 	int iOption1 = 0;
; 2221 : 	int iOption2 = 0;
; 2222 : 	int iOption3 = 0;
; 2223 : 	int iDropItemNum = 0;
; 2224 : 	int iDropItemRate = 0;
; 2225 : 	int iExOption = 0;
; 2226 : 	LPOBJ lpObj = &gObj[aIndex];
; 2227 : 
; 2228 : 	if ( this->GetBagCount() > 0 )

  00018	8b b3 20 01 00
	00		 mov	 esi, DWORD PTR [ebx+288]
  0001e	57		 push	 edi
  0001f	8b 7d 08	 mov	 edi, DWORD PTR _aIndex$[ebp]
  00022	69 ff 50 2b 00
	00		 imul	 edi, 11088		; 00002b50H
  00028	03 3d 00 00 00
	00		 add	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0002e	89 45 f4	 mov	 DWORD PTR _iOption1$[ebp], eax
  00031	89 45 f8	 mov	 DWORD PTR _iOption2$[ebp], eax
  00034	89 45 fc	 mov	 DWORD PTR _iOption3$[ebp], eax
  00037	89 45 f0	 mov	 DWORD PTR _iExOption$[ebp], eax
  0003a	3b f0		 cmp	 esi, eax
  0003c	0f 8e 88 01 00
	00		 jle	 $LN11@DropSilver

; 2229 : 	{
; 2230 : 		iDropItemNum = rand()% this->GetBagCount();

  00042	e8 00 00 00 00	 call	 _rand
  00047	99		 cdq
  00048	f7 fe		 idiv	 esi

; 2231 : 		fDur = 0;
; 2232 : 
; 2233 : 		if ( cX == 0 && cY == 0 )

  0004a	8a 45 10	 mov	 al, BYTE PTR _cX$[ebp]
  0004d	8a 4d 14	 mov	 cl, BYTE PTR _cY$[ebp]
  00050	8b f2		 mov	 esi, edx
  00052	89 75 08	 mov	 DWORD PTR _iDropItemNum$[ebp], esi
  00055	84 c0		 test	 al, al
  00057	75 1a		 jne	 SHORT $LN10@DropSilver
  00059	84 c9		 test	 cl, cl
  0005b	75 16		 jne	 SHORT $LN10@DropSilver

; 2234 : 		{
; 2235 : 			X = lpObj->X;

  0005d	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]

; 2236 : 			Y = lpObj->Y;

  00064	0f bf 8f 46 01
	00 00		 movsx	 ecx, WORD PTR [edi+326]
  0006b	89 45 ec	 mov	 DWORD PTR _X$[ebp], eax
  0006e	89 4d 14	 mov	 DWORD PTR _Y$[ebp], ecx

; 2237 : 		}
; 2238 : 		else

  00071	eb 0c		 jmp	 SHORT $LN9@DropSilver
$LN10@DropSilver:

; 2239 : 		{
; 2240 : 			X = cX;

  00073	0f b6 d0	 movzx	 edx, al

; 2241 : 			Y = cY;

  00076	0f b6 c1	 movzx	 eax, cl
  00079	89 55 ec	 mov	 DWORD PTR _X$[ebp], edx
  0007c	89 45 14	 mov	 DWORD PTR _Y$[ebp], eax
$LN9@DropSilver:

; 2242 : 		}
; 2243 : 
; 2244 : 		iLevel = this->GetLevel(iDropItemNum);

  0007f	56		 push	 esi
  00080	8b cb		 mov	 ecx, ebx
  00082	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel

; 2245 : 		iType = ItemGetNumberMake(this->BagObject[iDropItemNum].m_type, this->BagObject[iDropItemNum].m_index);

  00087	0f b6 94 f3 1e
	02 00 00	 movzx	 edx, BYTE PTR [ebx+esi*8+542]
  0008f	0f b6 c8	 movzx	 ecx, al
  00092	0f b6 84 f3 1d
	02 00 00	 movzx	 eax, BYTE PTR [ebx+esi*8+541]
  0009a	52		 push	 edx
  0009b	50		 push	 eax
  0009c	89 4d 10	 mov	 DWORD PTR _iLevel$[ebp], ecx
  0009f	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  000a4	8b f0		 mov	 esi, eax
  000a6	83 c4 08	 add	 esp, 8

; 2246 : 
; 2247 : 		if ( iType == -1 )

  000a9	83 fe ff	 cmp	 esi, -1
  000ac	75 0b		 jne	 SHORT $LN8@DropSilver

; 2248 : 			return FALSE;

  000ae	5f		 pop	 edi
  000af	5e		 pop	 esi
  000b0	33 c0		 xor	 eax, eax
  000b2	5b		 pop	 ebx

; 2296 : }

  000b3	8b e5		 mov	 esp, ebp
  000b5	5d		 pop	 ebp
  000b6	c2 10 00	 ret	 16			; 00000010H
$LN8@DropSilver:

; 2249 : 
; 2250 : 		if ( this->BagObject[iDropItemNum].m_isskill )

  000b9	8b 45 08	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  000bc	80 bc c3 21 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+545], 0
  000c4	74 07		 je	 SHORT $LN19@DropSilver

; 2251 : 			iOption1 = 1;

  000c6	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1
$LN19@DropSilver:

; 2252 : 
; 2253 : 		if ( this->BagObject[iDropItemNum].m_isluck )

  000cd	80 bc c3 22 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+546], 0
  000d5	74 21		 je	 SHORT $LN20@DropSilver

; 2254 : 		{
; 2255 : 			iOption2 = 0;

  000d7	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 2256 : 
; 2257 : 			if ( (rand()%2) == 0 )

  000de	e8 00 00 00 00	 call	 _rand
  000e3	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  000e8	79 05		 jns	 SHORT $LN24@DropSilver
  000ea	48		 dec	 eax
  000eb	83 c8 fe	 or	 eax, -2			; fffffffeH
  000ee	40		 inc	 eax
$LN24@DropSilver:
  000ef	75 07		 jne	 SHORT $LN20@DropSilver

; 2258 : 			{
; 2259 : 				iOption2 = 1;

  000f1	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 1
$LN20@DropSilver:

; 2260 : 			}
; 2261 : 		}
; 2262 : 
; 2263 : 		if ( this->BagObject[iDropItemNum].m_isoption != 0 )

  000f8	8b 4d 08	 mov	 ecx, DWORD PTR _iDropItemNum$[ebp]
  000fb	80 bc cb 23 02
	00 00 00	 cmp	 BYTE PTR [ebx+ecx*8+547], 0
  00103	74 2b		 je	 SHORT $LN2@DropSilver

; 2264 : 		{
; 2265 : 			if ( rand()%5 < 1 )

  00105	e8 00 00 00 00	 call	 _rand
  0010a	99		 cdq
  0010b	b9 05 00 00 00	 mov	 ecx, 5
  00110	f7 f9		 idiv	 ecx
  00112	83 fa 01	 cmp	 edx, 1
  00115	7d 09		 jge	 SHORT $LN3@DropSilver

; 2266 : 			{
; 2267 : 				iOption3 = 3;

  00117	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 3

; 2268 : 			}
; 2269 : 			else

  0011e	eb 10		 jmp	 SHORT $LN2@DropSilver
$LN3@DropSilver:

; 2270 : 			{
; 2271 : 				iOption3 = rand()%3;

  00120	e8 00 00 00 00	 call	 _rand
  00125	99		 cdq
  00126	b9 03 00 00 00	 mov	 ecx, 3
  0012b	f7 f9		 idiv	 ecx
  0012d	89 55 fc	 mov	 DWORD PTR _iOption3$[ebp], edx
$LN2@DropSilver:

; 2272 : 			}
; 2273 : 		}
; 2274 : 
; 2275 : 		if ( this->BagObject[iDropItemNum].m_isexitem != 0 )

  00130	8b 55 08	 mov	 edx, DWORD PTR _iDropItemNum$[ebp]
  00133	80 bc d3 24 02
	00 00 00	 cmp	 BYTE PTR [ebx+edx*8+548], 0
  0013b	74 1e		 je	 SHORT $LN21@DropSilver

; 2276 : 		{
; 2277 : 			iExOption = NewOptionRand(0);

  0013d	6a 00		 push	 0
  0013f	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  00144	0f b6 c0	 movzx	 eax, al
  00147	83 c4 04	 add	 esp, 4
  0014a	89 45 f0	 mov	 DWORD PTR _iExOption$[ebp], eax

; 2278 : #ifndef _FIX_
; 2279 : 			iOption2 = 0;
; 2280 : #endif
; 2281 : 			iOption1 = 1;

  0014d	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1

; 2282 : 			iLevel = 0;

  00154	c7 45 10 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0
$LN21@DropSilver:

; 2283 : 		}
; 2284 : 
; 2285 : 		ItemSerialCreateSend(lpObj->m_Index, btMapNumber, X, Y, iType, iLevel, fDur,
; 2286 : 			iOption1, iOption2, iOption3, lpObj->m_Index, iExOption, 0);

  0015b	8b 4d f0	 mov	 ecx, DWORD PTR _iExOption$[ebp]
  0015e	8b 07		 mov	 eax, DWORD PTR [edi]
  00160	8b 55 fc	 mov	 edx, DWORD PTR _iOption3$[ebp]
  00163	8b 5d 0c	 mov	 ebx, DWORD PTR _btMapNumber$[ebp]
  00166	6a 00		 push	 0
  00168	51		 push	 ecx
  00169	8b 4d f8	 mov	 ecx, DWORD PTR _iOption2$[ebp]
  0016c	50		 push	 eax
  0016d	52		 push	 edx
  0016e	8b 55 f4	 mov	 edx, DWORD PTR _iOption1$[ebp]
  00171	51		 push	 ecx
  00172	8b 4d 10	 mov	 ecx, DWORD PTR _iLevel$[ebp]
  00175	52		 push	 edx
  00176	8b 55 14	 mov	 edx, DWORD PTR _Y$[ebp]
  00179	6a 00		 push	 0
  0017b	51		 push	 ecx
  0017c	8b 4d ec	 mov	 ecx, DWORD PTR _X$[ebp]
  0017f	56		 push	 esi
  00180	52		 push	 edx
  00181	51		 push	 ecx
  00182	53		 push	 ebx
  00183	50		 push	 eax
  00184	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 2287 : 
; 2288 : 		LogAddTD("[ DOUBLEGOER ][ Reward ] Silver Chest Drop [%s][%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d",
; 2289 : 			lpObj->AccountID, lpObj->Name, btMapNumber, X, Y, ItemAttribute[iType].Name,
; 2290 : 			iType, iLevel, iOption1, iOption2, iOption3, iExOption);

  00189	8b 55 f0	 mov	 edx, DWORD PTR _iExOption$[ebp]
  0018c	8b 45 fc	 mov	 eax, DWORD PTR _iOption3$[ebp]
  0018f	8b 4d f8	 mov	 ecx, DWORD PTR _iOption2$[ebp]
  00192	52		 push	 edx
  00193	8b 55 f4	 mov	 edx, DWORD PTR _iOption1$[ebp]
  00196	50		 push	 eax
  00197	8b 45 10	 mov	 eax, DWORD PTR _iLevel$[ebp]
  0019a	51		 push	 ecx
  0019b	8b 4d 14	 mov	 ecx, DWORD PTR _Y$[ebp]
  0019e	52		 push	 edx
  0019f	8b 55 ec	 mov	 edx, DWORD PTR _X$[ebp]
  001a2	50		 push	 eax
  001a3	56		 push	 esi
  001a4	6b f6 70	 imul	 esi, 112		; 00000070H
  001a7	81 c6 00 00 00
	00		 add	 esi, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  001ad	56		 push	 esi
  001ae	51		 push	 ecx
  001af	52		 push	 edx
  001b0	0f b6 c3	 movzx	 eax, bl
  001b3	50		 push	 eax
  001b4	8d 4f 77	 lea	 ecx, DWORD PTR [edi+119]
  001b7	51		 push	 ecx
  001b8	83 c7 6c	 add	 edi, 108		; 0000006cH
  001bb	57		 push	 edi
  001bc	68 00 00 00 00	 push	 OFFSET ??_C@_0HE@PLDIECFP@?$FL?5DOUBLEGOER?5?$FN?$FL?5Reward?5?$FN?5Silver?5@
  001c1	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  001c7	83 c4 68	 add	 esp, 104		; 00000068H
$LN11@DropSilver:

; 2291 : 
; 2292 : 		return TRUE;
; 2293 : 	}
; 2294 : 
; 2295 : 	return TRUE;

  001ca	5f		 pop	 edi
  001cb	5e		 pop	 esi
  001cc	b8 01 00 00 00	 mov	 eax, 1
  001d1	5b		 pop	 ebx

; 2296 : }

  001d2	8b e5		 mov	 esp, ebp
  001d4	5d		 pop	 ebp
  001d5	c2 10 00	 ret	 16			; 00000010H
?DropSilverChestItem@CItemBagZt@@QAEHHEEE@Z ENDP	; CItemBagZt::DropSilverChestItem
_TEXT	ENDS
PUBLIC	??_C@_0HE@BPPBJCGL@?$FL?5DOUBLEGOER?5?$FN?$FL?5Reward?5?$FN?5Golden?5@ ; `string'
PUBLIC	?DropGoldenChestItem@CItemBagZt@@QAEHHEEE@Z	; CItemBagZt::DropGoldenChestItem
;	COMDAT ??_C@_0HE@BPPBJCGL@?$FL?5DOUBLEGOER?5?$FN?$FL?5Reward?5?$FN?5Golden?5@
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
CONST	SEGMENT
??_C@_0HE@BPPBJCGL@?$FL?5DOUBLEGOER?5?$FN?$FL?5Reward?5?$FN?5Golden?5@ DB '['
	DB	' DOUBLEGOER ][ Reward ] Golden Chest Drop [%s][%s] : (%d)(%d/'
	DB	'%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d', 00H ; `string'
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
CONST	ENDS
;	COMDAT ?DropGoldenChestItem@CItemBagZt@@QAEHHEEE@Z
_TEXT	SEGMENT
_X$ = -20						; size = 4
_iExOption$ = -16					; size = 4
_iOption1$ = -12					; size = 4
_iOption2$ = -8						; size = 4
_iOption3$ = -4						; size = 4
_iDropItemNum$ = 8					; size = 4
_aIndex$ = 8						; size = 4
_btMapNumber$ = 12					; size = 1
_iLevel$ = 16						; size = 4
_cX$ = 16						; size = 1
_Y$ = 20						; size = 4
_cY$ = 20						; size = 1
?DropGoldenChestItem@CItemBagZt@@QAEHHEEE@Z PROC	; CItemBagZt::DropGoldenChestItem, COMDAT
; _this$ = ecx

; 2299 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 14	 sub	 esp, 20			; 00000014H
  00006	53		 push	 ebx
  00007	8b d9		 mov	 ebx, ecx

; 2300 : 	if ( this->m_bLoad == FALSE )

  00009	33 c0		 xor	 eax, eax
  0000b	39 43 04	 cmp	 DWORD PTR [ebx+4], eax
  0000e	75 07		 jne	 SHORT $LN12@DropGolden
  00010	5b		 pop	 ebx

; 2384 : }

  00011	8b e5		 mov	 esp, ebp
  00013	5d		 pop	 ebp
  00014	c2 10 00	 ret	 16			; 00000010H
$LN12@DropGolden:
  00017	56		 push	 esi

; 2301 : 		return FALSE;
; 2302 : 
; 2303 : 	float fDur = 0;
; 2304 : 	int iType = 0;
; 2305 : 	int iLevel = 0;
; 2306 : 	int X = 0;
; 2307 : 	int Y = 0;
; 2308 : 	int iOption1 = 0;
; 2309 : 	int iOption2 = 0;
; 2310 : 	int iOption3 = 0;
; 2311 : 	int iDropItemNum = 0;
; 2312 : 	int iDropItemRate = 0;
; 2313 : 	int iExOption = 0;
; 2314 : 	LPOBJ lpObj = &gObj[aIndex];
; 2315 : 
; 2316 : 	if ( this->GetBagCount() > 0 )

  00018	8b b3 20 01 00
	00		 mov	 esi, DWORD PTR [ebx+288]
  0001e	57		 push	 edi
  0001f	8b 7d 08	 mov	 edi, DWORD PTR _aIndex$[ebp]
  00022	69 ff 50 2b 00
	00		 imul	 edi, 11088		; 00002b50H
  00028	03 3d 00 00 00
	00		 add	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0002e	89 45 f4	 mov	 DWORD PTR _iOption1$[ebp], eax
  00031	89 45 f8	 mov	 DWORD PTR _iOption2$[ebp], eax
  00034	89 45 fc	 mov	 DWORD PTR _iOption3$[ebp], eax
  00037	89 45 f0	 mov	 DWORD PTR _iExOption$[ebp], eax
  0003a	3b f0		 cmp	 esi, eax
  0003c	0f 8e 88 01 00
	00		 jle	 $LN11@DropGolden

; 2317 : 	{
; 2318 : 		iDropItemNum = rand()% this->GetBagCount();

  00042	e8 00 00 00 00	 call	 _rand
  00047	99		 cdq
  00048	f7 fe		 idiv	 esi

; 2319 : 		fDur = 0;
; 2320 : 
; 2321 : 		if ( cX == 0 && cY == 0 )

  0004a	8a 45 10	 mov	 al, BYTE PTR _cX$[ebp]
  0004d	8a 4d 14	 mov	 cl, BYTE PTR _cY$[ebp]
  00050	8b f2		 mov	 esi, edx
  00052	89 75 08	 mov	 DWORD PTR _iDropItemNum$[ebp], esi
  00055	84 c0		 test	 al, al
  00057	75 1a		 jne	 SHORT $LN10@DropGolden
  00059	84 c9		 test	 cl, cl
  0005b	75 16		 jne	 SHORT $LN10@DropGolden

; 2322 : 		{
; 2323 : 			X = lpObj->X;

  0005d	0f bf 87 44 01
	00 00		 movsx	 eax, WORD PTR [edi+324]

; 2324 : 			Y = lpObj->Y;

  00064	0f bf 8f 46 01
	00 00		 movsx	 ecx, WORD PTR [edi+326]
  0006b	89 45 ec	 mov	 DWORD PTR _X$[ebp], eax
  0006e	89 4d 14	 mov	 DWORD PTR _Y$[ebp], ecx

; 2325 : 		}
; 2326 : 		else

  00071	eb 0c		 jmp	 SHORT $LN9@DropGolden
$LN10@DropGolden:

; 2327 : 		{
; 2328 : 			X = cX;

  00073	0f b6 d0	 movzx	 edx, al

; 2329 : 			Y = cY;

  00076	0f b6 c1	 movzx	 eax, cl
  00079	89 55 ec	 mov	 DWORD PTR _X$[ebp], edx
  0007c	89 45 14	 mov	 DWORD PTR _Y$[ebp], eax
$LN9@DropGolden:

; 2330 : 		}
; 2331 : 
; 2332 : 		iLevel = this->GetLevel(iDropItemNum);

  0007f	56		 push	 esi
  00080	8b cb		 mov	 ecx, ebx
  00082	e8 00 00 00 00	 call	 ?GetLevel@CItemBagZt@@AAEEH@Z ; CItemBagZt::GetLevel

; 2333 : 		iType = ItemGetNumberMake(this->BagObject[iDropItemNum].m_type, this->BagObject[iDropItemNum].m_index);

  00087	0f b6 94 f3 1e
	02 00 00	 movzx	 edx, BYTE PTR [ebx+esi*8+542]
  0008f	0f b6 c8	 movzx	 ecx, al
  00092	0f b6 84 f3 1d
	02 00 00	 movzx	 eax, BYTE PTR [ebx+esi*8+541]
  0009a	52		 push	 edx
  0009b	50		 push	 eax
  0009c	89 4d 10	 mov	 DWORD PTR _iLevel$[ebp], ecx
  0009f	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  000a4	8b f0		 mov	 esi, eax
  000a6	83 c4 08	 add	 esp, 8

; 2334 : 
; 2335 : 		if ( iType == -1 )

  000a9	83 fe ff	 cmp	 esi, -1
  000ac	75 0b		 jne	 SHORT $LN8@DropGolden

; 2336 : 			return FALSE;

  000ae	5f		 pop	 edi
  000af	5e		 pop	 esi
  000b0	33 c0		 xor	 eax, eax
  000b2	5b		 pop	 ebx

; 2384 : }

  000b3	8b e5		 mov	 esp, ebp
  000b5	5d		 pop	 ebp
  000b6	c2 10 00	 ret	 16			; 00000010H
$LN8@DropGolden:

; 2337 : 
; 2338 : 		if ( this->BagObject[iDropItemNum].m_isskill )

  000b9	8b 45 08	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  000bc	80 bc c3 21 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+545], 0
  000c4	74 07		 je	 SHORT $LN19@DropGolden

; 2339 : 			iOption1 = 1;

  000c6	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1
$LN19@DropGolden:

; 2340 : 
; 2341 : 		if ( this->BagObject[iDropItemNum].m_isluck )

  000cd	80 bc c3 22 02
	00 00 00	 cmp	 BYTE PTR [ebx+eax*8+546], 0
  000d5	74 21		 je	 SHORT $LN20@DropGolden

; 2342 : 		{
; 2343 : 			iOption2 = 0;

  000d7	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 2344 : 
; 2345 : 			if ( (rand()%2) == 0 )

  000de	e8 00 00 00 00	 call	 _rand
  000e3	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  000e8	79 05		 jns	 SHORT $LN24@DropGolden
  000ea	48		 dec	 eax
  000eb	83 c8 fe	 or	 eax, -2			; fffffffeH
  000ee	40		 inc	 eax
$LN24@DropGolden:
  000ef	75 07		 jne	 SHORT $LN20@DropGolden

; 2346 : 			{
; 2347 : 				iOption2 = 1;

  000f1	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 1
$LN20@DropGolden:

; 2348 : 			}
; 2349 : 		}
; 2350 : 
; 2351 : 		if ( this->BagObject[iDropItemNum].m_isoption != 0 )

  000f8	8b 4d 08	 mov	 ecx, DWORD PTR _iDropItemNum$[ebp]
  000fb	80 bc cb 23 02
	00 00 00	 cmp	 BYTE PTR [ebx+ecx*8+547], 0
  00103	74 2b		 je	 SHORT $LN2@DropGolden

; 2352 : 		{
; 2353 : 			if ( rand()%5 < 1 )

  00105	e8 00 00 00 00	 call	 _rand
  0010a	99		 cdq
  0010b	b9 05 00 00 00	 mov	 ecx, 5
  00110	f7 f9		 idiv	 ecx
  00112	83 fa 01	 cmp	 edx, 1
  00115	7d 09		 jge	 SHORT $LN3@DropGolden

; 2354 : 			{
; 2355 : 				iOption3 = 3;

  00117	c7 45 fc 03 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 3

; 2356 : 			}
; 2357 : 			else

  0011e	eb 10		 jmp	 SHORT $LN2@DropGolden
$LN3@DropGolden:

; 2358 : 			{
; 2359 : 				iOption3 = rand()%3;

  00120	e8 00 00 00 00	 call	 _rand
  00125	99		 cdq
  00126	b9 03 00 00 00	 mov	 ecx, 3
  0012b	f7 f9		 idiv	 ecx
  0012d	89 55 fc	 mov	 DWORD PTR _iOption3$[ebp], edx
$LN2@DropGolden:

; 2360 : 			}
; 2361 : 		}
; 2362 : 
; 2363 : 		if ( this->BagObject[iDropItemNum].m_isexitem != 0 )

  00130	8b 55 08	 mov	 edx, DWORD PTR _iDropItemNum$[ebp]
  00133	80 bc d3 24 02
	00 00 00	 cmp	 BYTE PTR [ebx+edx*8+548], 0
  0013b	74 1e		 je	 SHORT $LN21@DropGolden

; 2364 : 		{
; 2365 : 			iExOption = NewOptionRand(0);

  0013d	6a 00		 push	 0
  0013f	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  00144	0f b6 c0	 movzx	 eax, al
  00147	83 c4 04	 add	 esp, 4
  0014a	89 45 f0	 mov	 DWORD PTR _iExOption$[ebp], eax

; 2366 : #ifndef _FIX_
; 2367 : 			iOption2 = 0;
; 2368 : #endif
; 2369 : 			iOption1 = 1;

  0014d	c7 45 f4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1

; 2370 : 			iLevel = 0;

  00154	c7 45 10 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0
$LN21@DropGolden:

; 2371 : 		}
; 2372 : 
; 2373 : 		ItemSerialCreateSend(lpObj->m_Index, btMapNumber, X, Y, iType, iLevel, fDur,
; 2374 : 			iOption1, iOption2, iOption3, lpObj->m_Index, iExOption, 0);

  0015b	8b 4d f0	 mov	 ecx, DWORD PTR _iExOption$[ebp]
  0015e	8b 07		 mov	 eax, DWORD PTR [edi]
  00160	8b 55 fc	 mov	 edx, DWORD PTR _iOption3$[ebp]
  00163	8b 5d 0c	 mov	 ebx, DWORD PTR _btMapNumber$[ebp]
  00166	6a 00		 push	 0
  00168	51		 push	 ecx
  00169	8b 4d f8	 mov	 ecx, DWORD PTR _iOption2$[ebp]
  0016c	50		 push	 eax
  0016d	52		 push	 edx
  0016e	8b 55 f4	 mov	 edx, DWORD PTR _iOption1$[ebp]
  00171	51		 push	 ecx
  00172	8b 4d 10	 mov	 ecx, DWORD PTR _iLevel$[ebp]
  00175	52		 push	 edx
  00176	8b 55 14	 mov	 edx, DWORD PTR _Y$[ebp]
  00179	6a 00		 push	 0
  0017b	51		 push	 ecx
  0017c	8b 4d ec	 mov	 ecx, DWORD PTR _X$[ebp]
  0017f	56		 push	 esi
  00180	52		 push	 edx
  00181	51		 push	 ecx
  00182	53		 push	 ebx
  00183	50		 push	 eax
  00184	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend

; 2375 : 
; 2376 : 		LogAddTD("[ DOUBLEGOER ][ Reward ] Golden Chest Drop [%s][%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d",
; 2377 : 			lpObj->AccountID, lpObj->Name, btMapNumber, X, Y, ItemAttribute[iType].Name,
; 2378 : 			iType, iLevel, iOption1, iOption2, iOption3, iExOption);

  00189	8b 55 f0	 mov	 edx, DWORD PTR _iExOption$[ebp]
  0018c	8b 45 fc	 mov	 eax, DWORD PTR _iOption3$[ebp]
  0018f	8b 4d f8	 mov	 ecx, DWORD PTR _iOption2$[ebp]
  00192	52		 push	 edx
  00193	8b 55 f4	 mov	 edx, DWORD PTR _iOption1$[ebp]
  00196	50		 push	 eax
  00197	8b 45 10	 mov	 eax, DWORD PTR _iLevel$[ebp]
  0019a	51		 push	 ecx
  0019b	8b 4d 14	 mov	 ecx, DWORD PTR _Y$[ebp]
  0019e	52		 push	 edx
  0019f	8b 55 ec	 mov	 edx, DWORD PTR _X$[ebp]
  001a2	50		 push	 eax
  001a3	56		 push	 esi
  001a4	6b f6 70	 imul	 esi, 112		; 00000070H
  001a7	81 c6 00 00 00
	00		 add	 esi, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  001ad	56		 push	 esi
  001ae	51		 push	 ecx
  001af	52		 push	 edx
  001b0	0f b6 c3	 movzx	 eax, bl
  001b3	50		 push	 eax
  001b4	8d 4f 77	 lea	 ecx, DWORD PTR [edi+119]
  001b7	51		 push	 ecx
  001b8	83 c7 6c	 add	 edi, 108		; 0000006cH
  001bb	57		 push	 edi
  001bc	68 00 00 00 00	 push	 OFFSET ??_C@_0HE@BPPBJCGL@?$FL?5DOUBLEGOER?5?$FN?$FL?5Reward?5?$FN?5Golden?5@
  001c1	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  001c7	83 c4 68	 add	 esp, 104		; 00000068H
$LN11@DropGolden:

; 2379 : 
; 2380 : 		return TRUE;
; 2381 : 	}
; 2382 : 
; 2383 : 	return TRUE;

  001ca	5f		 pop	 edi
  001cb	5e		 pop	 esi
  001cc	b8 01 00 00 00	 mov	 eax, 1
  001d1	5b		 pop	 ebx

; 2384 : }

  001d2	8b e5		 mov	 esp, ebp
  001d4	5d		 pop	 ebp
  001d5	c2 10 00	 ret	 16			; 00000010H
?DropGoldenChestItem@CItemBagZt@@QAEHHEEE@Z ENDP	; CItemBagZt::DropGoldenChestItem
_TEXT	ENDS
PUBLIC	??0CItemBagDropMapInfo@@QAE@XZ			; CItemBagDropMapInfo::CItemBagDropMapInfo
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.h
;	COMDAT ??0CItemBagDropMapInfo@@QAE@XZ
_TEXT	SEGMENT
??0CItemBagDropMapInfo@@QAE@XZ PROC			; CItemBagDropMapInfo::CItemBagDropMapInfo, COMDAT
; _this$ = ecx

; 19   : 	CItemBagDropMapInfo()

  00000	8b c1		 mov	 eax, ecx

; 20   : 	{
; 21   : 		this->Init();

  00002	32 c9		 xor	 cl, cl
  00004	66 c7 00 00 00	 mov	 WORD PTR [eax], 0
  00009	88 48 02	 mov	 BYTE PTR [eax+2], cl

; 22   : 	};

  0000c	c3		 ret	 0
??0CItemBagDropMapInfo@@QAE@XZ ENDP			; CItemBagDropMapInfo::CItemBagDropMapInfo
_TEXT	ENDS
PUBLIC	??0CItemBagZt@@QAE@XZ				; CItemBagZt::CItemBagZt
; Function compile flags: /Ogtp
; File e:\work\tranet_version\gs\gameserver\itembagzt.cpp
;	COMDAT ??0CItemBagZt@@QAE@XZ
_TEXT	SEGMENT
??0CItemBagZt@@QAE@XZ PROC				; CItemBagZt::CItemBagZt, COMDAT
; _this$ = ecx

; 13   : {

  00000	53		 push	 ebx
  00001	8b c1		 mov	 eax, ecx
  00003	56		 push	 esi
  00004	c7 00 00 00 00
	00		 mov	 DWORD PTR [eax], OFFSET ??_7CItemBagZt@@6B@
  0000a	8d 90 24 01 00
	00		 lea	 edx, DWORD PTR [eax+292]
  00010	be 52 00 00 00	 mov	 esi, 82			; 00000052H
  00015	32 db		 xor	 bl, bl
$LL4@CItemBagZt:
  00017	88 1a		 mov	 BYTE PTR [edx], bl
  00019	88 5a 01	 mov	 BYTE PTR [edx+1], bl
  0001c	88 5a 02	 mov	 BYTE PTR [edx+2], bl
  0001f	83 c2 03	 add	 edx, 3
  00022	4e		 dec	 esi
  00023	79 f2		 jns	 SHORT $LL4@CItemBagZt
  00025	8d 90 1d 02 00
	00		 lea	 edx, DWORD PTR [eax+541]
  0002b	be 95 00 00 00	 mov	 esi, 149		; 00000095H
$LL12@CItemBagZt:
  00030	88 1a		 mov	 BYTE PTR [edx], bl
  00032	88 5a 01	 mov	 BYTE PTR [edx+1], bl
  00035	88 5a 02	 mov	 BYTE PTR [edx+2], bl
  00038	88 5a 03	 mov	 BYTE PTR [edx+3], bl
  0003b	88 5a 04	 mov	 BYTE PTR [edx+4], bl
  0003e	88 5a 05	 mov	 BYTE PTR [edx+5], bl
  00041	88 5a 06	 mov	 BYTE PTR [edx+6], bl
  00044	88 5a 07	 mov	 BYTE PTR [edx+7], bl
  00047	83 c2 08	 add	 edx, 8
  0004a	4e		 dec	 esi
  0004b	79 e3		 jns	 SHORT $LL12@CItemBagZt

; 14   : 	return;
; 15   : }

  0004d	5e		 pop	 esi
  0004e	5b		 pop	 ebx
  0004f	c3		 ret	 0
??0CItemBagZt@@QAE@XZ ENDP				; CItemBagZt::CItemBagZt
_TEXT	ENDS
EXTRN	??3@YAXPAX@Z:PROC				; operator delete
; Function compile flags: /Ogtp
;	COMDAT ??_GCItemBagZt@@UAEPAXI@Z
_TEXT	SEGMENT
___flags$ = 8						; size = 4
??_GCItemBagZt@@UAEPAXI@Z PROC				; CItemBagZt::`scalar deleting destructor', COMDAT
; _this$ = ecx
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	56		 push	 esi
  00004	8b f1		 mov	 esi, ecx
  00006	e8 00 00 00 00	 call	 ??1CItemBagZt@@UAE@XZ	; CItemBagZt::~CItemBagZt
  0000b	f6 45 08 01	 test	 BYTE PTR ___flags$[ebp], 1
  0000f	74 09		 je	 SHORT $LN4@scalar
  00011	56		 push	 esi
  00012	e8 00 00 00 00	 call	 ??3@YAXPAX@Z		; operator delete
  00017	83 c4 04	 add	 esp, 4
$LN4@scalar:
  0001a	8b c6		 mov	 eax, esi
  0001c	5e		 pop	 esi
  0001d	5d		 pop	 ebp
  0001e	c2 04 00	 ret	 4
??_GCItemBagZt@@UAEPAXI@Z ENDP				; CItemBagZt::`scalar deleting destructor'
_TEXT	ENDS
PUBLIC	?Init@CItemBagZt@@QAEXPAD@Z			; CItemBagZt::Init
EXTRN	?GetNewPath@CDirPath@@QAEPADPAD@Z:PROC		; CDirPath::GetNewPath
EXTRN	?gDirPath@@3VCDirPath@@A:BYTE			; gDirPath
; Function compile flags: /Ogtp
;	COMDAT ?Init@CItemBagZt@@QAEXPAD@Z
_TEXT	SEGMENT
_name$ = 8						; size = 4
?Init@CItemBagZt@@QAEXPAD@Z PROC			; CItemBagZt::Init, COMDAT
; _this$ = ecx

; 23   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 24   : 	this->m_bLoad = FALSE;

  00003	33 c0		 xor	 eax, eax
  00005	56		 push	 esi
  00006	8b f1		 mov	 esi, ecx
  00008	89 46 04	 mov	 DWORD PTR [esi+4], eax

; 25   : 	this->m_sEventName[0] = 0;

  0000b	88 46 08	 mov	 BYTE PTR [esi+8], al

; 26   : 	this->m_iEventItemType = -1;
; 27   : 	this->m_iEventItemLevel = 0;

  0000e	89 86 0c 01 00
	00		 mov	 DWORD PTR [esi+268], eax

; 28   : 	this->m_iDropZen = 0;

  00014	89 86 10 01 00
	00		 mov	 DWORD PTR [esi+272], eax

; 29   : 	this->m_iEventItemDropRate = 0;

  0001a	89 86 14 01 00
	00		 mov	 DWORD PTR [esi+276], eax

; 30   : 	this->m_iItemDropRate = 0;

  00020	89 86 18 01 00
	00		 mov	 DWORD PTR [esi+280], eax

; 31   : 	this->m_iExItemDropRate = 0;

  00026	89 86 1c 01 00
	00		 mov	 DWORD PTR [esi+284], eax

; 32   : 	this->m_iBagObjectCount = 0;

  0002c	89 86 20 01 00
	00		 mov	 DWORD PTR [esi+288], eax

; 33   : 
; 34   : 	this->LoadItem(gDirPath.GetNewPath(name));

  00032	8b 45 08	 mov	 eax, DWORD PTR _name$[ebp]
  00035	50		 push	 eax
  00036	b9 00 00 00 00	 mov	 ecx, OFFSET ?gDirPath@@3VCDirPath@@A ; gDirPath
  0003b	c7 86 08 01 00
	00 ff ff ff ff	 mov	 DWORD PTR [esi+264], -1
  00045	e8 00 00 00 00	 call	 ?GetNewPath@CDirPath@@QAEPADPAD@Z ; CDirPath::GetNewPath
  0004a	50		 push	 eax
  0004b	8b ce		 mov	 ecx, esi
  0004d	e8 00 00 00 00	 call	 ?LoadItem@CItemBagZt@@QAEXPAD@Z ; CItemBagZt::LoadItem
  00052	5e		 pop	 esi

; 35   : }

  00053	5d		 pop	 ebp
  00054	c2 04 00	 ret	 4
?Init@CItemBagZt@@QAEXPAD@Z ENDP			; CItemBagZt::Init
_TEXT	ENDS
END
