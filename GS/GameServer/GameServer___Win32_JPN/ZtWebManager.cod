; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.30319.01 

	TITLE	E:\work\tranet_version\GS\GameServer\ZtWebManager.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?g_ZtWebManager@@3VCZtWebManager@@A		; g_ZtWebManager
_BSS	SEGMENT
?g_ZtWebManager@@3VCZtWebManager@@A DB 01H DUP (?)	; g_ZtWebManager
_BSS	ENDS
PUBLIC	??_H@YGXPAXIHP6EPAX0@Z@Z			; `vector constructor iterator'
; Function compile flags: /Ogtp
;	COMDAT ??_H@YGXPAXIHP6EPAX0@Z@Z
_TEXT	SEGMENT
___t$ = 8						; size = 4
___s$ = 12						; size = 4
___n$ = 16						; size = 4
___f$ = 20						; size = 4
??_H@YGXPAXIHP6EPAX0@Z@Z PROC				; `vector constructor iterator', COMDAT
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	57		 push	 edi
  00004	8b 7d 10	 mov	 edi, DWORD PTR ___n$[ebp]
  00007	4f		 dec	 edi
  00008	78 14		 js	 SHORT $LN1@vector
  0000a	53		 push	 ebx
  0000b	8b 5d 14	 mov	 ebx, DWORD PTR ___f$[ebp]
  0000e	56		 push	 esi
  0000f	8b 75 08	 mov	 esi, DWORD PTR ___t$[ebp]
$LL2@vector:
  00012	8b ce		 mov	 ecx, esi
  00014	ff d3		 call	 ebx
  00016	03 75 0c	 add	 esi, DWORD PTR ___s$[ebp]
  00019	4f		 dec	 edi
  0001a	79 f6		 jns	 SHORT $LL2@vector
  0001c	5e		 pop	 esi
  0001d	5b		 pop	 ebx
$LN1@vector:
  0001e	5f		 pop	 edi
  0001f	5d		 pop	 ebp
  00020	c2 10 00	 ret	 16			; 00000010H
??_H@YGXPAXIHP6EPAX0@Z@Z ENDP				; `vector constructor iterator'
_TEXT	ENDS
PUBLIC	__real@41f0000000000000
PUBLIC	?GameShopUpdate@CZtWebManager@@QAEXPAUGAMESHOP_WEB_UPDATE@@@Z ; CZtWebManager::GameShopUpdate
EXTRN	?ZtUserDataSend@@YAXH@Z:PROC			; ZtUserDataSend
EXTRN	?gObj@@3PAUOBJECTSTRUCT@@A:DWORD		; gObj
EXTRN	__fltused:DWORD
;	COMDAT __real@41f0000000000000
; File e:\work\tranet_version\gs\gameserver\ztwebmanager.cpp
CONST	SEGMENT
__real@41f0000000000000 DQ 041f0000000000000r	; 4.29497e+009
; Function compile flags: /Ogtp
CONST	ENDS
;	COMDAT ?GameShopUpdate@CZtWebManager@@QAEXPAUGAMESHOP_WEB_UPDATE@@@Z
_TEXT	SEGMENT
tv249 = 8						; size = 4
tv247 = 8						; size = 4
tv245 = 8						; size = 4
_lpMsg$ = 8						; size = 4
?GameShopUpdate@CZtWebManager@@QAEXPAUGAMESHOP_WEB_UPDATE@@@Z PROC ; CZtWebManager::GameShopUpdate, COMDAT
; _this$ = ecx

; 23   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	53		 push	 ebx

; 24   : 	int aIndex = -1;
; 25   : 
; 26   : 	for(int n = OBJ_STARTUSERINDZT; n < OBJMAX; n++)

  00004	8b 5d 08	 mov	 ebx, DWORD PTR _lpMsg$[ebp]
  00007	56		 push	 esi
  00008	8b 35 00 00 00
	00		 mov	 esi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0000e	57		 push	 edi
  0000f	bf b0 36 00 00	 mov	 edi, 14000		; 000036b0H
  00014	81 c6 6c a7 40
	09		 add	 esi, 155232108		; 0940a76cH
  0001a	8d 9b 00 00 00
	00		 npad	 6
$LL7@GameShopUp:

; 27   : 	{
; 28   : 		if(gObj[n].Connected == PLAYER_PLAYING)

  00020	83 7e 98 03	 cmp	 DWORD PTR [esi-104], 3
  00024	75 35		 jne	 SHORT $LN6@GameShopUp

; 29   : 		{
; 30   : 			if(gObj[n].AccountID[0] == lpMsg->AccountID[0])

  00026	8a 06		 mov	 al, BYTE PTR [esi]
  00028	3a 43 04	 cmp	 al, BYTE PTR [ebx+4]
  0002b	8d 4b 04	 lea	 ecx, DWORD PTR [ebx+4]
  0002e	75 2b		 jne	 SHORT $LN6@GameShopUp

; 31   : 			{
; 32   : 				if(strcmp(&gObj[n].AccountID[0] , lpMsg->AccountID) == 0)

  00030	8b c6		 mov	 eax, esi
$LL13@GameShopUp:
  00032	8a 10		 mov	 dl, BYTE PTR [eax]
  00034	3a 11		 cmp	 dl, BYTE PTR [ecx]
  00036	75 1a		 jne	 SHORT $LN14@GameShopUp
  00038	84 d2		 test	 dl, dl
  0003a	74 12		 je	 SHORT $LN15@GameShopUp
  0003c	8a 50 01	 mov	 dl, BYTE PTR [eax+1]
  0003f	3a 51 01	 cmp	 dl, BYTE PTR [ecx+1]
  00042	75 0e		 jne	 SHORT $LN14@GameShopUp
  00044	83 c0 02	 add	 eax, 2
  00047	83 c1 02	 add	 ecx, 2
  0004a	84 d2		 test	 dl, dl
  0004c	75 e4		 jne	 SHORT $LL13@GameShopUp
$LN15@GameShopUp:
  0004e	33 c0		 xor	 eax, eax
  00050	eb 05		 jmp	 SHORT $LN16@GameShopUp
$LN14@GameShopUp:
  00052	1b c0		 sbb	 eax, eax
  00054	83 d8 ff	 sbb	 eax, -1
$LN16@GameShopUp:
  00057	85 c0		 test	 eax, eax
  00059	74 16		 je	 SHORT $LN11@GameShopUp
$LN6@GameShopUp:

; 24   : 	int aIndex = -1;
; 25   : 
; 26   : 	for(int n = OBJ_STARTUSERINDZT; n < OBJMAX; n++)

  0005b	47		 inc	 edi
  0005c	81 c6 50 2b 00
	00		 add	 esi, 11088		; 00002b50H
  00062	81 ff 98 3a 00
	00		 cmp	 edi, 15000		; 00003a98H
  00068	7c b6		 jl	 SHORT $LL7@GameShopUp
  0006a	5f		 pop	 edi
  0006b	5e		 pop	 esi
  0006c	5b		 pop	 ebx

; 52   : }

  0006d	5d		 pop	 ebp
  0006e	c2 04 00	 ret	 4
$LN11@GameShopUp:

; 33   : 				{
; 34   : 					aIndex = n;
; 35   : 					break;
; 36   : 				}
; 37   : 			}
; 38   : 		}
; 39   : 	}
; 40   : 
; 41   : 	if(aIndex == -1)

  00071	83 ff ff	 cmp	 edi, -1
  00074	74 59		 je	 SHORT $LN8@GameShopUp

; 42   : 	{
; 43   : 		return;
; 44   : 	}
; 45   : 
; 46   : 	LPOBJ lpUser = &gObj[aIndex];
; 47   : 	lpUser->GameShop.WCoinC = lpMsg->WCoinC;

  00076	8b 4b 10	 mov	 ecx, DWORD PTR [ebx+16]
  00079	db 43 10	 fild	 DWORD PTR [ebx+16]
  0007c	8b c7		 mov	 eax, edi
  0007e	69 c0 50 2b 00
	00		 imul	 eax, 11088		; 00002b50H
  00084	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0008a	85 c9		 test	 ecx, ecx
  0008c	79 06		 jns	 SHORT $LN17@GameShopUp
  0008e	dc 05 00 00 00
	00		 fadd	 QWORD PTR __real@41f0000000000000
$LN17@GameShopUp:
  00094	dd 98 00 23 00
	00		 fstp	 QWORD PTR [eax+8960]

; 48   : 	lpUser->GameShop.WCoinP = lpMsg->WCoinP;

  0009a	8b 53 14	 mov	 edx, DWORD PTR [ebx+20]
  0009d	db 43 14	 fild	 DWORD PTR [ebx+20]
  000a0	85 d2		 test	 edx, edx
  000a2	79 06		 jns	 SHORT $LN18@GameShopUp
  000a4	dc 05 00 00 00
	00		 fadd	 QWORD PTR __real@41f0000000000000
$LN18@GameShopUp:
  000aa	dd 98 f8 22 00
	00		 fstp	 QWORD PTR [eax+8952]

; 49   : 	lpUser->GameShop.GoblinPoint = lpMsg->GoblinPoint;

  000b0	8b 4b 18	 mov	 ecx, DWORD PTR [ebx+24]
  000b3	db 43 18	 fild	 DWORD PTR [ebx+24]
  000b6	85 c9		 test	 ecx, ecx
  000b8	79 06		 jns	 SHORT $LN19@GameShopUp
  000ba	dc 05 00 00 00
	00		 fadd	 QWORD PTR __real@41f0000000000000
$LN19@GameShopUp:

; 50   : 
; 51   : 	ZtUserDataSend(aIndex);

  000c0	57		 push	 edi
  000c1	dd 98 08 23 00
	00		 fstp	 QWORD PTR [eax+8968]
  000c7	e8 00 00 00 00	 call	 ?ZtUserDataSend@@YAXH@Z	; ZtUserDataSend
  000cc	83 c4 04	 add	 esp, 4
$LN8@GameShopUp:
  000cf	5f		 pop	 edi
  000d0	5e		 pop	 esi
  000d1	5b		 pop	 ebx

; 52   : }

  000d2	5d		 pop	 ebp
  000d3	c2 04 00	 ret	 4
?GameShopUpdate@CZtWebManager@@QAEXPAUGAMESHOP_WEB_UPDATE@@@Z ENDP ; CZtWebManager::GameShopUpdate
_TEXT	ENDS
PUBLIC	__real@4f800000
PUBLIC	?CreditsUpdate@CZtWebManager@@QAEXPAUCREDIT_WEB_UPDATE@@@Z ; CZtWebManager::CreditsUpdate
;	COMDAT __real@4f800000
CONST	SEGMENT
__real@4f800000 DD 04f800000r			; 4.29497e+009
; Function compile flags: /Ogtp
CONST	ENDS
;	COMDAT ?CreditsUpdate@CZtWebManager@@QAEXPAUCREDIT_WEB_UPDATE@@@Z
_TEXT	SEGMENT
tv239 = 8						; size = 4
_lpMsg$ = 8						; size = 4
?CreditsUpdate@CZtWebManager@@QAEXPAUCREDIT_WEB_UPDATE@@@Z PROC ; CZtWebManager::CreditsUpdate, COMDAT
; _this$ = ecx

; 55   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	53		 push	 ebx

; 56   : 	int aIndex = -1;
; 57   : 
; 58   : 	for(int n = OBJ_STARTUSERINDZT; n < OBJMAX; n++)

  00004	8b 5d 08	 mov	 ebx, DWORD PTR _lpMsg$[ebp]
  00007	56		 push	 esi
  00008	8b 35 00 00 00
	00		 mov	 esi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0000e	57		 push	 edi
  0000f	bf b0 36 00 00	 mov	 edi, 14000		; 000036b0H
  00014	81 c6 6c a7 40
	09		 add	 esi, 155232108		; 0940a76cH
  0001a	8d 9b 00 00 00
	00		 npad	 6
$LL7@CreditsUpd:

; 59   : 	{
; 60   : 		if(gObj[n].Connected == PLAYER_PLAYING)

  00020	83 7e 98 03	 cmp	 DWORD PTR [esi-104], 3
  00024	75 35		 jne	 SHORT $LN6@CreditsUpd

; 61   : 		{
; 62   : 			if(gObj[n].AccountID[0] == lpMsg->AccountID[0])

  00026	8a 06		 mov	 al, BYTE PTR [esi]
  00028	3a 43 04	 cmp	 al, BYTE PTR [ebx+4]
  0002b	8d 4b 04	 lea	 ecx, DWORD PTR [ebx+4]
  0002e	75 2b		 jne	 SHORT $LN6@CreditsUpd

; 63   : 			{
; 64   : 				if(strcmp(&gObj[n].AccountID[0] , lpMsg->AccountID) == 0)

  00030	8b c6		 mov	 eax, esi
$LL13@CreditsUpd:
  00032	8a 10		 mov	 dl, BYTE PTR [eax]
  00034	3a 11		 cmp	 dl, BYTE PTR [ecx]
  00036	75 1a		 jne	 SHORT $LN14@CreditsUpd
  00038	84 d2		 test	 dl, dl
  0003a	74 12		 je	 SHORT $LN15@CreditsUpd
  0003c	8a 50 01	 mov	 dl, BYTE PTR [eax+1]
  0003f	3a 51 01	 cmp	 dl, BYTE PTR [ecx+1]
  00042	75 0e		 jne	 SHORT $LN14@CreditsUpd
  00044	83 c0 02	 add	 eax, 2
  00047	83 c1 02	 add	 ecx, 2
  0004a	84 d2		 test	 dl, dl
  0004c	75 e4		 jne	 SHORT $LL13@CreditsUpd
$LN15@CreditsUpd:
  0004e	33 c0		 xor	 eax, eax
  00050	eb 05		 jmp	 SHORT $LN16@CreditsUpd
$LN14@CreditsUpd:
  00052	1b c0		 sbb	 eax, eax
  00054	83 d8 ff	 sbb	 eax, -1
$LN16@CreditsUpd:
  00057	85 c0		 test	 eax, eax
  00059	74 16		 je	 SHORT $LN11@CreditsUpd
$LN6@CreditsUpd:

; 56   : 	int aIndex = -1;
; 57   : 
; 58   : 	for(int n = OBJ_STARTUSERINDZT; n < OBJMAX; n++)

  0005b	47		 inc	 edi
  0005c	81 c6 50 2b 00
	00		 add	 esi, 11088		; 00002b50H
  00062	81 ff 98 3a 00
	00		 cmp	 edi, 15000		; 00003a98H
  00068	7c b6		 jl	 SHORT $LL7@CreditsUpd
  0006a	5f		 pop	 edi
  0006b	5e		 pop	 esi
  0006c	5b		 pop	 ebx

; 82   : }

  0006d	5d		 pop	 ebp
  0006e	c2 04 00	 ret	 4
$LN11@CreditsUpd:

; 65   : 				{
; 66   : 					aIndex = n;
; 67   : 					break;
; 68   : 				}
; 69   : 			}
; 70   : 		}
; 71   : 	}
; 72   : 
; 73   : 	if(aIndex == -1)

  00071	83 ff ff	 cmp	 edi, -1
  00074	74 2d		 je	 SHORT $LN8@CreditsUpd

; 74   : 	{
; 75   : 		return;
; 76   : 	}
; 77   : 
; 78   : 	LPOBJ lpUser = &gObj[aIndex];
; 79   : 	lpUser->ZtCred = lpMsg->Credit;

  00076	8b 4b 10	 mov	 ecx, DWORD PTR [ebx+16]
  00079	db 43 10	 fild	 DWORD PTR [ebx+16]
  0007c	85 c9		 test	 ecx, ecx
  0007e	79 06		 jns	 SHORT $LN17@CreditsUpd
  00080	d8 05 00 00 00
	00		 fadd	 DWORD PTR __real@4f800000
$LN17@CreditsUpd:
  00086	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0008b	8b d7		 mov	 edx, edi
  0008d	69 d2 50 2b 00
	00		 imul	 edx, 11088		; 00002b50H

; 80   : 
; 81   : 	ZtUserDataSend(aIndex);

  00093	57		 push	 edi
  00094	d9 9c 02 a8 22
	00 00		 fstp	 DWORD PTR [edx+eax+8872]
  0009b	e8 00 00 00 00	 call	 ?ZtUserDataSend@@YAXH@Z	; ZtUserDataSend
  000a0	83 c4 04	 add	 esp, 4
$LN8@CreditsUpd:
  000a3	5f		 pop	 edi
  000a4	5e		 pop	 esi
  000a5	5b		 pop	 ebx

; 82   : }

  000a6	5d		 pop	 ebp
  000a7	c2 04 00	 ret	 4
?CreditsUpdate@CZtWebManager@@QAEXPAUCREDIT_WEB_UPDATE@@@Z ENDP ; CZtWebManager::CreditsUpdate
_TEXT	ENDS
PUBLIC	?Protocol@CZtWebManager@@QAEXEPAE@Z		; CZtWebManager::Protocol
; Function compile flags: /Ogtp
;	COMDAT ?Protocol@CZtWebManager@@QAEXEPAE@Z
_TEXT	SEGMENT
_protoNum$ = 8						; size = 1
_aRecv$ = 12						; size = 4
?Protocol@CZtWebManager@@QAEXEPAE@Z PROC		; CZtWebManager::Protocol, COMDAT
; _this$ = ecx

; 10   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 11   : 	switch(protoNum)

  00003	0f b6 45 08	 movzx	 eax, BYTE PTR _protoNum$[ebp]
  00007	83 e8 00	 sub	 eax, 0
  0000a	74 10		 je	 SHORT $LN2@Protocol
  0000c	48		 dec	 eax
  0000d	75 16		 jne	 SHORT $LN3@Protocol

; 15   : 		break;
; 16   : 	case 0x01:
; 17   : 		this->CreditsUpdate((CREDIT_WEB_UPDATE*)aRecv);

  0000f	8b 45 0c	 mov	 eax, DWORD PTR _aRecv$[ebp]
  00012	50		 push	 eax
  00013	e8 00 00 00 00	 call	 ?CreditsUpdate@CZtWebManager@@QAEXPAUCREDIT_WEB_UPDATE@@@Z ; CZtWebManager::CreditsUpdate

; 18   : 		break;
; 19   : 	}
; 20   : }

  00018	5d		 pop	 ebp
  00019	c2 08 00	 ret	 8
$LN2@Protocol:

; 12   : 	{
; 13   : 	case 0x00:
; 14   : 		this->GameShopUpdate((GAMESHOP_WEB_UPDATE*)aRecv);

  0001c	8b 55 0c	 mov	 edx, DWORD PTR _aRecv$[ebp]
  0001f	52		 push	 edx
  00020	e8 00 00 00 00	 call	 ?GameShopUpdate@CZtWebManager@@QAEXPAUGAMESHOP_WEB_UPDATE@@@Z ; CZtWebManager::GameShopUpdate
$LN3@Protocol:

; 18   : 		break;
; 19   : 	}
; 20   : }

  00025	5d		 pop	 ebp
  00026	c2 08 00	 ret	 8
?Protocol@CZtWebManager@@QAEXEPAE@Z ENDP		; CZtWebManager::Protocol
_TEXT	ENDS
END
